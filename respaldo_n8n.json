[
  {
    "updatedAt": "2025-07-04T12:41:08.000Z",
    "createdAt": "2025-04-22T15:22:55.721Z",
    "id": "1XO5qIENwWyX1cn9",
    "name": "ComfyUI",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "typeVersion": 1.1,
        "position": [
          0,
          0
        ],
        "id": "a0f41695-a6bb-434a-8d40-3791e5e1846b",
        "name": "When chat message received",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=You are an expert prompt engineer for AI image generation. When I provide a simple concept, transform it into a highly detailed, vivid prompt that an AI image generator can use to create a beautiful image.\n\nConcept: {{ $json.chatInput }}\n\nYour expanded prompts should:\nInclude visual details about style, composition, lighting, colors, and mood\nSpecify camera angles, artistic influences, and technical aspects like lens type when appropriate\nAdd descriptive adjectives and cinematic elements that enhance the concept\nBe carefully crafted to avoid unwanted elements\nBe approximately 4‚Äì6 sentences long\nFormat your response as a complete, ready-to-use prompt without explanations or commentary. "
        },
        "type": "@n8n/n8n-nodes-langchain.chainLlm",
        "typeVersion": 1.6,
        "position": [
          220,
          0
        ],
        "id": "ab4873ed-4f4e-401d-902d-9e7640ffee52",
        "name": "Basic LLM Chain"
      },
      {
        "parameters": {
          "model": "deepseek/deepseek-chat:free",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          240,
          180
        ],
        "id": "a12e346f-6f06-499a-823d-1e6340ce2ac9",
        "name": "OpenRouter Chat Model",
        "credentials": {
          "openRouterApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $json.text.replace(/\"/g, '') }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 512,\n      \"height\": 512,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}"
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          580,
          0
        ],
        "id": "0ecf59e3-57c6-4db3-9f43-a4cb005c0f46",
        "name": "ComfyUI",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/image ",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -80,
          380
        ],
        "id": "733a0770-fa8f-429b-92df-717f19601bc9",
        "name": "If"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your image",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          140,
          360
        ],
        "id": "502eb9b7-e098-4bae-aed5-e2730a739c99",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?image\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          320,
          360
        ],
        "id": "37859914-9405-45ed-bd39-3016b3b5d761",
        "name": "Code"
      },
      {
        "parameters": {
          "operation": "sendPhoto",
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          960,
          360
        ],
        "id": "1e760afa-cbaf-4d69-949e-65ee41ef0d48",
        "name": "Telegram1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $('Telegram Trigger').item.json.message.caption }}",
                "rightValue": "/video",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -80,
          620
        ],
        "id": "7e198ee8-d7bd-402f-a24b-d6ba989fa8c6",
        "name": "If1"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your video",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          160,
          600
        ],
        "id": "04561682-63a2-4a2e-8ab2-79c87229320e",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.caption;\nconst cleanPrompt = original\n  .replace(/^\\/?video\\s*/i, \"\")  \n  .replace(/^\\/+/, \"\")          \n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If1').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          340,
          600
        ],
        "id": "a48b2060-5162-40e1-a79c-ead117df0a05",
        "name": "Code1"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1120,
          600
        ],
        "id": "42d95c01-5cbb-4325-a4d9-d3ec7355cb8d",
        "name": "Telegram3",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"3\": {\n    \"inputs\": {\n      \"seed\": 1043102782273638,\n      \"steps\": 20,\n      \"cfg\": 6,\n      \"sampler_name\": \"uni_pc\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"54\",\n        0\n      ],\n      \"positive\": [\n        \"50\",\n        0\n      ],\n      \"negative\": [\n        \"50\",\n        1\n      ],\n      \"latent_image\": [\n        \"50\",\n        2\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"6\": {\n    \"inputs\": {\n      \"text\": \"{{ $('Code1').item.json.prompt }}\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"7\": {\n    \"inputs\": {\n      \"text\": \"Ëâ≤Ë∞ÉËâ≥‰∏ΩÔºåËøáÊõùÔºåÈùôÊÄÅÔºåÁªÜËäÇÊ®°Á≥ä‰∏çÊ∏ÖÔºåÂ≠óÂπïÔºåÈ£éÊ†ºÔºå‰ΩúÂìÅÔºåÁîª‰ΩúÔºåÁîªÈù¢ÔºåÈùôÊ≠¢ÔºåÊï¥‰ΩìÂèëÁÅ∞ÔºåÊúÄÂ∑ÆË¥®ÈáèÔºå‰ΩéË¥®ÈáèÔºåJPEGÂéãÁº©ÊÆãÁïôÔºå‰∏ëÈôãÁöÑÔºåÊÆãÁº∫ÁöÑÔºåÂ§ö‰ΩôÁöÑÊâãÊåáÔºåÁîªÂæó‰∏çÂ•ΩÁöÑÊâãÈÉ®ÔºåÁîªÂæó‰∏çÂ•ΩÁöÑËÑ∏ÈÉ®ÔºåÁï∏ÂΩ¢ÁöÑÔºåÊØÅÂÆπÁöÑÔºåÂΩ¢ÊÄÅÁï∏ÂΩ¢ÁöÑËÇ¢‰ΩìÔºåÊâãÊåáËûçÂêàÔºåÈùôÊ≠¢‰∏çÂä®ÁöÑÁîªÈù¢ÔºåÊùÇ‰π±ÁöÑËÉåÊôØÔºå‰∏âÊù°ËÖøÔºåËÉåÊôØ‰∫∫ÂæàÂ§öÔºåÂÄíÁùÄËµ∞\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"3\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"37\": {\n    \"inputs\": {\n      \"unet_name\": \"Wan2.1\\\\wan2.1_i2v_480p_14B_fp8_scaled.safetensors\",\n      \"weight_dtype\": \"default\"\n    },\n    \"class_type\": \"UNETLoader\",\n    \"_meta\": {\n      \"title\": \"Load Diffusion Model\"\n    }\n  },\n  \"38\": {\n    \"inputs\": {\n      \"clip_name\": \"umt5_xxl_fp8_e4m3fn_scaled.safetensors\",\n      \"type\": \"wan\",\n      \"device\": \"default\"\n    },\n    \"class_type\": \"CLIPLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP\"\n    }\n  },\n  \"39\": {\n    \"inputs\": {\n      \"vae_name\": \"wan_2.1_vae.safetensors\"\n    },\n    \"class_type\": \"VAELoader\",\n    \"_meta\": {\n      \"title\": \"Load VAE\"\n    }\n  },\n  \"49\": {\n    \"inputs\": {\n      \"clip_name\": \"clip_vision_h.safetensors\"\n    },\n    \"class_type\": \"CLIPVisionLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP Vision\"\n    }\n  },\n  \"50\": {\n    \"inputs\": {\n      \"width\": 512,\n      \"height\": 512,\n      \"length\": 33,\n      \"batch_size\": 1,\n      \"positive\": [\n        \"6\",\n        0\n      ],\n      \"negative\": [\n        \"7\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ],\n      \"clip_vision_output\": [\n        \"51\",\n        0\n      ],\n      \"start_image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"WanImageToVideo\",\n    \"_meta\": {\n      \"title\": \"WanImageToVideo\"\n    }\n  },\n  \"51\": {\n    \"inputs\": {\n      \"crop\": \"none\",\n      \"clip_vision\": [\n        \"49\",\n        0\n      ],\n      \"image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPVisionEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Vision Encode\"\n    }\n  },\n  \"52\": {\n    \"inputs\": {\n      \"image\": \"ComfyUI_00001_.png\"\n    },\n    \"class_type\": \"LoadImage\",\n    \"_meta\": {\n      \"title\": \"Load Image\"\n    }\n  },\n  \"54\": {\n    \"inputs\": {\n      \"shift\": 8,\n      \"model\": [\n        \"37\",\n        0\n      ]\n    },\n    \"class_type\": \"ModelSamplingSD3\",\n    \"_meta\": {\n      \"title\": \"ModelSamplingSD3\"\n    }\n  },\n  \"55\": {\n    \"inputs\": {\n      \"frame_rate\": 16,\n      \"loop_count\": 0,\n      \"filename_prefix\": \"comfyUI\",\n      \"format\": \"video/h264-mp4\",\n      \"pix_fmt\": \"yuv420p\",\n      \"crf\": 19,\n      \"save_metadata\": true,\n      \"trim_to_audio\": false,\n      \"pingpong\": false,\n      \"save_output\": true,\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"VHS_VideoCombine\",\n    \"_meta\": {\n      \"title\": \"Video Combine üé•üÖ•üÖóüÖ¢\"\n    }\n  }\n}",
          "inputType": "binary"
        },
        "type": "n8n-nodes-comfyui-image-to-video.comfyuiImageToVideo",
        "typeVersion": 1,
        "position": [
          920,
          600
        ],
        "id": "c61a87ef-74ae-4343-985d-79cf579a9b63",
        "name": "ComfyUI Image to Video",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "resource": "file",
          "fileId": "={{ $('Telegram Trigger').item.json.message.document.thumbnail.file_id }}"
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          520,
          600
        ],
        "id": "f5f0e43c-03d9-4db1-90b7-ed1e36b92fff",
        "name": "Telegram4",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "return $input.all().map(item => {\n  if (item.binary && item.binary.data) {\n    item.binary.data.mimeType = 'image/png'; // O 'image/jpeg' si sabes que es JPG\n  }\n  return item;\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          740,
          600
        ],
        "id": "515cd3de-3c35-426d-a110-412902496b22",
        "name": "Code2"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('Basic LLM Chain').item.json.text.replace(/\"/g, '') }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1100,
          360
        ],
        "id": "d0cd897f-5f14-4dd5-950b-1e9e088fc057",
        "name": "Telegram5",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $json.prompt }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 256,\n      \"height\": 256,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          700,
          360
        ],
        "id": "38c26ade-de06-4927-9afc-40e9e74f370a",
        "name": "ComfyUI1",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      }
    ],
    "connections": {
      "When chat message received": {
        "main": [
          [
            {
              "node": "Basic LLM Chain",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Basic LLM Chain",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Basic LLM Chain": {
        "main": [
          [
            {
              "node": "ComfyUI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "ComfyUI1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram1": {
        "main": [
          [
            {
              "node": "Telegram5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram2": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Telegram4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI Image to Video": {
        "main": [
          [
            {
              "node": "Telegram3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram4": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "ComfyUI Image to Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI1": {
        "main": [
          [
            {
              "node": "Telegram1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "8d2d49bc-484c-47c5-9685-781ee3203bb7",
    "activeVersionId": null,
    "triggerCount": 2,
    "shared": [
      {
        "updatedAt": "2025-04-22T15:22:55.727Z",
        "createdAt": "2025-04-22T15:22:55.727Z",
        "role": "workflow:owner",
        "workflowId": "1XO5qIENwWyX1cn9",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-11-04T03:25:55.000Z",
    "createdAt": "2025-04-10T06:57:23.767Z",
    "id": "3vG7TldgummcvoCY",
    "name": "Japan Flashcards callbacks",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "updates": [
            "message",
            "callback_query"
          ],
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          -540,
          -740
        ],
        "id": "4e777c33-6c3a-4ee9-8d6e-6a6829a1b6e7",
        "name": "Telegram Trigger",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $node[\"Telegram Trigger\"].json.message?.chat?.id || $node[\"Telegram Trigger\"].json.callback_query?.from?.id }}",
          "text": "={{ $('Aggregate').item.json.question[$json.randomIndex]}} ",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "Show",
                      "additionalFields": {
                        "callback_data": "=cal_show_{{ $('Aggregate').item.json.row_number[$json.randomIndex] }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          800,
          -760
        ],
        "id": "8d466bb1-bd0c-4bbe-863e-f98a25d772c9",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status"
              },
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          140,
          -760
        ],
        "id": "a1feae11-1503-4355-99a2-9293f51bafe4",
        "name": "Google Sheets",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          360,
          -760
        ],
        "id": "56ef65b5-d982-4158-b357-3c0c0e9522be",
        "name": "Aggregate"
      },
      {
        "parameters": {
          "jsCode": "const randomIndex = Math.floor(Math.random() * $input.first().json.row_number.length);\nreturn [{ json: { randomIndex } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          580,
          -760
        ],
        "id": "986c7fad-edb1-45b9-94ce-bfa9555df9f8",
        "name": "Code1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.callback_query.data }}",
                "rightValue": "cal",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -500,
          -440
        ],
        "id": "80658958-279b-45e4-a5e8-4001c44c37c3",
        "name": "If"
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          460,
          -500
        ],
        "id": "3bfa85ac-04be-44ea-8b96-ee0451e36f35",
        "name": "Aggregate1"
      },
      {
        "parameters": {
          "jsCode": "// Obt√©n el texto del mensaje\nconst messageText = $input.first().json.callback_query.data;\n\nconst parts = messageText.split(\"_\");\n\nconst secondWord = parts[1]; \nconst thirdValue = parseInt(parts[2], 10);\n\nreturn [\n  {\n    json: {\n      secondWord: secondWord,\n      thirdValue: thirdValue\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -260,
          -460
        ],
        "id": "379cc901-77f4-4ebb-abf8-f5a8d6965418",
        "name": "Code2"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/study",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -80,
          -740
        ],
        "id": "76843c1b-789c-4ae7-92b2-d0648e99931d",
        "name": "If1"
      },
      {
        "parameters": {
          "chatId": "={{ $node[\"Telegram Trigger\"].json.message?.chat?.id || $node[\"Telegram Trigger\"].json.callback_query?.from?.id }}",
          "text": "={{ $('Aggregate1').item.json.answer[ $('Code4').item.json.index]}}",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "More",
                      "additionalFields": {
                        "callback_data": "=cal_more_{{ $('Code2').item.json.thirdValue }}"
                      }
                    },
                    {
                      "text": "Done",
                      "additionalFields": {
                        "callback_data": "=cal_done_{{ $('Code2').item.json.thirdValue }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          780,
          -500
        ],
        "id": "1c319994-0b16-41d5-848b-3bcd69788d30",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "88fe368c-4042-4bee-8916-c1df4d26dcf5",
                "leftValue": "={{ $json.secondWord }}",
                "rightValue": "show",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          160,
          -480
        ],
        "id": "c73929b8-6340-4f67-9f0f-eb88cd504463",
        "name": "If2"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "88fe368c-4042-4bee-8916-c1df4d26dcf5",
                "leftValue": "={{ $json.secondWord }}",
                "rightValue": "more",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          100,
          -220
        ],
        "id": "714854f6-48f9-4424-82cd-92fba49510e3",
        "name": "If3"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "more",
              "row_number": "={{ $('Code2').item.json.thirdValue }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "question",
                "displayName": "question",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "answer",
                "displayName": "answer",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          300,
          -240
        ],
        "id": "596db2a6-eee0-4bec-a4ff-1ca02f0bdfd6",
        "name": "Google Sheets2",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const randomIndex = Math.floor(Math.random() * $('Aggregate2').first().json.row_number.length);\nreturn [{ json: { randomIndex } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          760,
          -240
        ],
        "id": "ca52948c-021d-4a08-af5c-80299e628bc0",
        "name": "Code3"
      },
      {
        "parameters": {
          "chatId": "={{ $node[\"Telegram Trigger\"].json.message?.chat?.id || $node[\"Telegram Trigger\"].json.callback_query?.from?.id }}",
          "text": "={{ $('Aggregate2').item.json.question[$json.randomIndex]}} ",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "Show",
                      "additionalFields": {
                        "callback_data": "=cal_show_{{ $('Aggregate2').item.json.row_number[$json.randomIndex] }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          900,
          -240
        ],
        "id": "207fa949-97d4-4aa5-95fb-6130c9fd478a",
        "name": "Telegram3",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              },
              {
                "lookupColumn": "status"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          320,
          -500
        ],
        "id": "b34f4fe8-3efd-4de7-a3b5-99907ee9eb33",
        "name": "Google Sheets4",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              },
              {
                "lookupColumn": "status"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          480,
          -240
        ],
        "id": "b664461b-0a8a-40b3-8ada-8c02d742ab22",
        "name": "Google Sheets1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "88fe368c-4042-4bee-8916-c1df4d26dcf5",
                "leftValue": "={{ $json.secondWord }}",
                "rightValue": "done",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          120,
          40
        ],
        "id": "956074d8-9bcf-4443-8135-0a821b71e767",
        "name": "If4"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "done",
              "row_number": "={{ $('Code2').item.json.thirdValue }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "question",
                "displayName": "question",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "answer",
                "displayName": "answer",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          320,
          20
        ],
        "id": "37555b41-3bf5-4da4-bd3a-ae8f709762e3",
        "name": "Google Sheets3",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          640,
          20
        ],
        "id": "933f85d2-0623-4a5c-a32d-f1ca41f8c04c",
        "name": "Aggregate3"
      },
      {
        "parameters": {
          "jsCode": "const randomIndex = Math.floor(Math.random() * $('Aggregate3').first().json.row_number.length);\nreturn [{ json: { randomIndex } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          760,
          20
        ],
        "id": "f68ba649-f1dd-49bf-821e-e6310939d5e5",
        "name": "Code"
      },
      {
        "parameters": {
          "chatId": "={{ $node[\"Telegram Trigger\"].json.message?.chat?.id || $node[\"Telegram Trigger\"].json.callback_query?.from?.id }}",
          "text": "={{ $('Aggregate3').item.json.question[$json.randomIndex]}} ",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "Show",
                      "additionalFields": {
                        "callback_data": "=cal_show_{{ $('Aggregate3').item.json.row_number[$json.randomIndex] }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          900,
          20
        ],
        "id": "0ae3552f-fdab-4dab-a27b-bf5d53540d61",
        "name": "Telegram4",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              },
              {
                "lookupColumn": "status"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          500,
          20
        ],
        "id": "1fc3390a-e637-4894-80a5-1d051373065d",
        "name": "Google Sheets5",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "content": "# Show first item",
          "height": 260,
          "width": 1120
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -140,
          -860
        ],
        "id": "24eb34a0-a542-46bd-af73-334dff098524",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "## Show it!\n",
          "height": 240,
          "width": 900,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          80,
          -560
        ],
        "id": "76de59fa-a86c-4e3e-a9b7-32594f64d337",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "jsCode": "// Supongamos que el array est√° en 'json.row_number'\nconst items = $input.first().json.row_number;\n\n// Par√°metro espec√≠fico que estamos buscando\nconst searchValue = $('Code2').first().json.thirdValue;  // El valor que quieres encontrar en la lista\n\n// Buscar el √≠ndice en base al par√°metro (por ejemplo, valor 20)\nconst index = items.findIndex(item => item === searchValue);\n\n// Devolver el √≠ndice encontrado\nreturn [\n  {\n    json: {\n      index: index\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          620,
          -500
        ],
        "id": "942f4281-27c1-49a9-b9c2-3dec28854e01",
        "name": "Code4"
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          620,
          -240
        ],
        "id": "3ab4354c-f7b5-4426-9d00-1e0ff019a562",
        "name": "Aggregate2"
      }
    ],
    "connections": {
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate1": {
        "main": [
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Google Sheets4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Google Sheets2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets2": {
        "main": [
          [
            {
              "node": "Google Sheets1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Telegram3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets4": {
        "main": [
          [
            {
              "node": "Aggregate1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets1": {
        "main": [
          [
            {
              "node": "Aggregate2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Google Sheets3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets3": {
        "main": [
          [
            {
              "node": "Google Sheets5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate3": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Telegram4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets5": {
        "main": [
          [
            {
              "node": "Aggregate3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate2": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "e4315990-d5ad-4fc9-b7ab-0707d5b843d7",
    "activeVersionId": null,
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-04-10T06:57:23.772Z",
        "createdAt": "2025-04-10T06:57:23.772Z",
        "role": "workflow:owner",
        "workflowId": "3vG7TldgummcvoCY",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-07-04T12:41:11.000Z",
    "createdAt": "2025-05-08T05:51:17.266Z",
    "id": "ECplpylC8p32ZPgx",
    "name": "morningIdeasAuto",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 8
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -480,
          -40
        ],
        "id": "3bb0fc39-be32-4d62-a631-8dafb6cd5804",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "={{ $json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          440,
          -60
        ],
        "id": "fc72df6a-c222-4d30-9f2c-5b30cd377832",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          80,
          120
        ],
        "id": "020ff47d-afed-4c14-b89b-d4fca48efa1d",
        "name": "DeepSeek Chat Model3",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nWrite a peaceful and motivational voiceover script for a spiritual YouTube channel called \"Breathe & Believe\". The tone should be calming, gentle, and emotionally uplifting. Begin with a short, reflective introduction that invites the viewer to pause, breathe, and be present. Include a specific Bible verse (you choose one that fits the message), and reflect on its meaning in a way that connects to everyday struggles like anxiety, stress, or feeling lost.\n\nOffer gentle encouragement to trust in God, let go of fear, and find peace through faith. End the script with a warm message of hope, reassurance, and a reminder that God is always present. The total length should be around 700‚Äì800 words. Write it in English and make sure it sounds natural and heartfelt.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- the ouput must be in 1 paragraph",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          100,
          -60
        ],
        "id": "2155afdf-e4dc-4ba8-823a-c5658cf87ff8",
        "name": "Image Prompt Agent"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          220,
          120
        ],
        "id": "7a69b962-6933-460e-b5e8-04b42a8c7e0a",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "={{ $json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1040,
          -60
        ],
        "id": "75a29358-d0c1-4bb5-bfa5-93a39654e52c",
        "name": "Telegram1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          680,
          120
        ],
        "id": "b1c1d0ad-b812-4b73-8ffd-68dcc9d375e3",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nWrite a short original horror story inspired by Japanese urban legends. The story should be deeply unsettling, mysterious, and psychologically disturbing ‚Äî but without any graphic violence, gore, or explicit content. It should focus on atmosphere, suspense, and eerie details that create a sense of fear and unease. Include a twist ending that leaves the viewer thinking. Make it appropriate for YouTube's content guidelines, while still being genuinely creepy and engaging. Use vivid but clean language, and keep the tone chilling yet narratable in a calm voiceover. Target length: 600‚Äì800 words. Write in English.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- the ouput must be in 1 paragraph",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          700,
          -60
        ],
        "id": "94597d76-001a-4a1c-be52-f702d8f9b199",
        "name": "Image Prompt Agent1"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          820,
          120
        ],
        "id": "6ccb80fc-8d67-4779-a09d-5267ba4b978f",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "={{ $json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1680,
          -60
        ],
        "id": "98e1791e-b5e8-4d01-a71c-c554ea1d4e36",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1320,
          120
        ],
        "id": "54bb6fca-83ab-413d-aa8d-9aa1842bfee9",
        "name": "DeepSeek Chat Model1",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nGenerate a fun and catchy concept for a short AI-generated song (30‚Äì60 seconds long) that could go viral on social media. The song idea should be specific, relatable, and easy for content creators to personalize or remix. Themes can include guilty pleasures, funny relationship moments, pet pampering, niche obsessions, or any quirky daily life situation. Make sure the concept is emotionally engaging or humorous, with potential to spark trends or memes.\nDo not write the lyrics or the music yet ‚Äî just describe the overall concept, the mood, and why people might want to make their own version. Keep it in English.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- the ouput must be in 1 paragraph",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1340,
          -60
        ],
        "id": "c66d62be-cde5-4751-8ec9-2399165d0207",
        "name": "Image Prompt Agent2"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1460,
          120
        ],
        "id": "0e0178ea-5e48-4088-8511-d42a2ab88881",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "={{ $json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          2320,
          -80
        ],
        "id": "7226c0c7-0a98-44d7-8a37-8ce352027f09",
        "name": "Telegram3",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1960,
          100
        ],
        "id": "15665215-e8de-4491-92c2-34446ede06e6",
        "name": "DeepSeek Chat Model2",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nGenerate a super cute and highly shareable video concept featuring a fluffy Pomeranian puppy doing something unexpected, like a human activity or a funny, exaggerated version of everyday life. The idea should be surprising, heart-melting, and visually engaging ‚Äî something that could easily go viral on platforms like TikTok, YouTube Shorts, or Instagram Reels. The concept should include a brief description of the setting, the puppy‚Äôs role or actions, and what makes it emotionally or comedically impactful. Make it unique, wholesome, and irresistibly adorable.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- the ouput must be in 1 paragraph",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1980,
          -80
        ],
        "id": "2dccdea9-6035-4055-87c1-deb8a3210e2e",
        "name": "Image Prompt Agent3"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2100,
          100
        ],
        "id": "2ba0dd78-53c0-4a67-9e9b-766fb8eef454",
        "name": "Simple Memory3"
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "Religion Idea:",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -100,
          -200
        ],
        "id": "44230c25-3464-464f-8e22-7009e71fb2df",
        "name": "Telegram4",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "Scary Idea:",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          580,
          -220
        ],
        "id": "2dcfe18f-edad-493b-bc33-7745b9510022",
        "name": "Telegram5",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "Song Idea:",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1160,
          -220
        ],
        "id": "8bc41f7c-f223-471c-99f1-c13de2494323",
        "name": "Telegram6",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "Pets Idea:",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1820,
          -240
        ],
        "id": "f08ddf70-0c4a-49a4-9563-2d81991a894d",
        "name": "Telegram7",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "morningIDeas"
          }
        }
      },
      {
        "parameters": {
          "content": "## Religion",
          "height": 80,
          "width": 200
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          120,
          -240
        ],
        "id": "cdf1385f-a3e6-4598-83eb-6b45ddb5cd6d",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "## Terror",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          720,
          -240
        ],
        "id": "5e950c91-0ffc-417e-b225-0362f71132e1",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "content": "## Music",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1360,
          -240
        ],
        "id": "f4bd302f-43da-46e0-b9da-f29874498934",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "content": "## Pets",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1980,
          -260
        ],
        "id": "06022a39-178c-40fd-b027-30a242e89b06",
        "name": "Sticky Note3"
      }
    ],
    "connections": {
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Telegram4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          [
            {
              "node": "Telegram5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent1": {
        "main": [
          [
            {
              "node": "Telegram1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent2": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent2",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Telegram1": {
        "main": [
          [
            {
              "node": "Telegram6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent3": {
        "main": [
          [
            {
              "node": "Telegram3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory3": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent3",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Telegram2": {
        "main": [
          [
            {
              "node": "Telegram7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram4": {
        "main": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram5": {
        "main": [
          [
            {
              "node": "Image Prompt Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram6": {
        "main": [
          [
            {
              "node": "Image Prompt Agent2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram7": {
        "main": [
          [
            {
              "node": "Image Prompt Agent3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1",
      "timezone": "Asia/Tokyo",
      "callerPolicy": "workflowsFromSameOwner"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      }
    },
    "meta": null,
    "pinData": {},
    "versionId": "d0c1e4ba-e08d-412a-bfa6-52118cd45e57",
    "activeVersionId": null,
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-05-08T05:51:17.276Z",
        "createdAt": "2025-05-08T05:51:17.276Z",
        "role": "workflow:owner",
        "workflowId": "ECplpylC8p32ZPgx",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-08-05T15:59:37.000Z",
    "createdAt": "2025-05-22T23:14:12.328Z",
    "id": "NiRdJVFkPfBtgEd0",
    "name": "Youtube_Auto_allInOne",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "operation": "create",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentLink }}",
            "mode": "url"
          },
          "title": "={{ $json.fileName }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2260,
          -420
        ],
        "id": "054b53a7-90fa-45e8-9e86-fecfd1b3731d",
        "name": "Google Sheets14",
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "return [\n  {\n    \"imageStatus\": null,\n    \"imageVStatus\": null,\n    \"videoStatus\": null,\n    \"videoVStatus\": null,\n    \"narratorStatus\": null,\n    \"shotDescStatus\": null,\n    \"thumbnailStatus\": null,\n    \"imagePrompt\": null,\n    \"shotDescription\": null,\n    \"narratorScript\": null,\n    \"imageLink\": null,\n    \"imageLinkV\": null,\n    \"videoLink\": null,\n    \"videoLinkV\": null,\n    \"narratorLink\": null,\n    \"storyIdea\": null,\n    \"landscapeFormat\": null,\n    \"portraitFormat\": null,\n    \"imageGeneration\": null,\n    \"videoGeneration\": null,\n    \"narratorGeneration\": null,\n    \"makeImageRender\": null,\n    \"makeVideoRender\": null,\n    \"addSubtitles\": null,\n    \"addMusic\": null,\n    \"channel\": null,\n    \"YoutubeTitle\": null,\n    \"YoutubeDescription\": null,\n    \"YoutubeTags\": null,\n    \"YoutubeThumbnail\": null\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2440,
          -420
        ],
        "id": "a92d4b0a-869c-4ba2-b66b-6eb4ae71dafa",
        "name": "Code30"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "dataMode": "autoMapInputData",
          "options": {}
        },
        "id": "c57117ee-a125-41a3-8098-3a0086d76380",
        "name": "Add header",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 3,
        "position": [
          2620,
          -420
        ],
        "executeOnce": true,
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          3000,
          -300
        ],
        "id": "2052cd17-f62c-4243-b339-7dfc5843946a",
        "name": "DeepSeek Chat Model5",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          3120,
          -280
        ],
        "id": "87836c56-66c4-464a-8c5a-39c963381729",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "jsCode": "const input = $input.first().json.output; // Aseg√∫rate que el nodo anterior tenga la propiedad \"text\" con todo el contenido\n\n// Dividir por l√≠neas y filtrar l√≠neas vac√≠as\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Eliminar el n√∫mero inicial de cada l√≠nea y devolver cada frase como un item separado\nreturn lines.map(line => {\n  return {\n    json: {\n      sentence: line.replace(/^\\d+\\.\\s*/, \"\").trim()\n    }\n  };\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3340,
          -460
        ],
        "id": "0deaf5c2-7d8e-4dcf-b00c-0e8795c36d06",
        "name": "Code33"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3600,
          -480
        ],
        "id": "2270caad-c6f7-44fb-a50a-7e2978978ffc",
        "name": "Loop Over Items5"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "imageStatus": "ready",
              "imageVStatus": "ready",
              "narratorStatus": "ready",
              "imagePrompt": "={{ $json.cleanedText }}",
              "narratorScript": "={{ $json.cleanedNarrator }}",
              "YoutubeTitle": "={{ $('Edit Fields5').item.json.youtubeTitle }}",
              "YoutubeDescription": "={{ $('Edit Fields5').item.json.youtubeDescription }}",
              "YoutubeTags": "={{ $('Edit Fields5').item.json.youtubeTags }}",
              "YoutubeThumbnail": "={{ $('Edit Fields5').item.json.youtubeThumbnail }}",
              "landscapeFormat": "={{ $('Wait4').item.json.landscapeFormat }}",
              "portraitFormat": "={{ $('Wait4').item.json.portraitFormat }}",
              "imageGeneration": "={{ $('Wait4').item.json.imageGeneration }}",
              "videoGeneration": "={{ $('Wait4').item.json.videoGeneration }}",
              "narratorGeneration": "={{ $('Wait4').item.json.narratorGeneration }}",
              "makeImageRender": "={{ $('Wait4').item.json.makeImageRender }}",
              "makeVideoRender": "={{ $('Wait4').item.json.makeVideoRender }}",
              "addSubtitles": "={{ $('Wait4').item.json.addSubtitles }}",
              "addMusic": "={{ $('Wait4').item.json.addMusic }}",
              "channel": "={{ $('Wait4').item.json.channel }}",
              "thumbnailStatus": "ready"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "shotDescStatus",
                "displayName": "shotDescStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "thumbnailStatus",
                "displayName": "thumbnailStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "shotDescription",
                "displayName": "shotDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "landscapeFormat",
                "displayName": "landscapeFormat",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "portraitFormat",
                "displayName": "portraitFormat",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "imageGeneration",
                "displayName": "imageGeneration",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoGeneration",
                "displayName": "videoGeneration",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorGeneration",
                "displayName": "narratorGeneration",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "makeImageRender",
                "displayName": "makeImageRender",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "makeVideoRender",
                "displayName": "makeVideoRender",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "addSubtitles",
                "displayName": "addSubtitles",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "addMusic",
                "displayName": "addMusic",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "channel",
                "displayName": "channel",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          4640,
          -420
        ],
        "id": "23c91a9d-7d7d-45f2-8e57-d2f9f4bf751d",
        "name": "Google Sheets16",
        "retryOnFail": true,
        "waitBetweenTries": 3000,
        "maxTries": 5,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Script finished  {{ $('Google Sheets14').item.json.title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5220,
          -500
        ],
        "id": "85b4d879-984c-43e4-8a0f-5b7972e2ee4c",
        "name": "Telegram31",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4800,
          -520
        ],
        "id": "2ab6853e-3118-4d83-a2ae-243c54f8d4d1",
        "name": "Limit5"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1720,
          -300
        ],
        "id": "8246705f-ac18-41c9-9ec8-79bea1815fa1",
        "name": "DeepSeek Chat Model8",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1820,
          -280
        ],
        "id": "9744da8d-6805-464a-be51-9bb5294d591f",
        "name": "Simple Memory5"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "= {{ $json.output }}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2040,
          -460
        ],
        "id": "6c3ace2c-84f4-4992-95b9-a4e4e2634498",
        "name": "Edit Fields5"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\nstory: \n{{ $json.Introduction }}\n\n{{ $json.Development }}\n\n{{ $json.Resolution }}\n\nYou are a professional YouTube creator. Based on the previous story generate:\n\nA YouTube Title that must a copy of the next prompt, just make sure to replace the context information on the square-brakets with the correct information: {{ $('Wait4').item.json.TitleConcept }}\n\nA YouTube Description that describes the video as simple as possible. It should use storytelling language, include SEO-rich keywords, and connect with both faith-based viewers and audiences who enjoy ironic or educational content. Include relevant hashtags to boost visibility.\n\nA YouTube Thumbnail image prompt that must a copy of the next prompt, just make sure to replace the context information on the square-brakets with the correct information:\n{{ $('Wait4').item.json.thumbnailPromptConcept }}\n\n\nA FileName that is one single word inspired by the story (no spaces), max 10 characters, followed by a 3-digit random number. It must feel relevant to the tone of the video and work well in a video production pipeline.\n\nA single paragraph of tags, written as a comma-separated list, using keywords related to the the video and or YouTube series, and any other that could help.\n\nYour output must be exactly 5 paragraphs, one for each item above. Do not include titles, labels, numbers, or formatting. Each paragraph must be written in a way that is ready to paste directly into the YouTube upload page.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n\nFormat the output like this:\n\n{\n  \"youtubeTitle\": \"Superdog Begins this shortfilm make me cry\",\n  \"youtubeDescription\": \"Superdog Begins is a story that...\",\n  \"youtubeThumbnail\": \"Create an image of a realistic dog...\",\n  \"youtubeTags\": \"dogs, cats, pets, funny\",\n  \"fileName\": \"superDogBeg157\"\n}\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1700,
          -460
        ],
        "id": "2c24aae5-d323-4337-aed4-54d76a12e0f6",
        "name": "Titles and Description"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          3780,
          -220
        ],
        "id": "013b5df4-52e1-4d76-9823-3b1e537a451a",
        "name": "DeepSeek Chat Model10",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          3900,
          -220
        ],
        "id": "7ae8c1f0-0868-4aa0-b994-e8223b19f00f",
        "name": "Simple Memory7"
      },
      {
        "parameters": {
          "jsCode": "// Obtener el texto del nodo anterior\nconst text = $input.first().json.output || '';\nconst narrator = $('Loop Over Items5').first().json.sentence || '';\n\n// Funci√≥n para limpiar texto problem√°tico para FFmpeg drawtext\nconst cleanForDrawtext = (str) => {\n  return str\n    .replace(/['\"`\\\\]/g, '')         // Comillas simples, dobles, backticks, backslash\n    .replace(/[:*[\\]{}<>|;]/g, '')   // S√≠mbolos comunes que causan errores\n    .replace(/[\\u2000-\\u206F]/g, '') // Caracteres invisibles Unicode (puntos suspensivos, etc.)\n    .replace(/\\s+/g, ' ')            // Reemplaza m√∫ltiples espacios por uno\n    .trim();                         // Elimina espacios al inicio/final\n};\n\n// Limpiar ambos textos\nconst cleanedText = cleanForDrawtext(text);\nconst cleanedNarrator = cleanForDrawtext(narrator);\n\n// Retornar los textos\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n    originalNarrator: narrator,\n    cleanedNarrator: cleanedNarrator\n  }\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4460,
          -420
        ],
        "id": "4b9b43d7-d718-4a00-ae48-99192caca212",
        "name": "Code"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "ready"
              },
              {
                "lookupColumn": "narratorGeneration",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          820,
          20
        ],
        "id": "f8529e35-ae26-4272-8786-6cedc734f20d",
        "name": "Google Sheets",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "8c269fad-e72b-4471-a564-6041c1d41f41",
                "name": "binary",
                "value": "={{$json[\"audioContent\"]}}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2120,
          120
        ],
        "id": "5b478cf2-689b-4278-a1fc-53b184d09a52",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "binary",
          "options": {}
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          2260,
          120
        ],
        "id": "a76ba474-7d78-4760-b420-978e812f35e2",
        "name": "Convert to File"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://texttospeech.googleapis.com/v1/text:synthesize",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googleOAuth2Api",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"text\": \"{{ $json.cleanedText }}\"\n  },\n  \"voice\": {\n    \"languageCode\": \"en-US\",\n    \"name\": \"en-US-Chirp3-HD-Enceladus\"\n  },\n  \"audioConfig\": {\n    \"audioEncoding\": \"MP3\",\n    \"speakingRate\": 0.92,\n    \"pitch\": 0,\n    \"volumeGainDb\": 2.0\n  }\n}\n",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1940,
          120
        ],
        "id": "87b6a1e1-4794-4f5a-8492-97134f9ccee6",
        "name": "HTTP Request2",
        "credentials": {
          "googleOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1240,
          60
        ],
        "id": "1ee30b47-b606-48e0-9679-63b92bbf68fa",
        "name": "Loop Over Items1"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"_\" + $('Wait1').first().json.documentName + \".mp3\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/narrator/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/narrator/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1460,
          120
        ],
        "id": "6616b08c-ce80-4f9f-8a60-dd4c55b67bb2",
        "name": "Code9"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code9').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          2940,
          120
        ],
        "id": "5c389249-81b5-4171-9126-2a5b7dc2f549",
        "name": "FTP3",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait1').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait1').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "narratorStatus": "done",
              "narratorLink": "={{ $('Code9').item.json.publicUrl }}",
              "row_number": "={{ $('Loop Over Items1').item.json.row_number }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "shotDescStatus",
                "displayName": "shotDescStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "shotDescription",
                "displayName": "shotDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3120,
          100
        ],
        "id": "6da724bb-0d4e-4a45-b466-61d1a4a9af59",
        "name": "Google Sheets5",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Narrator finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3860,
          -40
        ],
        "id": "71c50816-632e-4635-9ef5-7fd5b031480d",
        "name": "Telegram21",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          3600,
          -40
        ],
        "id": "27898dc5-2103-4bee-8818-33a144589f51",
        "name": "Limit2"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Loop Over Items1').first().json.narratorScript; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1760,
          120
        ],
        "id": "2097a373-734e-449f-88ae-c38d539ad504",
        "name": "Code2"
      },
      {
        "parameters": {
          "operation": "write",
          "fileName": "/tmp/audio.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2420,
          120
        ],
        "id": "18d72e5a-0af5-40c6-868e-06898308e4e3",
        "name": "Read/Write Files from Disk3"
      },
      {
        "parameters": {
          "command": "ffmpeg -i /tmp/audio.mp3 -af \"apad=pad_dur=1,adelay=200|200,apad=pad_dur=1\" -y /tmp/audio_padded.mp3"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2560,
          120
        ],
        "id": "854e6b2b-d6f6-4dc1-be0a-92942c13c6ae",
        "name": "Execute Command14"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/audio_padded.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2740,
          120
        ],
        "id": "05c5000e-5b46-4e26-aa0c-10689ba31790",
        "name": "Read/Write Files from Disk4"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              },
              {
                "lookupColumn": "imageGeneration",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "landscapeFormat",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          860,
          420
        ],
        "id": "e0a70408-4925-4e42-811b-6d6f2c55b830",
        "name": "Google Sheets1",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code1').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 768,\n      \"height\": 432,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          1980,
          560
        ],
        "id": "7ea59d0e-b000-4091-8786-7364100a0912",
        "name": "ComfyUI1",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1320,
          520
        ],
        "id": "3c8c031e-773d-45aa-8441-680779eee497",
        "name": "Loop Over Items"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code4').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          2120,
          560
        ],
        "id": "5ecc6598-7a86-4b38-8509-5e9ec53ee175",
        "name": "FTP1",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"_\" + $('Wait2').first().json.documentName + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/images/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1520,
          560
        ],
        "id": "007e6b8b-e2d5-4630-a0f2-51e13c2858a2",
        "name": "Code4"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          3940,
          400
        ],
        "id": "860f285b-c40d-49cc-9833-7691d6557202",
        "name": "Limit1"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Images finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5940,
          280
        ],
        "id": "6faa31a4-8725-4470-9201-453187c41e3c",
        "name": "Telegram14",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1860,
          560
        ],
        "id": "504508ac-ad89-4e3f-8fbf-bc3d39a7ab81",
        "name": "Code1"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items').item.json.row_number }}",
              "imageStatus": "done",
              "imageLink": "={{ $('Code4').item.json.publicUrl }}",
              "videoStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2280,
          540
        ],
        "id": "e05af517-51c8-45a5-8451-7e01dba16b94",
        "name": "Google Sheets6",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + $('Wait3').first().json.documentName + \"_prev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3020,
          1240
        ],
        "id": "1f6cfaec-cf23-4769-b300-66cd217d0609",
        "name": "Code28"
      },
      {
        "parameters": {
          "jsCode": "const rows = items;\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Funci√≥n para dividir texto a la mitad\nconst splitScriptInHalf = (text) => {\n  const words = text.trim().split(/\\s+/);\n  const midpoint = Math.ceil(words.length / 2);\n  return [\n    words.slice(0, midpoint).join(' '),\n    words.slice(midpoint).join(' ')\n  ];\n};\n\nconst addSubtitles = $input.first().json.addSubtitles === true;\nconst narratorGeneration = $input.first().json.narratorGeneration === true;\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLink;\n  const audioUrl = item.json.narratorLink;\n  const script = item.json.narratorScript || '';\n\n  if (!imageUrl) return;\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = audioUrl ? `/tmp/render/audio${index}.mp3` : null;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio (solo si hay audio y narratorGeneration=true)\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\";\\n`;\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n  }\n\n  downloadCommands += `duration=0; `;\n\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); `;\n  }\n\n  if (addSubtitles && script.trim() !== '') {\n    const [firstPart, secondPart] = splitScriptInHalf(script);\n\n    const drawtext1 = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${firstPart}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-120:enable='lt(t,$duration*0.4)'`;\n    const drawtext2 = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${secondPart}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-120:enable='gte(t,$duration*0.4)'`;\n\n    const fallbackText = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='‚ö†Ô∏è Error de string':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-120`;\n\n    downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=1280:720,fps=30,${drawtext1},${drawtext2}\" -pix_fmt yuv420p \"${rawVideo}\" || `;\n    downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=1280:720,fps=30,${fallbackText}\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n  } else {\n    downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=1280:720,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n  }\n\n  if (audioUrl && narratorGeneration) {\n    mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n    fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  } else {\n    // Si no hay audio o narratorGeneration es falso, usar solo el video para concatenar\n    fileListCommands += `if [ -f \"${rawVideo}\" ]; then echo \"file '${rawVideo}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  }\n});\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim()\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1340,
          1240
        ],
        "id": "309d9939-a8c7-40df-9bb2-34662edda4f9",
        "name": "Code8"
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1500,
          1240
        ],
        "id": "6aec4432-9393-46c1-aa94-1c0c3037959b",
        "name": "Execute Command7",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1620,
          1240
        ],
        "id": "4b08836a-9dd6-444f-a32c-7649c4495100",
        "name": "Execute Command8",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1740,
          1240
        ],
        "id": "24b2452d-e170-47da-9b72-66dd235aeab5",
        "name": "Execute Command9",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1860,
          1240
        ],
        "id": "f399f802-dd64-4ebb-8f00-34c02ea628fb",
        "name": "Execute Command10",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code10').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2400,
          1240
        ],
        "id": "3b1d89f7-2cf1-4603-9d5d-c75fb557e5dc",
        "name": "Execute Command11",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3220,
          1240
        ],
        "id": "47229ba5-f9ee-4224-a023-f085016ea42a",
        "name": "Read/Write Files from Disk2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code28').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3400,
          1240
        ],
        "id": "a260b7d8-7c58-4a87-9d4f-0898a0176005",
        "name": "FTP7",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code10').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3820,
          1240
        ],
        "id": "03ae43b2-f106-4384-b556-1879242cf1e0",
        "name": "Execute Command12"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "landscapeFormat",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "makeVideoRender",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          920,
          1420
        ],
        "id": "9fd91e61-16f0-46b8-b9a7-dbc8e4d0044c",
        "name": "Google Sheets2",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1140,
          -300
        ],
        "id": "414fc87c-bd4b-4ba7-9bb7-6a5e979af19d",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1260,
          -300
        ],
        "id": "0fd27a37-e07d-4e43-bba9-e5abd2ee0e08",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nYou are a professional scriptwriter, and you are going to provide a script concept, 3 paragraphs that include: \n\n1. Setup (Introduction)\n2. Confrontation (Development / Conflict / Exploration)\n3. Resolution (Climax and Conclusion)\n\nthe concept of the video is: {{ $('Wait4').item.json.concept1Sentece }}{{ $('idea').item.json.idea }}\n\n{{ $('Wait4').item.json.concept1Paragraph }}\n\n\n\n## IMPORTANT\n- Do not provide a title \n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- Format the output like this:\n\n{\n  \"Introduction\": \"Superdog Begins this shortfilm make me cry\",\n  \"Development\": \"Superdog Begins is a story that...\",\n  \"Resolution\": \"Create an image of a realistic dog...\"\n}\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1160,
          -480
        ],
        "id": "f7fd213b-1573-4b5d-8590-f64122dcd3a3",
        "name": "Idea Prompt Agent1"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          3400,
          100
        ],
        "id": "098fe5de-fd4b-440c-9963-a8c84de46e31",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "command": "={{ $('Code10').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2560,
          1240
        ],
        "id": "ac002915-318e-4c41-9fb1-6503c960bfdc",
        "name": "Execute Command"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Edit Fields5').first().json.fileName; \nconst documentLink = $('Wait4').first().json.documentLink;\n\nreturn [\n  {\n    documentName,\n    documentLink\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4940,
          -300
        ],
        "id": "955187e6-8bcf-4d04-a408-dfd9084217f7",
        "name": "Code3"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          640,
          20
        ],
        "id": "3187367e-5e8b-45bf-918e-d52c1d166b2d",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait1').first().json.documentName; \nconst documentLink = $('Wait1').first().json.documentLink; \n\nreturn [\n  {\n    documentName,\n    documentLink\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3820,
          160
        ],
        "id": "ecdfbe46-7052-4775-ae6c-a6f0e8f70c98",
        "name": "Code7"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          660,
          420
        ],
        "id": "cf2126f8-3c87-4fb6-b7f7-627afa0490b6",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait2').first().json.documentName; \nconst documentLink = $('Wait2').first().json.documentLink; \n\nreturn [\n  {\n    documentName,\n    documentLink\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5940,
          600
        ],
        "id": "0fa27d01-0e38-4343-b25e-4cd37b44eed3",
        "name": "Code5"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1000,
          -60
        ],
        "id": "a5917c9c-f6ed-4553-8cb6-4fbd382b548c",
        "name": "If3"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1080,
          400
        ],
        "id": "da12c113-4b21-4ac3-8b35-a12ba49847f2",
        "name": "If4"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          680,
          1300
        ],
        "id": "5349fad2-bef6-420b-86ed-4df8b67e7248",
        "name": "Wait3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1120,
          1260
        ],
        "id": "2d844293-fb58-44fa-aab2-d1a7657e37aa",
        "name": "If6"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code28').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3580,
          1240
        ],
        "id": "4889a2bb-6890-4c65-823b-437bb6bb807b",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code10').item.json.yt_title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4060,
          1240
        ],
        "id": "4a0b720a-5a0d-4d07-bf59-51ef287afdc6",
        "name": "Telegram16",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageVStatus",
                "lookupValue": "ready"
              },
              {
                "lookupColumn": "imageGeneration",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "portraitFormat",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2740,
          380
        ],
        "id": "c3fb45d4-09c1-4ca7-a83a-bd18e13b615c",
        "name": "Google Sheets3",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code13').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 432,\n      \"height\": 768,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          3560,
          600
        ],
        "id": "f609c976-0579-4a51-b9e1-530bbdff7e4f",
        "name": "ComfyUI",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3100,
          480
        ],
        "id": "7364e070-9498-49c7-b60f-ebc164495f6d",
        "name": "Loop Over Items2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code12').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3720,
          600
        ],
        "id": "c5c7f8e4-82af-41e7-8947-b35f06c2ed96",
        "name": "FTP",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"_\" + $('Wait2').first().json.documentName + \"V.jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3300,
          600
        ],
        "id": "9b9a104d-41ce-43f8-a3cd-0443acfa5a00",
        "name": "Code12"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items2').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3420,
          600
        ],
        "id": "e7239639-2a90-4e02-a10a-5a70200da6b3",
        "name": "Code13"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items2').item.json.row_number }}",
              "imageVStatus": "done",
              "imageLinkV": "={{ $('Code12').item.json.publicUrl }}",
              "videoVStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3940,
          540
        ],
        "id": "33aa6362-763e-4894-b845-bd61df9da07d",
        "name": "Google Sheets7",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          2980,
          360
        ],
        "id": "21315680-20cc-4b7c-bba9-8f1a6c48bdee",
        "name": "If7"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          2280,
          400
        ],
        "id": "8d28c823-8b6f-4514-af98-89e66a8afeff",
        "name": "Limit"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code10').item.json.yt_description }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4200,
          1240
        ],
        "id": "2759b15b-15a0-42e7-9978-f75900b25dec",
        "name": "Telegram19",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code10').item.json.yt_thumbnail }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4340,
          1240
        ],
        "id": "7da0d330-73b8-4434-9958-4161af7a3351",
        "name": "Telegram20",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code10').item.json.yt_tags }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4480,
          1240
        ],
        "id": "c1df7ae2-e4b8-4806-8fdc-4694ab2df259",
        "name": "Telegram23",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoVStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "portraitFormat",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "makeVideoRender",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          880,
          1900
        ],
        "id": "85a8ce87-dc14-43f2-85a9-fb3cdc4a46c2",
        "name": "Google Sheets11",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1080,
          1760
        ],
        "id": "81c2a27d-40a6-47af-8837-46d501b30785",
        "name": "If10"
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 4
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -1020,
          -1800
        ],
        "id": "8aac86a1-238f-4432-8be6-7da54973fabf",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          -660,
          -820
        ],
        "id": "eddc09d6-e75c-4f2d-8316-6852416ec1b7",
        "name": "When clicking ‚ÄòTest workflow‚Äô"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "dce2d9ce-0dad-4ee3-9071-3b7e22f081a5",
                "name": "documentName",
                "value": "webofwoe428",
                "type": "string"
              },
              {
                "id": "bb6593b2-7cd5-4fb2-918d-b58c7c5493a7",
                "name": "documentLink",
                "value": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          320,
          1280
        ],
        "id": "719c2845-e98b-4966-bd0d-aee31b711073",
        "name": "Edit Fields1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          800,
          -400
        ],
        "id": "c46a6ea6-4040-48c8-9e49-f38f2b68480c",
        "name": "Limit3"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.Sheet }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $json.row_number }}",
              "status": "processing"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "idea",
                "displayName": "idea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          940,
          -400
        ],
        "id": "cbd87e3e-4480-45cf-b3a7-6dd1caafe72e",
        "name": "Google Sheets8",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "command": "#!/bin/bash\n\n# Borrar archivos en /tmp m√°s viejos de 1 d√≠a\nfind /tmp -type f -mtime +1 -exec rm -f {} \\; 2>/dev/null\nfind /tmp -type d -empty -mtime +1 -exec rmdir {} \\; 2>/dev/null\n\n# Limpiar cach√© de apt (solo si es un sistema basado en Debian/Ubuntu)\nif command -v apt-get &> /dev/null; then\n  apt-get clean\n  apt-get autoclean\nfi\n\n# Borrar archivos de log rotados (sin tocar logs actuales)\nfind /var/log -type f -name \"*.gz\" -mtime +7 -exec rm -f {} \\; 2>/dev/null\nfind /var/log -type f -name \"*.1\" -mtime +7 -exec rm -f {} \\; 2>/dev/null\n\n# Limpiar cach√© de thumbnails (si existe)\nrm -rf ~/.cache/thumbnails/* 2>/dev/null\n\n# Mostrar cu√°nto espacio libre hay despu√©s\necho \"Espacio libre en disco despu√©s de limpiar:\"\ndf -h /\n\nexit 0\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          780,
          2260
        ],
        "id": "5d33b355-dda6-46d9-8524-82f08b3faa25",
        "name": "Execute Command20"
      },
      {
        "parameters": {
          "content": "## Cleanup",
          "height": 260,
          "width": 360
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          660,
          2180
        ],
        "id": "057a40d3-f903-4674-bde0-4cdbbbd0d5ff",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "## Script\n\n",
          "height": 380,
          "width": 4860
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          620,
          -540
        ],
        "id": "69858c1a-8fce-4d26-a415-e7826f45526f",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "content": "## Lemon Sushi, Why it sucks\n\n",
          "height": 220,
          "width": 340
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -360,
          -380
        ],
        "id": "f6a6aadf-ba27-4358-928e-a800451fbf3a",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n\"Paramenters\": \"________________________________________________________\",\n\"landscapeFormat\":true,\n\"portraitFormat\":true,\n\"imageGeneration\":true,\n\"videoGeneration\":true,\n\"narratorGeneration\":true,\n\"makeImageRender\":false,\n\"makeVideoRender\":true,\n\"addSubtitles\":true,\n\"addMusic\":true,\n\"documentConfiguration\": \"________________________________________________________\",\n\"documentLink\":\"https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk\",\n\"Sheet\": \"Sheet1\",\n\"videoContent\": \"________________________________________________________\",\n\"artStyle\":\"Pixar style\",\n\"howManySentences\":\"between 10 and 16\",\n\"concept1Sentece\": \"why it sucks to be: \",\n\"concept1Paragraph\": \"The tone should balance emotional storytelling with a touch of dark humor and irony, while remaining respectful, family-friendly, and legally safe when referencing fictional characters., highlighting why this character‚Äôs life was unexpectedly difficult or unfair despite their fame, powers, or heroic status. Focus on emotional burdens, social pressure, identity struggles, misunderstood intentions, or ironic outcomes. Use vivid, imaginative language to evoke visuals and feelings without sounding too cinematic. Keep the story grounded, relatable, and with a hint of satire or social commentary. Avoid quoting or copying exact phrases or events from copyrighted material ‚Äî use generalized references instead.\",\n\"narratorStyle\":\"Each sentence must describe a moment or scene that shows how difficult, frustrating, or unexpectedly ironic their life was. The tone should be emotional, grounded, and filled with human tension ‚Äî but with modern, relatable humor and a clear sense that this is a parody. If the character is fictional or from pop culture, describe their challenges in a generalized and transformative way that avoids direct or copyrighted references, while still making their identity recognizable.\",\n\"Youtube\": \"________________________________________________________\",\n\"channel\":\"LemonSushi\",\n\"TitleConcept\": \"Why it sucks to be [Character], [something that generates curiosity]\",\n\"thumbnailPromptConcept\": \"A Pixar style image with a clean white background. At the center is a handcrafted clay figure of [Character], sculpted with expressive facial features and exaggerated emotional details, Above the character, the title ‚ÄúWHY IT SUCKED TO BE [Character Name]‚Äù is written in extra large, colorful clay letters‚Äîeach word in a different vibrant color (red, yellow, blue, green, orange, purple). The letters should be bold, oversized, and clearly legible even at small thumbnail size, taking up a significant portion of the top half of the image. The font is playful and eye-catching, with a handcrafted texture. The overall image should look like a still frame from a high-end Pixar movie, with dramatic composition and soft shadows for realism, but always keeping a handcrafted plasticine aesthetic.\",\n\"last\":\"last\"\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -280,
          -320
        ],
        "id": "93b91a4c-73d1-4ee7-ad09-54c5a56721fb",
        "name": "Edit Fields2"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.Sheet }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          660,
          -400
        ],
        "id": "e2863484-8152-43e2-bb1a-0ba11a101673",
        "name": "idea",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "= {{ $json.output }}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1480,
          -400
        ],
        "id": "d87355f4-9e3e-4e51-add6-79913cac1a4b",
        "name": "Edit Fields6"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Overview  \nSeparate the next story into narrator-style in the concept of:\n\n{{ $('Wait4').item.json.concept1Sentece }}{{ $('idea').item.json.idea }}\n\n{{ $('Wait4').item.json.narratorStyle }}\n\nIt should feel like the narrator is walking the viewer through the story. Use dramatic pauses, ironic contrasts, and subtle jokes to create empathy while also entertaining.\n\nThe final output must contain {{ $('Wait4').item.json.howManySentences }} numbered sentences that feel like a progressive story being told make sure to follow the introduction, development and conclusion of the story. \n\nStory:\nIntro:\n{{ $('Edit Fields6').item.json.Introduction }}\nDevelopment:\n{{ $('Edit Fields6').item.json.Development }}\nConclusion:\n{{ $('Edit Fields6').item.json.Resolution }}\n\n\n## IMPORTANT  \n- The sentences must not be longer than 24 words long.\n- The first sentence must be: {{ $('Edit Fields5').item.json.youtubeTitle }}\n- One of the middle sentences must be: If you like this content make sure to subscribe to our channel and leave us a like. \n- The last sentence must be: thank you for watching, if you like this video I'm sure you will like this other one. \n- All output must be family friendly, no sensitive words should be used.  \n- No references to weapons (even toy guns).  \n- No reference of ‚Äúshowdowns‚Äù or violent events.  \n- Add originality and modern-day fun, but do not mock faith, real-life trauma, or copyrighted plots.  \n- Do not copy direct lines or events from source material.  \n- No extra format nor explanations, output must be in plain ready-to-use text.  \n- Do not add any quote symbols or quotation marks  \n- avoid \"\" at all cost  \n- Do not add any * symbols or any special format  \n- avoid * at all cost  \n\n## OUTPUT  \nThe output must be enumerated sentences\n\n\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          3000,
          -460
        ],
        "id": "23fa8bff-2217-4454-b161-3ec6ca085f5b",
        "name": "Narrator Script",
        "retryOnFail": true
      },
      {
        "parameters": {
          "content": "## Narrator\n",
          "height": 380,
          "width": 3480
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          620,
          -80
        ],
        "id": "7dccde7d-487c-4701-8edf-6dd0cea37424",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "content": "## Image Generation\n",
          "height": 380,
          "width": 5500
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          600,
          300
        ],
        "id": "c17010d1-0113-4644-800e-76607a4be139",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "content": "## Render",
          "height": 800,
          "width": 4920,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          660,
          1240
        ],
        "id": "1a868b20-2b34-4443-be87-06a7d3a4548d",
        "name": "Sticky Note6"
      },
      {
        "parameters": {
          "command": "echo \"üîç Verificando archivos listados en /tmp/render/filelist.txt...\"\n\nif [ ! -f /tmp/render/filelist.txt ]; then\n  echo \"‚ùå filelist.txt no existe\"\n  exit 1\nfi\n\nwhile IFS= read -r line; do\n  # Omitir l√≠neas vac√≠as\n  if [ -z \"$line\" ]; then\n    continue\n  fi\n\n  file_path=$(echo \"$line\" | cut -d\"'\" -f2)\n  if [ -z \"$file_path\" ]; then\n    echo \"‚ùå L√≠nea malformada: $line\"\n    continue\n  fi\n\n  if [ ! -f \"$file_path\" ]; then\n    echo \"‚ùå Falta $file_path\"\n  else\n    echo \"‚úÖ Existe $file_path\"\n  fi\ndone < /tmp/render/filelist.txt\n\necho \"‚úÖ Verificaci√≥n finalizada\"\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2000,
          1240
        ],
        "id": "d9101d6d-5260-499e-9e45-4bf1fe8a87e1",
        "name": "Execute Command5"
      },
      {
        "parameters": {
          "jsCode": "const musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst addMusic = $('If6').first().json.addMusic === true;\n\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\nlet musicCommand = '';\nif (addMusic) {\n  musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n} else {\n  // Si no se a√±ade m√∫sica, simplemente copiar combo.mp4 a final_with_music.mp4 para mantener flujo igual\n  musicCommand = `cp /tmp/render/combo.mp4 /tmp/render/final_with_music.mp4`;\n}\n\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    yt_title: $('Google Sheets17').first().json.YoutubeTitle,\n    yt_description: $('Google Sheets17').first().json.YoutubeDescription,\n    yt_tags: $('Google Sheets17').first().json.YoutubeTags,\n    yt_thumbnail: $('Google Sheets17').first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2200,
          1240
        ],
        "id": "7ec26f06-22e7-4cdc-80f0-443685717474",
        "name": "Code10"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          400,
          -860
        ],
        "id": "ae57e043-f7d6-486e-a7f9-dcd807e453c0",
        "name": "Wait4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + $('Wait3').first().json.documentName + \"_prevVert.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3020,
          1740
        ],
        "id": "3f296846-a91a-4fa9-8c46-24331cfb71ab",
        "name": "Code29"
      },
      {
        "parameters": {
          "jsCode": "const rows = items;\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Funci√≥n para dividir texto en dos mitades\nconst splitScriptInHalf = (text) => {\n  const words = text.trim().split(/\\s+/);\n  const midpoint = Math.ceil(words.length / 2);\n  return [\n    words.slice(0, midpoint).join(' '),\n    words.slice(midpoint).join(' ')\n  ];\n};\n\n// Escapar texto para FFmpeg drawtext\nconst escapeFFmpegText = (text) =>\n  text.replace(/:/g, '\\\\:').replace(/'/g, \"\\\\\\\\'\").replace(/\"/g, '');\n\nconst addSubtitles = $input.first().json.addSubtitles === true;\nconst narratorGeneration = $input.first().json.narratorGeneration === true;\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLinkV;\n  const audioUrl = item.json.narratorLink;\n  const script = item.json.narratorScript || '';\n\n  if (!imageUrl) return;\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = audioUrl ? `/tmp/render/audio${index}.mp3` : null;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio (solo si narratorGeneration es true)\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\";\\n`;\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n  }\n\n  // Obtener duraci√≥n\n  downloadCommands += `duration=0; `;\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); `;\n  }\n\n  if (addSubtitles && script.trim() !== '') {\n    // Dividir en dos mitades y en dos l√≠neas cada mitad\n    const [rawFirst, rawSecond] = splitScriptInHalf(script);\n    const firstWords = rawFirst.trim().split(/\\s+/);\n    const secondWords = rawSecond.trim().split(/\\s+/);\n\n    const firstLine1 = escapeFFmpegText(firstWords.slice(0, Math.ceil(firstWords.length / 2)).join(' '));\n    const firstLine2 = escapeFFmpegText(firstWords.slice(Math.ceil(firstWords.length / 2)).join(' '));\n    const secondLine1 = escapeFFmpegText(secondWords.slice(0, Math.ceil(secondWords.length / 2)).join(' '));\n    const secondLine2 = escapeFFmpegText(secondWords.slice(Math.ceil(secondWords.length / 2)).join(' '));\n\n    const drawtext1a = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${firstLine1}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-640:enable='lt(t,$duration*0.4)'`;\n    const drawtext1b = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${firstLine2}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-600:enable='lt(t,$duration*0.4)'`;\n    const drawtext2a = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${secondLine1}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-640:enable='gte(t,$duration*0.4)'`;\n    const drawtext2b = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${secondLine2}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-600:enable='gte(t,$duration*0.4)'`;\n\n    const fallbackText = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='‚ö†Ô∏è Error de string':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-600`;\n\n    downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=720:1280,fps=30,${drawtext1a},${drawtext1b},${drawtext2a},${drawtext2b}\" -pix_fmt yuv420p \"${rawVideo}\" || `;\n    downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=720:1280,fps=30,${fallbackText}\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n  } else {\n    downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=720:1280,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n  }\n\n  if (audioUrl && narratorGeneration) {\n    mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n    fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  } else {\n    fileListCommands += `if [ -f \"${rawVideo}\" ]; then echo \"file '${rawVideo}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  }\n});\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim()\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1340,
          1740
        ],
        "id": "86f866a0-03ca-46c0-8eb7-29e1d1a2241f",
        "name": "Code11"
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1500,
          1740
        ],
        "id": "b34f48a1-a758-4d2c-a51d-a0a935bc7311",
        "name": "Execute Command13",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1620,
          1740
        ],
        "id": "9963567e-b063-48bd-bbe2-0337668a14dc",
        "name": "Execute Command15",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1740,
          1740
        ],
        "id": "2b721546-28c7-41a0-85ef-f6d5bcb1db2c",
        "name": "Execute Command16",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1860,
          1740
        ],
        "id": "4fb6ee79-1fb6-40a2-968f-ebf1d8e5c611",
        "name": "Execute Command17",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code14').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2400,
          1740
        ],
        "id": "84f0b7cf-0074-469f-97d7-3dcf27a877df",
        "name": "Execute Command18",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3220,
          1740
        ],
        "id": "837a2579-4fce-4022-9145-285646c1e027",
        "name": "Read/Write Files from Disk"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code29').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3400,
          1740
        ],
        "id": "60c50141-8dbc-4730-9ca5-12e343e089b8",
        "name": "FTP8",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code14').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3820,
          1740
        ],
        "id": "ad2b5853-3798-46ec-9888-d46959e51467",
        "name": "Execute Command19"
      },
      {
        "parameters": {
          "command": "={{ $('Code14').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2560,
          1740
        ],
        "id": "3a9cab45-d9a9-48e4-b689-563ab51720c7",
        "name": "Execute Command1"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code29').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3580,
          1740
        ],
        "id": "3d2fb0c8-d214-48a0-bf38-0f0d2af83577",
        "name": "Telegram17",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "command": "echo \"üîç Verificando archivos listados en /tmp/render/filelist.txt...\"\n\nif [ ! -f /tmp/render/filelist.txt ]; then\n  echo \"‚ùå filelist.txt no existe\"\n  exit 1\nfi\n\nwhile IFS= read -r line; do\n  # Omitir l√≠neas vac√≠as\n  if [ -z \"$line\" ]; then\n    continue\n  fi\n\n  file_path=$(echo \"$line\" | cut -d\"'\" -f2)\n  if [ -z \"$file_path\" ]; then\n    echo \"‚ùå L√≠nea malformada: $line\"\n    continue\n  fi\n\n  if [ ! -f \"$file_path\" ]; then\n    echo \"‚ùå Falta $file_path\"\n  else\n    echo \"‚úÖ Existe $file_path\"\n  fi\ndone < /tmp/render/filelist.txt\n\necho \"‚úÖ Verificaci√≥n finalizada\"\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2000,
          1740
        ],
        "id": "0cdf2b7d-cca9-4861-a00f-e6fc0ddefe47",
        "name": "Execute Command6"
      },
      {
        "parameters": {
          "jsCode": "const musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst addMusic = $('If10').first().json.addMusic === true;\n\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\nlet musicCommand = '';\nif (addMusic) {\n  musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n} else {\n  musicCommand = `cp /tmp/render/combo.mp4 /tmp/render/final_with_music.mp4`;\n}\n\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2200,
          1740
        ],
        "id": "1afc4c4b-2d44-41d3-83a7-ef1e285a2b6f",
        "name": "Code14"
      },
      {
        "parameters": {
          "content": "## - Publicacion directa en youtube",
          "height": 260,
          "width": 600,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          720,
          -1460
        ],
        "id": "e720efc3-a059-4dda-8c30-1206fbe1e28e",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoStatus",
                "lookupValue": "ready"
              },
              {
                "lookupColumn": "videoGeneration",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "landscapeFormat",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          900,
          840
        ],
        "id": "7d48b1b0-d9b9-4614-a408-613e525c1c7f",
        "name": "Google Sheets4",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1340,
          940
        ],
        "id": "07e62284-e75b-4ff0-b8c9-b17f8bc5a83f",
        "name": "Loop Over Items3"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code15').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          2160,
          980
        ],
        "id": "bf5d8807-95cb-42bd-afd5-943b5d91c1f9",
        "name": "FTP4",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + $('Wait5').first().json.documentName + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1500,
          980
        ],
        "id": "1f48e0fc-163e-450e-afb0-045233352625",
        "name": "Code15"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Video finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4420,
          820
        ],
        "id": "51d5a69a-1b93-43e8-ac4a-50b8e07b4e78",
        "name": "Telegram18",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items3').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1620,
          980
        ],
        "id": "adaa8d52-2753-4399-8c72-4581ffedf8eb",
        "name": "Code16"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait5').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait5').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items3').item.json.row_number }}",
              "videoStatus": "done",
              "videoLink": "={{ $('Code15').item.json.publicUrl }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "shotDescStatus",
                "displayName": "shotDescStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoBol",
                "displayName": "videoBol",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorBol",
                "displayName": "narratorBol",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "shotDescription",
                "displayName": "shotDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2320,
          980
        ],
        "id": "ad700ee2-6b7b-4b31-a5d4-f499d2d46688",
        "name": "Google Sheets9",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          680,
          840
        ],
        "id": "38361bed-76a7-4d6b-bc01-f9587e15dc99",
        "name": "Wait5",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait5').first().json.documentName; \nconst documentLink = $('Wait5').first().json.documentLink; \n\nreturn [\n  {\n    documentName,\n    documentLink\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4460,
          1000
        ],
        "id": "46dea281-6a1a-4380-b8b8-2b266a9a0bfa",
        "name": "Code17"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1100,
          820
        ],
        "id": "11f9881e-dea6-4377-85fd-901b09b491f4",
        "name": "If"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          2360,
          820
        ],
        "id": "241320e3-e08a-490a-8db2-43bd7c07c06a",
        "name": "Limit6"
      },
      {
        "parameters": {
          "content": "## Video Generation",
          "height": 380,
          "width": 4000
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          640,
          780
        ],
        "id": "43a5809c-4c2e-408c-a3dc-819cab60d1c9",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('Google Sheets4').item.json.imageLink }}\" -O /tmp/generated.jpg"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1740,
          980
        ],
        "id": "b5f13d6c-db91-4069-9c32-ea3e755ab5fc",
        "name": "Execute Command2",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.jpg",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1880,
          980
        ],
        "id": "6ffc70d3-e362-4316-82d7-d198178bc8a0",
        "name": "Read/Write Files from Disk1"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait5').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait5').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoVStatus",
                "lookupValue": "ready"
              },
              {
                "lookupColumn": "videoGeneration",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "portraitFormat",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2720,
          800
        ],
        "id": "caec8544-5dfb-46fd-81f9-bdba7c16f8a1",
        "name": "Google Sheets10",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3120,
          920
        ],
        "id": "ab516015-02b4-493d-82b4-686ce25c82d9",
        "name": "Loop Over Items4"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code18').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3940,
          960
        ],
        "id": "2837a441-cabe-4509-a034-c322ba7c3950",
        "name": "FTP5",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + $('Wait5').first().json.documentName + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3280,
          960
        ],
        "id": "fcff676f-6d53-495c-8114-7f35539526ee",
        "name": "Code18"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items4').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3400,
          960
        ],
        "id": "311f454a-bcb8-433b-b37e-dbeef171dc00",
        "name": "Code19"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait5').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait5').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items4').item.json.row_number }}",
              "videoVStatus": "done",
              "videoLinkV": "={{ $('Code18').item.json.publicUrl }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "shotDescStatus",
                "displayName": "shotDescStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoBol",
                "displayName": "videoBol",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorBol",
                "displayName": "narratorBol",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "shotDescription",
                "displayName": "shotDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          4120,
          960
        ],
        "id": "adc3fb4c-9c72-4d2f-bad2-388ac025926c",
        "name": "Google Sheets12",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          2880,
          800
        ],
        "id": "5f95c246-efaa-4508-9701-ce0127fbfb5f",
        "name": "If1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4140,
          800
        ],
        "id": "9447c2d3-4316-4f62-9b50-3d1a71d1bb64",
        "name": "Limit7"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('Google Sheets10').item.json.imageLinkV }}\" -O /tmp/generated.jpg"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3520,
          960
        ],
        "id": "d1698051-d8b8-43be-8512-106f116b4a83",
        "name": "Execute Command3",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.jpg",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3660,
          960
        ],
        "id": "2b2d8780-8ec2-4595-a207-1e40756e443f",
        "name": "Read/Write Files from Disk5"
      },
      {
        "parameters": {
          "workflow": "={\n  \"3\": {\n    \"inputs\": {\n      \"seed\": 1043102782273638,\n      \"steps\": 20,\n      \"cfg\": 6.0,\n      \"sampler_name\": \"uni_pc\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1.0,\n      \"model\": [\n        \"54\",\n        0\n      ],\n      \"positive\": [\n        \"50\",\n        0\n      ],\n      \"negative\": [\n        \"50\",\n        1\n      ],\n      \"latent_image\": [\n        \"50\",\n        2\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"6\": {\n    \"inputs\": {\n      \"text\": \"{{ $('Code16').item.json.cleanedText }}\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"7\": {\n    \"inputs\": {\n      \"text\": \"Ëâ≤Ë∞ÉËâ≥‰∏ΩÔºåËøáÊõùÔºåÈùôÊÄÅÔºåÁªÜËäÇÊ®°Á≥ä‰∏çÊ∏ÖÔºåÂ≠óÂπïÔºåÈ£éÊ†ºÔºå‰ΩúÂìÅÔºåÁîª‰ΩúÔºåÁîªÈù¢ÔºåÈùôÊ≠¢ÔºåÊï¥‰ΩìÂèëÁÅ∞ÔºåÊúÄÂ∑ÆË¥®ÈáèÔºå‰ΩéË¥®ÈáèÔºåJPEGÂéãÁº©ÊÆãÁïôÔºå‰∏ëÈôãÁöÑÔºåÊÆãÁº∫ÁöÑÔºåÂ§ö‰ΩôÁöÑÊâãÊåáÔºåÁîªÂæó‰∏çÂ•ΩÁöÑÊâãÈÉ®ÔºåÁîªÂæó‰∏çÂ•ΩÁöÑËÑ∏ÈÉ®ÔºåÁï∏ÂΩ¢ÁöÑÔºåÊØÅÂÆπÁöÑÔºåÂΩ¢ÊÄÅÁï∏ÂΩ¢ÁöÑËÇ¢‰ΩìÔºåÊâãÊåáËûçÂêàÔºåÈùôÊ≠¢‰∏çÂä®ÁöÑÁîªÈù¢ÔºåÊùÇ‰π±ÁöÑËÉåÊôØÔºå‰∏âÊù°ËÖøÔºåËÉåÊôØ‰∫∫ÂæàÂ§öÔºåÂÄíÁùÄËµ∞\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"3\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"37\": {\n    \"inputs\": {\n      \"unet_name\": \"Wan2.1\\\\wan2.1_i2v_480p_14B_fp8_scaled.safetensors\",\n      \"weight_dtype\": \"default\"\n    },\n    \"class_type\": \"UNETLoader\",\n    \"_meta\": {\n      \"title\": \"Load Diffusion Model\"\n    }\n  },\n  \"38\": {\n    \"inputs\": {\n      \"clip_name\": \"umt5_xxl_fp8_e4m3fn_scaled.safetensors\",\n      \"type\": \"wan\",\n      \"device\": \"default\"\n    },\n    \"class_type\": \"CLIPLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP\"\n    }\n  },\n  \"39\": {\n    \"inputs\": {\n      \"vae_name\": \"wan_2.1_vae.safetensors\"\n    },\n    \"class_type\": \"VAELoader\",\n    \"_meta\": {\n      \"title\": \"Load VAE\"\n    }\n  },\n  \"49\": {\n    \"inputs\": {\n      \"clip_name\": \"clip_vision_h.safetensors\"\n    },\n    \"class_type\": \"CLIPVisionLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP Vision\"\n    }\n  },\n  \"50\": {\n    \"inputs\": {\n      \"width\": 576,\n      \"height\": 320,\n      \"length\": 60,\n      \"batch_size\": 1,\n      \"positive\": [\n        \"6\",\n        0\n      ],\n      \"negative\": [\n        \"7\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ],\n      \"clip_vision_output\": [\n        \"51\",\n        0\n      ],\n      \"start_image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"WanImageToVideo\",\n    \"_meta\": {\n      \"title\": \"WanImageToVideo\"\n    }\n  },\n  \"51\": {\n    \"inputs\": {\n      \"crop\": \"none\",\n      \"clip_vision\": [\n        \"49\",\n        0\n      ],\n      \"image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPVisionEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Vision Encode\"\n    }\n  },\n  \"52\": {\n    \"inputs\": {\n      \"image\": \"generated.jpg\"\n    },\n    \"class_type\": \"LoadImage\",\n    \"_meta\": {\n      \"title\": \"Load Image\"\n    }\n  },\n  \"54\": {\n    \"inputs\": {\n      \"shift\": 8.000000000000002,\n      \"model\": [\n        \"37\",\n        0\n      ]\n    },\n    \"class_type\": \"ModelSamplingSD3\",\n    \"_meta\": {\n      \"title\": \"ModelSamplingSD3\"\n    }\n  },\n  \"55\": {\n    \"inputs\": {\n      \"frame_rate\": 12,\n      \"loop_count\": 0,\n      \"filename_prefix\": \"comfyUI\",\n      \"format\": \"video/h264-mp4\",\n      \"pix_fmt\": \"yuv420p\",\n      \"crf\": 19,\n      \"save_metadata\": true,\n      \"trim_to_audio\": false,\n      \"pingpong\": true,\n      \"save_output\": true,\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"VHS_VideoCombine\",\n    \"_meta\": {\n      \"title\": \"Video Combine üé•üÖ•üÖóüÖ¢\"\n    }\n  }\n}",
          "inputType": "binary",
          "timeout": 60
        },
        "type": "n8n-nodes-comfyui-image-to-video.comfyuiImageToVideo",
        "typeVersion": 1,
        "position": [
          2020,
          980
        ],
        "id": "f62b040a-31dc-4663-a7e3-81cff32bbb62",
        "name": "ComfyUI Image to Video",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"3\": {\n    \"inputs\": {\n      \"seed\": 1043102782273638,\n      \"steps\": 20,\n      \"cfg\": 6.0,\n      \"sampler_name\": \"uni_pc\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1.0,\n      \"model\": [\n        \"54\",\n        0\n      ],\n      \"positive\": [\n        \"50\",\n        0\n      ],\n      \"negative\": [\n        \"50\",\n        1\n      ],\n      \"latent_image\": [\n        \"50\",\n        2\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"6\": {\n    \"inputs\": {\n      \"text\": \"{{ $('Code16').item.json.cleanedText }}\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"7\": {\n    \"inputs\": {\n      \"text\": \"Ëâ≤Ë∞ÉËâ≥‰∏ΩÔºåËøáÊõùÔºåÈùôÊÄÅÔºåÁªÜËäÇÊ®°Á≥ä‰∏çÊ∏ÖÔºåÂ≠óÂπïÔºåÈ£éÊ†ºÔºå‰ΩúÂìÅÔºåÁîª‰ΩúÔºåÁîªÈù¢ÔºåÈùôÊ≠¢ÔºåÊï¥‰ΩìÂèëÁÅ∞ÔºåÊúÄÂ∑ÆË¥®ÈáèÔºå‰ΩéË¥®ÈáèÔºåJPEGÂéãÁº©ÊÆãÁïôÔºå‰∏ëÈôãÁöÑÔºåÊÆãÁº∫ÁöÑÔºåÂ§ö‰ΩôÁöÑÊâãÊåáÔºåÁîªÂæó‰∏çÂ•ΩÁöÑÊâãÈÉ®ÔºåÁîªÂæó‰∏çÂ•ΩÁöÑËÑ∏ÈÉ®ÔºåÁï∏ÂΩ¢ÁöÑÔºåÊØÅÂÆπÁöÑÔºåÂΩ¢ÊÄÅÁï∏ÂΩ¢ÁöÑËÇ¢‰ΩìÔºåÊâãÊåáËûçÂêàÔºåÈùôÊ≠¢‰∏çÂä®ÁöÑÁîªÈù¢ÔºåÊùÇ‰π±ÁöÑËÉåÊôØÔºå‰∏âÊù°ËÖøÔºåËÉåÊôØ‰∫∫ÂæàÂ§öÔºåÂÄíÁùÄËµ∞\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"3\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"37\": {\n    \"inputs\": {\n      \"unet_name\": \"Wan2.1\\\\wan2.1_i2v_480p_14B_fp8_scaled.safetensors\",\n      \"weight_dtype\": \"default\"\n    },\n    \"class_type\": \"UNETLoader\",\n    \"_meta\": {\n      \"title\": \"Load Diffusion Model\"\n    }\n  },\n  \"38\": {\n    \"inputs\": {\n      \"clip_name\": \"umt5_xxl_fp8_e4m3fn_scaled.safetensors\",\n      \"type\": \"wan\",\n      \"device\": \"default\"\n    },\n    \"class_type\": \"CLIPLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP\"\n    }\n  },\n  \"39\": {\n    \"inputs\": {\n      \"vae_name\": \"wan_2.1_vae.safetensors\"\n    },\n    \"class_type\": \"VAELoader\",\n    \"_meta\": {\n      \"title\": \"Load VAE\"\n    }\n  },\n  \"49\": {\n    \"inputs\": {\n      \"clip_name\": \"clip_vision_h.safetensors\"\n    },\n    \"class_type\": \"CLIPVisionLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP Vision\"\n    }\n  },\n  \"50\": {\n    \"inputs\": {\n      \"width\": 320,\n      \"height\": 576,\n      \"length\": 60,\n      \"batch_size\": 1,\n      \"positive\": [\n        \"6\",\n        0\n      ],\n      \"negative\": [\n        \"7\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ],\n      \"clip_vision_output\": [\n        \"51\",\n        0\n      ],\n      \"start_image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"WanImageToVideo\",\n    \"_meta\": {\n      \"title\": \"WanImageToVideo\"\n    }\n  },\n  \"51\": {\n    \"inputs\": {\n      \"crop\": \"none\",\n      \"clip_vision\": [\n        \"49\",\n        0\n      ],\n      \"image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPVisionEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Vision Encode\"\n    }\n  },\n  \"52\": {\n    \"inputs\": {\n      \"image\": \"generated.jpg\"\n    },\n    \"class_type\": \"LoadImage\",\n    \"_meta\": {\n      \"title\": \"Load Image\"\n    }\n  },\n  \"54\": {\n    \"inputs\": {\n      \"shift\": 8.000000000000002,\n      \"model\": [\n        \"37\",\n        0\n      ]\n    },\n    \"class_type\": \"ModelSamplingSD3\",\n    \"_meta\": {\n      \"title\": \"ModelSamplingSD3\"\n    }\n  },\n  \"55\": {\n    \"inputs\": {\n      \"frame_rate\": 12,\n      \"loop_count\": 0,\n      \"filename_prefix\": \"comfyUI\",\n      \"format\": \"video/h264-mp4\",\n      \"pix_fmt\": \"yuv420p\",\n      \"crf\": 19,\n      \"save_metadata\": true,\n      \"trim_to_audio\": false,\n      \"pingpong\": true,\n      \"save_output\": true,\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"VHS_VideoCombine\",\n    \"_meta\": {\n      \"title\": \"Video Combine üé•üÖ•üÖóüÖ¢\"\n    }\n  }\n}",
          "inputType": "binary",
          "timeout": 60
        },
        "type": "n8n-nodes-comfyui-image-to-video.comfyuiImageToVideo",
        "typeVersion": 1,
        "position": [
          3800,
          960
        ],
        "id": "3af2cc2e-55d2-487c-beb5-10aa5fed22b1",
        "name": "ComfyUI Image to Video1",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + $('Wait3').first().json.documentName + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3020,
          1420
        ],
        "id": "8453287e-61c3-4047-86e9-a6ea12103511",
        "name": "Code31"
      },
      {
        "parameters": {
          "jsCode": "const rows = items;\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Funci√≥n para dividir texto a la mitad\nconst splitScriptInHalf = (text) => {\n  const words = text.trim().split(/\\s+/);\n  const midpoint = Math.ceil(words.length / 2);\n  return [\n    words.slice(0, midpoint).join(' '),\n    words.slice(midpoint).join(' ')\n  ];\n};\n\nconst addSubtitles = $input.first().json.addSubtitles === true;\nconst narratorGeneration = $input.first().json.narratorGeneration === true;\n\nrows.forEach((item, index) => {\n  const videoUrl = item.json.videoLink;\n  const audioUrl = item.json.narratorLink;\n  const script = item.json.narratorScript || '';\n\n  if (!videoUrl) return;\n\n  const rawVideo = `/tmp/render/rawvideo${index}.mp4`;\n  const rawAudio = audioUrl ? `/tmp/render/audio${index}.mp3` : null;\n  const subtitledVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar video y, si aplica, audio\n  downloadCommands += `wget -q -O \"${rawVideo}\" \"${videoUrl}\";\\n`;\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n  }\n\n  // Obtener duraci√≥n\n  downloadCommands += `duration=0; `;\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); `;\n  }\n\n  if (addSubtitles && script.trim() !== '') {\n    const [firstPart, secondPart] = splitScriptInHalf(script);\n\n    const drawtext1 = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${firstPart}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-120:enable='lt(t,$duration*0.4)'`;\n    const drawtext2 = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${secondPart}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-120:enable='gte(t,$duration*0.4)'`;\n\n    const fallbackText = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='‚ö†Ô∏è Error de string':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-120`;\n\n    downloadCommands += `ffmpeg -y -i \"${rawVideo}\" -t $duration -vf \"scale=1280:720,fps=30,${drawtext1},${drawtext2}\" -pix_fmt yuv420p \"${subtitledVideo}\" || `;\n    downloadCommands += `ffmpeg -y -i \"${rawVideo}\" -t $duration -vf \"scale=1280:720,fps=30,${fallbackText}\" -pix_fmt yuv420p \"${subtitledVideo}\";\\n`;\n  } else {\n    downloadCommands += `ffmpeg -y -i \"${rawVideo}\" -t $duration -vf \"scale=1280:720,fps=30\" -pix_fmt yuv420p \"${subtitledVideo}\";\\n`;\n  }\n\n  if (audioUrl && narratorGeneration) {\n    mergeCommands += `ffmpeg -y -i \"${subtitledVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n    fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  } else {\n    // Sin audio, agrega video solo para concatenar\n    fileListCommands += `if [ -f \"${subtitledVideo}\" ]; then echo \"file '${subtitledVideo}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  }\n});\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim()\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1340,
          1420
        ],
        "id": "b3d7a781-35c7-4790-911b-0972dec9b030",
        "name": "Code20"
      },
      {
        "parameters": {
          "command": "={{ $('Code20').item.json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1500,
          1420
        ],
        "id": "0507d728-5866-4a99-adc3-2cfe10d7c8bd",
        "name": "Execute Command21",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code20').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1620,
          1420
        ],
        "id": "211fdaf7-2d29-43ed-86f4-097bbec53b8e",
        "name": "Execute Command22",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code20').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1740,
          1420
        ],
        "id": "0b4835ff-a221-4c89-b7c3-17cd4980aca8",
        "name": "Execute Command23",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code20').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1860,
          1420
        ],
        "id": "73ab32ec-8ddb-410d-8625-2c19dedeffae",
        "name": "Execute Command24",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code22').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2400,
          1420
        ],
        "id": "ba9a2470-ff09-42b6-b24a-5e704629fd39",
        "name": "Execute Command25",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3220,
          1420
        ],
        "id": "302cd84d-9ee2-4c37-9b95-590172e266be",
        "name": "Read/Write Files from Disk6"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code31').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3400,
          1420
        ],
        "id": "bdad377a-3822-4d01-870e-ca59a83659ce",
        "name": "FTP9",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code22').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3820,
          1420
        ],
        "id": "8c215513-897b-494d-8699-15a68ffa8774",
        "name": "Execute Command26"
      },
      {
        "parameters": {
          "command": "={{ $('Code22').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2560,
          1420
        ],
        "id": "93eab72e-b5f2-4772-99fc-b5fd6e47cd07",
        "name": "Execute Command4"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code31').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3580,
          1420
        ],
        "id": "abc50adf-c081-4614-a1bc-d2d461531ea4",
        "name": "Telegram22",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code22').item.json.yt_title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4060,
          1420
        ],
        "id": "0eb7745b-e660-4db7-950a-1d99b7ee2c15",
        "name": "Telegram24",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code22').item.json.yt_description }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4200,
          1420
        ],
        "id": "22601684-ae2d-423a-aaeb-3aaa8ebe63f1",
        "name": "Telegram25",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code22').item.json.yt_thumbnail }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4340,
          1420
        ],
        "id": "84af3897-648b-43eb-8a94-cd56e2d42da3",
        "name": "Telegram26",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code22').item.json.yt_tags }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4480,
          1420
        ],
        "id": "0c90a045-f27d-4ddc-b8eb-966f923b2ce8",
        "name": "Telegram27",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $json.sentence }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 768,\n      \"height\": 432,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          5400,
          420
        ],
        "id": "4f8a80e1-81c6-4631-9cbd-737fd627d46d",
        "name": "ComfyUI3",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code21').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          5560,
          420
        ],
        "id": "973cd781-f1c2-407e-af36-1aaf9c083be7",
        "name": "FTP6",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const originalName = $('Wait2').first().json.documentName;\n\nconst filename = originalName\n  .replace(/:/g, \"_\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"ThumbNail.jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5000,
          420
        ],
        "id": "e148c18e-dfe4-4360-a687-b95ff2de0bde",
        "name": "Code21"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code21').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5720,
          420
        ],
        "id": "bc1f395e-f9d8-48ce-b4e9-896b3d4e876b",
        "name": "Telegram1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "command": "echo \"üîç Verificando archivos listados en /tmp/render/filelist.txt...\"\n\nif [ ! -f /tmp/render/filelist.txt ]; then\n  echo \"‚ùå filelist.txt no existe\"\n  exit 1\nfi\n\nwhile IFS= read -r line; do\n  # Omitir l√≠neas vac√≠as\n  if [ -z \"$line\" ]; then\n    continue\n  fi\n\n  file_path=$(echo \"$line\" | cut -d\"'\" -f2)\n  if [ -z \"$file_path\" ]; then\n    echo \"‚ùå L√≠nea malformada: $line\"\n    continue\n  fi\n\n  if [ ! -f \"$file_path\" ]; then\n    echo \"‚ùå Falta $file_path\"\n  else\n    echo \"‚úÖ Existe $file_path\"\n  fi\ndone < /tmp/render/filelist.txt\n\necho \"‚úÖ Verificaci√≥n finalizada\"\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2000,
          1420
        ],
        "id": "eadfc89e-f5a3-4c7a-a366-08d7ec84aab0",
        "name": "Execute Command27"
      },
      {
        "parameters": {
          "jsCode": "const musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst addMusic = $('If8').first().json.addMusic === true;\n\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\nlet musicCommand = '';\nif (addMusic) {\n  musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n} else {\n  musicCommand = `cp /tmp/render/combo.mp4 /tmp/render/final_with_music.mp4`;\n}\n\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    yt_title: $('Google Sheets2').first().json.YoutubeTitle,\n    yt_description: $('Google Sheets2').first().json.YoutubeDescription,\n    yt_tags: $('Google Sheets2').first().json.YoutubeTags,\n    yt_thumbnail: $('Google Sheets2').first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2200,
          1420
        ],
        "id": "f80c08fe-e25a-499a-8bc9-314db95415d7",
        "name": "Code22"
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + $('Wait3').first().json.documentName + \"Vert.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/AIO/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/AIO/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3020,
          1880
        ],
        "id": "40834da7-0626-47a8-b1d4-5beae7a69d26",
        "name": "Code32"
      },
      {
        "parameters": {
          "jsCode": "const rows = items;\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Funci√≥n para dividir texto en dos mitades\nconst splitScriptInHalf = (text) => {\n  const words = text.trim().split(/\\s+/);\n  const midpoint = Math.ceil(words.length / 2);\n  return [\n    words.slice(0, midpoint).join(' '),\n    words.slice(midpoint).join(' ')\n  ];\n};\n\n// Escapar texto para FFmpeg drawtext\nconst escapeFFmpegText = (text) =>\n  text.replace(/:/g, '\\\\:').replace(/'/g, \"\\\\\\\\'\").replace(/\"/g, '');\n\nconst addSubtitles = $input.first().json.addSubtitles === true;\nconst narratorGeneration = $input.first().json.narratorGeneration === true;\n\nrows.forEach((item, index) => {\n  const videoUrl = item.json.videoLinkV;\n  const audioUrl = item.json.narratorLink;\n  const script = item.json.narratorScript || '';\n\n  if (!videoUrl) return;\n\n  const rawVideo = `/tmp/render/rawvideo${index}.mp4`;\n  const rawAudio = audioUrl ? `/tmp/render/audio${index}.mp3` : null;\n  const subtitledVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar video y audio si aplica\n  downloadCommands += `wget -q -O \"${rawVideo}\" \"${videoUrl}\";\\n`;\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n  }\n\n  // Obtener duraci√≥n\n  downloadCommands += `duration=0; `;\n  if (audioUrl && narratorGeneration) {\n    downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); `;\n  }\n\n  if (addSubtitles && script.trim() !== '') {\n    const [rawFirst, rawSecond] = splitScriptInHalf(script);\n    const firstWords = rawFirst.trim().split(/\\s+/);\n    const secondWords = rawSecond.trim().split(/\\s+/);\n\n    const firstLine1 = escapeFFmpegText(firstWords.slice(0, Math.ceil(firstWords.length / 2)).join(' '));\n    const firstLine2 = escapeFFmpegText(firstWords.slice(Math.ceil(firstWords.length / 2)).join(' '));\n    const secondLine1 = escapeFFmpegText(secondWords.slice(0, Math.ceil(secondWords.length / 2)).join(' '));\n    const secondLine2 = escapeFFmpegText(secondWords.slice(Math.ceil(secondWords.length / 2)).join(' '));\n\n    const drawtext1a = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${firstLine1}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-640:enable='lt(t,$duration*0.4)'`;\n    const drawtext1b = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${firstLine2}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-600:enable='lt(t,$duration*0.4)'`;\n    const drawtext2a = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${secondLine1}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-640:enable='gte(t,$duration*0.4)'`;\n    const drawtext2b = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='${secondLine2}':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-600:enable='gte(t,$duration*0.4)'`;\n\n    const fallbackText = `drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf:text='‚ö†Ô∏è Error de string':fontcolor=white:fontsize=30:borderw=2:x=(w-text_w)/2:y=h-600`;\n\n    downloadCommands += `ffmpeg -y -i \"${rawVideo}\" -t $duration -vf \"scale=720:1280,fps=30,${drawtext1a},${drawtext1b},${drawtext2a},${drawtext2b}\" -pix_fmt yuv420p \"${subtitledVideo}\" || `;\n    downloadCommands += `ffmpeg -y -i \"${rawVideo}\" -t $duration -vf \"scale=720:1280,fps=30,${fallbackText}\" -pix_fmt yuv420p \"${subtitledVideo}\";\\n`;\n  } else {\n    downloadCommands += `ffmpeg -y -i \"${rawVideo}\" -t $duration -vf \"scale=720:1280,fps=30\" -pix_fmt yuv420p \"${subtitledVideo}\";\\n`;\n  }\n\n  if (audioUrl && narratorGeneration) {\n    mergeCommands += `ffmpeg -y -i \"${subtitledVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n    fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  } else {\n    fileListCommands += `if [ -f \"${subtitledVideo}\" ]; then echo \"file '${subtitledVideo}'\" >> /tmp/render/filelist.txt; fi\\n`;\n  }\n});\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim()\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1340,
          1880
        ],
        "id": "6dd67194-7e9a-4f55-829a-fef8916a54f4",
        "name": "Code23"
      },
      {
        "parameters": {
          "command": "={{ $('Code23').item.json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1500,
          1880
        ],
        "id": "961f71a2-28c0-49aa-b2e4-abac76f7222b",
        "name": "Execute Command28",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code23').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1620,
          1880
        ],
        "id": "e0d8e2dc-6231-4a4d-8432-619abd822163",
        "name": "Execute Command29",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code23').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1740,
          1880
        ],
        "id": "742d24f0-2aa3-41c3-bb0b-9632e66fcdf6",
        "name": "Execute Command30",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code23').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1860,
          1880
        ],
        "id": "5c33300b-6253-407d-a855-72c7579d6f67",
        "name": "Execute Command31",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code25').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2400,
          1880
        ],
        "id": "f0ab15d8-e165-465c-a21f-e357172e00cc",
        "name": "Execute Command32",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3220,
          1880
        ],
        "id": "ccb89a98-7838-44b3-8b0b-3b4d96051096",
        "name": "Read/Write Files from Disk7"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code32').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3400,
          1880
        ],
        "id": "399367dc-fe6d-47d8-9e26-f9f77dce1a6d",
        "name": "FTP10",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code25').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3820,
          1880
        ],
        "id": "1702f943-2f97-4811-a881-5fe9f0a33c29",
        "name": "Execute Command33"
      },
      {
        "parameters": {
          "command": "={{ $('Code25').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2560,
          1880
        ],
        "id": "53b22b37-e195-4578-bb6e-f04d177cb257",
        "name": "Execute Command34"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code32').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3580,
          1880
        ],
        "id": "60475b8e-e815-49c2-86ab-9586eb0ef9be",
        "name": "Telegram28",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "command": "echo \"üîç Verificando archivos listados en /tmp/render/filelist.txt...\"\n\nif [ ! -f /tmp/render/filelist.txt ]; then\n  echo \"‚ùå filelist.txt no existe\"\n  exit 1\nfi\n\nwhile IFS= read -r line; do\n  # Omitir l√≠neas vac√≠as\n  if [ -z \"$line\" ]; then\n    continue\n  fi\n\n  file_path=$(echo \"$line\" | cut -d\"'\" -f2)\n  if [ -z \"$file_path\" ]; then\n    echo \"‚ùå L√≠nea malformada: $line\"\n    continue\n  fi\n\n  if [ ! -f \"$file_path\" ]; then\n    echo \"‚ùå Falta $file_path\"\n  else\n    echo \"‚úÖ Existe $file_path\"\n  fi\ndone < /tmp/render/filelist.txt\n\necho \"‚úÖ Verificaci√≥n finalizada\"\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2000,
          1880
        ],
        "id": "f858b5bc-e01b-4db1-9867-ff6fefdff0fd",
        "name": "Execute Command35"
      },
      {
        "parameters": {
          "jsCode": "const musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst addMusic = $('If9').first().json.addMusic === true;\n\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\nconst musicCommand = addMusic\n  ? `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`\n  : `cp /tmp/render/combo.mp4 /tmp/render/final_with_music.mp4`;\n\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand\n  }\n};\n\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2200,
          1880
        ],
        "id": "99747515-b6f2-4dd7-b38f-8f468f4db93c",
        "name": "Code25"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n\"Paramenters\": \"________________________________________________________\",\n\"landscapeFormat\":true,\n\"portraitFormat\":true,\n\"imageGeneration\":true,\n\"videoGeneration\":true,\n\"narratorGeneration\":true,\n\"makeImageRender\":true,\n\"makeVideoRender\":true,\n\"addSubtitles\":true,\n\"addMusic\":true,\n\"documentConfiguration\": \"________________________________________________________\",\n\"documentLink\":\"https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk\",\n\"Sheet\": \"Sheet1\",\n\"videoContent\": \"________________________________________________________\",\n\"artStyle\":\"2D disney style\",\n\"howManySentences\":\"3\",\n\"concept1Sentece\": \"why it sucks to be: \",\n\"concept1Paragraph\": \"The tone should balance emotional storytelling with a touch of dark humor and irony, while remaining respectful, family-friendly, and legally safe when referencing fictional characters., highlighting why this character‚Äôs life was unexpectedly difficult or unfair despite their fame, powers, or heroic status. Focus on emotional burdens, social pressure, identity struggles, misunderstood intentions, or ironic outcomes. Use vivid, imaginative language to evoke visuals and feelings without sounding too cinematic. Keep the story grounded, relatable, and with a hint of satire or social commentary. Avoid quoting or copying exact phrases or events from copyrighted material ‚Äî use generalized references instead.\",\n\"narratorStyle\":\"Each sentence must describe a moment or scene that shows how difficult, frustrating, or unexpectedly ironic their life was. The tone should be emotional, grounded, and filled with human tension ‚Äî but with modern, relatable humor and a clear sense that this is a parody. If the character is fictional or from pop culture, describe their challenges in a generalized and transformative way that avoids direct or copyrighted references, while still making their identity recognizable.\",\n\"Youtube\": \"________________________________________________________\",\n\"channel\":\"LemonSushi\",\n\"TitleConcept\": \"Why it sucks to be [Character], [something that generates curiosity]\",\n\"thumbnailPromptConcept\": \"A 2d disney style image with a clean white background. At the center is a handcrafted clay figure of [Character], sculpted with expressive facial features and exaggerated emotional details, as if made from real plasticine. Above the character, the title ‚ÄúWHY IT SUCKED TO BE [Character Name]‚Äù is written in extra large, colorful clay letters‚Äîeach word in a different vibrant color (red, yellow, blue, green, orange, purple). The letters should be bold, oversized, and clearly legible even at small thumbnail size, taking up a significant portion of the top half of the image. The font is playful and eye-catching, with a handcrafted texture. The overall image should look like a still frame from a high-end 2d disney movie, with dramatic composition and soft shadows for realism, but always keeping a handcrafted plasticine aesthetic.\",\n\"last\":\"last\"\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -320,
          -1100
        ],
        "id": "19f4dd69-eec8-45b7-9db4-df7eec86b2d2",
        "name": "Edit Fields3"
      },
      {
        "parameters": {
          "content": "## Dummy\n\n",
          "height": 240,
          "color": 7
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -380,
          -1180
        ],
        "id": "54ee74ff-e4c0-4f71-bb4c-7c5b7f8ecc50",
        "name": "Sticky Note7"
      },
      {
        "parameters": {
          "content": "## Check if there is a WIP\n\n",
          "height": 380,
          "width": 900
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          620,
          -960
        ],
        "id": "3e8aa833-09bb-4c57-8da7-ebf61f007c49",
        "name": "Sticky Note10"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.Sheet }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "wip"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          680,
          -860
        ],
        "id": "18883dec-32c7-4b34-8813-f43504c66bb4",
        "name": "idea1",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "e006a779-15c2-4461-804b-ac76e05f6c1d",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          860,
          -860
        ],
        "id": "6cc38351-49ce-415e-a565-138cef8c372a",
        "name": "If2"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.Sheet }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('idea').item.json.row_number }}",
              "status": "wip",
              "sheet": "={{ $('Edit Fields5').item.json.fileName }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "idea",
                "displayName": "idea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "sheet",
                "displayName": "sheet",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          5000,
          -520
        ],
        "id": "69cd3ebb-b054-45b9-ae33-0280b552cb7b",
        "name": "Google Sheets13",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          4100,
          -220
        ],
        "id": "4e2747a9-3f0b-42c6-8145-d37dc776ac4d",
        "name": "DeepSeek Chat Model11",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          4240,
          -180
        ],
        "id": "70e8505f-e2da-42de-afe7-46f9d51f9098",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Task  \nYou are a professional text-to-image prompt engineer working for a YouTube channel. You will receive:  \n1 narrator sentence.  \n\nYour job is to convert that sentence into a single image prompt Each image must reflect emotional storytelling, and expressive character design\n\n\nUse this structure for each prompt:  \n\"{{ $('Wait4').item.json.artStyle }} Describe, who is the [Character] is a [age]-year-old [gender] with [facial features] (e.g., [hair color/style, eye shape, exaggerated or simple features]), wearing [clothing style] that reflects their [personality traits]. Their [physical mannerisms] (such as [posture or gesture]) express their emotional state. In this scene, they are [action/position] in a [environment] , with visible textures, enhanced by [lighting, mood, colors].\"\n\nIf the sentence does not involve a character, describe the scene or symbolic element in the same style\n\n\n#Video is about\n{{ $('Edit Fields5').item.json.youtubeTitle }}\n#Narrator Sentence  \n{{ $json.sentence }}\n\n\n# Rules  \n- All characters and elements must be in {{ $('Wait4').item.json.artStyle }}\n- Do not number the prompts or use labels like Scene1 or VersionB  \n- Do not include any extra explanations or formatting  \n- Output must be exactly 1 standalone prompt in paragraph form  \n\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          3780,
          -420
        ],
        "id": "3e93ce5e-8788-4683-98a7-b25b7017c5c0",
        "name": "Image Prompt Agent1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Task  \nYou are a professional text-to-image prompt supervisor working for a YouTube channel. You will receive:  \n1 image prompt\n\nYour job is to confirm that the prompt is correct and if its not correct to fix it. \n\n- Each image prompt must reflect emotional storytelling, and expressive character design\n- the prompt must include the style: {{ $('Wait4').item.json.artStyle }}\n- the prompt must be about the next information:\n\n\n#Video is about\n{{ $('Edit Fields5').item.json.youtubeTitle }}\n#Narrator Sentence  \n{{ $('Loop Over Items5').item.json.sentence }}\n\n\n# Rules  \n- All characters and elements must be in {{ $('Wait4').item.json.artStyle }}\n- Do not number the prompts or use labels like Scene1 or VersionB  \n- Do not include any extra explanations or formatting  \n- Output must be exactly 1 standalone prompt in paragraph form ready to use\n\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          4120,
          -420
        ],
        "id": "420ad782-3dca-47ae-b3ec-e1eeabaaba10",
        "name": "Image Prompt Supervisor"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $input.first().json.sheet\nconst documentLink = $('Wait4').first().json.documentLink;\n\nreturn [\n  {\n    documentName,\n    documentLink\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1080,
          -880
        ],
        "id": "5a23dcc8-a378-445d-b3d5-b0e323864314",
        "name": "Code24"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "thumbnailStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          4140,
          420
        ],
        "id": "c0ef84c2-f702-437b-a5af-bf1f87f3a739",
        "name": "Google Sheets15",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n\"Paramenters\": \"________________________________________________________\",\n\"landscapeFormat\":true,\n\"portraitFormat\":true,\n\"imageGeneration\":true,\n\"videoGeneration\":true,\n\"narratorGeneration\":true,\n\"makeImageRender\":false,\n\"makeVideoRender\":true,\n\"addSubtitles\":true,\n\"addMusic\":true,\n\"documentConfiguration\": \"________________________________________________________\",\n\"documentLink\":\"https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk\",\n\"Sheet\": \"Sheet1\",\n\"videoContent\": \"________________________________________________________\",\n\"artStyle\":\"pixar style\",\n\"howManySentences\":\"between 10 and 16\",\n\"concept1Sentece\": \"why it sucks to be: \",\n\"concept1Paragraph\": \"The tone should balance emotional storytelling with a touch of dark humor and irony, while remaining respectful, family-friendly, and legally safe when referencing fictional characters., highlighting why this character‚Äôs life was unexpectedly difficult or unfair despite their fame, powers, or heroic status. Focus on emotional burdens, social pressure, identity struggles, misunderstood intentions, or ironic outcomes. Use vivid, imaginative language to evoke visuals and feelings without sounding too cinematic. Keep the story grounded, relatable, and with a hint of satire or social commentary. Avoid quoting or copying exact phrases or events from copyrighted material ‚Äî use generalized references instead.\",\n\"narratorStyle\":\"Each sentence must describe a moment or scene that shows how difficult, frustrating, or unexpectedly ironic their life was. The tone should be emotional, grounded, and filled with human tension ‚Äî but with modern, relatable humor and a clear sense that this is a parody. If the character is fictional or from pop culture, describe their challenges in a generalized and transformative way that avoids direct or copyrighted references, while still making their identity recognizable.\",\n\"Youtube\": \"________________________________________________________\",\n\"channel\":\"GOD\",\n\"TitleConcept\": \"Why it sucks to be [Character], [something that generates curiosity]\",\n\"thumbnailPromptConcept\": \"A Pixar style image with a clean white background. At the center is a handcrafted clay figure of [Character], sculpted with expressive facial features and exaggerated emotional details. Above the character, the title ‚ÄúWHY IT SUCKED TO BE [Character Name]‚Äù is written in extra large, colorful clay letters‚Äîeach word in a different vibrant color (red, yellow, blue, green, orange, purple). The letters should be bold, oversized, and clearly legible even at small thumbnail size, taking up a significant portion of the top half of the image. The font is playful and eye-catching, with a handcrafted texture. The overall image should look like a still frame from a high-end pixar movie, with dramatic composition and soft shadows for realism, but always keeping a handcrafted plasticine aesthetic.\",\n\"last\":\"last\"\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -280,
          -60
        ],
        "id": "85503ba3-f1cc-4be0-83f2-7369a5ba6de9",
        "name": "Edit Fields4"
      },
      {
        "parameters": {
          "jsCode": "const input = $('Google Sheets15').first().json.YoutubeThumbnail; // Aseg√∫rate que el nodo anterior tenga la propiedad \"text\" con todo el contenido\n\n// Dividir por l√≠neas y filtrar l√≠neas vac√≠as\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Eliminar el n√∫mero inicial de cada l√≠nea y devolver cada frase como un item separado\nreturn lines.map(line => {\n  return {\n    json: {\n      sentence: line.replace(/^\\d+\\.\\s*/, \"\").trim()\n    }\n  };\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5200,
          420
        ],
        "id": "53d7cb30-5b21-4b7f-be45-dd8d015f0a28",
        "name": "Code34"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "landscapeFormat",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "makeImageRender",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          920,
          1260
        ],
        "id": "d00942af-a722-47d6-abb2-3a79eac02aa1",
        "name": "Google Sheets17",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1120,
          1420
        ],
        "id": "6d0d19df-04a7-49a3-95f5-84909d98a609",
        "name": "If8"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1080,
          1900
        ],
        "id": "879cc95e-b599-4bff-abe0-4260a6915e77",
        "name": "If9"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "={{ $json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoVStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "portraitFormat",
                "lookupValue": "true"
              },
              {
                "lookupColumn": "makeImageRender",
                "lookupValue": "true"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          900,
          1740
        ],
        "id": "b3d99d62-a79f-4885-957b-c438ff8fba0d",
        "name": "Google Sheets18",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          4320,
          280
        ],
        "id": "9dd3e531-bb09-42f0-8c1e-b57244543bd5",
        "name": "If11"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          4460,
          480
        ],
        "id": "686da315-78ed-4057-b5be-7cf23500fd0d",
        "name": "Loop Over Items6"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentLink }}",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items6').item.json.row_number }}",
              "thumbnailStatus": "done"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "shotDescStatus",
                "displayName": "shotDescStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "thumbnailStatus",
                "displayName": "thumbnailStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "shotDescription",
                "displayName": "shotDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "landscapeFormat",
                "displayName": "landscapeFormat",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "portraitFormat",
                "displayName": "portraitFormat",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageGeneration",
                "displayName": "imageGeneration",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoGeneration",
                "displayName": "videoGeneration",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorGeneration",
                "displayName": "narratorGeneration",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "makeImageRender",
                "displayName": "makeImageRender",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "makeVideoRender",
                "displayName": "makeVideoRender",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "addSubtitles",
                "displayName": "addSubtitles",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "addMusic",
                "displayName": "addMusic",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "channel",
                "displayName": "channel",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          4700,
          540
        ],
        "id": "1df72ac1-bf69-49af-9913-824b873f1a41",
        "name": "Google Sheets19",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "content": "## Religion\n\n",
          "height": 220,
          "width": 340
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -360,
          -120
        ],
        "id": "49ef3226-a55b-4062-a22e-b7c3a3f60f21",
        "name": "Sticky Note8"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n  \"Paramenters\": \"________________________________________________________\",\n  \"landscapeFormat\": true,\n  \"portraitFormat\": true,\n  \"imageGeneration\": true,\n  \"videoGeneration\": true,\n  \"narratorGeneration\": true,\n  \"makeImageRender\": false,\n  \"makeVideoRender\": true,\n  \"addSubtitles\": true,\n  \"addMusic\": true,\n  \"documentConfiguration\": \"________________________________________________________\",\n  \"documentLink\": \"https://docs.google.com/spreadsheets/d/TOKEN_REMOVED_gq5Bf7zgNyo\",\n  \"Sheet\": \"Sheet1\",\n  \"videoContent\": \"This documentary-style video explores strange connections between the Bible and popular conspiracy theories. Each segment presents a theory (e.g. Nephilim, Anunnaki, ancient technology), backed by a relevant Bible verse and an interpretation that encourages viewers to reflect. The tone is serious, respectful, and mysterious ‚Äî aiming to raise questions rather than provide definitive answers.\",\n  \"artStyle\": \"Masterpiece Hyperrealistic\",\n  \"howManySentences\": \"between 14 and 16\",\n  \"concept1Sentece\": \"Biblical Conspiracy: \",\n  \"concept1Paragraph\": \"This concept explores controversial and mysterious theories that some believe are hidden within the Bible ‚Äî such as ancient giants, alien contact, forbidden knowledge, and divine technology. Each theory is supported with at least one Bible verse and presented with a calm, investigative tone. The goal is not to sensationalize, but to present thought-provoking ideas using scripture, historical mystery, and symbolic visuals. The style should feel like a high-quality, serious docuseries.\",\n  \"narratorStyle\": \"The narrator should sound like a thoughtful documentary host. Each sentence should either introduce a theory, present a Bible verse (with chapter and book), or explain an interpretation. Maintain a calm, intelligent, and investigative tone. Avoid hype or dramatic language ‚Äî let the mystery and scripture speak for themselves.\",\n  \"Youtube\": \"________________________________________________________\",\n  \"channel\": \"GOD\",\n  \"TitleConcept\": \"Biblical Conspiracies: [Theory] ‚Äì What the Scriptures May Be Hiding\",\n  \"thumbnailPromptConcept\": \"A dramatic documentary thumbnail. An old Bible lies open on a stone table, lit by candlelight. Next to it, a mysterious glowing artifact (e.g., orb, compass). Above: 'BIBLICAL CONSPIRACIES' in large gold serif letters. Below: '[THEORY NAME]' subtitle. The background is dark and atmospheric with soft fog or mystical particles. The style should feel like a Netflix documentary.\",\n  \"last\": \"last\"\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -280,
          140
        ],
        "id": "ba94dfdd-2097-4b39-853b-2d83fca7f909",
        "name": "Edit Fields7"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n  \"Paramenters\": \"________________________________________________________\",\n  \"landscapeFormat\": true,\n  \"portraitFormat\": true,\n  \"imageGeneration\": true,\n  \"videoGeneration\": true,\n  \"narratorGeneration\": true,\n  \"makeImageRender\": false,\n  \"makeVideoRender\": true,\n  \"addSubtitles\": true,\n  \"addMusic\": true,\n  \"documentConfiguration\": \"________________________________________________________\",\n  \"documentLink\": \"https://docs.google.com/spreadsheets/d/TOKEN_REMOVED-Bo\",\n  \"Sheet\": \"Sheet1\",\n  \"videoContent\": \"an epic battle between two powerful characters from different universes. The video breaks down their abilities, personality, and fighting styles. The story unfolds like a turn-based battle: one attacks, the other counters. Each move escalates the tension until a dramatic conclusion is reached. The narration guides the viewer through key strategic moments, emotional beats, and surprising tactics ‚Äî ending with a definitive winner and why they would triumph in this scenario.\",\n  \"artStyle\": \"Pixar style\",\n  \"howManySentences\": \"between 10 and 16\",\n  \"concept1Sentece\": \"epic 1v1 battles between 2 famous characters\",\n  \"concept1Paragraph\": \"This concept explores epic 1v1 battles between iconic characters from different universes. The tone is exciting and cinematic but keeps a clever and family-friendly approach. The script should flow like a narrated storybook fight ‚Äî describing each fighter's tactics, highlighting dramatic turning points, and keeping the audience on edge. The narration should be clear and imaginative, using action-driven language, building up each round of the fight, and finishing with a definitive victory and rationale.\",\n  \"narratorStyle\": \"The narrator should sound like a dramatic sports or anime commentator ‚Äî emotionally invested but composed. Each sentence describes either a key moment in the battle, an ability being used, or a strategic move. Start with introductions, then alternate attack rounds, building to the climax. The final lines must declare a winner and explain why, in a way that feels earned and satisfying.\",\n  \"Youtube\": \"________________________________________________________\",\n  \"channel\": \"LemonSushi\",\n  \"TitleConcept\": \"Who Would Win: [Character A] vs [Character B] ‚Äì Ultimate Battle Breakdown\",\n  \"thumbnailPromptConcept\": \"A Pixar style face-off image. On a clean white background, two handcrafted clay figures stand in dramatic battle poses facing each other ‚Äî [Character A] on the left and [Character B] on the right. Both characters should have exaggerated expressions and stylized battle stances. Between them, the text 'WHO WOULD WIN?' appears in bold, colorful clay letters (red, blue, yellow), big and clear for thumbnails. The visual should capture tension, color, and playful intensity ‚Äî like a scene from a high-end Pixar movie, with soft shadows and rich detail, but staying in handcrafted claymation style.\",\n  \"last\": \"last\"\n}\n",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -280,
          320
        ],
        "id": "5d3e3288-6b03-4961-a01f-fe8409c3b6be",
        "name": "Edit Fields8"
      },
      {
        "parameters": {
          "content": "## Video",
          "height": 80,
          "width": 360
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          720,
          1920
        ],
        "id": "84e4ef19-0787-41b6-8daa-8ee951df65e6",
        "name": "Sticky Note11"
      },
      {
        "parameters": {
          "content": "## Video",
          "height": 80,
          "width": 360
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          740,
          1440
        ],
        "id": "613e539d-2c8d-435e-800e-ab2e1ea05d4f",
        "name": "Sticky Note12"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n\"Paramenters\": \"________________________________________________________\",\n\"landscapeFormat\":true,\n\"portraitFormat\":false,\n\"imageGeneration\":true,\n\"videoGeneration\":true,\n\"narratorGeneration\":false,\n\"makeImageRender\":false,\n\"makeVideoRender\":true,\n\"addSubtitles\":false,\n\"addMusic\":false,\n\"documentConfiguration\": \"________________________________________________________\",\n\"documentLink\":\"https://docs.google.com/spreadsheets/d/1y_TOKEN_REMOVED-GDDf21co\",\n\"Sheet\": \"Sheet1\",\n\"videoContent\": \"________________________________________________________\",\n\"artStyle\":\"Pixar style\",\n\"howManySentences\":\"between 18 and 24\",\n\"concept1Sentece\": \"My First Day in: \",\n\"concept1Paragraph\": \"Create a heartwarming and imaginative children's story, similar in tone and spirit to an episode of Anpanman, designed for preschoolers. The story should take place in a colorful, fully described 3D world ‚Äî like a Pixar-style animated setting ‚Äî with vivid details about each location, from lush hills to cozy bakeries or magical forests. Introduce charming, friendly characters with simple but memorable traits (e.g., a bread-headed hero, a shy strawberry fairy, a grumpy pickled radish monster), and describe their appearances clearly ‚Äî including colors, facial features, and any special accessories they carry. Focus on a small, relatable problem (like a lost item, bad weather, or a friend feeling left out) and build a gentle, uplifting adventure around it. Use playful language, positive emotions, and simple dialogue. Avoid violence, sarcasm, or dark themes. The story should end with a cheerful resolution, reinforcing values like friendship, kindness, sharing, and perseverance. Keep everything visually rich, emotionally soft, and appropriate for toddlers and very young children.\",\n\"narratorStyle\":\"The narrator should use a warm, gentle, and expressive tone that feels like a caring adult talking directly to a child. The voice should be calm, clear, and slightly playful, with an encouraging and emotionally supportive attitude. Use simple words, short sentences, and joyful intonations that help small children (ages 2‚Äì5) follow along easily. When characters speak, subtly shift the voice to match their personalities ‚Äî for example, a shy character might speak softly, while a cheerful one might have a bouncy rhythm. The narrator should sound kind, curious, and full of wonder, like they‚Äôre inviting the listener into a magical world. Avoid sarcasm, complex metaphors, or overly dramatic tones. The goal is to make every child feel safe, included, and excited to hear what happens next.\",\n\"Youtube\": \"________________________________________________________\",\n\"channel\":\"Kids Song Test\",\n\"TitleConcept\": \"My First Day in [Location], [something that generates curiosity]\",\n\"thumbnailPromptConcept\": \"A vibrant, Pixar-style 3D image filled with bright, saturated colors and playful details. At the center is the main character ‚Äî a cute, rounded, toy-like animal or mascot (like a bear, bunny, or tiger), designed for preschool audiences ‚Äî standing with a joyful or surprised expression, ready to explore. The background is a colorful, stylized version of {location}, filled with recognizable elements (e.g. cherry blossoms for a park, sushi stands for a market, books and crayons for a preschool), but simplified and toy-like. Everything should feel soft, shiny, and full of warmth ‚Äî like a high-quality clay or plastic toy set. The title ‚ÄúMI PRIMER D√çA EN {LOCACI√ìN}‚Äù appears in big, bold, rainbow-colored bubble letters near the top or bottom of the frame, with each word in a different bright color. The font should be playful, 3D, and easy to read at small sizes. The overall thumbnail should feel like a still from a magical Pixar short for toddlers ‚Äî dynamic, colorful, and packed with visual excitement to immediately capture a 2‚Äì5-year-old‚Äôs attention.\",\n\"last\":\"last\"\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -320,
          -840
        ],
        "id": "725f43ce-e6fd-40b6-8bdf-3c38df21b24e",
        "name": "Edit Fields9"
      }
    ],
    "connections": {
      "Google Sheets14": {
        "main": [
          [
            {
              "node": "Code30",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code30": {
        "main": [
          [
            {
              "node": "Add header",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add header": {
        "main": [
          [
            {
              "node": "Narrator Script",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "Narrator Script",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "Narrator Script",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code33": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items5": {
        "main": [
          [
            {
              "node": "Limit5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Image Prompt Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets16": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram31": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit5": {
        "main": [
          [
            {
              "node": "Google Sheets13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory5": {
        "ai_memory": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Titles and Description": {
        "main": [
          [
            {
              "node": "Edit Fields5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields5": {
        "main": [
          [
            {
              "node": "Google Sheets14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model10": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory7": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Google Sheets16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items1": {
        "main": [
          [
            {
              "node": "Limit2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP3": {
        "main": [
          [
            {
              "node": "Google Sheets5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets5": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit2": {
        "main": [
          [
            {
              "node": "Telegram21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk3": {
        "main": [
          [
            {
              "node": "Execute Command14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command14": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk4": {
        "main": [
          [
            {
              "node": "FTP3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          [
            {
              "node": "Google Sheets6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit1": {
        "main": [
          [
            {
              "node": "Google Sheets15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets1": {
        "main": [
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "ComfyUI1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets6": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram21": {
        "main": [
          [
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram14": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code28": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "Execute Command7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command7": {
        "main": [
          [
            {
              "node": "Execute Command8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command8": {
        "main": [
          [
            {
              "node": "Execute Command9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command9": {
        "main": [
          [
            {
              "node": "Execute Command10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command10": {
        "main": [
          [
            {
              "node": "Execute Command5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command11": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets2": {
        "main": [
          [
            {
              "node": "If8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Code28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Idea Prompt Agent1": {
        "main": [
          [
            {
              "node": "Edit Fields6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "Google Sheets1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Wait5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait3": {
        "main": [
          [
            {
              "node": "Google Sheets11",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets18",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets17",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram15": {
        "main": [
          [
            {
              "node": "Execute Command12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command12": {
        "main": [
          [
            {
              "node": "Telegram16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets3": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items2": {
        "main": [
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Google Sheets7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Code13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code13": {
        "main": [
          [
            {
              "node": "ComfyUI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit": {
        "main": [
          [
            {
              "node": "Google Sheets3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram16": {
        "main": [
          [
            {
              "node": "Telegram19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram19": {
        "main": [
          [
            {
              "node": "Telegram20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram20": {
        "main": [
          [
            {
              "node": "Telegram23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets11": {
        "main": [
          [
            {
              "node": "If9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If10": {
        "main": [
          [
            {
              "node": "Code11",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Schedule Trigger": {
        "main": [
          []
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Edit Fields9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit3": {
        "main": [
          [
            {
              "node": "Google Sheets8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets8": {
        "main": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram23": {
        "main": [
          []
        ]
      },
      "Edit Fields2": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "idea": {
        "main": [
          [
            {
              "node": "Limit3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields6": {
        "main": [
          [
            {
              "node": "Titles and Description",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Narrator Script": {
        "main": [
          [
            {
              "node": "Code33",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command5": {
        "main": [
          [
            {
              "node": "Code10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code10": {
        "main": [
          [
            {
              "node": "Execute Command11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait4": {
        "main": [
          [
            {
              "node": "idea1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code29": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code11": {
        "main": [
          [
            {
              "node": "Execute Command13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command13": {
        "main": [
          [
            {
              "node": "Execute Command15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command15": {
        "main": [
          [
            {
              "node": "Execute Command16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command16": {
        "main": [
          [
            {
              "node": "Execute Command17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command17": {
        "main": [
          [
            {
              "node": "Execute Command6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command18": {
        "main": [
          [
            {
              "node": "Execute Command1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk": {
        "main": [
          [
            {
              "node": "FTP8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP8": {
        "main": [
          [
            {
              "node": "Telegram17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command1": {
        "main": [
          [
            {
              "node": "Code29",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram17": {
        "main": [
          [
            {
              "node": "Execute Command19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command6": {
        "main": [
          [
            {
              "node": "Code14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code14": {
        "main": [
          [
            {
              "node": "Execute Command18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets4": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items3": {
        "main": [
          [
            {
              "node": "Limit6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP4": {
        "main": [
          [
            {
              "node": "Google Sheets9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code15": {
        "main": [
          [
            {
              "node": "Code16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram18": {
        "main": [
          [
            {
              "node": "Code17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code16": {
        "main": [
          [
            {
              "node": "Execute Command2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets9": {
        "main": [
          [
            {
              "node": "Loop Over Items3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait5": {
        "main": [
          [
            {
              "node": "Google Sheets4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Loop Over Items3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit6": {
        "main": [
          [
            {
              "node": "Google Sheets10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command2": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk1": {
        "main": [
          [
            {
              "node": "ComfyUI Image to Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets10": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items4": {
        "main": [
          [
            {
              "node": "Limit7",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP5": {
        "main": [
          [
            {
              "node": "Google Sheets12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code18": {
        "main": [
          [
            {
              "node": "Code19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code19": {
        "main": [
          [
            {
              "node": "Execute Command3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets12": {
        "main": [
          [
            {
              "node": "Loop Over Items4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Loop Over Items4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command3": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk5": {
        "main": [
          [
            {
              "node": "ComfyUI Image to Video1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit7": {
        "main": [
          [
            {
              "node": "Telegram18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI Image to Video": {
        "main": [
          [
            {
              "node": "FTP4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI Image to Video1": {
        "main": [
          [
            {
              "node": "FTP5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code31": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code20": {
        "main": [
          [
            {
              "node": "Execute Command21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command21": {
        "main": [
          [
            {
              "node": "Execute Command22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command22": {
        "main": [
          [
            {
              "node": "Execute Command23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command23": {
        "main": [
          [
            {
              "node": "Execute Command24",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command24": {
        "main": [
          [
            {
              "node": "Execute Command27",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command25": {
        "main": [
          [
            {
              "node": "Execute Command4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk6": {
        "main": [
          [
            {
              "node": "FTP9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP9": {
        "main": [
          [
            {
              "node": "Telegram22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command26": {
        "main": [
          [
            {
              "node": "Telegram24",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command4": {
        "main": [
          [
            {
              "node": "Code31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram22": {
        "main": [
          [
            {
              "node": "Execute Command26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram24": {
        "main": [
          [
            {
              "node": "Telegram25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram25": {
        "main": [
          [
            {
              "node": "Telegram26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram26": {
        "main": [
          [
            {
              "node": "Telegram27",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram27": {
        "main": [
          []
        ]
      },
      "ComfyUI3": {
        "main": [
          [
            {
              "node": "FTP6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP6": {
        "main": [
          [
            {
              "node": "Telegram1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code21": {
        "main": [
          [
            {
              "node": "Code34",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command27": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code22": {
        "main": [
          [
            {
              "node": "Execute Command25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code17": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code32": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code23": {
        "main": [
          [
            {
              "node": "Execute Command28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command28": {
        "main": [
          [
            {
              "node": "Execute Command29",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command29": {
        "main": [
          [
            {
              "node": "Execute Command30",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command30": {
        "main": [
          [
            {
              "node": "Execute Command31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command31": {
        "main": [
          [
            {
              "node": "Execute Command35",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command32": {
        "main": [
          [
            {
              "node": "Execute Command34",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk7": {
        "main": [
          [
            {
              "node": "FTP10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP10": {
        "main": [
          [
            {
              "node": "Telegram28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command33": {
        "main": [
          []
        ]
      },
      "Execute Command34": {
        "main": [
          [
            {
              "node": "Code32",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram28": {
        "main": [
          [
            {
              "node": "Execute Command33",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command35": {
        "main": [
          [
            {
              "node": "Code25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code25": {
        "main": [
          [
            {
              "node": "Execute Command32",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields3": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "idea1": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Code24",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "idea",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets13": {
        "main": [
          [
            {
              "node": "Telegram31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model11": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Supervisor",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Supervisor",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent1": {
        "main": [
          [
            {
              "node": "Image Prompt Supervisor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Supervisor": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code24": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets15": {
        "main": [
          [
            {
              "node": "If11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields4": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram1": {
        "main": [
          [
            {
              "node": "Telegram14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code34": {
        "main": [
          [
            {
              "node": "ComfyUI3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets17": {
        "main": [
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If8": {
        "main": [
          [
            {
              "node": "Code20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets18": {
        "main": [
          [
            {
              "node": "If10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If9": {
        "main": [
          [
            {
              "node": "Code23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If11": {
        "main": [
          [
            {
              "node": "Loop Over Items6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Telegram14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items6": {
        "main": [
          [
            {
              "node": "Code21",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Google Sheets19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets19": {
        "main": [
          [
            {
              "node": "Loop Over Items6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields7": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields8": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields9": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      },
      "node:Schedule Trigger1": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "f72ae1c4-c6ac-4cf1-835a-42bdf6cf525c",
    "activeVersionId": null,
    "triggerCount": 2,
    "shared": [
      {
        "updatedAt": "2025-05-22T23:14:12.345Z",
        "createdAt": "2025-05-22T23:14:12.345Z",
        "role": "workflow:owner",
        "workflowId": "NiRdJVFkPfBtgEd0",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-05-08T05:50:53.000Z",
    "createdAt": "2025-04-07T05:54:02.780Z",
    "id": "PELMHRJSTnu65RoI",
    "name": "investmentAuto",
    "active": true,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 22
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          0,
          0
        ],
        "id": "73e8174a-8ed9-428a-97dc-da8e5c65dd5b",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {
          "chatId": "6407630145",
          "text": "={{ $json.message }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          440,
          0
        ],
        "id": "111cc4bf-75eb-47a0-a3c4-1a1e5dc4c99f",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram account 2"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const data = $json[\"Time Series (Daily)\"]; // Historical data for SPY\nlet prices = [];\n\nfor (let date in data) {\n  prices.push(parseFloat(data[date][\"4. close\"])); // Extract the closing price\n}\n\n// Get the ATH (maximum price)\nconst ath = Math.max(...prices);\nconst currentPrice = prices[0]; // The most recent price is the first one\n\n// Calculate the percentage change\nconst percentChange = ((currentPrice - ath) / ath) * 100;\n\nlet message = `The SPY is `;\nif (percentChange > 0) {\n  message += `up by ${percentChange.toFixed(2)}% from its last All-Time High.`;\n} else if (percentChange < 0) {\n  message += `down by ${Math.abs(percentChange).toFixed(2)}% from its last All-Time High.`;\n} else {\n  message += `at its last All-Time High.`;\n}\n\nreturn [{ json: { message } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          300,
          0
        ],
        "id": "baa6341e-2041-4e6b-8b24-d339a3698976",
        "name": "Code2"
      },
      {
        "parameters": {
          "url": "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=SPY&outputsize=compact&apikey=KPF97T83H6VTK4OW",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          160,
          0
        ],
        "id": "829308c3-214e-4715-9e2e-99ba1de74fd3",
        "name": "HTTP Request1"
      }
    ],
    "connections": {
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          []
        ]
      }
    },
    "settings": {
      "executionOrder": "v1",
      "timezone": "Asia/Tokyo",
      "callerPolicy": "workflowsFromSameOwner"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      }
    },
    "meta": null,
    "pinData": {},
    "versionId": "c12a4479-c9e3-4918-9d7b-a31652065c9c",
    "activeVersionId": "c12a4479-c9e3-4918-9d7b-a31652065c9c",
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-04-07T05:54:02.781Z",
        "createdAt": "2025-04-07T05:54:02.781Z",
        "role": "workflow:owner",
        "workflowId": "PELMHRJSTnu65RoI",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": {
      "updatedAt": "2025-12-26T01:33:14.866Z",
      "createdAt": "2025-12-26T01:33:14.866Z",
      "versionId": "c12a4479-c9e3-4918-9d7b-a31652065c9c",
      "workflowId": "PELMHRJSTnu65RoI",
      "nodes": [
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "triggerAtHour": 22
                }
              ]
            }
          },
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.2,
          "position": [
            0,
            0
          ],
          "id": "73e8174a-8ed9-428a-97dc-da8e5c65dd5b",
          "name": "Schedule Trigger"
        },
        {
          "parameters": {
            "chatId": "6407630145",
            "text": "={{ $json.message }}",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            440,
            0
          ],
          "id": "111cc4bf-75eb-47a0-a3c4-1a1e5dc4c99f",
          "name": "Telegram",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram account 2"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const data = $json[\"Time Series (Daily)\"]; // Historical data for SPY\nlet prices = [];\n\nfor (let date in data) {\n  prices.push(parseFloat(data[date][\"4. close\"])); // Extract the closing price\n}\n\n// Get the ATH (maximum price)\nconst ath = Math.max(...prices);\nconst currentPrice = prices[0]; // The most recent price is the first one\n\n// Calculate the percentage change\nconst percentChange = ((currentPrice - ath) / ath) * 100;\n\nlet message = `The SPY is `;\nif (percentChange > 0) {\n  message += `up by ${percentChange.toFixed(2)}% from its last All-Time High.`;\n} else if (percentChange < 0) {\n  message += `down by ${Math.abs(percentChange).toFixed(2)}% from its last All-Time High.`;\n} else {\n  message += `at its last All-Time High.`;\n}\n\nreturn [{ json: { message } }];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            300,
            0
          ],
          "id": "baa6341e-2041-4e6b-8b24-d339a3698976",
          "name": "Code2"
        },
        {
          "parameters": {
            "url": "https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=SPY&outputsize=compact&apikey=KPF97T83H6VTK4OW",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            160,
            0
          ],
          "id": "829308c3-214e-4715-9e2e-99ba1de74fd3",
          "name": "HTTP Request1"
        }
      ],
      "connections": {
        "Schedule Trigger": {
          "main": [
            [
              {
                "node": "HTTP Request1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code2": {
          "main": [
            [
              {
                "node": "Telegram",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request1": {
          "main": [
            [
              {
                "node": "Code2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram": {
          "main": [
            []
          ]
        }
      },
      "authors": "system migration",
      "name": null,
      "description": null,
      "autosaved": false
    },
    "tags": []
  },
  {
    "updatedAt": "2025-11-09T13:10:21.000Z",
    "createdAt": "2025-07-04T12:42:57.890Z",
    "id": "SC0yaHxOi9wQSK1J",
    "name": "videoAi_postiz",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {
            "download": false
          }
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          0,
          0
        ],
        "id": "d324a672-516b-4426-8981-8a39705369d6",
        "name": "Telegram Trigger1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/help",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          200,
          0
        ],
        "id": "70250847-ddb3-40c5-ac49-8a92c8df34ef",
        "name": "If7"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "=this is the help for the commands that you can use Chimo. \n/script              # is going create a new idea like chatgpt\n/image your prompt   # is going to create an image like sora\n/video link          # is going to create a video with replicate\n/bake link           # is going to add music and watermark\n/publish prompt      # is going to give you a title idea with hastags\n/aato link           # adds aato music\n/combo link1 link2   # combines multiple videos\n/pvideo link prompt  # is going to create a video with prompt\nfor the pvideo you have to separate de /pvideo link and prompt with double underscore ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          420,
          -20
        ],
        "id": "f7bf9ad6-1b76-45ed-a081-7e8973a0aa10",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/google/imagen-4/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"aspect_ratio\": \"9:16\",\n    \"output_format\": \"jpg\",\n    \"safety_filter_level\": \"block_medium_and_above\"\n  }\n} \n",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          760,
          440
        ],
        "id": "f489f0fd-c66c-4153-af15-82a6bab08dd7",
        "name": "HTTP Request",
        "retryOnFail": false,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?image\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          600,
          440
        ],
        "id": "01e82a42-4e8d-4ba8-81a6-b2ed3deb1674",
        "name": "Code"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1060,
          440
        ],
        "id": "640edd5e-7024-4afd-b0af-251467a5cf5e",
        "name": "HTTP Request1",
        "retryOnFail": true,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "amount": 10
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          900,
          440
        ],
        "id": "5c327042-5ae5-421b-8213-cb7da00c2363",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/image",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          220,
          460
        ],
        "id": "055019a3-a175-453c-b426-be3f90872601",
        "name": "If"
      },
      {
        "parameters": {
          "operation": "sendPhoto",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request1').item.json.output }}",
          "additionalFields": {
            "caption": "={{ $('Code4').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1960,
          440
        ],
        "id": "76ba17b4-bd5e-4b9a-b3f3-07bbb235b68a",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your image",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          420,
          440
        ],
        "id": "d3e50ead-72c0-45e9-9ad2-9ec716af3593",
        "name": "Telegram3",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request1').item.json.output }}\" -O /tmp/generated.jpg"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1380,
          440
        ],
        "id": "745ab6a6-65d4-429f-93a3-b071a880054c",
        "name": "Execute Command2"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.jpg",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1560,
          440
        ],
        "id": "85b8c7c5-e508-442f-8d90-e421179f0e64",
        "name": "Read/Write Files from Disk1"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code4').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1760,
          440
        ],
        "id": "afb1bf00-88c8-4848-84d4-104d67aaa068",
        "name": "FTP1",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/postiz/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/postiz/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1220,
          440
        ],
        "id": "694a4af4-00f6-4f62-8741-02937a6ecd8d",
        "name": "Code4"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?video\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          580,
          660
        ],
        "id": "a9975079-8604-4d93-abf7-793be6fe3e77",
        "name": "Code2"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your video",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          420,
          660
        ],
        "id": "c51ecffe-83cf-486f-88a2-f1877fe2e2cd",
        "name": "Telegram5",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/bytedance/seedance-1-pro/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"fps\": 24,\n    \"image\": \"{{ $json.prompt }}\",\n    \"prompt\": \"\",\n    \"duration\": 5,\n    \"resolution\": \"1080p\",\n    \"aspect_ratio\": \"9:16\",\n    \"camera_fixed\": false\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          740,
          660
        ],
        "id": "0def2be4-8fa9-4409-b74f-3a6917a8da13",
        "name": "HTTP Request2",
        "retryOnFail": false,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request3').item.json.output }}",
          "additionalFields": {
            "caption": "={{ $('Code5').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1920,
          660
        ],
        "id": "802a68f6-297f-459c-a8c3-4c40d665c19c",
        "name": "Telegram6",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1040,
          660
        ],
        "id": "1a18b846-e71a-40c8-844d-973778fee7e8",
        "name": "HTTP Request3",
        "retryOnFail": true,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "amount": 3,
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          880,
          660
        ],
        "id": "d64faab5-f0b7-4fc6-b045-e2d984a10c0e",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request3').item.json.output }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1400,
          660
        ],
        "id": "c65c6ca5-f855-4498-84de-7c43c1123f92",
        "name": "Execute Command3"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1560,
          660
        ],
        "id": "d77c0bb4-ded8-4762-a774-858ee0a43911",
        "name": "Read/Write Files from Disk2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code5').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1740,
          660
        ],
        "id": "e0fc3801-7958-42f9-814c-34abff1159b3",
        "name": "FTP",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/postiz/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/postiz/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1220,
          660
        ],
        "id": "18cfe2eb-e27a-49a6-8abd-0ac69a4b560e",
        "name": "Code5"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/video",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          220,
          680
        ],
        "id": "bc122a5d-8511-4320-8149-08ea4aa72234",
        "name": "If2"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If3').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?audio\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If3').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          580,
          880
        ],
        "id": "3edcd264-615e-4004-9b00-b9fe589632b9",
        "name": "Code3"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your audio ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          420,
          880
        ],
        "id": "2b6215f1-3844-418b-9b09-cf18b1958b7a",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"version\": \"zsxkib/mmaudio:TOKEN_REMOVED\",\n  \"input\": {\n    \"seed\": -1,\n    \"video\": \"{{ $json.prompt }}\",\n    \"prompt\": \"\",\n    \"duration\": 11,\n    \"num_steps\": 25,\n    \"cfg_strength\": 4.5,\n    \"negative_prompt\": \"music\"\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          740,
          880
        ],
        "id": "265f85c1-2558-43dc-8d03-edc9c6b959d7",
        "name": "HTTP Request4",
        "retryOnFail": false,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request5').item.json.output }}",
          "additionalFields": {
            "caption": "={{ $('Code6').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1920,
          880
        ],
        "id": "e4cf8dd6-4d15-4653-a9d5-a486e7ff6eea",
        "name": "Telegram7",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1040,
          880
        ],
        "id": "bae84e76-2dae-44df-9946-f39fdff9f70b",
        "name": "HTTP Request5",
        "retryOnFail": true,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "amount": 1,
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          880,
          880
        ],
        "id": "37f6d50b-4edd-4e97-a8ff-c99d16dd83fa",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request5').item.json.output }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1400,
          880
        ],
        "id": "ff9a9f8a-c4d9-4dc9-9000-a65b5eff2dac",
        "name": "Execute Command"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1560,
          880
        ],
        "id": "0134f975-9759-470a-8954-f5e4d36627df",
        "name": "Read/Write Files from Disk"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code6').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1740,
          880
        ],
        "id": "8bb57203-1a08-4497-9715-e38d78d782f0",
        "name": "FTP2",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/postiz/videosA/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/postiz/videosA/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1220,
          880
        ],
        "id": "6e1e449c-5a6f-4161-a1c4-abd35a56626b",
        "name": "Code6"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/audio",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          220,
          900
        ],
        "id": "f19375dc-57d9-48e3-9237-09ebc1dd9f72",
        "name": "If3"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/title",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          240,
          240
        ],
        "id": "29fe3d28-a7c1-4161-b448-f2a5fe5dbaaa",
        "name": "If4"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your title",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          440,
          220
        ],
        "id": "71a09e5b-e82d-4c7d-a01e-4897e025776f",
        "name": "Telegram9",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If4').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?title\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          640,
          220
        ],
        "id": "08b9fbb9-13b7-4ad5-966d-7a67f39c86f7",
        "name": "Code8"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\nimage prompt: \n{{ $json.prompt }}\n\n\nYou are a professional YouTube creator. Based on the previous image prompt, generate:\n\nA YouTube Title, highquality youtube title that include some hashtags and information to improve the seo of the video keep it short.\n\nA YouTube Description that describes the video as simple as possible. It should use storytelling language, include SEO-rich keywords, and connect with both faith-based viewers and audiences who enjoy ironic or educational content. Include relevant hashtags to boost visibility.\n\nA single paragraph of tags, written as a comma-separated list, using keywords related to the the video and or YouTube series, and any other that could help.\n\nYour output must be exactly 3 paragraphs, one for each item above. Do not include titles, labels, numbers, or formatting. Each paragraph must be written in a way that is ready to paste directly into the YouTube upload page.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n\nFormat the output in 3 paragraphs",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.8,
        "position": [
          820,
          220
        ],
        "id": "09f7bfd5-c78b-4a2d-9f76-f2ce63ce427a",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          760,
          320
        ],
        "id": "cb95f14b-36d6-49de-952d-64fedf935584",
        "name": "DeepSeek Chat Model1",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1080,
          320
        ],
        "id": "e4d6f00f-6587-4246-aa63-2a9e93d598a9",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "={{ $json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1220,
          220
        ],
        "id": "77797113-fdc0-4213-bd21-1d92ca0935a0",
        "name": "Telegram4",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAi_postiz_telegram"
          }
        }
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.identifier }}",
                      "rightValue": "tiktok",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "3ff74ffe-3f82-437d-9218-bce4f7551211"
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "SENSITIVE_DATA_REMOVED"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "2edc7f5f-18cf-45e2-9a10-03c6ee2a062f",
                      "leftValue": "={{ $json.identifier }}",
                      "rightValue": "youtube",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "SENSITIVE_DATA_REMOVED"
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "id": "f461c331-7506-486b-ab4a-de03823f82f9",
                      "leftValue": "={{ $json.identifier }}",
                      "rightValue": "instagram",
                      "operator": {
                        "type": "string",
                        "operation": "contains"
                      }
                    }
                  ],
                  "combinator": "and"
                },
                "renameOutput": true,
                "outputKey": "SENSITIVE_DATA_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          1480,
          1360
        ],
        "id": "84bb765d-fdee-449b-82ff-26208e53d3dd",
        "name": "Switch",
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "0f5772c0-1f84-45e9-b131-8be1c8dd6d85",
                "name": "postiz_api",
                "value": "YOUR_POSTIZ_URL/api/public/v1",
                "type": "string"
              },
              {
                "id": "781d5f1b-1724-4cd4-9e0d-916de65b43e5",
                "name": "share_video_url",
                "value": "https://cdn.pixabay.com/video/2023/08/31/178472-859955927_small.mp4?download",
                "type": "string"
              },
              {
                "id": "f3d9536a-3dc9-4673-b774-0434ca64575f",
                "name": "share_title",
                "value": "Summer is coming",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          480,
          1240
        ],
        "id": "36a00c06-493a-4280-8966-052608b1fdb1",
        "name": "Configure me",
        "disabled": true
      },
      {
        "parameters": {
          "url": "={{ $json.share_video_url }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          860,
          1360
        ],
        "id": "434431ee-c821-4763-8514-936f086a19bf",
        "name": "Download video",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $('Configure me').item.json.postiz_api }}/upload",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendBody": true,
          "contentType": "multipart-form-data",
          "bodyParameters": {
            "parameters": [
              {
                "parameterType": "formBinaryData",
                "name": "file",
                "inputDataFieldName": "data"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1080,
          1360
        ],
        "id": "32a7e5d8-c35a-4c39-865b-b9c3379c7c25",
        "name": "Upload video to Postiz",
        "disabled": true
      },
      {
        "parameters": {
          "url": "={{ $('Configure me').item.json.postiz_api }}/integrations",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1280,
          1360
        ],
        "id": "88bc792b-1109-4a10-9713-248d4b491c26",
        "name": "Get Postiz integrations",
        "disabled": true
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "6edb3f17-3d22-408b-a935-5e9f59fa6cc5",
                "leftValue": "",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1720,
          1360
        ],
        "id": "ac0c5905-9760-4e4d-a1ff-c1eb5cff1726",
        "name": "YouTube check",
        "disabled": true
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "6edb3f17-3d22-408b-a935-5e9f59fa6cc5",
                "leftValue": "",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1720,
          1100
        ],
        "id": "620e4bbc-1efc-48c6-a4ca-13727497bcd5",
        "name": "TikTok check",
        "disabled": true
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "6edb3f17-3d22-408b-a935-5e9f59fa6cc5",
                "leftValue": "",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1720,
          1600
        ],
        "id": "6c4596ec-c702-4e27-9757-5efc28f2b8c4",
        "name": "Instagram check",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $('Configure me').item.json.postiz_api }}/posts",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"type\": \"schedule\",\n  \"date\": \"{{ $now.plus(1, 'days').toISO() }}\",\n  \"tags\": [],\n  \"shortLink\": false,\n  \"posts\": [\n    {\n      \"integration\": {\n        \"id\": \"{{ $('Switch').item.json.id }}\"\n      },\n      \"value\": [\n        {\n          \"content\": \"{{ $('Configure me').item.json.share_title }}\",\n          \"image\": [\n            {\n              \"id\": \"{{ $('Upload video to Postiz').item.json.id }}\",\n              \"path\": \"{{ $('Upload video to Postiz').item.json.path }}\"\n            }\n          ]\n        }\n      ],\n      \"settings\": {\n        \"title\": \"{{ $('Configure me').item.json.share_title }}\"\n      }\n    }\n  ]\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          2120,
          1340
        ],
        "id": "c096c695-8dce-4471-97cc-02024b40ec82",
        "name": "HTTP Request6",
        "disabled": true
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/publish",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          200,
          1200
        ],
        "id": "fa0a5876-4081-47e2-9cbb-1d1e9ff5b8e7",
        "name": "If5"
      }
    ],
    "connections": {
      "Telegram Trigger1": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Telegram3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram3": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command2": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Execute Command2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram5": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request3": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command3": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Telegram6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Execute Command3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Telegram5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "HTTP Request4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request4": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request5": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "HTTP Request5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk": {
        "main": [
          [
            {
              "node": "FTP2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP2": {
        "main": [
          [
            {
              "node": "Telegram7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Telegram9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram9": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Telegram4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "TikTok check",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "YouTube check",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Instagram check",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Configure me": {
        "main": [
          [
            {
              "node": "Download video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download video": {
        "main": [
          [
            {
              "node": "Upload video to Postiz",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload video to Postiz": {
        "main": [
          [
            {
              "node": "Get Postiz integrations",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Postiz integrations": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "YouTube check": {
        "main": [
          [
            {
              "node": "HTTP Request6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If5": {
        "main": [
          [
            {
              "node": "Configure me",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": null,
    "pinData": {},
    "versionId": "75fc1322-99dc-4b6c-827a-a8af6559ac8d",
    "activeVersionId": null,
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-07-04T12:42:57.896Z",
        "createdAt": "2025-07-04T12:42:57.896Z",
        "role": "workflow:owner",
        "workflowId": "SC0yaHxOi9wQSK1J",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-12-26T02:34:38.960Z",
    "createdAt": "2025-12-26T01:37:52.525Z",
    "id": "TNdsatk1NU1sicH8",
    "name": "Github Backup",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "0 0 * * *"
              }
            ]
          }
        },
        "id": "5d7f4c3a-3c6c-4246-afa2-5c2c746428d0",
        "name": "Cada media noche",
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          2064,
          256
        ]
      },
      {
        "parameters": {
          "filters": {},
          "requestOptions": {}
        },
        "id": "1837d319-ca18-46a3-a828-89dceb065b46",
        "name": "Obtener todos los flujos",
        "type": "n8n-nodes-base.n8n",
        "typeVersion": 1,
        "position": [
          2272,
          256
        ],
        "credentials": {
          "n8nApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "n8n account"
          }
        }
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "destinationFieldName": "datos_json",
          "options": {}
        },
        "id": "97cf8330-72b6-4186-afb0-07cba09c4778",
        "name": "Agrupar Flujos",
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          2496,
          256
        ]
      },
      {
        "parameters": {
          "jsCode": "// Obtener todos los flujos agregados\nconst workflows = $input.first().json.datos_json;\n\n// Convertir a JSON string con formato\nconst jsonContent = JSON.stringify(workflows, null, 2);\n\n// Codificar en Base64 para GitHub\nconst base64Content = Buffer.from(jsonContent).toString('base64');\n\nreturn [{\n  json: {\n    content: base64Content\n  }\n}];"
        },
        "id": "05ba56a2-8096-421f-9a50-164426b9c932",
        "name": "Convertir a Base64",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2720,
          256
        ]
      },
      {
        "parameters": {
          "resource": "file",
          "operation": "edit",
          "owner": "pumacamargo",
          "repository": "n8n-backup",
          "filePath": "respaldo_n8n.json",
          "fileContent": "={{ $json.content }}",
          "commitMessage": "Backup automatico"
        },
        "id": "a3557d06-5340-43c1-9584-a35f1a021b47",
        "name": "Subir a GitHub",
        "type": "n8n-nodes-base.github",
        "typeVersion": 1,
        "position": [
          2928,
          256
        ],
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "githubApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "GitHub account"
          }
        }
      }
    ],
    "connections": {
      "Cada media noche": {
        "main": [
          [
            {
              "node": "Obtener todos los flujos",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Obtener todos los flujos": {
        "main": [
          [
            {
              "node": "Agrupar Flujos",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Agrupar Flujos": {
        "main": [
          [
            {
              "node": "Convertir a Base64",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convertir a Base64": {
        "main": [
          [
            {
              "node": "Subir a GitHub",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1",
      "availableInMCP": false
    },
    "staticData": null,
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "3b9bb076-c91a-4879-8c71-b792b34fe647",
    "activeVersionId": null,
    "triggerCount": 0,
    "shared": [
      {
        "updatedAt": "2025-12-26T01:37:52.528Z",
        "createdAt": "2025-12-26T01:37:52.528Z",
        "role": "workflow:owner",
        "workflowId": "TNdsatk1NU1sicH8",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-12-24T09:03:27.000Z",
    "createdAt": "2025-12-17T01:40:03.503Z",
    "id": "TPZsi4pU0KrvgHA2",
    "name": "Theta Sentinel AI - An√°lisis Diario",
    "active": true,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "url": "https://query1.finance.yahoo.com/v8/finance/chart/QS",
          "options": {}
        },
        "id": "6b46bfc9-b011-4b46-9a11-ba095ccdb076",
        "name": "üìà Get QS Price",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.1,
        "position": [
          80,
          160
        ]
      },
      {
        "parameters": {
          "url": "https://query1.finance.yahoo.com/v8/finance/chart/F",
          "options": {}
        },
        "id": "642c78ee-7a79-47bc-8987-769232f258ad",
        "name": "üöó Get F Price",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.1,
        "position": [
          80,
          336
        ]
      },
      {
        "parameters": {
          "url": "https://query1.finance.yahoo.com/v8/finance/chart/^VIX",
          "options": {}
        },
        "id": "55d769fe-b1b5-44e1-821e-68bb3b4e5fd0",
        "name": "üìä Get VIX Data",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.1,
        "position": [
          96,
          496
        ]
      },
      {
        "parameters": {
          "jsCode": "// Get market data from Merge node\nconst items = $input.all();\n\nif (items.length < 3) {\n  throw new Error(`Only received ${items.length} items. Expected 3 (QS, F, VIX). Check the Merge node.`);\n}\n\n// Identify QS, F, and VIX data\nlet qsData, fData, vixData;\n\nfor (const item of items) {\n  const json = item.json;\n  \n  if (json.chart && json.chart.result && json.chart.result[0]) {\n    const symbol = json.chart.result[0].meta.symbol;\n    \n    if (symbol && symbol.includes('QS')) {\n      qsData = json;\n      console.log('‚úì QS data found');\n    } else if (symbol && (symbol.includes('F') || symbol === 'F')) {\n      fData = json;\n      console.log('‚úì F data found');\n    } else if (symbol && symbol.includes('VIX')) {\n      vixData = json;\n      console.log('‚úì VIX data found');\n    }\n  }\n}\n\nif (!qsData || !fData || !vixData) {\n  throw new Error(`Missing data: QS=${!!qsData}, F=${!!fData}, VIX=${!!vixData}`);\n}\n\n// Process QS data\nconst qsPrice = qsData.chart.result[0].meta.regularMarketPrice;\nconst qsPrevClose = qsData.chart.result[0].meta.chartPreviousClose;\nconst qsChange = ((qsPrice - qsPrevClose) / qsPrevClose * 100).toFixed(2);\nconst qsVolume = qsData.chart.result[0].meta.regularMarketVolume || 0;\n\n// Process F data\nconst fPrice = fData.chart.result[0].meta.regularMarketPrice;\nconst fPrevClose = fData.chart.result[0].meta.chartPreviousClose;\nconst fChange = ((fPrice - fPrevClose) / fPrevClose * 100).toFixed(2);\nconst fVolume = fData.chart.result[0].meta.regularMarketVolume || 0;\n\n// Process VIX data (for general market volatility context)\nconst vixCurrent = vixData.chart.result[0].meta.regularMarketPrice;\nconst vixPrevClose = vixData.chart.result[0].meta.chartPreviousClose;\nconst vixChange = ((vixCurrent - vixPrevClose) / vixPrevClose * 100).toFixed(2);\n\n// Handle case where VIX data might be empty or incomplete\nconst vixQuoteData = vixData.chart.result[0].indicators?.quote?.[0]?.close;\nconst vixHistory = vixQuoteData \n  ? vixQuoteData.filter(v => v !== null && v !== undefined)\n  : [vixCurrent]; // Fallback to current price if no history\nconst vix6mAvg = vixHistory.length > 0 \n  ? (vixHistory.reduce((a, b) => a + b, 0) / vixHistory.length).toFixed(2)\n  : vixCurrent.toFixed(2);\n\n// Get current date/time in JST\nconst now = new Date();\nconst jstDate = now.toLocaleDateString('en-US', {timeZone: 'Asia/Tokyo'});\nconst jstTime = now.toLocaleTimeString('en-US', {timeZone: 'Asia/Tokyo', hour: '2-digit', minute: '2-digit'});\n\nconst prompt = `You are a professional options trader specializing in the Wheel Strategy on individual stocks.\n\nüìä CURRENT STOCK PRICES:\nQS (QuantumScape):\n- Price: $${qsPrice.toFixed(2)} (${qsChange > 0 ? '+' : ''}${qsChange}%)\n- Previous Close: $${qsPrevClose.toFixed(2)}\n- Volume: ${qsVolume.toLocaleString()}\n\nF (Ford Motor):\n- Price: $${fPrice.toFixed(2)} (${fChange > 0 ? '+' : ''}${fChange}%)\n- Previous Close: $${fPrevClose.toFixed(2)}\n- Volume: ${fVolume.toLocaleString()}\n- Dividend Yield: 5.5% annual ($0.15 quarterly)\n\nMARKET VOLATILITY (VIX - for context):\n- VIX Current: ${vixCurrent.toFixed(2)} (${vixChange > 0 ? '+' : ''}${vixChange}%)\n- VIX 6-Month Average: ${vix6mAvg}\n- Market sentiment: ${vixCurrent < 15 ? 'LOW VOLATILITY - Good for selling puts' : vixCurrent < 20 ? 'MODERATE VOLATILITY - Normal conditions' : 'HIGH VOLATILITY - Be cautious'}\n\nDate: ${jstDate}\nTime: ${jstTime} JST\n\nüë§ MY TRADING PROFILE:\n- Account Size: $3,000 USD\n- Location: Japan (sleeping during US market hours)\n- Broker: Webull (manual execution, no API)\n- Strategy: THE WHEEL on QS and F stocks\n- Target Allocation: \n  * QS: ~$1,140 (1 contract / 100 shares)\n  * F: ~$1,330 (1 contract / 100 shares)\n  * Cash Reserve: ~$530 minimum\n- Goal: Generate monthly income through options premiums + F dividends\n\nüéØ THE WHEEL STRATEGY (My Approach):\n\nPHASE 1 - Sell Cash-Secured Puts:\n- Sell puts on QS and F to collect premium\n- If assigned ‚Üí own shares at good entry price\n- DTE: 30-45 days preferred\n- Delta: 0.20-0.30 (out of the money, ~10-15% below current price)\n\nPHASE 2 - If Assigned, Sell Covered Calls:\n- Sell calls above my cost basis\n- Collect premium while waiting for assignment\n- DTE: 30-45 days\n- Strike: 15-25% above cost basis\n\nPHASE 3 - Repeat:\n- If shares called away ‚Üí restart with cash-secured puts\n- If puts expire worthless ‚Üí sell new puts\n- Continuous income generation\n\nüì∏ MY CURRENT ACCOUNT STATUS:\nPlease analyze the screenshot of my Webull account that I attached.\n\nFrom the image, identify:\n- Current QS position (if any): shares owned, cost basis, P&L\n- Current F position (if any): shares owned, cost basis, P&L\n- Open options contracts: strikes, DTE, type (put/call), P&L\n- Available buying power\n- Total account value\n\nüéØ What should I do TODAY based on:\n1. Current QS price: $${qsPrice.toFixed(2)} and F price: $${fPrice.toFixed(2)}\n2. My current positions shown in the screenshot\n3. VIX level (${vixCurrent.toFixed(2)}) for market context\n4. My available capital\n5. Optimal Wheel strategy execution\n\nANALYSIS REQUIRED FOR EACH STOCK:\n\n**QS (QuantumScape) - High Risk/High Premium:**\nCurrent Status:\n- Today's price: $${qsPrice.toFixed(2)} (${qsChange > 0 ? '+' : ''}${qsChange}%)\n- Risk level: HIGH (pre-revenue, volatile)\n- Premium potential: HIGH (usually 5-7% monthly)\n\nWhat to do:\n- If I have NO position: Should I sell a cash-secured put? Which strike?\n- If I OWN shares: Should I sell a covered call? Which strike?\n- If I have an OPEN put: Should I roll, close, or let it expire?\n- If I have an OPEN call: Should I roll, close, or let it be assigned?\n\n**F (Ford Motor) - Lower Risk/Stable + Dividend:**\nCurrent Status:\n- Today's price: $${fPrice.toFixed(2)} (${fChange > 0 ? '+' : ''}${fChange}%)\n- Risk level: LOW (established company, dividend)\n- Premium potential: MODERATE (usually 3-4% monthly)\n- Dividend: $0.15/share quarterly (if I own shares)\n\nWhat to do:\n- If I have NO position: Should I sell a cash-secured put? Which strike?\n- If I OWN shares: Should I sell a covered call? Which strike?\n- If I have an OPEN put: Should I roll, close, or let it expire?\n- If I have an OPEN call: Should I roll, close, or let it be assigned?\n\nIMPORTANT GUIDELINES:\n- Max capital usage: 75% ($2,250 max on positions)\n- Min cash reserve: $500\n- QS strikes: Round to whole dollars (e.g., $10, $11, $12)\n- F strikes: Round to $0.50 increments (e.g., $12.50, $13.00, $13.50)\n- Always check earnings dates (avoid selling options during earnings week)\n- Prefer monthly expiration dates for liquidity\n- If VIX > 20: Be more conservative with strikes\n- If VIX < 15: Can be slightly more aggressive\n\n‚ö†Ô∏è RISK MANAGEMENT:\nQS Limits:\n- Don't sell puts below $8 (too risky)\n- If assigned, don't average down\n- Max loss tolerance: -$300 per position\n\nF Limits:\n- Don't sell puts below $11 (safe threshold)\n- If assigned, can hold long-term (dividends help)\n- Max loss tolerance: -$200 per position\n\nExit Rules:\n- Close options at 50% profit if available\n- If stock moves against put by >15%, consider rolling\n- If stock moves past call by >10%, let it be assigned (take profit)\n\nREQUIRED RESPONSE FORMAT:\n\nüü¢ SIGNAL: [SELL PUT QS / SELL PUT F / SELL CALL QS / SELL CALL F / HOLD / ADJUST / CLOSE]\n\nüìä MARKET ANALYSIS:\n[Brief analysis of QS and F price action today, VIX context]\n\nüíº ACCOUNT ANALYSIS:\n[What you see in my screenshot: current positions, options, buying power, P&L]\n\nüìç SPECIFIC ACTIONS:\n\nQS Recommendation:\nAction: [SELL PUT / SELL CALL / HOLD / ROLL / CLOSE]\nStrike: $X.XX\nDTE: X days (expiration date: MM/DD)\nPremium: $X.XX per contract ($XX total)\nMax risk if assigned: $XXX\nProbability of profit: ~XX%\n\nF Recommendation:\nAction: [SELL PUT / SELL CALL / HOLD / ROLL / CLOSE]\nStrike: $X.XX\nDTE: X days (expiration date: MM/DD)\nPremium: $X.XX per contract ($XX total)\nMax risk if assigned: $XXX\nProbability of profit: ~XX%\n+ Dividend: $X.XX quarterly if assigned\n\nüí° REASONING:\n[Why these specific strikes and actions make sense given current prices and market conditions]\n\n‚ö†Ô∏è RISKS TO CONSIDER:\n- QS: [Any upcoming earnings, news, technical levels]\n- F: [Any upcoming earnings, news, sector developments]\n- Market: [VIX levels, upcoming economic data]\n\nüí∞ EXPECTED INCOME:\nThis month's premium: $XXX\nF dividends (if holding shares): $XXX\nTotal monthly income: $XXX\nAnnual projection (if consistent): $X,XXX (XX% ROI)\n\nüìà PORTFOLIO PROJECTION (30 days):\nBest case: $X,XXX (if options expire worthless)\nExpected case: $X,XXX (normal scenario)\nWorst case: $X,XXX (if assigned at strikes)\n\nüéØ EXECUTION CHECKLIST:\n1. [ ] Check QS earnings date (avoid if within 2 weeks)\n2. [ ] Check F earnings date (avoid if within 2 weeks)\n3. [ ] Confirm buying power covers margin requirements\n4. [ ] Set calendar reminder for options expiration\n5. [ ] Monitor positions weekly for adjustments`;\n\nreturn [{\n  json: {\n    prompt: prompt,\n    marketData: {\n      qsPrice: qsPrice,\n      qsChange: parseFloat(qsChange),\n      fPrice: fPrice,\n      fChange: parseFloat(fChange),\n      vix: vixCurrent,\n      vix6mAvg: parseFloat(vix6mAvg),\n      date: jstDate,\n      time: jstTime\n    }\n  }\n}];"
        },
        "id": "5ff6ea37-a595-4483-81ad-5563cbcbd836",
        "name": "üß† Build AI Prompt",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          544,
          352
        ]
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "30 22 * * *"
              }
            ]
          }
        },
        "id": "ec41243e-97ec-4069-92ea-23bddf9d4f0f",
        "name": "Pre-Apertura NYSE 22:30 JST",
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.1,
        "position": [
          -224,
          464
        ]
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "field": "cronExpression",
                "expression": "30 6 * * *"
              }
            ]
          }
        },
        "id": "df67b0c8-af77-4ce7-89c7-58faed36d903",
        "name": "Post-Cierre 06:30 JST",
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.1,
        "position": [
          -224,
          304
        ]
      },
      {
        "parameters": {
          "numberInputs": 3
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          384,
          336
        ],
        "id": "5be80cd2-49b0-4396-829b-e556f49a0a7f",
        "name": "Merge"
      },
      {
        "parameters": {
          "updates": [
            "message",
            "callback_query"
          ],
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          -752,
          -464
        ],
        "id": "e55b21a4-e016-42ec-9aab-064042865edd",
        "name": "Telegram Trigger",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram ThetaSentinelBot"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/help",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -272,
          -464
        ],
        "id": "e1a5172e-6b75-4747-ae55-abc4d693ba88",
        "name": "If7"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=this is the help for the commands that you can use Chimo. \n/run              # is going analitic\n/upload        # is going upload your current positions",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -64,
          -480
        ],
        "id": "102159b5-9149-4191-9d81-3d7447352ec2",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram ThetaSentinelBot"
          }
        }
      },
      {
        "parameters": {
          "content": "## Help\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -560,
          -464
        ],
        "id": "ee2faccd-a825-4374-a521-a4d8272aa87e",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.caption }}",
                "rightValue": "/upload",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -272,
          -208
        ],
        "id": "16143096-9b11-4072-a801-64379f1a4e21",
        "name": "If5"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "I'm working on your upload",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -64,
          -224
        ],
        "id": "df6d9884-323b-4ac8-8bdb-eeb18fda62ce",
        "name": "Telegram13",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram ThetaSentinelBot"
          }
        }
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code12').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          544,
          -224
        ],
        "id": "4572cd0d-2e49-4225-bd75-9d66870ea562",
        "name": "FTP6",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = \"currentPosition.jpg\";\n\n// Aseg√∫rate de que el binary data tambi√©n se pase correctamente\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/ThetaSentinel/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/ThetaSentinel/images/${filename}`\n    },\n    binary: items[0].binary // Esto pasa el binary data al siguiente paso\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          144,
          -224
        ],
        "id": "77a72838-2bff-43eb-813c-9109cf7564e7",
        "name": "Code12"
      },
      {
        "parameters": {
          "resource": "file",
          "fileId": "={{ $('If5').item.json.message.document.file_id }}",
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          352,
          -224
        ],
        "id": "9794ceb8-dd33-487e-a6f0-77807a1bb439",
        "name": "Telegram23",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram ThetaSentinelBot"
          }
        }
      },
      {
        "parameters": {
          "operation": "sendPhoto",
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code12').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          752,
          -240
        ],
        "id": "3fda2d2a-b9c3-4871-965d-a2a22c9b4cd2",
        "name": "Telegram25",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram ThetaSentinelBot"
          }
        }
      },
      {
        "parameters": {
          "content": "## Upload\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -592,
          -192
        ],
        "id": "388326b5-507a-4350-85e0-7a51c6ca264f",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/run",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -256,
          48
        ],
        "id": "110b8be2-2e26-4b69-8db5-2cfaae66ca7a",
        "name": "If"
      },
      {
        "parameters": {
          "content": "## RUN\n\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -560,
          -16
        ],
        "id": "c871322e-10d3-4bf1-be63-619e31635754",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "resource": "image",
          "modelId": {
            "__rl": true,
            "value": "claude-haiku-4-5-20251001",
            "mode": "list",
            "cachedResultName": "claude-haiku-4-5-20251001"
          },
          "text": "={{ $json.prompt }}",
          "imageUrls": "https://lemonsushi.com/uploads/ThetaSentinel/images/currentPosition.jpg",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.anthropic",
        "typeVersion": 1,
        "position": [
          704,
          336
        ],
        "id": "3e34dbeb-9505-42c4-bd48-a2a94e2e9a59",
        "name": "Analyze image",
        "credentials": {
          "anthropicApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Anthropic n8n"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Extraer respuesta de Claude\nconst response = $input.first().json;\nconst claudeResponse = response.content[0].text;\n\n// Obtener datos de mercado\nconst marketData = $('üß† Build AI Prompt').first().json.marketData || {};\n\n// Generar nombre de archivo con timestamp\nconst now = new Date();\nconst timestamp = now.toISOString().slice(0, 19).replace(/:/g, '-');\nconst filename = `wheel_analysis_${timestamp}.html`;\n\n// Crear HTML con estilos profesionales\nconst htmlContent = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Wheel Strategy Analysis - ${marketData.date}</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            padding: 20px;\n            line-height: 1.6;\n        }\n        \n        .container {\n            max-width: 900px;\n            margin: 0 auto;\n            background: white;\n            border-radius: 16px;\n            box-shadow: 0 20px 60px rgba(0,0,0,0.3);\n            overflow: hidden;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            color: white;\n            padding: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            font-size: 28px;\n            margin-bottom: 10px;\n            font-weight: 700;\n        }\n        \n        .header .subtitle {\n            font-size: 14px;\n            opacity: 0.9;\n            display: flex;\n            justify-content: center;\n            gap: 20px;\n            margin-top: 10px;\n        }\n        \n        .market-overview {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n            padding: 30px;\n            background: #f8f9fa;\n            border-bottom: 1px solid #e0e0e0;\n        }\n        \n        .stock-card {\n            background: white;\n            padding: 20px;\n            border-radius: 12px;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n            border-left: 4px solid #2a5298;\n        }\n        \n        .stock-card h3 {\n            font-size: 16px;\n            color: #2a5298;\n            margin-bottom: 10px;\n        }\n        \n        .stock-price {\n            font-size: 32px;\n            font-weight: 700;\n            color: #1e3c72;\n            margin: 10px 0;\n        }\n        \n        .stock-change {\n            font-size: 18px;\n            font-weight: 600;\n            padding: 5px 10px;\n            border-radius: 6px;\n            display: inline-block;\n        }\n        \n        .positive {\n            color: #10b981;\n            background: #d1fae5;\n        }\n        \n        .negative {\n            color: #ef4444;\n            background: #fee2e2;\n        }\n        \n        .content {\n            padding: 30px;\n        }\n        \n        .content h2 {\n            color: #1e3c72;\n            margin-top: 30px;\n            margin-bottom: 15px;\n            font-size: 22px;\n            border-bottom: 3px solid #2a5298;\n            padding-bottom: 10px;\n        }\n        \n        .content h3 {\n            color: #2a5298;\n            margin-top: 20px;\n            margin-bottom: 10px;\n            font-size: 18px;\n        }\n        \n        .content p, .content ul, .content ol {\n            margin-bottom: 15px;\n            color: #333;\n        }\n        \n        .content ul, .content ol {\n            margin-left: 25px;\n        }\n        \n        .content li {\n            margin-bottom: 8px;\n        }\n        \n        .signal-box {\n            background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 12px;\n            margin: 20px 0;\n            font-size: 20px;\n            font-weight: 700;\n            text-align: center;\n            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);\n        }\n        \n        .warning-box {\n            background: #fef3c7;\n            border-left: 4px solid #f59e0b;\n            padding: 15px;\n            border-radius: 8px;\n            margin: 20px 0;\n        }\n        \n        .info-box {\n            background: #dbeafe;\n            border-left: 4px solid #3b82f6;\n            padding: 15px;\n            border-radius: 8px;\n            margin: 20px 0;\n        }\n        \n        .action-card {\n            background: #f8f9fa;\n            padding: 20px;\n            border-radius: 12px;\n            margin: 15px 0;\n            border: 2px solid #e0e0e0;\n        }\n        \n        .action-card h4 {\n            color: #1e3c72;\n            margin-bottom: 10px;\n            font-size: 18px;\n        }\n        \n        .footer {\n            background: #1e3c72;\n            color: white;\n            padding: 20px;\n            text-align: center;\n            font-size: 14px;\n        }\n        \n        pre {\n            background: #f4f4f4;\n            padding: 15px;\n            border-radius: 8px;\n            overflow-x: auto;\n            font-size: 14px;\n            line-height: 1.4;\n        }\n        \n        code {\n            background: #f4f4f4;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 14px;\n        }\n        \n        @media (max-width: 768px) {\n            body {\n                padding: 10px;\n            }\n            \n            .header h1 {\n                font-size: 22px;\n            }\n            \n            .stock-price {\n                font-size: 24px;\n            }\n            \n            .market-overview {\n                padding: 15px;\n            }\n            \n            .content {\n                padding: 20px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>üéØ Wheel Strategy Analysis</h1>\n            <div class=\"subtitle\">\n                <span>üìÖ ${marketData.date || 'N/A'}</span>\n                <span>üïê ${marketData.time || 'N/A'} JST</span>\n            </div>\n        </div>\n        \n        <div class=\"market-overview\">\n            <div class=\"stock-card\">\n                <h3>QS (QuantumScape)</h3>\n                <div class=\"stock-price\">$${marketData.qsPrice?.toFixed(2) || 'N/A'}</div>\n                <div class=\"stock-change ${marketData.qsChange >= 0 ? 'positive' : 'negative'}\">\n                    ${marketData.qsChange >= 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(marketData.qsChange || 0).toFixed(2)}%\n                </div>\n            </div>\n            \n            <div class=\"stock-card\">\n                <h3>F (Ford Motor)</h3>\n                <div class=\"stock-price\">$${marketData.fPrice?.toFixed(2) || 'N/A'}</div>\n                <div class=\"stock-change ${marketData.fChange >= 0 ? 'positive' : 'negative'}\">\n                    ${marketData.fChange >= 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(marketData.fChange || 0).toFixed(2)}%\n                </div>\n            </div>\n            \n            <div class=\"stock-card\">\n                <h3>VIX (Volatility Index)</h3>\n                <div class=\"stock-price\">${marketData.vix?.toFixed(2) || 'N/A'}</div>\n                <div class=\"stock-change\" style=\"background: #e0e7ff; color: #4f46e5;\">\n                    6M Avg: ${marketData.vix6mAvg || 'N/A'}\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"content\">\n            <pre style=\"white-space: pre-wrap; word-wrap: break-word;\">${claudeResponse}</pre>\n        </div>\n        \n        <div class=\"footer\">\n            <p>ü§ñ Generated by Theta Sentinel AI</p>\n            <p style=\"margin-top: 5px; font-size: 12px; opacity: 0.8;\">\n                Automated Options Analysis System\n            </p>\n        </div>\n    </div>\n</body>\n</html>`;\n\nreturn [{\n  json: {\n    filename: filename,\n    htmlContent: htmlContent,\n    marketData: marketData,\n    claudeResponse: claudeResponse\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          960,
          144
        ],
        "id": "821b15f3-f9dc-48ec-8311-c45176730bf3",
        "name": "Create html report"
      },
      {
        "parameters": {
          "jsCode": "// Obtener datos del nodo anterior\nconst data = $input.first().json;\n\n// La respuesta de Claude viene en content[0].text\nlet claudeResponse = '';\n\nif (data.claudeResponse) {\n  claudeResponse = data.claudeResponse;\n} else if (data.content && Array.isArray(data.content) && data.content[0]?.text) {\n  claudeResponse = data.content[0].text;\n} else if (data.message?.content && Array.isArray(data.message.content) && data.message.content[0]?.text) {\n  claudeResponse = data.message.content[0].text;\n} else if (typeof data === 'string') {\n  claudeResponse = data;\n} else {\n  throw new Error('Could not find Claude response in input data');\n}\n\nif (!claudeResponse || typeof claudeResponse !== 'string') {\n  throw new Error('Claude response is not a valid string');\n}\n\n// Extraer datos de mercado del texto de Claude\nlet marketData = {\n  qsPrice: null,\n  qsChange: null,\n  fPrice: null,\n  fChange: null,\n  vix: null,\n  vix6mAvg: null,\n  time: null,\n  date: null\n};\n\n// Extraer QS price y change\nconst qsMatch = claudeResponse.match(/QS.*?\\$?([\\d.]+)\\s*\\(([+-][\\d.]+)%\\)/i);\nif (qsMatch) {\n  marketData.qsPrice = parseFloat(qsMatch[1]);\n  marketData.qsChange = parseFloat(qsMatch[2]);\n}\n\n// Extraer F price y change\nconst fMatch = claudeResponse.match(/F.*?Ford.*?\\$?([\\d.]+)\\s*\\(([+-][\\d.]+)%\\)/i);\nif (fMatch) {\n  marketData.fPrice = parseFloat(fMatch[1]);\n  marketData.fChange = parseFloat(fMatch[2]);\n}\n\n// Extraer VIX\nconst vixMatch = claudeResponse.match(/VIX(?:\\s+at|\\s+Current:)?\\s*(\\d+\\.?\\d*)/i);\nif (vixMatch) {\n  marketData.vix = parseFloat(vixMatch[1]);\n  marketData.vix6mAvg = parseFloat(vixMatch[1]);\n}\n\n// Extraer fecha y hora\nconst dateMatch = claudeResponse.match(/Date:\\s*(\\d+\\/\\d+\\/\\d+)/i);\nif (dateMatch) {\n  marketData.date = dateMatch[1];\n}\n\nconst timeMatch = claudeResponse.match(/Time:\\s*([\\d:]+\\s*(?:AM|PM)?)/i);\nif (timeMatch) {\n  marketData.time = timeMatch[1];\n}\n\n// Extraer SIGNAL\nlet signal = 'N/A';\nconst signalMatch = claudeResponse.match(/üü¢ SIGNAL:\\s*\\*?(.+?)\\*?(?:\\n|$)/i);\nif (signalMatch) {\n  signal = signalMatch[1].trim().replace(/\\*\\*/g, '');\n}\n\n// Extraer QS Action\nlet qsAction = 'N/A';\nconst qsRecommendationMatch = claudeResponse.match(/### \\*\\*QS RECOMMENDATION:[\\s\\S]*?Action:\\*?\\s*(.+?)(?:\\n|$)/i);\nif (qsRecommendationMatch) {\n  qsAction = qsRecommendationMatch[1].trim().replace(/\\*\\*/g, '');\n  \n  const qsStrikeMatch = claudeResponse.match(/### \\*\\*QS RECOMMENDATION:[\\s\\S]*?Strike:\\*?\\s*\\$?([\\d.]+)/i);\n  const qsPremiumMatch = claudeResponse.match(/### \\*\\*QS RECOMMENDATION:[\\s\\S]*?Premium:\\*?\\s*~?\\$?([\\d.-]+)/i);\n  \n  if (qsStrikeMatch && qsPremiumMatch) {\n    qsAction = `${qsAction} @ $${qsStrikeMatch[1]} (${qsPremiumMatch[1]} premium)`;\n  }\n}\n\n// Extraer F Action\nlet fAction = 'N/A';\nconst fRecommendationMatch = claudeResponse.match(/### \\*\\*F RECOMMENDATION:[\\s\\S]*?Action:\\*?\\s*(.+?)(?:\\n|$)/i);\nif (fRecommendationMatch) {\n  fAction = fRecommendationMatch[1].trim().replace(/\\*\\*/g, '');\n  \n  const fStrikeMatch = claudeResponse.match(/### \\*\\*F RECOMMENDATION:[\\s\\S]*?Strike:\\*?\\s*\\$?([\\d.]+)/i);\n  const fPremiumMatch = claudeResponse.match(/### \\*\\*F RECOMMENDATION:[\\s\\S]*?Premium:\\*?\\s*~?\\$?([\\d.-]+)/i);\n  \n  if (fStrikeMatch && fPremiumMatch) {\n    fAction = `${fAction} @ $${fStrikeMatch[1]} (${fPremiumMatch[1]} premium)`;\n  }\n}\n\n// Extraer Expected Income\nlet expectedIncome = 'N/A';\nlet incomeMatch = claudeResponse.match(/This month[''']?s? premium:\\s*\\$?([\\d,]+)/i);\nif (!incomeMatch) {\n  incomeMatch = claudeResponse.match(/Monthly premium:\\s*\\$?([\\d,]+)/i);\n}\nif (incomeMatch) {\n  expectedIncome = `$${incomeMatch[1]}`;\n}\n\n// Funci√≥n para escapar caracteres especiales de Telegram Markdown\nfunction escapeTelegramMarkdown(text) {\n  if (!text) return '';\n  return text\n    .replace(/\\\\/g, '\\\\\\\\')   // Backslash\n    .replace(/`/g, '\\\\`')     // Backticks\n    .replace(/_/g, '\\\\_')     // Underscore\n    .replace(/\\*/g, '\\\\*')    // Asterisk\n    .replace(/\\[/g, '\\\\[')    // Left bracket\n    .replace(/\\]/g, '\\\\]')    // Right bracket\n    .replace(/\\(/g, '\\\\(')    // Left paren\n    .replace(/\\)/g, '\\\\)')    // Right paren\n    .replace(/~/g, '\\\\~')     // Tilde\n    .replace(/`/g, '\\\\`')     // Backtick\n    .replace(/>/g, '\\\\>')     // Greater than\n    .replace(/</g, '\\\\<')     // Less than\n    .replace(/\\|/g, '\\\\|');   // Pipe\n}\n\n// Escapar los valores extra√≠dos\nconst escapedSignal = escapeTelegramMarkdown(signal);\nconst escapedQsAction = escapeTelegramMarkdown(qsAction);\nconst escapedFAction = escapeTelegramMarkdown(fAction);\nconst escapedIncome = escapeTelegramMarkdown(expectedIncome);\n\n// Crear mensaje SIMPLE sin Markdown\nconst telegramMessage = `WHEEL STRATEGY - QS & F ANALYSIS\n\nSIGNAL: ${escapedSignal}\n\nMarket Status:\nQS: $${marketData.qsPrice?.toFixed(2) || 'N/A'} (${marketData.qsChange >= 0 ? '+' : ''}${marketData.qsChange?.toFixed(2) || 'N/A'}%)\nF: $${marketData.fPrice?.toFixed(2) || 'N/A'} (${marketData.fChange >= 0 ? '+' : ''}${marketData.fChange?.toFixed(2) || 'N/A'}%)\nVIX: ${marketData.vix?.toFixed(2) || 'N/A'} (Low volatility env)\n\nQuick Actions:\nQS: ${escapedQsAction}\nF: ${escapedFAction}\n\nExpected Income: ${escapedIncome}/month\nTime: ${marketData.time || ''} JST (${marketData.date || ''})`;\n\n// RETORNAR\nreturn [{\n  json: {\n    text: telegramMessage,\n    marketData: marketData,\n    signal: signal,\n    qsAction: qsAction,\n    fAction: fAction,\n    expectedIncome: expectedIncome\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          928,
          432
        ],
        "id": "6e8efc6f-a51c-4381-8cca-6d086e4145d8",
        "name": "Extract summary telegram",
        "disabled": true
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $json.text }}",
          "replyMarkup": "forceReply",
          "forceReply": {},
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1216,
          448
        ],
        "id": "835fb57e-129e-4daa-8e44-e4fe959956b4",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram ThetaSentinelBot"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Obtener datos del nodo anterior\nconst data = $input.first().json;\nconst filename = data.filename;\nconst htmlContent = data.htmlContent;\n\nif (!htmlContent) {\n  throw new Error('No HTML content found');\n}\n\n// Convertir HTML string a buffer/binario\nconst buffer = Buffer.from(htmlContent, 'utf8');\nconst base64 = buffer.toString('base64');\n\nreturn [{\n  json: {\n    filename: filename,\n    success: true,\n    message: `HTML file ready for download: ${filename}`\n  },\n  binary: {\n    htmlFile: {\n      data: base64,\n      mimetype: 'text/html',\n      filename: filename\n    }\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1152,
          144
        ],
        "id": "a49ff5fc-de72-4786-bee6-84bd246ef976",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "jsCode": "// Obtener datos del nodo anterior\nconst data = $input.first().json;\nconst filename = $input.first().json.filename;\nconst htmlContent = $('Create html report').first().json.htmlContent;\n\nif (!htmlContent) {\n  throw new Error('No HTML content found');\n}\n\n// Convertir HTML string a buffer/binario\nconst buffer = Buffer.from(htmlContent, 'utf8');\nconst base64 = buffer.toString('base64');\n\n// Paths para FTP\nconst ftpPath = `/public_html/uploads/ThetaSentinel/reports/${filename}`;\nconst publicUrl = `https://lemonsushi.com/uploads/ThetaSentinel/reports/${filename}`;\n\nreturn [{\n  json: {\n    filename: filename,\n    filepath: ftpPath,\n    publicUrl: publicUrl,\n    success: true,\n    message: `HTML file ready: ${filename}`,\n    downloadUrl: publicUrl\n  },\n  binary: {\n    htmlFile: {\n      data: base64,\n      mimetype: 'text/html',\n      filename: filename\n    }\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1344,
          160
        ],
        "id": "f95ccecd-51fe-428f-a735-0c1a365220cc",
        "name": "Code in JavaScript1"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $json.filepath }}",
          "binaryPropertyName": "htmlFile"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1520,
          144
        ],
        "id": "6b9c7f72-e216-4b26-9d3e-d1f7146c5741",
        "name": "FTP",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $json.publicUrl }}",
          "replyMarkup": "forceReply",
          "forceReply": {},
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1728,
          128
        ],
        "id": "661d87db-8d3f-4a79-859a-cfaafc787d76",
        "name": "Telegram26",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram ThetaSentinelBot"
          }
        }
      }
    ],
    "connections": {
      "üìä Get VIX Data": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "üß† Build AI Prompt": {
        "main": [
          [
            {
              "node": "Analyze image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Pre-Apertura NYSE 22:30 JST": {
        "main": [
          [
            {
              "node": "üìä Get VIX Data",
              "type": "main",
              "index": 0
            },
            {
              "node": "üöó Get F Price",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìà Get QS Price",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Post-Cierre 06:30 JST": {
        "main": [
          [
            {
              "node": "üìä Get VIX Data",
              "type": "main",
              "index": 0
            },
            {
              "node": "üöó Get F Price",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìà Get QS Price",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "üß† Build AI Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If5": {
        "main": [
          [
            {
              "node": "Telegram13",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram13": {
        "main": [
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP6": {
        "main": [
          [
            {
              "node": "Telegram25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Telegram23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram23": {
        "main": [
          [
            {
              "node": "FTP6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "üìä Get VIX Data",
              "type": "main",
              "index": 0
            },
            {
              "node": "üöó Get F Price",
              "type": "main",
              "index": 0
            },
            {
              "node": "üìà Get QS Price",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Analyze image": {
        "main": [
          [
            {
              "node": "Create html report",
              "type": "main",
              "index": 0
            },
            {
              "node": "Extract summary telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "üöó Get F Price": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "üìà Get QS Price": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract summary telegram": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create html report": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Code in JavaScript1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript1": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Telegram26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Pre-Market Analysis 15:30 JST": {
        "recurrenceRules": []
      },
      "node:Pre-Apertura NYSE 22:30 JST": {
        "recurrenceRules": []
      },
      "node:Post-Cierre 06:30 JST": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "dd443563-4b68-42b0-8c02-33706d5acc79",
    "activeVersionId": "dd443563-4b68-42b0-8c02-33706d5acc79",
    "triggerCount": 3,
    "shared": [
      {
        "updatedAt": "2025-12-17T01:40:03.506Z",
        "createdAt": "2025-12-17T01:40:03.506Z",
        "role": "workflow:owner",
        "workflowId": "TPZsi4pU0KrvgHA2",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": {
      "updatedAt": "2025-12-26T01:33:14.866Z",
      "createdAt": "2025-12-26T01:33:14.866Z",
      "versionId": "dd443563-4b68-42b0-8c02-33706d5acc79",
      "workflowId": "TPZsi4pU0KrvgHA2",
      "nodes": [
        {
          "parameters": {
            "url": "https://query1.finance.yahoo.com/v8/finance/chart/QS",
            "options": {}
          },
          "id": "6b46bfc9-b011-4b46-9a11-ba095ccdb076",
          "name": "üìà Get QS Price",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            80,
            160
          ]
        },
        {
          "parameters": {
            "url": "https://query1.finance.yahoo.com/v8/finance/chart/F",
            "options": {}
          },
          "id": "642c78ee-7a79-47bc-8987-769232f258ad",
          "name": "üöó Get F Price",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            80,
            336
          ]
        },
        {
          "parameters": {
            "url": "https://query1.finance.yahoo.com/v8/finance/chart/^VIX",
            "options": {}
          },
          "id": "55d769fe-b1b5-44e1-821e-68bb3b4e5fd0",
          "name": "üìä Get VIX Data",
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.1,
          "position": [
            96,
            496
          ]
        },
        {
          "parameters": {
            "jsCode": "// Get market data from Merge node\nconst items = $input.all();\n\nif (items.length < 3) {\n  throw new Error(`Only received ${items.length} items. Expected 3 (QS, F, VIX). Check the Merge node.`);\n}\n\n// Identify QS, F, and VIX data\nlet qsData, fData, vixData;\n\nfor (const item of items) {\n  const json = item.json;\n  \n  if (json.chart && json.chart.result && json.chart.result[0]) {\n    const symbol = json.chart.result[0].meta.symbol;\n    \n    if (symbol && symbol.includes('QS')) {\n      qsData = json;\n      console.log('‚úì QS data found');\n    } else if (symbol && (symbol.includes('F') || symbol === 'F')) {\n      fData = json;\n      console.log('‚úì F data found');\n    } else if (symbol && symbol.includes('VIX')) {\n      vixData = json;\n      console.log('‚úì VIX data found');\n    }\n  }\n}\n\nif (!qsData || !fData || !vixData) {\n  throw new Error(`Missing data: QS=${!!qsData}, F=${!!fData}, VIX=${!!vixData}`);\n}\n\n// Process QS data\nconst qsPrice = qsData.chart.result[0].meta.regularMarketPrice;\nconst qsPrevClose = qsData.chart.result[0].meta.chartPreviousClose;\nconst qsChange = ((qsPrice - qsPrevClose) / qsPrevClose * 100).toFixed(2);\nconst qsVolume = qsData.chart.result[0].meta.regularMarketVolume || 0;\n\n// Process F data\nconst fPrice = fData.chart.result[0].meta.regularMarketPrice;\nconst fPrevClose = fData.chart.result[0].meta.chartPreviousClose;\nconst fChange = ((fPrice - fPrevClose) / fPrevClose * 100).toFixed(2);\nconst fVolume = fData.chart.result[0].meta.regularMarketVolume || 0;\n\n// Process VIX data (for general market volatility context)\nconst vixCurrent = vixData.chart.result[0].meta.regularMarketPrice;\nconst vixPrevClose = vixData.chart.result[0].meta.chartPreviousClose;\nconst vixChange = ((vixCurrent - vixPrevClose) / vixPrevClose * 100).toFixed(2);\n\n// Handle case where VIX data might be empty or incomplete\nconst vixQuoteData = vixData.chart.result[0].indicators?.quote?.[0]?.close;\nconst vixHistory = vixQuoteData \n  ? vixQuoteData.filter(v => v !== null && v !== undefined)\n  : [vixCurrent]; // Fallback to current price if no history\nconst vix6mAvg = vixHistory.length > 0 \n  ? (vixHistory.reduce((a, b) => a + b, 0) / vixHistory.length).toFixed(2)\n  : vixCurrent.toFixed(2);\n\n// Get current date/time in JST\nconst now = new Date();\nconst jstDate = now.toLocaleDateString('en-US', {timeZone: 'Asia/Tokyo'});\nconst jstTime = now.toLocaleTimeString('en-US', {timeZone: 'Asia/Tokyo', hour: '2-digit', minute: '2-digit'});\n\nconst prompt = `You are a professional options trader specializing in the Wheel Strategy on individual stocks.\n\nüìä CURRENT STOCK PRICES:\nQS (QuantumScape):\n- Price: $${qsPrice.toFixed(2)} (${qsChange > 0 ? '+' : ''}${qsChange}%)\n- Previous Close: $${qsPrevClose.toFixed(2)}\n- Volume: ${qsVolume.toLocaleString()}\n\nF (Ford Motor):\n- Price: $${fPrice.toFixed(2)} (${fChange > 0 ? '+' : ''}${fChange}%)\n- Previous Close: $${fPrevClose.toFixed(2)}\n- Volume: ${fVolume.toLocaleString()}\n- Dividend Yield: 5.5% annual ($0.15 quarterly)\n\nMARKET VOLATILITY (VIX - for context):\n- VIX Current: ${vixCurrent.toFixed(2)} (${vixChange > 0 ? '+' : ''}${vixChange}%)\n- VIX 6-Month Average: ${vix6mAvg}\n- Market sentiment: ${vixCurrent < 15 ? 'LOW VOLATILITY - Good for selling puts' : vixCurrent < 20 ? 'MODERATE VOLATILITY - Normal conditions' : 'HIGH VOLATILITY - Be cautious'}\n\nDate: ${jstDate}\nTime: ${jstTime} JST\n\nüë§ MY TRADING PROFILE:\n- Account Size: $3,000 USD\n- Location: Japan (sleeping during US market hours)\n- Broker: Webull (manual execution, no API)\n- Strategy: THE WHEEL on QS and F stocks\n- Target Allocation: \n  * QS: ~$1,140 (1 contract / 100 shares)\n  * F: ~$1,330 (1 contract / 100 shares)\n  * Cash Reserve: ~$530 minimum\n- Goal: Generate monthly income through options premiums + F dividends\n\nüéØ THE WHEEL STRATEGY (My Approach):\n\nPHASE 1 - Sell Cash-Secured Puts:\n- Sell puts on QS and F to collect premium\n- If assigned ‚Üí own shares at good entry price\n- DTE: 30-45 days preferred\n- Delta: 0.20-0.30 (out of the money, ~10-15% below current price)\n\nPHASE 2 - If Assigned, Sell Covered Calls:\n- Sell calls above my cost basis\n- Collect premium while waiting for assignment\n- DTE: 30-45 days\n- Strike: 15-25% above cost basis\n\nPHASE 3 - Repeat:\n- If shares called away ‚Üí restart with cash-secured puts\n- If puts expire worthless ‚Üí sell new puts\n- Continuous income generation\n\nüì∏ MY CURRENT ACCOUNT STATUS:\nPlease analyze the screenshot of my Webull account that I attached.\n\nFrom the image, identify:\n- Current QS position (if any): shares owned, cost basis, P&L\n- Current F position (if any): shares owned, cost basis, P&L\n- Open options contracts: strikes, DTE, type (put/call), P&L\n- Available buying power\n- Total account value\n\nüéØ What should I do TODAY based on:\n1. Current QS price: $${qsPrice.toFixed(2)} and F price: $${fPrice.toFixed(2)}\n2. My current positions shown in the screenshot\n3. VIX level (${vixCurrent.toFixed(2)}) for market context\n4. My available capital\n5. Optimal Wheel strategy execution\n\nANALYSIS REQUIRED FOR EACH STOCK:\n\n**QS (QuantumScape) - High Risk/High Premium:**\nCurrent Status:\n- Today's price: $${qsPrice.toFixed(2)} (${qsChange > 0 ? '+' : ''}${qsChange}%)\n- Risk level: HIGH (pre-revenue, volatile)\n- Premium potential: HIGH (usually 5-7% monthly)\n\nWhat to do:\n- If I have NO position: Should I sell a cash-secured put? Which strike?\n- If I OWN shares: Should I sell a covered call? Which strike?\n- If I have an OPEN put: Should I roll, close, or let it expire?\n- If I have an OPEN call: Should I roll, close, or let it be assigned?\n\n**F (Ford Motor) - Lower Risk/Stable + Dividend:**\nCurrent Status:\n- Today's price: $${fPrice.toFixed(2)} (${fChange > 0 ? '+' : ''}${fChange}%)\n- Risk level: LOW (established company, dividend)\n- Premium potential: MODERATE (usually 3-4% monthly)\n- Dividend: $0.15/share quarterly (if I own shares)\n\nWhat to do:\n- If I have NO position: Should I sell a cash-secured put? Which strike?\n- If I OWN shares: Should I sell a covered call? Which strike?\n- If I have an OPEN put: Should I roll, close, or let it expire?\n- If I have an OPEN call: Should I roll, close, or let it be assigned?\n\nIMPORTANT GUIDELINES:\n- Max capital usage: 75% ($2,250 max on positions)\n- Min cash reserve: $500\n- QS strikes: Round to whole dollars (e.g., $10, $11, $12)\n- F strikes: Round to $0.50 increments (e.g., $12.50, $13.00, $13.50)\n- Always check earnings dates (avoid selling options during earnings week)\n- Prefer monthly expiration dates for liquidity\n- If VIX > 20: Be more conservative with strikes\n- If VIX < 15: Can be slightly more aggressive\n\n‚ö†Ô∏è RISK MANAGEMENT:\nQS Limits:\n- Don't sell puts below $8 (too risky)\n- If assigned, don't average down\n- Max loss tolerance: -$300 per position\n\nF Limits:\n- Don't sell puts below $11 (safe threshold)\n- If assigned, can hold long-term (dividends help)\n- Max loss tolerance: -$200 per position\n\nExit Rules:\n- Close options at 50% profit if available\n- If stock moves against put by >15%, consider rolling\n- If stock moves past call by >10%, let it be assigned (take profit)\n\nREQUIRED RESPONSE FORMAT:\n\nüü¢ SIGNAL: [SELL PUT QS / SELL PUT F / SELL CALL QS / SELL CALL F / HOLD / ADJUST / CLOSE]\n\nüìä MARKET ANALYSIS:\n[Brief analysis of QS and F price action today, VIX context]\n\nüíº ACCOUNT ANALYSIS:\n[What you see in my screenshot: current positions, options, buying power, P&L]\n\nüìç SPECIFIC ACTIONS:\n\nQS Recommendation:\nAction: [SELL PUT / SELL CALL / HOLD / ROLL / CLOSE]\nStrike: $X.XX\nDTE: X days (expiration date: MM/DD)\nPremium: $X.XX per contract ($XX total)\nMax risk if assigned: $XXX\nProbability of profit: ~XX%\n\nF Recommendation:\nAction: [SELL PUT / SELL CALL / HOLD / ROLL / CLOSE]\nStrike: $X.XX\nDTE: X days (expiration date: MM/DD)\nPremium: $X.XX per contract ($XX total)\nMax risk if assigned: $XXX\nProbability of profit: ~XX%\n+ Dividend: $X.XX quarterly if assigned\n\nüí° REASONING:\n[Why these specific strikes and actions make sense given current prices and market conditions]\n\n‚ö†Ô∏è RISKS TO CONSIDER:\n- QS: [Any upcoming earnings, news, technical levels]\n- F: [Any upcoming earnings, news, sector developments]\n- Market: [VIX levels, upcoming economic data]\n\nüí∞ EXPECTED INCOME:\nThis month's premium: $XXX\nF dividends (if holding shares): $XXX\nTotal monthly income: $XXX\nAnnual projection (if consistent): $X,XXX (XX% ROI)\n\nüìà PORTFOLIO PROJECTION (30 days):\nBest case: $X,XXX (if options expire worthless)\nExpected case: $X,XXX (normal scenario)\nWorst case: $X,XXX (if assigned at strikes)\n\nüéØ EXECUTION CHECKLIST:\n1. [ ] Check QS earnings date (avoid if within 2 weeks)\n2. [ ] Check F earnings date (avoid if within 2 weeks)\n3. [ ] Confirm buying power covers margin requirements\n4. [ ] Set calendar reminder for options expiration\n5. [ ] Monitor positions weekly for adjustments`;\n\nreturn [{\n  json: {\n    prompt: prompt,\n    marketData: {\n      qsPrice: qsPrice,\n      qsChange: parseFloat(qsChange),\n      fPrice: fPrice,\n      fChange: parseFloat(fChange),\n      vix: vixCurrent,\n      vix6mAvg: parseFloat(vix6mAvg),\n      date: jstDate,\n      time: jstTime\n    }\n  }\n}];"
          },
          "id": "5ff6ea37-a595-4483-81ad-5563cbcbd836",
          "name": "üß† Build AI Prompt",
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            544,
            352
          ]
        },
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "30 22 * * *"
                }
              ]
            }
          },
          "id": "ec41243e-97ec-4069-92ea-23bddf9d4f0f",
          "name": "Pre-Apertura NYSE 22:30 JST",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            -224,
            464
          ]
        },
        {
          "parameters": {
            "rule": {
              "interval": [
                {
                  "field": "cronExpression",
                  "expression": "30 6 * * *"
                }
              ]
            }
          },
          "id": "df67b0c8-af77-4ce7-89c7-58faed36d903",
          "name": "Post-Cierre 06:30 JST",
          "type": "n8n-nodes-base.scheduleTrigger",
          "typeVersion": 1.1,
          "position": [
            -224,
            304
          ]
        },
        {
          "parameters": {
            "numberInputs": 3
          },
          "type": "n8n-nodes-base.merge",
          "typeVersion": 3.2,
          "position": [
            384,
            336
          ],
          "id": "5be80cd2-49b0-4396-829b-e556f49a0a7f",
          "name": "Merge"
        },
        {
          "parameters": {
            "updates": [
              "message",
              "callback_query"
            ],
            "additionalFields": {}
          },
          "type": "n8n-nodes-base.telegramTrigger",
          "typeVersion": 1.1,
          "position": [
            -752,
            -464
          ],
          "id": "e55b21a4-e016-42ec-9aab-064042865edd",
          "name": "Telegram Trigger",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram ThetaSentinelBot"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/help",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -272,
            -464
          ],
          "id": "e1a5172e-6b75-4747-ae55-abc4d693ba88",
          "name": "If7"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
            "text": "=this is the help for the commands that you can use Chimo. \n/run              # is going analitic\n/upload        # is going upload your current positions",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -64,
            -480
          ],
          "id": "102159b5-9149-4191-9d81-3d7447352ec2",
          "name": "Telegram15",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram ThetaSentinelBot"
            }
          }
        },
        {
          "parameters": {
            "content": "## Help\n\n",
            "height": 80
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -560,
            -464
          ],
          "id": "ee2faccd-a825-4374-a521-a4d8272aa87e",
          "name": "Sticky Note"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.caption }}",
                  "rightValue": "/upload",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -272,
            -208
          ],
          "id": "16143096-9b11-4072-a801-64379f1a4e21",
          "name": "If5"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
            "text": "I'm working on your upload",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -64,
            -224
          ],
          "id": "df6d9884-323b-4ac8-8bdb-eeb18fda62ce",
          "name": "Telegram13",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram ThetaSentinelBot"
            }
          }
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code12').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            544,
            -224
          ],
          "id": "4572cd0d-2e49-4225-bd75-9d66870ea562",
          "name": "FTP6",
          "retryOnFail": true,
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const filename = \"currentPosition.jpg\";\n\n// Aseg√∫rate de que el binary data tambi√©n se pase correctamente\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/ThetaSentinel/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/ThetaSentinel/images/${filename}`\n    },\n    binary: items[0].binary // Esto pasa el binary data al siguiente paso\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            144,
            -224
          ],
          "id": "77a72838-2bff-43eb-813c-9109cf7564e7",
          "name": "Code12"
        },
        {
          "parameters": {
            "resource": "file",
            "fileId": "={{ $('If5').item.json.message.document.file_id }}",
            "additionalFields": {}
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            352,
            -224
          ],
          "id": "9794ceb8-dd33-487e-a6f0-77807a1bb439",
          "name": "Telegram23",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram ThetaSentinelBot"
            }
          }
        },
        {
          "parameters": {
            "operation": "sendPhoto",
            "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
            "binaryData": true,
            "additionalFields": {
              "caption": "={{ $('Code12').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            752,
            -240
          ],
          "id": "3fda2d2a-b9c3-4871-965d-a2a22c9b4cd2",
          "name": "Telegram25",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram ThetaSentinelBot"
            }
          }
        },
        {
          "parameters": {
            "content": "## Upload\n\n",
            "height": 80
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -592,
            -192
          ],
          "id": "388326b5-507a-4350-85e0-7a51c6ca264f",
          "name": "Sticky Note9"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/run",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -256,
            48
          ],
          "id": "110b8be2-2e26-4b69-8db5-2cfaae66ca7a",
          "name": "If"
        },
        {
          "parameters": {
            "content": "## RUN\n\n\n",
            "height": 80
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -560,
            -16
          ],
          "id": "c871322e-10d3-4bf1-be63-619e31635754",
          "name": "Sticky Note1"
        },
        {
          "parameters": {
            "resource": "image",
            "modelId": {
              "__rl": true,
              "value": "claude-haiku-4-5-20251001",
              "mode": "list",
              "cachedResultName": "claude-haiku-4-5-20251001"
            },
            "text": "={{ $json.prompt }}",
            "imageUrls": "https://lemonsushi.com/uploads/ThetaSentinel/images/currentPosition.jpg",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.anthropic",
          "typeVersion": 1,
          "position": [
            704,
            336
          ],
          "id": "3e34dbeb-9505-42c4-bd48-a2a94e2e9a59",
          "name": "Analyze image",
          "credentials": {
            "anthropicApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Anthropic n8n"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Extraer respuesta de Claude\nconst response = $input.first().json;\nconst claudeResponse = response.content[0].text;\n\n// Obtener datos de mercado\nconst marketData = $('üß† Build AI Prompt').first().json.marketData || {};\n\n// Generar nombre de archivo con timestamp\nconst now = new Date();\nconst timestamp = now.toISOString().slice(0, 19).replace(/:/g, '-');\nconst filename = `wheel_analysis_${timestamp}.html`;\n\n// Crear HTML con estilos profesionales\nconst htmlContent = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Wheel Strategy Analysis - ${marketData.date}</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            padding: 20px;\n            line-height: 1.6;\n        }\n        \n        .container {\n            max-width: 900px;\n            margin: 0 auto;\n            background: white;\n            border-radius: 16px;\n            box-shadow: 0 20px 60px rgba(0,0,0,0.3);\n            overflow: hidden;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            color: white;\n            padding: 30px;\n            text-align: center;\n        }\n        \n        .header h1 {\n            font-size: 28px;\n            margin-bottom: 10px;\n            font-weight: 700;\n        }\n        \n        .header .subtitle {\n            font-size: 14px;\n            opacity: 0.9;\n            display: flex;\n            justify-content: center;\n            gap: 20px;\n            margin-top: 10px;\n        }\n        \n        .market-overview {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n            padding: 30px;\n            background: #f8f9fa;\n            border-bottom: 1px solid #e0e0e0;\n        }\n        \n        .stock-card {\n            background: white;\n            padding: 20px;\n            border-radius: 12px;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n            border-left: 4px solid #2a5298;\n        }\n        \n        .stock-card h3 {\n            font-size: 16px;\n            color: #2a5298;\n            margin-bottom: 10px;\n        }\n        \n        .stock-price {\n            font-size: 32px;\n            font-weight: 700;\n            color: #1e3c72;\n            margin: 10px 0;\n        }\n        \n        .stock-change {\n            font-size: 18px;\n            font-weight: 600;\n            padding: 5px 10px;\n            border-radius: 6px;\n            display: inline-block;\n        }\n        \n        .positive {\n            color: #10b981;\n            background: #d1fae5;\n        }\n        \n        .negative {\n            color: #ef4444;\n            background: #fee2e2;\n        }\n        \n        .content {\n            padding: 30px;\n        }\n        \n        .content h2 {\n            color: #1e3c72;\n            margin-top: 30px;\n            margin-bottom: 15px;\n            font-size: 22px;\n            border-bottom: 3px solid #2a5298;\n            padding-bottom: 10px;\n        }\n        \n        .content h3 {\n            color: #2a5298;\n            margin-top: 20px;\n            margin-bottom: 10px;\n            font-size: 18px;\n        }\n        \n        .content p, .content ul, .content ol {\n            margin-bottom: 15px;\n            color: #333;\n        }\n        \n        .content ul, .content ol {\n            margin-left: 25px;\n        }\n        \n        .content li {\n            margin-bottom: 8px;\n        }\n        \n        .signal-box {\n            background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n            color: white;\n            padding: 20px;\n            border-radius: 12px;\n            margin: 20px 0;\n            font-size: 20px;\n            font-weight: 700;\n            text-align: center;\n            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);\n        }\n        \n        .warning-box {\n            background: #fef3c7;\n            border-left: 4px solid #f59e0b;\n            padding: 15px;\n            border-radius: 8px;\n            margin: 20px 0;\n        }\n        \n        .info-box {\n            background: #dbeafe;\n            border-left: 4px solid #3b82f6;\n            padding: 15px;\n            border-radius: 8px;\n            margin: 20px 0;\n        }\n        \n        .action-card {\n            background: #f8f9fa;\n            padding: 20px;\n            border-radius: 12px;\n            margin: 15px 0;\n            border: 2px solid #e0e0e0;\n        }\n        \n        .action-card h4 {\n            color: #1e3c72;\n            margin-bottom: 10px;\n            font-size: 18px;\n        }\n        \n        .footer {\n            background: #1e3c72;\n            color: white;\n            padding: 20px;\n            text-align: center;\n            font-size: 14px;\n        }\n        \n        pre {\n            background: #f4f4f4;\n            padding: 15px;\n            border-radius: 8px;\n            overflow-x: auto;\n            font-size: 14px;\n            line-height: 1.4;\n        }\n        \n        code {\n            background: #f4f4f4;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 14px;\n        }\n        \n        @media (max-width: 768px) {\n            body {\n                padding: 10px;\n            }\n            \n            .header h1 {\n                font-size: 22px;\n            }\n            \n            .stock-price {\n                font-size: 24px;\n            }\n            \n            .market-overview {\n                padding: 15px;\n            }\n            \n            .content {\n                padding: 20px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>üéØ Wheel Strategy Analysis</h1>\n            <div class=\"subtitle\">\n                <span>üìÖ ${marketData.date || 'N/A'}</span>\n                <span>üïê ${marketData.time || 'N/A'} JST</span>\n            </div>\n        </div>\n        \n        <div class=\"market-overview\">\n            <div class=\"stock-card\">\n                <h3>QS (QuantumScape)</h3>\n                <div class=\"stock-price\">$${marketData.qsPrice?.toFixed(2) || 'N/A'}</div>\n                <div class=\"stock-change ${marketData.qsChange >= 0 ? 'positive' : 'negative'}\">\n                    ${marketData.qsChange >= 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(marketData.qsChange || 0).toFixed(2)}%\n                </div>\n            </div>\n            \n            <div class=\"stock-card\">\n                <h3>F (Ford Motor)</h3>\n                <div class=\"stock-price\">$${marketData.fPrice?.toFixed(2) || 'N/A'}</div>\n                <div class=\"stock-change ${marketData.fChange >= 0 ? 'positive' : 'negative'}\">\n                    ${marketData.fChange >= 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(marketData.fChange || 0).toFixed(2)}%\n                </div>\n            </div>\n            \n            <div class=\"stock-card\">\n                <h3>VIX (Volatility Index)</h3>\n                <div class=\"stock-price\">${marketData.vix?.toFixed(2) || 'N/A'}</div>\n                <div class=\"stock-change\" style=\"background: #e0e7ff; color: #4f46e5;\">\n                    6M Avg: ${marketData.vix6mAvg || 'N/A'}\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"content\">\n            <pre style=\"white-space: pre-wrap; word-wrap: break-word;\">${claudeResponse}</pre>\n        </div>\n        \n        <div class=\"footer\">\n            <p>ü§ñ Generated by Theta Sentinel AI</p>\n            <p style=\"margin-top: 5px; font-size: 12px; opacity: 0.8;\">\n                Automated Options Analysis System\n            </p>\n        </div>\n    </div>\n</body>\n</html>`;\n\nreturn [{\n  json: {\n    filename: filename,\n    htmlContent: htmlContent,\n    marketData: marketData,\n    claudeResponse: claudeResponse\n  }\n}];"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            960,
            144
          ],
          "id": "821b15f3-f9dc-48ec-8311-c45176730bf3",
          "name": "Create html report"
        },
        {
          "parameters": {
            "jsCode": "// Obtener datos del nodo anterior\nconst data = $input.first().json;\n\n// La respuesta de Claude viene en content[0].text\nlet claudeResponse = '';\n\nif (data.claudeResponse) {\n  claudeResponse = data.claudeResponse;\n} else if (data.content && Array.isArray(data.content) && data.content[0]?.text) {\n  claudeResponse = data.content[0].text;\n} else if (data.message?.content && Array.isArray(data.message.content) && data.message.content[0]?.text) {\n  claudeResponse = data.message.content[0].text;\n} else if (typeof data === 'string') {\n  claudeResponse = data;\n} else {\n  throw new Error('Could not find Claude response in input data');\n}\n\nif (!claudeResponse || typeof claudeResponse !== 'string') {\n  throw new Error('Claude response is not a valid string');\n}\n\n// Extraer datos de mercado del texto de Claude\nlet marketData = {\n  qsPrice: null,\n  qsChange: null,\n  fPrice: null,\n  fChange: null,\n  vix: null,\n  vix6mAvg: null,\n  time: null,\n  date: null\n};\n\n// Extraer QS price y change\nconst qsMatch = claudeResponse.match(/QS.*?\\$?([\\d.]+)\\s*\\(([+-][\\d.]+)%\\)/i);\nif (qsMatch) {\n  marketData.qsPrice = parseFloat(qsMatch[1]);\n  marketData.qsChange = parseFloat(qsMatch[2]);\n}\n\n// Extraer F price y change\nconst fMatch = claudeResponse.match(/F.*?Ford.*?\\$?([\\d.]+)\\s*\\(([+-][\\d.]+)%\\)/i);\nif (fMatch) {\n  marketData.fPrice = parseFloat(fMatch[1]);\n  marketData.fChange = parseFloat(fMatch[2]);\n}\n\n// Extraer VIX\nconst vixMatch = claudeResponse.match(/VIX(?:\\s+at|\\s+Current:)?\\s*(\\d+\\.?\\d*)/i);\nif (vixMatch) {\n  marketData.vix = parseFloat(vixMatch[1]);\n  marketData.vix6mAvg = parseFloat(vixMatch[1]);\n}\n\n// Extraer fecha y hora\nconst dateMatch = claudeResponse.match(/Date:\\s*(\\d+\\/\\d+\\/\\d+)/i);\nif (dateMatch) {\n  marketData.date = dateMatch[1];\n}\n\nconst timeMatch = claudeResponse.match(/Time:\\s*([\\d:]+\\s*(?:AM|PM)?)/i);\nif (timeMatch) {\n  marketData.time = timeMatch[1];\n}\n\n// Extraer SIGNAL\nlet signal = 'N/A';\nconst signalMatch = claudeResponse.match(/üü¢ SIGNAL:\\s*\\*?(.+?)\\*?(?:\\n|$)/i);\nif (signalMatch) {\n  signal = signalMatch[1].trim().replace(/\\*\\*/g, '');\n}\n\n// Extraer QS Action\nlet qsAction = 'N/A';\nconst qsRecommendationMatch = claudeResponse.match(/### \\*\\*QS RECOMMENDATION:[\\s\\S]*?Action:\\*?\\s*(.+?)(?:\\n|$)/i);\nif (qsRecommendationMatch) {\n  qsAction = qsRecommendationMatch[1].trim().replace(/\\*\\*/g, '');\n  \n  const qsStrikeMatch = claudeResponse.match(/### \\*\\*QS RECOMMENDATION:[\\s\\S]*?Strike:\\*?\\s*\\$?([\\d.]+)/i);\n  const qsPremiumMatch = claudeResponse.match(/### \\*\\*QS RECOMMENDATION:[\\s\\S]*?Premium:\\*?\\s*~?\\$?([\\d.-]+)/i);\n  \n  if (qsStrikeMatch && qsPremiumMatch) {\n    qsAction = `${qsAction} @ $${qsStrikeMatch[1]} (${qsPremiumMatch[1]} premium)`;\n  }\n}\n\n// Extraer F Action\nlet fAction = 'N/A';\nconst fRecommendationMatch = claudeResponse.match(/### \\*\\*F RECOMMENDATION:[\\s\\S]*?Action:\\*?\\s*(.+?)(?:\\n|$)/i);\nif (fRecommendationMatch) {\n  fAction = fRecommendationMatch[1].trim().replace(/\\*\\*/g, '');\n  \n  const fStrikeMatch = claudeResponse.match(/### \\*\\*F RECOMMENDATION:[\\s\\S]*?Strike:\\*?\\s*\\$?([\\d.]+)/i);\n  const fPremiumMatch = claudeResponse.match(/### \\*\\*F RECOMMENDATION:[\\s\\S]*?Premium:\\*?\\s*~?\\$?([\\d.-]+)/i);\n  \n  if (fStrikeMatch && fPremiumMatch) {\n    fAction = `${fAction} @ $${fStrikeMatch[1]} (${fPremiumMatch[1]} premium)`;\n  }\n}\n\n// Extraer Expected Income\nlet expectedIncome = 'N/A';\nlet incomeMatch = claudeResponse.match(/This month[''']?s? premium:\\s*\\$?([\\d,]+)/i);\nif (!incomeMatch) {\n  incomeMatch = claudeResponse.match(/Monthly premium:\\s*\\$?([\\d,]+)/i);\n}\nif (incomeMatch) {\n  expectedIncome = `$${incomeMatch[1]}`;\n}\n\n// Funci√≥n para escapar caracteres especiales de Telegram Markdown\nfunction escapeTelegramMarkdown(text) {\n  if (!text) return '';\n  return text\n    .replace(/\\\\/g, '\\\\\\\\')   // Backslash\n    .replace(/`/g, '\\\\`')     // Backticks\n    .replace(/_/g, '\\\\_')     // Underscore\n    .replace(/\\*/g, '\\\\*')    // Asterisk\n    .replace(/\\[/g, '\\\\[')    // Left bracket\n    .replace(/\\]/g, '\\\\]')    // Right bracket\n    .replace(/\\(/g, '\\\\(')    // Left paren\n    .replace(/\\)/g, '\\\\)')    // Right paren\n    .replace(/~/g, '\\\\~')     // Tilde\n    .replace(/`/g, '\\\\`')     // Backtick\n    .replace(/>/g, '\\\\>')     // Greater than\n    .replace(/</g, '\\\\<')     // Less than\n    .replace(/\\|/g, '\\\\|');   // Pipe\n}\n\n// Escapar los valores extra√≠dos\nconst escapedSignal = escapeTelegramMarkdown(signal);\nconst escapedQsAction = escapeTelegramMarkdown(qsAction);\nconst escapedFAction = escapeTelegramMarkdown(fAction);\nconst escapedIncome = escapeTelegramMarkdown(expectedIncome);\n\n// Crear mensaje SIMPLE sin Markdown\nconst telegramMessage = `WHEEL STRATEGY - QS & F ANALYSIS\n\nSIGNAL: ${escapedSignal}\n\nMarket Status:\nQS: $${marketData.qsPrice?.toFixed(2) || 'N/A'} (${marketData.qsChange >= 0 ? '+' : ''}${marketData.qsChange?.toFixed(2) || 'N/A'}%)\nF: $${marketData.fPrice?.toFixed(2) || 'N/A'} (${marketData.fChange >= 0 ? '+' : ''}${marketData.fChange?.toFixed(2) || 'N/A'}%)\nVIX: ${marketData.vix?.toFixed(2) || 'N/A'} (Low volatility env)\n\nQuick Actions:\nQS: ${escapedQsAction}\nF: ${escapedFAction}\n\nExpected Income: ${escapedIncome}/month\nTime: ${marketData.time || ''} JST (${marketData.date || ''})`;\n\n// RETORNAR\nreturn [{\n  json: {\n    text: telegramMessage,\n    marketData: marketData,\n    signal: signal,\n    qsAction: qsAction,\n    fAction: fAction,\n    expectedIncome: expectedIncome\n  }\n}];"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            928,
            432
          ],
          "id": "6e8efc6f-a51c-4381-8cca-6d086e4145d8",
          "name": "Extract summary telegram",
          "disabled": true
        },
        {
          "parameters": {
            "chatId": "=6407630145",
            "text": "={{ $json.text }}",
            "replyMarkup": "forceReply",
            "forceReply": {},
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            1216,
            448
          ],
          "id": "835fb57e-129e-4daa-8e44-e4fe959956b4",
          "name": "Telegram",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram ThetaSentinelBot"
            }
          },
          "disabled": true
        },
        {
          "parameters": {
            "jsCode": "// Obtener datos del nodo anterior\nconst data = $input.first().json;\nconst filename = data.filename;\nconst htmlContent = data.htmlContent;\n\nif (!htmlContent) {\n  throw new Error('No HTML content found');\n}\n\n// Convertir HTML string a buffer/binario\nconst buffer = Buffer.from(htmlContent, 'utf8');\nconst base64 = buffer.toString('base64');\n\nreturn [{\n  json: {\n    filename: filename,\n    success: true,\n    message: `HTML file ready for download: ${filename}`\n  },\n  binary: {\n    htmlFile: {\n      data: base64,\n      mimetype: 'text/html',\n      filename: filename\n    }\n  }\n}];"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1152,
            144
          ],
          "id": "a49ff5fc-de72-4786-bee6-84bd246ef976",
          "name": "Code in JavaScript"
        },
        {
          "parameters": {
            "jsCode": "// Obtener datos del nodo anterior\nconst data = $input.first().json;\nconst filename = $input.first().json.filename;\nconst htmlContent = $('Create html report').first().json.htmlContent;\n\nif (!htmlContent) {\n  throw new Error('No HTML content found');\n}\n\n// Convertir HTML string a buffer/binario\nconst buffer = Buffer.from(htmlContent, 'utf8');\nconst base64 = buffer.toString('base64');\n\n// Paths para FTP\nconst ftpPath = `/public_html/uploads/ThetaSentinel/reports/${filename}`;\nconst publicUrl = `https://lemonsushi.com/uploads/ThetaSentinel/reports/${filename}`;\n\nreturn [{\n  json: {\n    filename: filename,\n    filepath: ftpPath,\n    publicUrl: publicUrl,\n    success: true,\n    message: `HTML file ready: ${filename}`,\n    downloadUrl: publicUrl\n  },\n  binary: {\n    htmlFile: {\n      data: base64,\n      mimetype: 'text/html',\n      filename: filename\n    }\n  }\n}];"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            1344,
            160
          ],
          "id": "f95ccecd-51fe-428f-a735-0c1a365220cc",
          "name": "Code in JavaScript1"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $json.filepath }}",
            "binaryPropertyName": "htmlFile"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            1520,
            144
          ],
          "id": "6b9c7f72-e216-4b26-9d3e-d1f7146c5741",
          "name": "FTP",
          "retryOnFail": true,
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "chatId": "=6407630145",
            "text": "={{ $json.publicUrl }}",
            "replyMarkup": "forceReply",
            "forceReply": {},
            "additionalFields": {
              "appendAttribution": false,
              "parse_mode": "HTML"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            1728,
            128
          ],
          "id": "661d87db-8d3f-4a79-859a-cfaafc787d76",
          "name": "Telegram26",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Telegram ThetaSentinelBot"
            }
          }
        }
      ],
      "connections": {
        "üìä Get VIX Data": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 2
              }
            ]
          ]
        },
        "üß† Build AI Prompt": {
          "main": [
            [
              {
                "node": "Analyze image",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Pre-Apertura NYSE 22:30 JST": {
          "main": [
            [
              {
                "node": "üìä Get VIX Data",
                "type": "main",
                "index": 0
              },
              {
                "node": "üöó Get F Price",
                "type": "main",
                "index": 0
              },
              {
                "node": "üìà Get QS Price",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Post-Cierre 06:30 JST": {
          "main": [
            [
              {
                "node": "üìä Get VIX Data",
                "type": "main",
                "index": 0
              },
              {
                "node": "üöó Get F Price",
                "type": "main",
                "index": 0
              },
              {
                "node": "üìà Get QS Price",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Merge": {
          "main": [
            [
              {
                "node": "üß† Build AI Prompt",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram Trigger": {
          "main": [
            [
              {
                "node": "If7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If7": {
          "main": [
            [
              {
                "node": "Telegram15",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If5": {
          "main": [
            [
              {
                "node": "Telegram13",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram13": {
          "main": [
            [
              {
                "node": "Code12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP6": {
          "main": [
            [
              {
                "node": "Telegram25",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code12": {
          "main": [
            [
              {
                "node": "Telegram23",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram23": {
          "main": [
            [
              {
                "node": "FTP6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If": {
          "main": [
            [
              {
                "node": "üìä Get VIX Data",
                "type": "main",
                "index": 0
              },
              {
                "node": "üöó Get F Price",
                "type": "main",
                "index": 0
              },
              {
                "node": "üìà Get QS Price",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Analyze image": {
          "main": [
            [
              {
                "node": "Create html report",
                "type": "main",
                "index": 0
              },
              {
                "node": "Extract summary telegram",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "üöó Get F Price": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 1
              }
            ]
          ]
        },
        "üìà Get QS Price": {
          "main": [
            [
              {
                "node": "Merge",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Extract summary telegram": {
          "main": [
            [
              {
                "node": "Telegram",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Create html report": {
          "main": [
            [
              {
                "node": "Code in JavaScript",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code in JavaScript": {
          "main": [
            [
              {
                "node": "Code in JavaScript1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code in JavaScript1": {
          "main": [
            [
              {
                "node": "FTP",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP": {
          "main": [
            [
              {
                "node": "Telegram26",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "authors": "system migration",
      "name": null,
      "description": null,
      "autosaved": false
    },
    "tags": []
  },
  {
    "updatedAt": "2025-11-09T14:08:50.000Z",
    "createdAt": "2025-04-02T12:57:57.796Z",
    "id": "UolXmPAEZdI7C2Q9",
    "name": "LS_ProdAi_Pets",
    "active": true,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/black-forest-labs/flux-dev-lora/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"go_fast\": true,\n    \"guidance\": 3,\n    \"lora_scale\": 1,\n    \"megapixels\": \"1\",\n    \"num_outputs\": 1,\n    \"aspect_ratio\": \"9:16\",\n    \"lora_weights\": \"\",\n    \"output_format\": \"jpg\",\n    \"output_quality\": 80,\n    \"prompt_strength\": 0.8,\n    \"num_inference_steps\": 28\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          0,
          624
        ],
        "id": "958808a9-a237-4bf0-b93a-eb5204c2f96d",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?image\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -160,
          624
        ],
        "id": "f4cd4061-549a-48ff-bc76-ce28fe989d98",
        "name": "Code"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          304,
          624
        ],
        "id": "9817017f-8494-490a-a556-9fb772ef9a8d",
        "name": "HTTP Request1"
      },
      {
        "parameters": {
          "amount": 10
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          144,
          624
        ],
        "id": "825fdeb3-9d6f-4450-9ed6-954538aa5a08",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {
            "download": false
          }
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          -768,
          -16
        ],
        "id": "7bc7611f-de73-41ec-bb86-d47c6e5dd988",
        "name": "Telegram Trigger1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/script",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -544,
          288
        ],
        "id": "1744fe91-8d62-49c5-860a-07ec0a9fceed",
        "name": "If1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "Based on the following example, generate a new, highly detailed prompt for a photorealistic AI image that fits within the category of extremely cute animals performing everyday activities. The new prompt must clearly describe a specific animal character engaged in a mundane yet visually engaging activity within a realistic physical setting. Emphasize clear, tangible visual details that could be easily transformed into a detailed image: precisely describe the foreground, middle ground, and background. Include detailed descriptions of materials, shapes, textures, lighting conditions, and the physical environment. Mention surrounding objects, surfaces, walls, lighting sources, and other elements that contribute to realism.\n\nThe image should evoke warmth, joy, and charm through specific, clearly visible details, similar to a scene captured by a high-end camera. Avoid emotional or abstract descriptions; instead, focus strictly on concrete visual elements. Clearly describe the camera angle, lens type, aperture setting, lighting style (natural, diffused, ambient), and depth of field. Specifically mention at least five distinct visible objects or elements beyond the main subject.\n\nWrite as if creating precise instructions for a 3D artist or AI image generator. Prioritize visual clarity, realism, and cinematic composition. Everything should be contained in one cohesive paragraph.\n\nExample:\nA highly detailed 3D-rendered image depicting an adorable baby bunny character sleeping peacefully on its back in a miniature wooden bed, presented in a Pixar-inspired 3D animation style, even cuter and softer than characters from Zootopia. The bunny features smooth, rounded shapes, distinctly fluffy and soft-looking fur textures in delicate shades of beige and creamy white, gently shut eyes with soft eyelashes, a small round nose, and a subtle smiling expression. Its tiny paws rest gently atop the beige linen blanket, which is neatly tucked around its body, highlighting clear fabric weave details. A matching soft-textured pillow comfortably supports the bunny‚Äôs head. Surrounding the bed are visible elements enhancing realism: polished hardwood flooring, semi-transparent cream-colored curtains filtering diffused natural sunlight, a plain beige wall with subtle texture, a neatly painted baseboard trim, and partially visible edges of a window. Soft shadows beneath the furniture and gentle fabric folds add depth and realism. The scene is captured from an elevated angle looking downward, utilizing an 85mm lens with an aperture of f/2.0, resulting in a shallow depth of field, sharply focusing on the bunny and bed, smoothly transitioning into a softly blurred, inviting background. Natural diffused lighting provides delicate highlights, emphasizing textures of fur, wood, and fabric, clearly visible and reinforcing a gentle, nostalgic, and visually inviting composition.",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.8,
        "position": [
          -176,
          272
        ],
        "id": "9f01dcd1-e954-4efb-bff8-ce42f3f72f0a",
        "name": "AI Agent"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          -208,
          432
        ],
        "id": "544f515b-df64-46dd-9ed6-3980a9a3fb4a",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "={{ $json.cleanedOutput }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          320,
          272
        ],
        "id": "0b951827-839a-4493-a710-dab3ff17e445",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your script",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -336,
          272
        ],
        "id": "67434bb1-8e71-4e5b-8a85-7ca8d6662a38",
        "name": "Telegram1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/image",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -544,
          640
        ],
        "id": "6b06cb6e-14b2-4a4a-9868-e688c55fe874",
        "name": "If"
      },
      {
        "parameters": {
          "operation": "sendPhoto",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request1').item.json.output[0] }}",
          "additionalFields": {
            "caption": "={{ $('Code4').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1168,
          624
        ],
        "id": "05e07cff-e9fb-46ce-b2ad-7d1233010a3d",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your image",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -336,
          624
        ],
        "id": "d9061403-cb19-438b-acc0-8021caeb7522",
        "name": "Telegram3",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          -80,
          432
        ],
        "id": "0b9d4d22-154a-4104-85b8-d092119cb706",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/video",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -544,
          944
        ],
        "id": "c9d17480-e8e0-4e9b-962b-0b3e2b43bb55",
        "name": "If2"
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // Verifica si comienza y termina con comillas dobles\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          144,
          272
        ],
        "id": "fd3ef022-6dee-47c0-adaf-afad002ee121",
        "name": "Code1"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?video\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -208,
          928
        ],
        "id": "46073475-49ef-442d-98f2-7a46bf43cb37",
        "name": "Code2"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your video",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -368,
          928
        ],
        "id": "68750717-03e8-4096-bd91-8429858338e9",
        "name": "Telegram5",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/kwaivgi/kling-v1.6-pro/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"motion\",\n    \"duration\": 5,\n    \"cfg_scale\": 0.5,\n    \"start_image\": \"{{ $json.prompt }}\",\n    \"aspect_ratio\": \"9:16\",\n    \"negative_prompt\": \"\"\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -48,
          928
        ],
        "id": "74fb302e-053f-4938-aff4-d05aa4203fb1",
        "name": "HTTP Request2"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request3').item.json.output }}",
          "additionalFields": {
            "caption": "={{ $('Code5').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1184,
          928
        ],
        "id": "96520b18-f648-43e0-8f5e-1bca65495d79",
        "name": "Telegram6",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          272,
          928
        ],
        "id": "5c0b9e4e-62db-47bd-8509-3e3c9d4ce5b9",
        "name": "HTTP Request3",
        "retryOnFail": true,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "amount": 7,
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          112,
          928
        ],
        "id": "8cd8fce9-4c49-49eb-8664-c2649b2aa69e",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/bake",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -528,
          1248
        ],
        "id": "f3f17d83-e3c2-4899-8258-a4ab7457ce38",
        "name": "If3"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your bake",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -320,
          1248
        ],
        "id": "03611cb9-49b2-40fc-a1f9-144ae43ccb53",
        "name": "Telegram7",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.prompt }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          400,
          1248
        ],
        "id": "fd7dcc67-8c36-426d-95cc-36af0e37ba69",
        "name": "Execute Command"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?bake\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          240,
          1248
        ],
        "id": "563b153f-4541-420e-b8c7-7a3413aef496",
        "name": "Code3"
      },
      {
        "parameters": {
          "command": "=ffmpeg -y \\\n-i /tmp/generated.mp4 \\\n-ss {{ $('Code7').item.json.startSecond }} -i /tmp/music.mp3 \\\n-map 0:v -map 1:a:0 -shortest \\\n-c:v libx264 -c:a aac -b:a 192k -preset veryfast \\\n/tmp/video_watermarked.mp4\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          560,
          1248
        ],
        "id": "26cdd979-c229-471e-a256-e3a8563db548",
        "name": "Execute Command1"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code6').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1232,
          1248
        ],
        "id": "44f904cf-0fce-4459-884b-3595f6ab5fb3",
        "name": "Telegram8",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "fileSelector": "/tmp/video_watermarked.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          880,
          1248
        ],
        "id": "9e869211-7531-41a9-a163-53a2e94f955f",
        "name": "Read/Write Files from Disk"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request1').item.json.output[0] }}\" -O /tmp/generated.jpg"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          624,
          624
        ],
        "id": "0ac67d77-948f-486b-b5c2-2758d26e579d",
        "name": "Execute Command2"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.jpg",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          800,
          624
        ],
        "id": "6c350637-c42b-4d97-89ef-e086dc021726",
        "name": "Read/Write Files from Disk1"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code4').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1008,
          624
        ],
        "id": "df070366-e806-43e4-97c1-bece2a19441a",
        "name": "FTP1",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          464,
          624
        ],
        "id": "97e10c04-4fb3-4235-a8aa-1d3d87c2aa86",
        "name": "Code4"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request3').item.json.output }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          624,
          928
        ],
        "id": "44c60eee-5071-4580-b784-85ffeb7d69fd",
        "name": "Execute Command3"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          800,
          928
        ],
        "id": "1ce5b256-a87f-4786-a0b2-6a6ffcfafe5a",
        "name": "Read/Write Files from Disk2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code5').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1008,
          928
        ],
        "id": "47d29288-0501-4a15-bd9f-86c86e96708d",
        "name": "FTP",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          448,
          928
        ],
        "id": "96a2acae-6a83-4070-85e7-45df158f188d",
        "name": "Code5"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          720,
          1248
        ],
        "id": "48f41b4e-2074-474f-87bc-a60b19adb656",
        "name": "Code6"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code6').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1072,
          1248
        ],
        "id": "8c3c0862-35dd-460a-8e7b-1767e6eb225d",
        "name": "FTP2",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Lista de audios actualizada\nconst audios = [\n  \"https://lemonsushi.com/uploads/pets/audios/Fun.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/happyPiano.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/newBaby.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/ThisKids.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/upbeat.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/version2.mp3\"\n];\n\n// Elegir un audio al azar\nconst selectedAudio = audios[Math.floor(Math.random() * audios.length)];\n\n// Generar un segundo de inicio entre 5 y 15\nconst startSecond = Math.floor(Math.random() * 11) + 5;\n\nreturn [\n  {\n    json: {\n      audioUrl: selectedAudio,\n      startSecond: startSecond\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -128,
          1248
        ],
        "id": "805ff6ec-ef68-4f17-9cb5-ba9a1903c3b1",
        "name": "Code7"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.audioUrl }}\" -O /tmp/music.mp3"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          48,
          1248
        ],
        "id": "45236b4d-ea75-4420-a4cd-f83c787fea52",
        "name": "Execute Command4"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/publish",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -528,
          1488
        ],
        "id": "742ababa-ef6d-43ab-9d5c-27bd53fe9927",
        "name": "If4"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your publish",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -320,
          1472
        ],
        "id": "a1028cc3-8ae8-4b2b-8940-268a81627410",
        "name": "Telegram9",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?publish\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -128,
          1472
        ],
        "id": "f9e3ea2f-3727-4ccb-8c35-5bf507ac0763",
        "name": "Code8"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=You are an expert in creating viral content for TikTok and YouTube Shorts. Your task is to generate a **short, catchy, and emotional title** based on this video description:\n\n{{ $json.prompt }}\n\nThis title should be optimized to go viral. It must include **emojis and 3 or more popular hashtags** at the end that are appropriate for the video, especially hashtags like #cute, #kawaii, #pets, #adorable, etc., if applicable.\n\n‚úÖ Respond with only the final title text, no explanations.  \n‚úÖ Do not use quotation marks or formatting.  \n‚úÖ Avoid generic titles like ‚Äúanother day‚Äù or ‚Äúthe cutest thing‚Äù ‚Äî be specific about what‚Äôs happening in the video.\n\nExample of the final format:  \nA puppy sleeping with his duck üê∂üí§ #cute #kawaii #dogsoftiktok",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.8,
        "position": [
          64,
          1472
        ],
        "id": "5af19dbd-fc11-43fd-9bb2-858b82139fd9",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          64,
          1648
        ],
        "id": "13cb831a-0dc6-4c11-9e61-55eb618ff821",
        "name": "DeepSeek Chat Model1",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          192,
          1648
        ],
        "id": "309b6ceb-157f-4382-8a45-c3fc2638aa68",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "={{ $json.cleanedOutput }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          640,
          1472
        ],
        "id": "914aae6c-2f6f-470c-a193-101d908bb269",
        "name": "Telegram4",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // Verifica si comienza y termina con comillas dobles\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          432,
          1472
        ],
        "id": "fab37c8a-8543-47bc-a7bd-d2e380ee13cd",
        "name": "Code9"
      },
      {
        "parameters": {
          "content": "## Penguin \nGenerate a similar prompt to the next example, make sure that you enter as many details as the example, use the exact same description of the character just change the location and action that the character is doing, make sure that the location has a reference object, in the example there is the hand, but it could be anything else but try to choose indoor locations.\n\nExample:\nA hyperrealistic, photorealistic 10 centimetre tall baby penguin resting gently on a human hand. The penguin has fluffy, long, realistic feathers that are mostly white with soft gray tones, and a dark head with subtle black markings, consistent with baby emperor penguin patterns. It has huge black eyes, like black marbles, and a natural posture, slightly looking up. Its small feet are touching the skin of the hand. The human hand is detailed, showing realistic skin texture, natural wrinkles, and soft lighting. The scene is shot in natural daylight with **cold tones**, and **a soft blue sky with faint clouds and subtle snowy textures in the distant background**. The depth of field is shallow, focusing on the penguin with a gentle blur on the cool-colored background. The image should look like a real photograph, with no cartoon or stylized elements. Ultra-detailed, full color, high-resolution, extremely realistic.",
          "width": 320
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          992,
          224
        ],
        "id": "0dbb9cb5-9590-49ec-a132-3594b3edbfce",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.caption }}",
                "rightValue": "/upload",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -528,
          1808
        ],
        "id": "e855f406-a7aa-4e5e-a7f9-705521a7e6c5",
        "name": "If5"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your upload",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -320,
          1792
        ],
        "id": "bc158a00-162e-4da8-8c8b-a1bce24226ed",
        "name": "Telegram10",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code10').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          288,
          1792
        ],
        "id": "92cf489b-e00b-4a90-b2e4-38c6440f70b3",
        "name": "FTP3",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpeg\";\n\n// Aseg√∫rate de que el binary data tambi√©n se pase correctamente\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    },\n    binary: items[0].binary // Esto pasa el binary data al siguiente paso\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -128,
          1792
        ],
        "id": "0f7cc311-ee1c-4e51-ad57-ea2164ee6d1b",
        "name": "Code10"
      },
      {
        "parameters": {
          "resource": "file",
          "fileId": "={{ $('If5').item.json.message.document.file_id }}",
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          112,
          1792
        ],
        "id": "cc902153-59b6-4d56-baad-a54011abd809",
        "name": "Telegram11",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "operation": "sendPhoto",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code10').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          480,
          1792
        ],
        "id": "8c37ccd8-5ce4-4c4e-a88d-12c420e3a5cd",
        "name": "Telegram12",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/pvideo",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -656,
          2064
        ],
        "id": "06dd895c-4559-4a27-b5b8-dbedc7b7d41d",
        "name": "If6"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If6').item.json.message.text;\n\n// Eliminar \"/pvideo\" y cualquier espacio extra\nconst cleanText = original.replace(/^\\/?pvideo__\\s*/i, \"\").trim();\n\n// Separar el texto usando dos guiones bajos `__`\nconst parts = cleanText.split('__', 2);  // Limitar la divisi√≥n a 2 partes\n\n// Asignar el primer valor como el link y el segundo como el prompt\nconst link = parts[0];\nconst prompt = parts[1];  // Unir el resto si hay m√°s de una parte\n\nreturn {\n  json: {\n    link: link,\n    prompt: prompt,\n    chat_id: $('If6').item.json.message.chat.id\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -224,
          2032
        ],
        "id": "fb81775d-c5c5-4c74-a550-ac09b1e8adca",
        "name": "Code11"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your video prompt",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -416,
          2048
        ],
        "id": "51291fbd-93d4-4cc3-8a3b-17d3e2b54bc6",
        "name": "Telegram13",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/kwaivgi/kling-v1.6-pro/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"duration\": 5,\n    \"cfg_scale\": 0.5,\n    \"start_image\": \"{{ $json.link }}\",\n    \"aspect_ratio\": \"9:16\",\n    \"negative_prompt\": \"\"\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -64,
          2032
        ],
        "id": "b23c6a27-6d15-44fd-ac14-6c1258e1b621",
        "name": "HTTP Request4"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request5').item.json.output }}",
          "additionalFields": {
            "caption": "={{ $('Code12').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1168,
          2032
        ],
        "id": "9c11ded8-9589-4938-a62e-84cdfff97400",
        "name": "Telegram14",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          240,
          2032
        ],
        "id": "44880cbe-e36c-4b50-9d6a-bc1ab77630eb",
        "name": "HTTP Request5",
        "retryOnFail": true,
        "maxTries": 5,
        "waitBetweenTries": 5000
      },
      {
        "parameters": {
          "amount": 7,
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          80,
          2032
        ],
        "id": "390479ab-bbfe-422d-b4ce-499f98b406f0",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request5').item.json.output }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          608,
          2032
        ],
        "id": "02d08d62-951c-4532-ad4f-e61cf6db0575",
        "name": "Execute Command5"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          784,
          2032
        ],
        "id": "a502b6ea-f424-42e1-8311-8c6daf710f3b",
        "name": "Read/Write Files from Disk3"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code12').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          992,
          2032
        ],
        "id": "2fa2c102-4b1d-4f91-a22c-45fd670e47d7",
        "name": "FTP4",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          432,
          2032
        ],
        "id": "013b3199-465e-4530-a160-240fd4ee88a8",
        "name": "Code12"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/help",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -496,
          -16
        ],
        "id": "8e63ce7f-cbc1-487b-a2b3-dc6df8c1002e",
        "name": "If7"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "=this is the help for the commands that you can use Chimo. \n/script              # is going create a new idea like chatgpt\n/image your prompt   # is going to create an image like sora\n/video link          # is going to create a video with replicate\n/bake link           # is going to add music and watermark\n/publish prompt      # is going to give you a title idea with hastags\n/aato link           # adds aato music\n/combo link1 link2   # combines multiple videos\n/pvideo link prompt  # is going to create a video with prompt\nfor the pvideo you have to separate de /pvideo link and prompt with double underscore ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -240,
          -16
        ],
        "id": "9500f564-9484-4cd5-aa34-8e1c88e242a6",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.caption }}",
                "rightValue": "/song",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -656,
          2288
        ],
        "id": "76ffdfe6-5f02-42a2-9c8b-61e2f7e9f910",
        "name": "If8"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your song",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -416,
          2272
        ],
        "id": "b2178c06-a85c-48ba-8f70-498f1ed3bb6e",
        "name": "Telegram16",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "resource": "file",
          "fileId": "={{ $('If8').item.json.message.audio.file_id }}",
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -240,
          2272
        ],
        "id": "de986362-e86c-4a4b-b8fd-83ded4191ae9",
        "name": "Telegram17",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "operation": "write",
          "fileName": "=/tmp/music.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          -16,
          2272
        ],
        "id": "20dc3308-1140-4a70-8e82-67301e78586b",
        "name": "Read/Write Files from Disk4"
      },
      {
        "parameters": {
          "command": "=ffmpeg -i /tmp/music.mp3 -af \"asetrate=44100*1.06,aresample=44100,atempo=1.06\" -y /tmp/music_modified.mp3"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          160,
          2272
        ],
        "id": "e11a6409-cedb-4984-ad3b-6d6a951473ae",
        "name": "Execute Command6"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp3\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/aatoMusic/music/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/aatoMusic/music/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          352,
          2272
        ],
        "id": "c7b48497-e4cb-468c-acfa-809a4c8ef318",
        "name": "Code13"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/music_modified.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          512,
          2272
        ],
        "id": "3400c74f-cc7f-44f6-8947-135f25806b1f",
        "name": "Read/Write Files from Disk5"
      },
      {
        "parameters": {
          "operation": "sendAudio",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code13').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          880,
          2272
        ],
        "id": "b55c25bb-b7d1-433f-b1c5-7af3c34411ab",
        "name": "Telegram18",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code13').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          704,
          2272
        ],
        "id": "6912d844-8468-400f-8225-e951a80b0066",
        "name": "FTP5",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/aato",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -624,
          2528
        ],
        "id": "5f890dd5-cd17-48f5-a53a-0aed82bc024e",
        "name": "If9"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your aato",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -448,
          2512
        ],
        "id": "4520a148-4cb4-4f29-b430-c1c33ff494d3",
        "name": "Telegram19",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.prompt }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          192,
          2512
        ],
        "id": "e61568fa-b08a-4f36-9d0d-d3efbb6cf242",
        "name": "Execute Command7"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?aato\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          32,
          2512
        ],
        "id": "9ca2f6ea-6888-447e-b2ee-93a63b84399b",
        "name": "Code14"
      },
      {
        "parameters": {
          "command": "=ffmpeg -y \\\n-i /tmp/generated.mp4 \\\n-ss {{ $('Code16').item.json.startSecond }} -i /tmp/music.wav \\\n-map 0:v -map 1:a:0 -shortest \\\n-c:v libx264 -c:a aac -b:a 192k -preset veryfast \\\n/tmp/video_watermarked.mp4\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          352,
          2512
        ],
        "id": "9d6ed1c7-fac7-4da9-af66-5897bc943590",
        "name": "Execute Command8"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code15').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          960,
          2512
        ],
        "id": "fdfd6d95-6298-4aed-a08c-4ff767e7695f",
        "name": "Telegram20",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "fileSelector": "/tmp/video_watermarked.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          640,
          2512
        ],
        "id": "cbf118ec-4457-4f3c-8290-2c30d6adff5c",
        "name": "Read/Write Files from Disk6"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          480,
          2512
        ],
        "id": "7354f3f2-700b-41c7-b0c0-2afc51ee6cdc",
        "name": "Code15"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code15').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          800,
          2512
        ],
        "id": "ab10c70f-5ff0-459f-98e8-36b8ea74fb04",
        "name": "FTP6",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Lista de audios actualizada\nconst audios = [\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\",\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\"\n];\n\n// Elegir un audio al azar\nconst selectedAudio = audios[Math.floor(Math.random() * audios.length)];\n\n// Generar un segundo de inicio entre 5 y 15\nconst startSecond = 75;\n\nreturn [\n  {\n    json: {\n      audioUrl: selectedAudio,\n      startSecond: startSecond\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -304,
          2512
        ],
        "id": "adff4a25-6d64-4907-8a47-356380ca94a2",
        "name": "Code16"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.audioUrl }}\" -O /tmp/music.wav"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          -144,
          2512
        ],
        "id": "82121d4c-dd16-4589-bbc1-bbd05e44795e",
        "name": "Execute Command9"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/combo",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -640,
          3024
        ],
        "id": "39e8815f-b2ae-4b0b-bebe-0e8d5779a74b",
        "name": "If10"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your combo",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -464,
          3008
        ],
        "id": "0196a090-dace-475d-b8da-706a24e6e8c7",
        "name": "Telegram21",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code18').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1072,
          2992
        ],
        "id": "16edf666-51e4-4552-9148-ba6436755b8c",
        "name": "Telegram22",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "fileSelector": "/tmp/combo.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          752,
          2992
        ],
        "id": "65ebb662-ee0f-4cc1-87bb-e9a1bf33b2f2",
        "name": "Read/Write Files from Disk7"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          592,
          2992
        ],
        "id": "8098154a-ea18-413e-a01e-9df0a14f8334",
        "name": "Code18"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code18').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          912,
          2992
        ],
        "id": "8d585362-9333-47a8-8291-1d0c479acea1",
        "name": "FTP7",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          -48,
          3008
        ],
        "id": "65d84a2f-6099-49cf-9d65-aee577d6ea65",
        "name": "Execute Command12"
      },
      {
        "parameters": {
          "jsCode": "const original = $('If10').item.json.message.text;\n\n// Eliminar la parte \"/combo\" y cualquier espacio extra\nconst cleanText = original.replace(/^\\/?combo\\s*/i, \"\").trim();\n\n// Separar los enlaces por espacio\nconst links = cleanText.split(' ');\n\n// Crear una lista con los enlaces\nreturn {\n  json: {\n    links: links,\n    chat_id: $('If6').item.json.message.chat.id\n  }\n};\n\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -320,
          3008
        ],
        "id": "871a607a-7a8f-4347-8dbe-a84426fc97f3",
        "name": "Code19"
      },
      {
        "parameters": {
          "jsCode": "const videos = $input.first().json.links;  // Obtiene la lista de enlaces\n\n// Crear el comando para descargar los videos\nlet downloadCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/filelist.txt\\n'; // Inicializa el archivo de lista\n\nvideos.forEach((url, index) => {\n  downloadCommands += `wget -O /tmp/video${index}.mp4 \"${url}\"; `;\n  fileListCommands += `echo \"file '/tmp/video${index}.mp4'\" >> /tmp/filelist.txt\\n`;\n});\n\n// Comando para crear el archivo de lista y concatenar los videos con FFmpeg\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/combo.mp4`;\n\nreturn {\n  json: {\n    downloadCommands: downloadCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand: combineCommand,\n  }\n};\n\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -176,
          3008
        ],
        "id": "e568249e-28fb-438b-a030-f1b743e654fd",
        "name": "Code17"
      },
      {
        "parameters": {
          "command": "={{ $('Code17').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          112,
          3008
        ],
        "id": "cb3c0ae5-cb00-4845-94e0-f3ebeca9a98c",
        "name": "Execute Command10"
      },
      {
        "parameters": {
          "command": "={{ $('Code17').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          320,
          3008
        ],
        "id": "947ab574-bde7-4736-a1c9-83e2f44a4e99",
        "name": "Execute Command11"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/2aato",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -624,
          2800
        ],
        "id": "bbc33f91-5b8f-41cd-820a-60810b233834",
        "name": "If11"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your 2aato",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -480,
          2768
        ],
        "id": "451bd671-bedc-411f-b5be-bb4e19eb9f99",
        "name": "Telegram23",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.prompt }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          144,
          2752
        ],
        "id": "5f52b85d-acd2-4a3d-b2a2-98c654453ec1",
        "name": "Execute Command13"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?2aato\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -16,
          2752
        ],
        "id": "8e59fed6-2653-4c4e-9e88-38a4b9676ed5",
        "name": "Code20"
      },
      {
        "parameters": {
          "command": "=ffmpeg -y \\\n-i /tmp/generated.mp4 \\\n-ss {{ $('Code22').item.json.startSecond }} -i /tmp/music.wav \\\n-map 0:v -map 1:a:0 -shortest \\\n-c:v libx264 -c:a aac -b:a 192k -preset veryfast \\\n/tmp/video_watermarked.mp4\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          304,
          2752
        ],
        "id": "7e2a24b6-f22f-4da2-8f5f-79aa835b6a21",
        "name": "Execute Command14"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code21').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          928,
          2752
        ],
        "id": "63c0e840-53c9-44bf-8639-ea4b3ef493e4",
        "name": "Telegram24",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "LS_01_Pets Video Creator"
          }
        }
      },
      {
        "parameters": {
          "fileSelector": "/tmp/video_watermarked.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          608,
          2752
        ],
        "id": "2aefdef1-61f5-4872-b192-c2c441a1806a",
        "name": "Read/Write Files from Disk8"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          448,
          2752
        ],
        "id": "9b9d9819-5624-4316-8527-7343fa2d9ccd",
        "name": "Code21"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code21').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          768,
          2752
        ],
        "id": "bedba7a4-46a9-46f0-8458-8a503eb2c57f",
        "name": "FTP8",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Lista de audios actualizada\nconst audios = [\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\",\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\"\n];\n\n// Elegir un audio al azar\nconst selectedAudio = audios[Math.floor(Math.random() * audios.length)];\n\n// Generar un segundo de inicio entre 5 y 15\nconst startSecond = 0;\n\nreturn [\n  {\n    json: {\n      audioUrl: selectedAudio,\n      startSecond: startSecond\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -336,
          2752
        ],
        "id": "4fbcebc0-4e35-4f41-a296-cf4d14df1ce1",
        "name": "Code22"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.audioUrl }}\" -O /tmp/music.wav"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          -176,
          2752
        ],
        "id": "8a728c5f-8ab4-43a1-a0df-592e76ed3912",
        "name": "Execute Command15"
      }
    ],
    "connections": {
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger1": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Telegram1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram1": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Telegram3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram3": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          []
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Telegram5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram5": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request3": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Telegram7",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram7": {
        "main": [
          [
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Execute Command1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command1": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk": {
        "main": [
          [
            {
              "node": "FTP2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command2": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Execute Command2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command3": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Execute Command3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Telegram6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP2": {
        "main": [
          [
            {
              "node": "Telegram8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "Execute Command4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command4": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Telegram9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram9": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "Telegram4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If5": {
        "main": [
          [
            {
              "node": "Telegram10",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram10": {
        "main": [
          [
            {
              "node": "Code10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code10": {
        "main": [
          [
            {
              "node": "Telegram11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP3": {
        "main": [
          [
            {
              "node": "Telegram12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram11": {
        "main": [
          [
            {
              "node": "FTP3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Telegram13",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code11": {
        "main": [
          [
            {
              "node": "HTTP Request4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram13": {
        "main": [
          [
            {
              "node": "Code11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request4": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request5": {
        "main": [
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "HTTP Request5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command5": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk3": {
        "main": [
          [
            {
              "node": "FTP4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP4": {
        "main": [
          [
            {
              "node": "Telegram14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Execute Command5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If8": {
        "main": [
          [
            {
              "node": "Telegram16",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram16": {
        "main": [
          [
            {
              "node": "Telegram17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram17": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk4": {
        "main": [
          [
            {
              "node": "Execute Command6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command6": {
        "main": [
          [
            {
              "node": "Code13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code13": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP5": {
        "main": [
          [
            {
              "node": "Telegram18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk5": {
        "main": [
          [
            {
              "node": "FTP5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If9": {
        "main": [
          [
            {
              "node": "Telegram19",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram19": {
        "main": [
          [
            {
              "node": "Code16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command7": {
        "main": [
          [
            {
              "node": "Execute Command8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code14": {
        "main": [
          [
            {
              "node": "Execute Command7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command8": {
        "main": [
          [
            {
              "node": "Code15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk6": {
        "main": [
          [
            {
              "node": "FTP6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code15": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP6": {
        "main": [
          [
            {
              "node": "Telegram20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code16": {
        "main": [
          [
            {
              "node": "Execute Command9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command9": {
        "main": [
          [
            {
              "node": "Code14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If10": {
        "main": [
          [
            {
              "node": "Telegram21",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram21": {
        "main": [
          [
            {
              "node": "Code19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk7": {
        "main": [
          [
            {
              "node": "FTP7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code18": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP7": {
        "main": [
          [
            {
              "node": "Telegram22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command12": {
        "main": [
          [
            {
              "node": "Execute Command10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code19": {
        "main": [
          [
            {
              "node": "Code17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code17": {
        "main": [
          [
            {
              "node": "Execute Command12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command10": {
        "main": [
          [
            {
              "node": "Execute Command11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command11": {
        "main": [
          [
            {
              "node": "Code18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If11": {
        "main": [
          [
            {
              "node": "Telegram23",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram23": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command13": {
        "main": [
          [
            {
              "node": "Execute Command14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code20": {
        "main": [
          [
            {
              "node": "Execute Command13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command14": {
        "main": [
          [
            {
              "node": "Code21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk8": {
        "main": [
          [
            {
              "node": "FTP8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code21": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP8": {
        "main": [
          [
            {
              "node": "Telegram24",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code22": {
        "main": [
          [
            {
              "node": "Execute Command15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command15": {
        "main": [
          [
            {
              "node": "Code20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "bdf6e03b-2f71-4a61-9d07-eeb48c55770e",
    "activeVersionId": "bdf6e03b-2f71-4a61-9d07-eeb48c55770e",
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-04-02T12:57:57.799Z",
        "createdAt": "2025-04-02T12:57:57.799Z",
        "role": "workflow:owner",
        "workflowId": "UolXmPAEZdI7C2Q9",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": {
      "updatedAt": "2025-12-26T01:33:14.866Z",
      "createdAt": "2025-12-26T01:33:14.866Z",
      "versionId": "bdf6e03b-2f71-4a61-9d07-eeb48c55770e",
      "workflowId": "UolXmPAEZdI7C2Q9",
      "nodes": [
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.replicate.com/v1/models/black-forest-labs/flux-dev-lora/predictions",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer r8_TOKEN_REMOVED"
                },
                {
                  "name": "Prefer",
                  "value": "wait"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"go_fast\": true,\n    \"guidance\": 3,\n    \"lora_scale\": 1,\n    \"megapixels\": \"1\",\n    \"num_outputs\": 1,\n    \"aspect_ratio\": \"9:16\",\n    \"lora_weights\": \"\",\n    \"output_format\": \"jpg\",\n    \"output_quality\": 80,\n    \"prompt_strength\": 0.8,\n    \"num_inference_steps\": 28\n  }\n} ",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            0,
            624
          ],
          "id": "958808a9-a237-4bf0-b93a-eb5204c2f96d",
          "name": "HTTP Request"
        },
        {
          "parameters": {
            "mode": "runOnceForEachItem",
            "jsCode": "const original = $('If').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?image\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -160,
            624
          ],
          "id": "f4cd4061-549a-48ff-bc76-ce28fe989d98",
          "name": "Code"
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            304,
            624
          ],
          "id": "9817017f-8494-490a-a556-9fb772ef9a8d",
          "name": "HTTP Request1"
        },
        {
          "parameters": {
            "amount": 10
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            144,
            624
          ],
          "id": "825fdeb3-9d6f-4450-9ed6-954538aa5a08",
          "name": "Wait",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "updates": [
              "message"
            ],
            "additionalFields": {
              "download": false
            }
          },
          "type": "n8n-nodes-base.telegramTrigger",
          "typeVersion": 1.1,
          "position": [
            -768,
            -16
          ],
          "id": "7bc7611f-de73-41ec-bb86-d47c6e5dd988",
          "name": "Telegram Trigger1",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/script",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -544,
            288
          ],
          "id": "1744fe91-8d62-49c5-860a-07ec0a9fceed",
          "name": "If1"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "Based on the following example, generate a new, highly detailed prompt for a photorealistic AI image that fits within the category of extremely cute animals performing everyday activities. The new prompt must clearly describe a specific animal character engaged in a mundane yet visually engaging activity within a realistic physical setting. Emphasize clear, tangible visual details that could be easily transformed into a detailed image: precisely describe the foreground, middle ground, and background. Include detailed descriptions of materials, shapes, textures, lighting conditions, and the physical environment. Mention surrounding objects, surfaces, walls, lighting sources, and other elements that contribute to realism.\n\nThe image should evoke warmth, joy, and charm through specific, clearly visible details, similar to a scene captured by a high-end camera. Avoid emotional or abstract descriptions; instead, focus strictly on concrete visual elements. Clearly describe the camera angle, lens type, aperture setting, lighting style (natural, diffused, ambient), and depth of field. Specifically mention at least five distinct visible objects or elements beyond the main subject.\n\nWrite as if creating precise instructions for a 3D artist or AI image generator. Prioritize visual clarity, realism, and cinematic composition. Everything should be contained in one cohesive paragraph.\n\nExample:\nA highly detailed 3D-rendered image depicting an adorable baby bunny character sleeping peacefully on its back in a miniature wooden bed, presented in a Pixar-inspired 3D animation style, even cuter and softer than characters from Zootopia. The bunny features smooth, rounded shapes, distinctly fluffy and soft-looking fur textures in delicate shades of beige and creamy white, gently shut eyes with soft eyelashes, a small round nose, and a subtle smiling expression. Its tiny paws rest gently atop the beige linen blanket, which is neatly tucked around its body, highlighting clear fabric weave details. A matching soft-textured pillow comfortably supports the bunny‚Äôs head. Surrounding the bed are visible elements enhancing realism: polished hardwood flooring, semi-transparent cream-colored curtains filtering diffused natural sunlight, a plain beige wall with subtle texture, a neatly painted baseboard trim, and partially visible edges of a window. Soft shadows beneath the furniture and gentle fabric folds add depth and realism. The scene is captured from an elevated angle looking downward, utilizing an 85mm lens with an aperture of f/2.0, resulting in a shallow depth of field, sharply focusing on the bunny and bed, smoothly transitioning into a softly blurred, inviting background. Natural diffused lighting provides delicate highlights, emphasizing textures of fur, wood, and fabric, clearly visible and reinforcing a gentle, nostalgic, and visually inviting composition.",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.8,
          "position": [
            -176,
            272
          ],
          "id": "9f01dcd1-e954-4efb-bff8-ce42f3f72f0a",
          "name": "AI Agent"
        },
        {
          "parameters": {
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
          "typeVersion": 1,
          "position": [
            -208,
            432
          ],
          "id": "544f515b-df64-46dd-9ed6-3980a9a3fb4a",
          "name": "DeepSeek Chat Model",
          "credentials": {
            "deepSeekApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "DeepSeek account"
            }
          }
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "={{ $json.cleanedOutput }}",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            320,
            272
          ],
          "id": "0b951827-839a-4493-a710-dab3ff17e445",
          "name": "Telegram",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your script",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -336,
            272
          ],
          "id": "67434bb1-8e71-4e5b-8a85-7ca8d6662a38",
          "name": "Telegram1",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/image",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -544,
            640
          ],
          "id": "6b06cb6e-14b2-4a4a-9868-e688c55fe874",
          "name": "If"
        },
        {
          "parameters": {
            "operation": "sendPhoto",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "file": "={{ $('HTTP Request1').item.json.output[0] }}",
            "additionalFields": {
              "caption": "={{ $('Code4').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            1168,
            624
          ],
          "id": "05e07cff-e9fb-46ce-b2ad-7d1233010a3d",
          "name": "Telegram2",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your image",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -336,
            624
          ],
          "id": "d9061403-cb19-438b-acc0-8021caeb7522",
          "name": "Telegram3",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED"
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            -80,
            432
          ],
          "id": "0b9d4d22-154a-4104-85b8-d092119cb706",
          "name": "Simple Memory"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/video",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -544,
            944
          ],
          "id": "c9d17480-e8e0-4e9b-962b-0b3e2b43bb55",
          "name": "If2"
        },
        {
          "parameters": {
            "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // Verifica si comienza y termina con comillas dobles\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            144,
            272
          ],
          "id": "fd3ef022-6dee-47c0-adaf-afad002ee121",
          "name": "Code1"
        },
        {
          "parameters": {
            "mode": "runOnceForEachItem",
            "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?video\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -208,
            928
          ],
          "id": "46073475-49ef-442d-98f2-7a46bf43cb37",
          "name": "Code2"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your video",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -368,
            928
          ],
          "id": "68750717-03e8-4096-bd91-8429858338e9",
          "name": "Telegram5",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.replicate.com/v1/models/kwaivgi/kling-v1.6-pro/predictions",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer r8_TOKEN_REMOVED"
                },
                {
                  "name": "Prefer",
                  "value": "wait"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"motion\",\n    \"duration\": 5,\n    \"cfg_scale\": 0.5,\n    \"start_image\": \"{{ $json.prompt }}\",\n    \"aspect_ratio\": \"9:16\",\n    \"negative_prompt\": \"\"\n  }\n} ",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            -48,
            928
          ],
          "id": "74fb302e-053f-4938-aff4-d05aa4203fb1",
          "name": "HTTP Request2"
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "file": "={{ $('HTTP Request3').item.json.output }}",
            "additionalFields": {
              "caption": "={{ $('Code5').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            1184,
            928
          ],
          "id": "96520b18-f648-43e0-8f5e-1bca65495d79",
          "name": "Telegram6",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            272,
            928
          ],
          "id": "5c0b9e4e-62db-47bd-8509-3e3c9d4ce5b9",
          "name": "HTTP Request3",
          "retryOnFail": true,
          "maxTries": 5,
          "waitBetweenTries": 5000
        },
        {
          "parameters": {
            "amount": 7,
            "unit": "minutes"
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            112,
            928
          ],
          "id": "8cd8fce9-4c49-49eb-8664-c2649b2aa69e",
          "name": "Wait1",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/bake",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -528,
            1248
          ],
          "id": "f3f17d83-e3c2-4899-8258-a4ab7457ce38",
          "name": "If3"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your bake",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -320,
            1248
          ],
          "id": "03611cb9-49b2-40fc-a1f9-144ae43ccb53",
          "name": "Telegram7",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "command": "=wget \"{{ $json.prompt }}\" -O /tmp/generated.mp4"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            400,
            1248
          ],
          "id": "fd7dcc67-8c36-426d-95cc-36af0e37ba69",
          "name": "Execute Command"
        },
        {
          "parameters": {
            "mode": "runOnceForEachItem",
            "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?bake\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            240,
            1248
          ],
          "id": "563b153f-4541-420e-b8c7-7a3413aef496",
          "name": "Code3"
        },
        {
          "parameters": {
            "command": "=ffmpeg -y \\\n-i /tmp/generated.mp4 \\\n-ss {{ $('Code7').item.json.startSecond }} -i /tmp/music.mp3 \\\n-map 0:v -map 1:a:0 -shortest \\\n-c:v libx264 -c:a aac -b:a 192k -preset veryfast \\\n/tmp/video_watermarked.mp4\n"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            560,
            1248
          ],
          "id": "26cdd979-c229-471e-a256-e3a8563db548",
          "name": "Execute Command1"
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "binaryData": true,
            "additionalFields": {
              "caption": "={{ $('Code6').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            1232,
            1248
          ],
          "id": "44f904cf-0fce-4459-884b-3595f6ab5fb3",
          "name": "Telegram8",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "fileSelector": "/tmp/video_watermarked.mp4",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            880,
            1248
          ],
          "id": "9e869211-7531-41a9-a163-53a2e94f955f",
          "name": "Read/Write Files from Disk"
        },
        {
          "parameters": {
            "command": "=wget \"{{ $('HTTP Request1').item.json.output[0] }}\" -O /tmp/generated.jpg"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            624,
            624
          ],
          "id": "0ac67d77-948f-486b-b5c2-2758d26e579d",
          "name": "Execute Command2"
        },
        {
          "parameters": {
            "fileSelector": "/tmp/generated.jpg",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            800,
            624
          ],
          "id": "6c350637-c42b-4d97-89ef-e086dc021726",
          "name": "Read/Write Files from Disk1"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code4').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            1008,
            624
          ],
          "id": "df070366-e806-43e4-97c1-bece2a19441a",
          "name": "FTP1",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            464,
            624
          ],
          "id": "97e10c04-4fb3-4235-a8aa-1d3d87c2aa86",
          "name": "Code4"
        },
        {
          "parameters": {
            "command": "=wget \"{{ $('HTTP Request3').item.json.output }}\" -O /tmp/generated.mp4"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            624,
            928
          ],
          "id": "44c60eee-5071-4580-b784-85ffeb7d69fd",
          "name": "Execute Command3"
        },
        {
          "parameters": {
            "fileSelector": "/tmp/generated.mp4",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            800,
            928
          ],
          "id": "1ce5b256-a87f-4786-a0b2-6a6ffcfafe5a",
          "name": "Read/Write Files from Disk2"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code5').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            1008,
            928
          ],
          "id": "47d29288-0501-4a15-bd9f-86c86e96708d",
          "name": "FTP",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/videos/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            448,
            928
          ],
          "id": "96a2acae-6a83-4070-85e7-45df158f188d",
          "name": "Code5"
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            720,
            1248
          ],
          "id": "48f41b4e-2074-474f-87bc-a60b19adb656",
          "name": "Code6"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code6').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            1072,
            1248
          ],
          "id": "8c3c0862-35dd-460a-8e7b-1767e6eb225d",
          "name": "FTP2",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Lista de audios actualizada\nconst audios = [\n  \"https://lemonsushi.com/uploads/pets/audios/Fun.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/happyPiano.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/newBaby.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/ThisKids.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/upbeat.mp3\",\n  \"https://lemonsushi.com/uploads/pets/audios/version2.mp3\"\n];\n\n// Elegir un audio al azar\nconst selectedAudio = audios[Math.floor(Math.random() * audios.length)];\n\n// Generar un segundo de inicio entre 5 y 15\nconst startSecond = Math.floor(Math.random() * 11) + 5;\n\nreturn [\n  {\n    json: {\n      audioUrl: selectedAudio,\n      startSecond: startSecond\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -128,
            1248
          ],
          "id": "805ff6ec-ef68-4f17-9cb5-ba9a1903c3b1",
          "name": "Code7"
        },
        {
          "parameters": {
            "command": "=wget \"{{ $json.audioUrl }}\" -O /tmp/music.mp3"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            48,
            1248
          ],
          "id": "45236b4d-ea75-4420-a4cd-f83c787fea52",
          "name": "Execute Command4"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/publish",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -528,
            1488
          ],
          "id": "742ababa-ef6d-43ab-9d5c-27bd53fe9927",
          "name": "If4"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your publish",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -320,
            1472
          ],
          "id": "a1028cc3-8ae8-4b2b-8940-268a81627410",
          "name": "Telegram9",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "mode": "runOnceForEachItem",
            "jsCode": "const original = $('If').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?publish\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -128,
            1472
          ],
          "id": "f9e3ea2f-3727-4ccb-8c35-5bf507ac0763",
          "name": "Code8"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=You are an expert in creating viral content for TikTok and YouTube Shorts. Your task is to generate a **short, catchy, and emotional title** based on this video description:\n\n{{ $json.prompt }}\n\nThis title should be optimized to go viral. It must include **emojis and 3 or more popular hashtags** at the end that are appropriate for the video, especially hashtags like #cute, #kawaii, #pets, #adorable, etc., if applicable.\n\n‚úÖ Respond with only the final title text, no explanations.  \n‚úÖ Do not use quotation marks or formatting.  \n‚úÖ Avoid generic titles like ‚Äúanother day‚Äù or ‚Äúthe cutest thing‚Äù ‚Äî be specific about what‚Äôs happening in the video.\n\nExample of the final format:  \nA puppy sleeping with his duck üê∂üí§ #cute #kawaii #dogsoftiktok",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 1.8,
          "position": [
            64,
            1472
          ],
          "id": "5af19dbd-fc11-43fd-9bb2-858b82139fd9",
          "name": "AI Agent1"
        },
        {
          "parameters": {
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
          "typeVersion": 1,
          "position": [
            64,
            1648
          ],
          "id": "13cb831a-0dc6-4c11-9e61-55eb618ff821",
          "name": "DeepSeek Chat Model1",
          "credentials": {
            "deepSeekApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "DeepSeek account"
            }
          }
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED"
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            192,
            1648
          ],
          "id": "309b6ceb-157f-4382-8a45-c3fc2638aa68",
          "name": "Simple Memory1"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "={{ $json.cleanedOutput }}",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            640,
            1472
          ],
          "id": "914aae6c-2f6f-470c-a193-101d908bb269",
          "name": "Telegram4",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // Verifica si comienza y termina con comillas dobles\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            432,
            1472
          ],
          "id": "fab37c8a-8543-47bc-a7bd-d2e380ee13cd",
          "name": "Code9"
        },
        {
          "parameters": {
            "content": "## Penguin \nGenerate a similar prompt to the next example, make sure that you enter as many details as the example, use the exact same description of the character just change the location and action that the character is doing, make sure that the location has a reference object, in the example there is the hand, but it could be anything else but try to choose indoor locations.\n\nExample:\nA hyperrealistic, photorealistic 10 centimetre tall baby penguin resting gently on a human hand. The penguin has fluffy, long, realistic feathers that are mostly white with soft gray tones, and a dark head with subtle black markings, consistent with baby emperor penguin patterns. It has huge black eyes, like black marbles, and a natural posture, slightly looking up. Its small feet are touching the skin of the hand. The human hand is detailed, showing realistic skin texture, natural wrinkles, and soft lighting. The scene is shot in natural daylight with **cold tones**, and **a soft blue sky with faint clouds and subtle snowy textures in the distant background**. The depth of field is shallow, focusing on the penguin with a gentle blur on the cool-colored background. The image should look like a real photograph, with no cartoon or stylized elements. Ultra-detailed, full color, high-resolution, extremely realistic.",
            "width": 320
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            992,
            224
          ],
          "id": "0dbb9cb5-9590-49ec-a132-3594b3edbfce",
          "name": "Sticky Note"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.caption }}",
                  "rightValue": "/upload",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -528,
            1808
          ],
          "id": "e855f406-a7aa-4e5e-a7f9-705521a7e6c5",
          "name": "If5"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your upload",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -320,
            1792
          ],
          "id": "bc158a00-162e-4da8-8c8b-a1bce24226ed",
          "name": "Telegram10",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code10').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            288,
            1792
          ],
          "id": "92cf489b-e00b-4a90-b2e4-38c6440f70b3",
          "name": "FTP3",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpeg\";\n\n// Aseg√∫rate de que el binary data tambi√©n se pase correctamente\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    },\n    binary: items[0].binary // Esto pasa el binary data al siguiente paso\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -128,
            1792
          ],
          "id": "0f7cc311-ee1c-4e51-ad57-ea2164ee6d1b",
          "name": "Code10"
        },
        {
          "parameters": {
            "resource": "file",
            "fileId": "={{ $('If5').item.json.message.document.file_id }}",
            "additionalFields": {}
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            112,
            1792
          ],
          "id": "cc902153-59b6-4d56-baad-a54011abd809",
          "name": "Telegram11",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "operation": "sendPhoto",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "binaryData": true,
            "additionalFields": {
              "caption": "={{ $('Code10').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            480,
            1792
          ],
          "id": "8c37ccd8-5ce4-4c4e-a88d-12c420e3a5cd",
          "name": "Telegram12",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/pvideo",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -656,
            2064
          ],
          "id": "06dd895c-4559-4a27-b5b8-dbedc7b7d41d",
          "name": "If6"
        },
        {
          "parameters": {
            "mode": "runOnceForEachItem",
            "jsCode": "const original = $('If6').item.json.message.text;\n\n// Eliminar \"/pvideo\" y cualquier espacio extra\nconst cleanText = original.replace(/^\\/?pvideo__\\s*/i, \"\").trim();\n\n// Separar el texto usando dos guiones bajos `__`\nconst parts = cleanText.split('__', 2);  // Limitar la divisi√≥n a 2 partes\n\n// Asignar el primer valor como el link y el segundo como el prompt\nconst link = parts[0];\nconst prompt = parts[1];  // Unir el resto si hay m√°s de una parte\n\nreturn {\n  json: {\n    link: link,\n    prompt: prompt,\n    chat_id: $('If6').item.json.message.chat.id\n  }\n};\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -224,
            2032
          ],
          "id": "fb81775d-c5c5-4c74-a550-ac09b1e8adca",
          "name": "Code11"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your video prompt",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -416,
            2048
          ],
          "id": "51291fbd-93d4-4cc3-8a3b-17d3e2b54bc6",
          "name": "Telegram13",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.replicate.com/v1/models/kwaivgi/kling-v1.6-pro/predictions",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer r8_TOKEN_REMOVED"
                },
                {
                  "name": "Prefer",
                  "value": "wait"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"duration\": 5,\n    \"cfg_scale\": 0.5,\n    \"start_image\": \"{{ $json.link }}\",\n    \"aspect_ratio\": \"9:16\",\n    \"negative_prompt\": \"\"\n  }\n} ",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            -64,
            2032
          ],
          "id": "b23c6a27-6d15-44fd-ac14-6c1258e1b621",
          "name": "HTTP Request4"
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "file": "={{ $('HTTP Request5').item.json.output }}",
            "additionalFields": {
              "caption": "={{ $('Code12').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            1168,
            2032
          ],
          "id": "9c11ded8-9589-4938-a62e-84cdfff97400",
          "name": "Telegram14",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            240,
            2032
          ],
          "id": "44880cbe-e36c-4b50-9d6a-bc1ab77630eb",
          "name": "HTTP Request5",
          "retryOnFail": true,
          "maxTries": 5,
          "waitBetweenTries": 5000
        },
        {
          "parameters": {
            "amount": 7,
            "unit": "minutes"
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            80,
            2032
          ],
          "id": "390479ab-bbfe-422d-b4ce-499f98b406f0",
          "name": "Wait2",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "command": "=wget \"{{ $('HTTP Request5').item.json.output }}\" -O /tmp/generated.mp4"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            608,
            2032
          ],
          "id": "02d08d62-951c-4532-ad4f-e61cf6db0575",
          "name": "Execute Command5"
        },
        {
          "parameters": {
            "fileSelector": "/tmp/generated.mp4",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            784,
            2032
          ],
          "id": "a502b6ea-f424-42e1-8311-8c6daf710f3b",
          "name": "Read/Write Files from Disk3"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code12').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            992,
            2032
          ],
          "id": "2fa2c102-4b1d-4f91-a22c-45fd670e47d7",
          "name": "FTP4",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/videos/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            432,
            2032
          ],
          "id": "013b3199-465e-4530-a160-240fd4ee88a8",
          "name": "Code12"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/help",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -496,
            -16
          ],
          "id": "8e63ce7f-cbc1-487b-a2b3-dc6df8c1002e",
          "name": "If7"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "=this is the help for the commands that you can use Chimo. \n/script              # is going create a new idea like chatgpt\n/image your prompt   # is going to create an image like sora\n/video link          # is going to create a video with replicate\n/bake link           # is going to add music and watermark\n/publish prompt      # is going to give you a title idea with hastags\n/aato link           # adds aato music\n/combo link1 link2   # combines multiple videos\n/pvideo link prompt  # is going to create a video with prompt\nfor the pvideo you have to separate de /pvideo link and prompt with double underscore ",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -240,
            -16
          ],
          "id": "9500f564-9484-4cd5-aa34-8e1c88e242a6",
          "name": "Telegram15",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.caption }}",
                  "rightValue": "/song",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -656,
            2288
          ],
          "id": "76ffdfe6-5f02-42a2-9c8b-61e2f7e9f910",
          "name": "If8"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your song",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -416,
            2272
          ],
          "id": "b2178c06-a85c-48ba-8f70-498f1ed3bb6e",
          "name": "Telegram16",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "resource": "file",
            "fileId": "={{ $('If8').item.json.message.audio.file_id }}",
            "additionalFields": {}
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -240,
            2272
          ],
          "id": "de986362-e86c-4a4b-b8fd-83ded4191ae9",
          "name": "Telegram17",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "operation": "write",
            "fileName": "=/tmp/music.mp3",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            -16,
            2272
          ],
          "id": "20dc3308-1140-4a70-8e82-67301e78586b",
          "name": "Read/Write Files from Disk4"
        },
        {
          "parameters": {
            "command": "=ffmpeg -i /tmp/music.mp3 -af \"asetrate=44100*1.06,aresample=44100,atempo=1.06\" -y /tmp/music_modified.mp3"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            160,
            2272
          ],
          "id": "e11a6409-cedb-4984-ad3b-6d6a951473ae",
          "name": "Execute Command6"
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp3\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/aatoMusic/music/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/aatoMusic/music/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            352,
            2272
          ],
          "id": "c7b48497-e4cb-468c-acfa-809a4c8ef318",
          "name": "Code13"
        },
        {
          "parameters": {
            "fileSelector": "/tmp/music_modified.mp3",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            512,
            2272
          ],
          "id": "3400c74f-cc7f-44f6-8947-135f25806b1f",
          "name": "Read/Write Files from Disk5"
        },
        {
          "parameters": {
            "operation": "sendAudio",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "binaryData": true,
            "additionalFields": {
              "caption": "={{ $('Code13').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            880,
            2272
          ],
          "id": "b55c25bb-b7d1-433f-b1c5-7af3c34411ab",
          "name": "Telegram18",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code13').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            704,
            2272
          ],
          "id": "6912d844-8468-400f-8225-e951a80b0066",
          "name": "FTP5",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/aato",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -624,
            2528
          ],
          "id": "5f890dd5-cd17-48f5-a53a-0aed82bc024e",
          "name": "If9"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your aato",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -448,
            2512
          ],
          "id": "4520a148-4cb4-4f29-b430-c1c33ff494d3",
          "name": "Telegram19",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "command": "=wget \"{{ $json.prompt }}\" -O /tmp/generated.mp4"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            192,
            2512
          ],
          "id": "e61568fa-b08a-4f36-9d0d-d3efbb6cf242",
          "name": "Execute Command7"
        },
        {
          "parameters": {
            "mode": "runOnceForEachItem",
            "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?aato\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            32,
            2512
          ],
          "id": "9ca2f6ea-6888-447e-b2ee-93a63b84399b",
          "name": "Code14"
        },
        {
          "parameters": {
            "command": "=ffmpeg -y \\\n-i /tmp/generated.mp4 \\\n-ss {{ $('Code16').item.json.startSecond }} -i /tmp/music.wav \\\n-map 0:v -map 1:a:0 -shortest \\\n-c:v libx264 -c:a aac -b:a 192k -preset veryfast \\\n/tmp/video_watermarked.mp4\n"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            352,
            2512
          ],
          "id": "9d6ed1c7-fac7-4da9-af66-5897bc943590",
          "name": "Execute Command8"
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "binaryData": true,
            "additionalFields": {
              "caption": "={{ $('Code15').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            960,
            2512
          ],
          "id": "fdfd6d95-6298-4aed-a08c-4ff767e7695f",
          "name": "Telegram20",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "fileSelector": "/tmp/video_watermarked.mp4",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            640,
            2512
          ],
          "id": "cbf118ec-4457-4f3c-8290-2c30d6adff5c",
          "name": "Read/Write Files from Disk6"
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            480,
            2512
          ],
          "id": "7354f3f2-700b-41c7-b0c0-2afc51ee6cdc",
          "name": "Code15"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code15').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            800,
            2512
          ],
          "id": "ab10c70f-5ff0-459f-98e8-36b8ea74fb04",
          "name": "FTP6",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Lista de audios actualizada\nconst audios = [\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\",\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\"\n];\n\n// Elegir un audio al azar\nconst selectedAudio = audios[Math.floor(Math.random() * audios.length)];\n\n// Generar un segundo de inicio entre 5 y 15\nconst startSecond = 75;\n\nreturn [\n  {\n    json: {\n      audioUrl: selectedAudio,\n      startSecond: startSecond\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -304,
            2512
          ],
          "id": "adff4a25-6d64-4907-8a47-356380ca94a2",
          "name": "Code16"
        },
        {
          "parameters": {
            "command": "=wget \"{{ $json.audioUrl }}\" -O /tmp/music.wav"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            -144,
            2512
          ],
          "id": "82121d4c-dd16-4589-bbc1-bbd05e44795e",
          "name": "Execute Command9"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/combo",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -640,
            3024
          ],
          "id": "39e8815f-b2ae-4b0b-bebe-0e8d5779a74b",
          "name": "If10"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your combo",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -464,
            3008
          ],
          "id": "0196a090-dace-475d-b8da-706a24e6e8c7",
          "name": "Telegram21",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "binaryData": true,
            "additionalFields": {
              "caption": "={{ $('Code18').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            1072,
            2992
          ],
          "id": "16edf666-51e4-4552-9148-ba6436755b8c",
          "name": "Telegram22",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "fileSelector": "/tmp/combo.mp4",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            752,
            2992
          ],
          "id": "65ebb662-ee0f-4cc1-87bb-e9a1bf33b2f2",
          "name": "Read/Write Files from Disk7"
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            592,
            2992
          ],
          "id": "8098154a-ea18-413e-a01e-9df0a14f8334",
          "name": "Code18"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code18').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            912,
            2992
          ],
          "id": "8d585362-9333-47a8-8291-1d0c479acea1",
          "name": "FTP7",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "command": "={{ $json.downloadCommands }}"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            -48,
            3008
          ],
          "id": "65d84a2f-6099-49cf-9d65-aee577d6ea65",
          "name": "Execute Command12"
        },
        {
          "parameters": {
            "jsCode": "const original = $('If10').item.json.message.text;\n\n// Eliminar la parte \"/combo\" y cualquier espacio extra\nconst cleanText = original.replace(/^\\/?combo\\s*/i, \"\").trim();\n\n// Separar los enlaces por espacio\nconst links = cleanText.split(' ');\n\n// Crear una lista con los enlaces\nreturn {\n  json: {\n    links: links,\n    chat_id: $('If6').item.json.message.chat.id\n  }\n};\n\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -320,
            3008
          ],
          "id": "871a607a-7a8f-4347-8dbe-a84426fc97f3",
          "name": "Code19"
        },
        {
          "parameters": {
            "jsCode": "const videos = $input.first().json.links;  // Obtiene la lista de enlaces\n\n// Crear el comando para descargar los videos\nlet downloadCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/filelist.txt\\n'; // Inicializa el archivo de lista\n\nvideos.forEach((url, index) => {\n  downloadCommands += `wget -O /tmp/video${index}.mp4 \"${url}\"; `;\n  fileListCommands += `echo \"file '/tmp/video${index}.mp4'\" >> /tmp/filelist.txt\\n`;\n});\n\n// Comando para crear el archivo de lista y concatenar los videos con FFmpeg\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/combo.mp4`;\n\nreturn {\n  json: {\n    downloadCommands: downloadCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand: combineCommand,\n  }\n};\n\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -176,
            3008
          ],
          "id": "e568249e-28fb-438b-a030-f1b743e654fd",
          "name": "Code17"
        },
        {
          "parameters": {
            "command": "={{ $('Code17').item.json.fileListCommands }}"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            112,
            3008
          ],
          "id": "cb3c0ae5-cb00-4845-94e0-f3ebeca9a98c",
          "name": "Execute Command10"
        },
        {
          "parameters": {
            "command": "={{ $('Code17').item.json.combineCommand }}"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            320,
            3008
          ],
          "id": "947ab574-bde7-4736-a1c9-83e2f44a4e99",
          "name": "Execute Command11"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                  "leftValue": "={{ $json.message.text }}",
                  "rightValue": "/2aato",
                  "operator": {
                    "type": "string",
                    "operation": "startsWith"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            -624,
            2800
          ],
          "id": "bbc33f91-5b8f-41cd-820a-60810b233834",
          "name": "If11"
        },
        {
          "parameters": {
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "text": "I'm working on your 2aato",
            "additionalFields": {
              "appendAttribution": false
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            -480,
            2768
          ],
          "id": "451bd671-bedc-411f-b5be-bb4e19eb9f99",
          "name": "Telegram23",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "command": "=wget \"{{ $json.prompt }}\" -O /tmp/generated.mp4"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            144,
            2752
          ],
          "id": "5f52b85d-acd2-4a3d-b2a2-98c654453ec1",
          "name": "Execute Command13"
        },
        {
          "parameters": {
            "mode": "runOnceForEachItem",
            "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?2aato\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -16,
            2752
          ],
          "id": "8e59fed6-2653-4c4e-9e88-38a4b9676ed5",
          "name": "Code20"
        },
        {
          "parameters": {
            "command": "=ffmpeg -y \\\n-i /tmp/generated.mp4 \\\n-ss {{ $('Code22').item.json.startSecond }} -i /tmp/music.wav \\\n-map 0:v -map 1:a:0 -shortest \\\n-c:v libx264 -c:a aac -b:a 192k -preset veryfast \\\n/tmp/video_watermarked.mp4\n"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            304,
            2752
          ],
          "id": "7e2a24b6-f22f-4da2-8f5f-79aa835b6a21",
          "name": "Execute Command14"
        },
        {
          "parameters": {
            "operation": "sendVideo",
            "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
            "binaryData": true,
            "additionalFields": {
              "caption": "={{ $('Code21').item.json.publicUrl }}"
            }
          },
          "type": "n8n-nodes-base.telegram",
          "typeVersion": 1.2,
          "position": [
            928,
            2752
          ],
          "id": "63c0e840-53c9-44bf-8639-ea4b3ef493e4",
          "name": "Telegram24",
          "webhookId": "WEBHOOKID_REMOVED",
          "credentials": {
            "telegramApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "LS_01_Pets Video Creator"
            }
          }
        },
        {
          "parameters": {
            "fileSelector": "/tmp/video_watermarked.mp4",
            "options": {}
          },
          "type": "n8n-nodes-base.readWriteFile",
          "typeVersion": 1,
          "position": [
            608,
            2752
          ],
          "id": "2aefdef1-61f5-4872-b192-c2c441a1806a",
          "name": "Read/Write Files from Disk8"
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/bakes/${filename}`\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            448,
            2752
          ],
          "id": "9b9d9819-5624-4316-8527-7343fa2d9ccd",
          "name": "Code21"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code21').item.json.filepath }}"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            768,
            2752
          ],
          "id": "bedba7a4-46a9-46f0-8458-8a503eb2c57f",
          "name": "FTP8",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "// Lista de audios actualizada\nconst audios = [\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\",\n  \"https://lemonsushi.com/uploads/aatoMusic/music/canIKeepThis_puma.wav\"\n];\n\n// Elegir un audio al azar\nconst selectedAudio = audios[Math.floor(Math.random() * audios.length)];\n\n// Generar un segundo de inicio entre 5 y 15\nconst startSecond = 0;\n\nreturn [\n  {\n    json: {\n      audioUrl: selectedAudio,\n      startSecond: startSecond\n    }\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            -336,
            2752
          ],
          "id": "4fbcebc0-4e35-4f41-a296-cf4d14df1ce1",
          "name": "Code22"
        },
        {
          "parameters": {
            "command": "=wget \"{{ $json.audioUrl }}\" -O /tmp/music.wav"
          },
          "type": "n8n-nodes-base.executeCommand",
          "typeVersion": 1,
          "position": [
            -176,
            2752
          ],
          "id": "8a728c5f-8ab4-43a1-a0df-592e76ed3912",
          "name": "Execute Command15"
        }
      ],
      "connections": {
        "HTTP Request": {
          "main": [
            [
              {
                "node": "Wait",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code": {
          "main": [
            [
              {
                "node": "HTTP Request",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request1": {
          "main": [
            [
              {
                "node": "Code4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait": {
          "main": [
            [
              {
                "node": "HTTP Request1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram Trigger1": {
          "main": [
            [
              {
                "node": "If7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If1": {
          "main": [
            [
              {
                "node": "Telegram1",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "DeepSeek Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent": {
          "main": [
            [
              {
                "node": "Code1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram1": {
          "main": [
            [
              {
                "node": "AI Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If": {
          "main": [
            [
              {
                "node": "Telegram3",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram3": {
          "main": [
            [
              {
                "node": "Code",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram": {
          "main": [
            []
          ]
        },
        "Simple Memory": {
          "ai_memory": [
            [
              {
                "node": "AI Agent",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "If2": {
          "main": [
            [
              {
                "node": "Telegram5",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code1": {
          "main": [
            [
              {
                "node": "Telegram",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code2": {
          "main": [
            [
              {
                "node": "HTTP Request2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram5": {
          "main": [
            [
              {
                "node": "Code2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request2": {
          "main": [
            [
              {
                "node": "Wait1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request3": {
          "main": [
            [
              {
                "node": "Code5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait1": {
          "main": [
            [
              {
                "node": "HTTP Request3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If3": {
          "main": [
            [
              {
                "node": "Telegram7",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram7": {
          "main": [
            [
              {
                "node": "Code7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code3": {
          "main": [
            [
              {
                "node": "Execute Command",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command": {
          "main": [
            [
              {
                "node": "Execute Command1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command1": {
          "main": [
            [
              {
                "node": "Code6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk": {
          "main": [
            [
              {
                "node": "FTP2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command2": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk1": {
          "main": [
            [
              {
                "node": "FTP1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code4": {
          "main": [
            [
              {
                "node": "Execute Command2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP1": {
          "main": [
            [
              {
                "node": "Telegram2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command3": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk2": {
          "main": [
            [
              {
                "node": "FTP",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code5": {
          "main": [
            [
              {
                "node": "Execute Command3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP": {
          "main": [
            [
              {
                "node": "Telegram6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code6": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP2": {
          "main": [
            [
              {
                "node": "Telegram8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code7": {
          "main": [
            [
              {
                "node": "Execute Command4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command4": {
          "main": [
            [
              {
                "node": "Code3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If4": {
          "main": [
            [
              {
                "node": "Telegram9",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram9": {
          "main": [
            [
              {
                "node": "Code8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "DeepSeek Chat Model1": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent1",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory1": {
          "ai_memory": [
            [
              {
                "node": "AI Agent1",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Code8": {
          "main": [
            [
              {
                "node": "AI Agent1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code9": {
          "main": [
            [
              {
                "node": "Telegram4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent1": {
          "main": [
            [
              {
                "node": "Code9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If5": {
          "main": [
            [
              {
                "node": "Telegram10",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram10": {
          "main": [
            [
              {
                "node": "Code10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code10": {
          "main": [
            [
              {
                "node": "Telegram11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP3": {
          "main": [
            [
              {
                "node": "Telegram12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram11": {
          "main": [
            [
              {
                "node": "FTP3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If6": {
          "main": [
            [
              {
                "node": "Telegram13",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code11": {
          "main": [
            [
              {
                "node": "HTTP Request4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram13": {
          "main": [
            [
              {
                "node": "Code11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request4": {
          "main": [
            [
              {
                "node": "Wait2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request5": {
          "main": [
            [
              {
                "node": "Code12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait2": {
          "main": [
            [
              {
                "node": "HTTP Request5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command5": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk3": {
          "main": [
            [
              {
                "node": "FTP4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP4": {
          "main": [
            [
              {
                "node": "Telegram14",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code12": {
          "main": [
            [
              {
                "node": "Execute Command5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If7": {
          "main": [
            [
              {
                "node": "Telegram15",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If8": {
          "main": [
            [
              {
                "node": "Telegram16",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram16": {
          "main": [
            [
              {
                "node": "Telegram17",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram17": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk4": {
          "main": [
            [
              {
                "node": "Execute Command6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command6": {
          "main": [
            [
              {
                "node": "Code13",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code13": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP5": {
          "main": [
            [
              {
                "node": "Telegram18",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk5": {
          "main": [
            [
              {
                "node": "FTP5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If9": {
          "main": [
            [
              {
                "node": "Telegram19",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram19": {
          "main": [
            [
              {
                "node": "Code16",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command7": {
          "main": [
            [
              {
                "node": "Execute Command8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code14": {
          "main": [
            [
              {
                "node": "Execute Command7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command8": {
          "main": [
            [
              {
                "node": "Code15",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk6": {
          "main": [
            [
              {
                "node": "FTP6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code15": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP6": {
          "main": [
            [
              {
                "node": "Telegram20",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code16": {
          "main": [
            [
              {
                "node": "Execute Command9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command9": {
          "main": [
            [
              {
                "node": "Code14",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If10": {
          "main": [
            [
              {
                "node": "Telegram21",
                "type": "main",
                "index": 0
              }
            ],
            []
          ]
        },
        "Telegram21": {
          "main": [
            [
              {
                "node": "Code19",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk7": {
          "main": [
            [
              {
                "node": "FTP7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code18": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP7": {
          "main": [
            [
              {
                "node": "Telegram22",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command12": {
          "main": [
            [
              {
                "node": "Execute Command10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code19": {
          "main": [
            [
              {
                "node": "Code17",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code17": {
          "main": [
            [
              {
                "node": "Execute Command12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command10": {
          "main": [
            [
              {
                "node": "Execute Command11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command11": {
          "main": [
            [
              {
                "node": "Code18",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If11": {
          "main": [
            [
              {
                "node": "Telegram23",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "If10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Telegram23": {
          "main": [
            [
              {
                "node": "Code22",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command13": {
          "main": [
            [
              {
                "node": "Execute Command14",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code20": {
          "main": [
            [
              {
                "node": "Execute Command13",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command14": {
          "main": [
            [
              {
                "node": "Code21",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Read/Write Files from Disk8": {
          "main": [
            [
              {
                "node": "FTP8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code21": {
          "main": [
            [
              {
                "node": "Read/Write Files from Disk8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP8": {
          "main": [
            [
              {
                "node": "Telegram24",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code22": {
          "main": [
            [
              {
                "node": "Execute Command15",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Execute Command15": {
          "main": [
            [
              {
                "node": "Code20",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "authors": "system migration",
      "name": null,
      "description": null,
      "autosaved": false
    },
    "tags": []
  },
  {
    "updatedAt": "2025-11-09T13:10:27.000Z",
    "createdAt": "2025-04-06T14:30:20.628Z",
    "id": "YFp5224kXZplxRdi",
    "name": "Tacos_ProdAi",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/black-forest-labs/flux-dev-lora/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"{{ $json.prompt }}\",\n    \"go_fast\": true,\n    \"guidance\": 3,\n    \"lora_scale\": 1,\n    \"megapixels\": \"1\",\n    \"num_outputs\": 1,\n    \"aspect_ratio\": \"9:16\",\n    \"lora_weights\": \"\",\n    \"output_format\": \"jpg\",\n    \"output_quality\": 80,\n    \"prompt_strength\": 0.8,\n    \"num_inference_steps\": 28\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          0,
          620
        ],
        "id": "f9605512-e041-40c6-8d40-e0eeac5d925e",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If').item.json.message.text;\n\nconst cleanPrompt = original\n  .replace(/^\\/?image\\s*/i, \"\")   // quita `/image`, `image`, etc.\n  .replace(/^\\/+/, \"\")            // quita cualquier `/` extra\n  .replace(/[\"']/g, \"\")           // elimina comillas dobles y simples\n  .replace(/[\\r\\n]+/g, \" \")       // reemplaza saltos de l√≠nea con espacio\n  .replace(/\\\\/g, \"\")             // elimina backslashes\n  .trim();\n\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -160,
          620
        ],
        "id": "08def401-447d-4f68-9b58-4cabbb9a35f3",
        "name": "Code"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          300,
          620
        ],
        "id": "f370e3c0-96c8-4353-b97d-2eba432fda2e",
        "name": "HTTP Request1"
      },
      {
        "parameters": {
          "amount": 10
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          140,
          620
        ],
        "id": "3085e20e-7d37-4156-9c60-4191e02c1f51",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          -760,
          280
        ],
        "id": "1b443f94-d7b8-401d-82c7-1d2736bbde81",
        "name": "Telegram Trigger1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/script",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -540,
          280
        ],
        "id": "43d35bb1-13b5-4461-82e2-a1502a446565",
        "name": "If1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "Based on the following example, generate a new, highly detailed prompt for a photorealistic AI image that fits within the Pok√©mon-themed desserts category. The new prompt must describe a specific, unique Pok√©mon-inspired dessert placed in a realistic physical setting. Clearly focus on visual elements suitable for image creation: describe precisely what is visible in the foreground, middle ground, and background. Include specific materials, shapes, textures, lighting conditions, and the physical environment. Mention surrounding objects, table surfaces, walls, lighting sources, and other realism-enhancing details.\n\nThe image should evoke wonder, joy, and nostalgia, but primarily describe tangible visual details visible within the frame, similar to a high-end photograph. Avoid overly emotional or abstract adjectives; instead, emphasize clear, visual clarity. Specify the camera angle, lens type, aperture, lighting style (natural, diffused, ambient), and depth of field. Clearly mention at least five distinct visible objects or elements beyond the main subject.\n\nBe specific and detailed, writing as if you are creating instructions for a 3D artist or AI image generator. Prioritize visual realism, clarity, and cinematic composition. Write everything in one cohesive paragraph.\n\nExample:\nA delightful and highly detailed Pok√©mon-themed ice cream cone featuring Pikachu, served in a crispy, golden waffle cone neatly wrapped with clean white paper. The ice cream is composed of two generously sized scoops of smooth, creamy, pastel-yellow ice cream, slightly melted and dripping deliciously down the edges, creating an appealing texture. Carefully placed atop the scoops is an intricately designed 3D edible figure of Pikachu, perfectly rounded with a soft, matte yellow surface. Pikachu's face is adorably captured with round, shiny black eyes reflecting gentle sunlight, bright red cheeks, a tiny smiling mouth, and two perfectly proportioned, erect ears accented with dark chocolate tips. On top of Pikachu's head rests a delicate drizzle of smooth white icing resembling sweet condensed milk, crowned by a single vibrant, glossy red cherry with its stem elegantly extending upwards. The background vividly portrays a cheerful, sunny outdoor festival or fair atmosphere, with subtle yet recognizable blurred details such as colorful fair booths, festive signage, and windows softly illuminated by natural sunlight. The foreground prominently shows a human hand gently holding the ice cream cone, fingertips delicately placed around the cone, featuring stylish, manicured nails with decorative, cute details, enhancing the overall joyful and whimsical vibe of the image. Highly realistic food photography, vivid and cheerful color palette, natural daylight illumination, appealing cinematic depth of field, conveying an inviting, festive outdoor atmosphere.",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.8,
        "position": [
          -180,
          260
        ],
        "id": "4367f24f-ff8e-43e2-ba59-76d36e76ed79",
        "name": "AI Agent"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          -200,
          420
        ],
        "id": "a513c294-14ed-47f5-bb0c-9da6d63008f8",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "={{ $json.cleanedOutput }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          320,
          260
        ],
        "id": "3fe36b75-ebb4-46b9-93d7-96407aa0f10f",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your script",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -340,
          260
        ],
        "id": "9fded458-340d-497b-9c3f-92528a88365b",
        "name": "Telegram1",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/image",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -540,
          640
        ],
        "id": "6775459e-5639-47e5-b549-217547920b0a",
        "name": "If"
      },
      {
        "parameters": {
          "operation": "sendPhoto",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request1').item.json.output[0] }}",
          "additionalFields": {
            "caption": "={{ $('Code4').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1160,
          620
        ],
        "id": "181395cc-b3c2-4ee1-bf1a-70445b1deb3c",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your image",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -340,
          620
        ],
        "id": "3e8e634d-d99e-4657-8814-adcb6455cad8",
        "name": "Telegram3",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          -80,
          420
        ],
        "id": "81900c40-8513-4ca3-a8b2-b76b0cb184a2",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/video",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -540,
          940
        ],
        "id": "7eca3ecf-4192-40a6-9e9c-c507fc5a5cda",
        "name": "If2"
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // Verifica si comienza y termina con comillas dobles\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          140,
          260
        ],
        "id": "a98b7f3d-0729-4776-bec7-43a3c58b2eaf",
        "name": "Code1"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If').item.json.message.text;\n\nconst cleanPrompt = original\n  .replace(/^\\/?video\\s*/i, \"\")   // quita `/image`, `image`, etc.\n  .replace(/^\\/+/, \"\")            // quita cualquier `/` extra\n  .replace(/[\"']/g, \"\")           // elimina comillas dobles y simples\n  .replace(/[\\r\\n]+/g, \" \")       // reemplaza saltos de l√≠nea con espacio\n  .replace(/\\\\/g, \"\")             // elimina backslashes\n  .trim();\n\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -200,
          920
        ],
        "id": "e04b3290-e0d8-46b9-aca8-f64a52abe35a",
        "name": "Code2"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your video",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -360,
          920
        ],
        "id": "4c7af183-97c3-4e75-8db8-15cab9d84639",
        "name": "Telegram5",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/kwaivgi/kling-v1.6-pro/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"motion\",\n    \"duration\": 5,\n    \"cfg_scale\": 0.5,\n    \"start_image\": \"{{ $json.prompt }}\",\n    \"aspect_ratio\": \"9:16\",\n    \"negative_prompt\": \"\"\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -40,
          920
        ],
        "id": "9d570262-1ea8-42ee-bda8-bc3b64e2b0ed",
        "name": "HTTP Request2"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "file": "={{ $('HTTP Request3').item.json.output }}",
          "additionalFields": {
            "caption": "={{ $('Code5').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1180,
          920
        ],
        "id": "6b3922b7-cd91-4be1-93ca-f90f915bbd95",
        "name": "Telegram6",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          260,
          920
        ],
        "id": "00f2bd9f-203a-41ad-9eb0-d04dd4ece8bb",
        "name": "HTTP Request3"
      },
      {
        "parameters": {
          "amount": 7,
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          100,
          920
        ],
        "id": "3843d932-fc6f-4b24-8366-de7610154c28",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/bake",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -520,
          1260
        ],
        "id": "b495b74a-8c87-4fd0-8d66-f5af03494be2",
        "name": "If3"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your bake",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -320,
          1240
        ],
        "id": "ac4db26d-2bad-4af3-b29c-0e4c2e9b65c4",
        "name": "Telegram7",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.prompt }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          400,
          1240
        ],
        "id": "908ac09c-6e0e-481e-a83e-f2cb9c554784",
        "name": "Execute Command"
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If2').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?bake\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If2').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          240,
          1240
        ],
        "id": "1b4b1150-3c24-4043-879b-0b371daace98",
        "name": "Code3"
      },
      {
        "parameters": {
          "command": "=ffmpeg -y \\\n-i /tmp/generated.mp4 \\\n-ss {{ $('Code7').item.json.startSecond }} -i /tmp/music.mp3 \\\n-i \"https://lemonsushi.com/uploads/tacos/tacosAgua.png\" \\\n-filter_complex \"[0:v][2:v]overlay=(W-w)/2:(H-h)/3[output]\" \\\n-map \"[output]\" -map 1:a:0 -shortest \\\n-c:v libx264 -c:a aac -b:a 192k -preset veryfast \\\n/tmp/video_watermarked.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          560,
          1240
        ],
        "id": "0f8878ea-a63e-47fa-9266-709a44db8287",
        "name": "Execute Command1"
      },
      {
        "parameters": {
          "operation": "sendVideo",
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code6').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1220,
          1240
        ],
        "id": "50222cb2-8cdb-4fe4-a81b-dd6eac182a79",
        "name": "Telegram8",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "fileSelector": "/tmp/video_watermarked.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          880,
          1240
        ],
        "id": "fb187df1-193c-4328-80ca-257cb7076b5e",
        "name": "Read/Write Files from Disk"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request1').item.json.output[0] }}\" -O /tmp/generated.jpg"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          620,
          620
        ],
        "id": "64da087e-647e-4932-956d-6599b42b9865",
        "name": "Execute Command2"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.jpg",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          800,
          620
        ],
        "id": "5931b60b-d67a-4cfb-ae91-61914b60b024",
        "name": "Read/Write Files from Disk1"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code4').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1000,
          620
        ],
        "id": "4f21f6a9-7046-456a-be9d-f25ccd7123af",
        "name": "FTP1",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/tacos/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/tacos/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          460,
          620
        ],
        "id": "b4464775-0ba7-4ec0-b8d0-3204a00b352c",
        "name": "Code4"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request3').item.json.output }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          620,
          920
        ],
        "id": "9f18ff78-5f69-4646-a035-7b0e2ab08c31",
        "name": "Execute Command3"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          800,
          920
        ],
        "id": "221f31ff-8969-4c6e-aff3-0a0b741d0bd4",
        "name": "Read/Write Files from Disk2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code5').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1000,
          920
        ],
        "id": "a6afef15-fcad-401f-a98e-5af1680c149b",
        "name": "FTP",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/tacos/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/tacos/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          440,
          920
        ],
        "id": "b973c875-1fc9-4fd5-a37e-82b9033707d3",
        "name": "Code5"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/tacos/bakes/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/tacos/bakes/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          720,
          1240
        ],
        "id": "4ec8b88d-a06d-4fbd-a6d2-024f3e9d87d9",
        "name": "Code6"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code6').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1060,
          1240
        ],
        "id": "5fdb6f31-13fb-4480-8e28-d9599dc11057",
        "name": "FTP2",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Lista de audios\nconst audios = [\n  \"https://lemonsushi.com/uploads/tacos/audios/Advertising.mp3\",\n  \"https://lemonsushi.com/uploads/tacos/audios/epic.mp3\",\n  \"https://lemonsushi.com/uploads/tacos/audios/StudioKolonna.mp3\",\n  \"https://lemonsushi.com/uploads/tacos/audios/thisepic.mp3\"\n];\n\n// Elegir un audio al azar\nconst selectedAudio = audios[Math.floor(Math.random() * audios.length)];\n\n// Generar un segundo de inicio entre 5 y 15\nconst startSecond = Math.floor(Math.random() * 11) + 5;\n\nreturn [\n  {\n    json: {\n      audioUrl: selectedAudio,\n      startSecond: startSecond\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -120,
          1240
        ],
        "id": "24b3bce2-1d11-4f80-a1f6-1cb11b3c53d2",
        "name": "Code7"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $json.audioUrl }}\" -O /tmp/music.mp3"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          40,
          1240
        ],
        "id": "28938dab-32d8-4a28-ab5c-7b17cad7c4db",
        "name": "Execute Command4"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/publish",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -520,
          1480
        ],
        "id": "3f8bc6db-2b42-4c9b-b1d5-70d26ac53d0f",
        "name": "If4"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "I'm working on your publish",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -320,
          1460
        ],
        "id": "64ac5ebd-beff-4ce3-8b1c-1b8ef3fe2813",
        "name": "Telegram9",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?publish\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -120,
          1460
        ],
        "id": "9cbdd9f5-51f2-4df9-bbaf-5f9a0d6d65a7",
        "name": "Code8"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=You are an expert in creating viral content for TikTok and YouTube Shorts. Your task is to generate a short, catchy, and visually imaginative title based on this video description:\n\n{{ $json.prompt }}\n\nThis title should be optimized to go viral for a channel focused on futuristic toys, Japanese gadgets, gachapon, arcade games, and collectible culture. It must feel magical, emotional, or jaw-dropping, and provoke curiosity or nostalgia.\n\nIt should include emojis and 3 or more popular hashtags at the end that are relevant to the video, such as #japan, #toys, #future, #gachapon, #anime, #kawaii, #otaku, #tech, etc.\n\n‚úÖ Respond with only the final title text, no explanations.\n‚úÖ Do not use quotation marks or formatting.\n‚úÖ Avoid generic titles like ‚Äúyou won‚Äôt believe this‚Äù or ‚Äúthe future is here‚Äù ‚Äî be specific about what‚Äôs happening or what the toy does.\n\nExample of the final format:\nA toy printer that creates your dream figure in seconds ü§Øüß∏ #japan #toys #futuretech",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.8,
        "position": [
          60,
          1460
        ],
        "id": "a9929bf1-9f90-43ea-92ae-1b1446ed9577",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          60,
          1640
        ],
        "id": "3d4a9a10-24ca-4ced-9661-2d022ef91e65",
        "name": "DeepSeek Chat Model1",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          180,
          1640
        ],
        "id": "989f4047-9aa1-4e7b-991e-b386f93dde40",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger1').item.json.message.chat.id }}",
          "text": "={{ $json.cleanedOutput }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          640,
          1460
        ],
        "id": "ac288add-fa5c-446d-8fb9-b067a5e61f0f",
        "name": "Telegram4",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Tacos Bot"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // Verifica si comienza y termina con comillas dobles\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          420,
          1460
        ],
        "id": "68f3097f-76ff-4602-b3d1-6045748b26bc",
        "name": "Code9"
      },
      {
        "parameters": {
          "content": "## Futuristic Toys Prompt\n\nBased on the following two examples, generate a new, highly detailed prompt for a photorealistic AI image that fits within the futuristic toy category. The new prompt must describe a specific, unique futuristic toy or toy-related technology in a realistic physical setting. Focus on clear, visual elements that could be used to create an image: describe what is in the foreground, middle ground, and background. Include specific materials, shapes, textures, lighting conditions, and the physical environment. Mention surrounding objects, table surfaces, walls, lighting sources, and any details that add realism to the image.\n\nThe image should evoke wonder and nostalgia, but the primary goal is to describe what is clearly visible in the frame ‚Äî like a scene captured by a high-end camera. Do not just use emotional or abstract adjectives ‚Äî focus on tangible, visible details. Describe the angle of the shot, the camera settings (lens, aperture), lighting type (natural, diffused, ambient), and depth of field. Mention at least five visible objects or elements in the scene beyond the main subject.\n\nBe specific. Write as if you are describing a photo for a 3D artist or AI image generator. Focus on visual clarity, realism, and cinematic composition.\n\nMake sure that everything is in 1 paragraph\n\nExample A:\nA futuristic hyper-realistic 3D printer in the process of materializing a highly detailed toy, halfway complete. The printer has a sleek, metallic design with transparent panels showing intricate inner mechanisms. The toy being printed is a colorful, complex action figure with glowing accents, soft textures, and realistic features‚Äîhalf of it already formed, while the other half is still emerging from a translucent gel-like material. The 3D printer is placed on a slightly messy wooden desk in a dimly lit bedroom. Scattered around the desk are video game controllers, colored pencils, paper sketches, cables, and some toy parts. The scene has a cozy, slightly chaotic feel, as if belonging to a creative kid or hobbyist. Bright, diffused lighting highlights the toy and printer, while the background remains softly blurred. Ultra-photorealistic, shallow depth of field, cinematic lighting, 85mm lens, shot on a full-frame camera.\n\nExample B: \nA brand-new futuristic toy of an extremely cute baby animal, just taken out of its packaging. The toy resembles a baby kitten but with exaggerated proportions‚Äîextra large sparkling eyes, a slightly oversized round head, chubby body, soft pastel fur, and tiny paws. It looks soft, warm, and irresistibly huggable. The toy is sitting inside a high-end futuristic box with foam inserts and soft interior lights. The box is opened, and bits of packaging material surround the toy. The setting is a cluttered bedroom desk with video game controllers, candy wrappers, pencils, and notebooks nearby. Warm ambient lighting and a shallow depth of field give it a cozy, cinematic feel. Ultra-photorealistic, high resolution, 85mm lens, full-frame camera, realistic shadows and textures.",
          "height": 180,
          "width": 300
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          920,
          140
        ],
        "id": "ff6119b9-28eb-4f0a-bb6c-3e749d902e06",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "## Pokemon Deserts\n\nBased on the following example, generate a new, highly detailed prompt for a photorealistic AI image that fits within the Pok√©mon-themed desserts category. The new prompt must describe a specific, unique Pok√©mon-inspired dessert placed in a realistic physical setting. Clearly focus on visual elements suitable for image creation: describe precisely what is visible in the foreground, middle ground, and background. Include specific materials, shapes, textures, lighting conditions, and the physical environment. Mention surrounding objects, table surfaces, walls, lighting sources, and other realism-enhancing details.\n\nThe image should evoke wonder, joy, and nostalgia, but primarily describe tangible visual details visible within the frame, similar to a high-end photograph. Avoid overly emotional or abstract adjectives; instead, emphasize clear, visual clarity. Specify the camera angle, lens type, aperture, lighting style (natural, diffused, ambient), and depth of field. Clearly mention at least five distinct visible objects or elements beyond the main subject.\n\nBe specific and detailed, writing as if you are creating instructions for a 3D artist or AI image generator. Prioritize visual realism, clarity, and cinematic composition. Write everything in one cohesive paragraph.\n\nExample:\nA delightful and highly detailed Pok√©mon-themed ice cream cone featuring Pikachu, served in a crispy, golden waffle cone neatly wrapped with clean white paper. The ice cream is composed of two generously sized scoops of smooth, creamy, pastel-yellow ice cream, slightly melted and dripping deliciously down the edges, creating an appealing texture. Carefully placed atop the scoops is an intricately designed 3D edible figure of Pikachu, perfectly rounded with a soft, matte yellow surface. Pikachu's face is adorably captured with round, shiny black eyes reflecting gentle sunlight, bright red cheeks, a tiny smiling mouth, and two perfectly proportioned, erect ears accented with dark chocolate tips. On top of Pikachu's head rests a delicate drizzle of smooth white icing resembling sweet condensed milk, crowned by a single vibrant, glossy red cherry with its stem elegantly extending upwards. The background vividly portrays a cheerful, sunny outdoor festival or fair atmosphere, with subtle yet recognizable blurred details such as colorful fair booths, festive signage, and windows softly illuminated by natural sunlight. The foreground prominently shows a human hand gently holding the ice cream cone, fingertips delicately placed around the cone, featuring stylish, manicured nails with decorative, cute details, enhancing the overall joyful and whimsical vibe of the image. Highly realistic food photography, vivid and cheerful color palette, natural daylight illumination, appealing cinematic depth of field, conveying an inviting, festive outdoor atmosphere.",
          "height": 180,
          "width": 300
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1280,
          120
        ],
        "id": "4fb8148c-1740-441b-bbc1-ee051ce7e7d0",
        "name": "Sticky Note1"
      }
    ],
    "connections": {
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger1": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Telegram1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram1": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Telegram3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram3": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          []
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Telegram5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram5": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request3": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Telegram7",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram7": {
        "main": [
          [
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Execute Command1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command1": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk": {
        "main": [
          [
            {
              "node": "FTP2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command2": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Execute Command2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command3": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Execute Command3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Telegram6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP2": {
        "main": [
          [
            {
              "node": "Telegram8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "Execute Command4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command4": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Telegram9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram9": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "Telegram4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "36ca44e9-eac3-44df-a015-789a5e5442f8",
    "activeVersionId": null,
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-04-06T14:30:20.630Z",
        "createdAt": "2025-04-06T14:30:20.630Z",
        "role": "workflow:owner",
        "workflowId": "YFp5224kXZplxRdi",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-11-09T13:09:57.000Z",
    "createdAt": "2025-04-23T01:37:14.273Z",
    "id": "efj6KWKjCCcaMj3M",
    "name": "videoAICreator",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "updates": [
            "message",
            "callback_query"
          ],
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          -680,
          -1360
        ],
        "id": "58ddb2da-53e3-47d5-ad39-e764b785dd8d",
        "name": "Telegram Trigger",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/help",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -200,
          -1360
        ],
        "id": "3add98fd-609b-4d6b-aad6-990d7c009215",
        "name": "If7"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=this is the help for the commands that you can use Chimo. \n/script              # is going create a new idea like chatgpt\n/image your prompt   # is going to create an image like sora\n/video link          # is going to create a video with replicate\n/bake link           # is going to add music and watermark\n/publish prompt      # is going to give you a title idea with hastags\n/aato link           # adds aato music\n/combo link1 link2   # combines multiple videos\n/pvideo link prompt  # is going to create a video with prompt\nfor the pvideo you have to separate de /pvideo link and prompt with double underscore ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          0,
          -1380
        ],
        "id": "35cdd672-9e13-423d-a887-ccc99b8abaf6",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/12story",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -120,
          180
        ],
        "id": "d26eef95-d6be-4e34-b592-ab631e8c6536",
        "name": "If2"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Process prompts finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          2240,
          660
        ],
        "id": "834ecbd7-efa0-462f-8630-daf74c46d726",
        "name": "Telegram9",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/idea",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -140,
          -480
        ],
        "id": "15fed60d-26e2-4d93-9dce-604ec4d91057",
        "name": "If4"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your idea",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          40,
          -500
        ],
        "id": "11b68c95-3762-4243-96ca-e877a18e96c3",
        "name": "Telegram11",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('If4').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?idea\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If4').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          200,
          -500
        ],
        "id": "16289f9f-fd84-4d0c-981a-288951098941",
        "name": "Code10"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          700,
          -540
        ],
        "id": "baaea189-9599-4bc7-957a-3a5117a6368e",
        "name": "Telegram12",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          380,
          -400
        ],
        "id": "1f488270-401d-4ac1-8b8e-52359e827827",
        "name": "DeepSeek Chat Model3",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nGenerate one unique and imaginative video ideas for a professional storytelling channel, ensuring each idea adheres to this genre:{{ $json.prompt }} . Each idea must include a working title, detailed main character(s) with names, roles, and brief descriptions, and a succinct plot summary in 1‚Äì2 sentences. Optionally incorporate details on the setting or world-building, genre and tone, overarching theme or message, unique visual or stylistic elements, and target audience if applicable. Push creative boundaries with unexpected narrative twists, vibrant worlds, and unforgettable character journeys to captivate both creators and audiences while maintaining high-quality storytelling. do not add any extra information nor titles other than the idea.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- the ouput must be in 1 paragraph",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          380,
          -540
        ],
        "id": "b5588d8f-c63e-4eb7-8a1c-e42b99674ebe",
        "name": "Image Prompt Agent"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          500,
          -380
        ],
        "id": "5276852b-0b98-47a9-8e44-2bf6f4ce5fe4",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          2380,
          280
        ],
        "id": "cde44ec9-dcfd-4705-b6b5-732a528c722d",
        "name": "DeepSeek Chat Model4",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2480,
          300
        ],
        "id": "ff2d3dac-88c6-4f40-ad97-13adb29cf925",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/prompts",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -60,
          820
        ],
        "id": "156f387e-0adb-4185-9af4-f0d1b7e70fe2",
        "name": "If6"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your prompts",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          140,
          800
        ],
        "id": "493b6bd6-8182-45a7-a90e-5f9c7d90b0a9",
        "name": "Telegram17",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?prompts\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If6').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          300,
          800
        ],
        "id": "27dd1916-d440-4244-8138-b62db5508208",
        "name": "Code18"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          620,
          800
        ],
        "id": "d3fb85f7-54e3-4bb4-8a82-381b54c1b1e6",
        "name": "Loop Over Items4"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          800,
          980
        ],
        "id": "0fc44a4b-faf4-4fca-b1a7-0f948331f333",
        "name": "DeepSeek Chat Model10",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Task\nYou are a professional script writer. You will receive:\n1. Story Idea\n2. Characters Description\n3. Narrator Script Sentence\n\nwith this information, you will provide a shot that is going to be presented at the time the narrator is saying his script. \n\nyou will provide:\n\n- Camera angle (specify if its a wide, medium, closeup, or any other kind of shot? you must also specify if the camera is looking from the front, side, 3/4 or back)\n- Description of the Action (Simple description Subject + verb + location, if there is no subject, describe the location, this information a 5 year old must be able to understand, for example: the dog is running in the park, a view of the clouds on the park)\n- Who is in the Scene (Specify who is in the scene, if the name is available in the character description you can use the name, if not just specify who, for example: Marta, her dog and 2 other people, another example: Oliver, and 2 other dogs)\n- Character description (considering the previous parameter Who is in the Scene, check the character Description, and who ever is in the scene provide the same description is in the Character Description, for example: Oliver is a golden retriver 5 years old with long hair) \n\neach one of the previously mentioned request are going to be deliver in individual paragraphs, in the same order that was mentioned.\n\n\n#Story Idea\n{{ $json.storyIdea }}\n\n# Character Description\n{{ $json.allCharsDescription }}\n\n# Narrator Script\n{{ $json.narratorScript }}\n\n\n\n# Rules\n- Every character mentioned in the Character description must use the **exact description** from the reference list.\n- Do not invent or change any character details.\n- If a scene is purely environmental, still describe it using the same structure, just without character data\n- Do not number the prompts or use labels like Scene1 or VersionB.\n- Do not include any extra explanations or formatting.\n\n\n\n## IMPORTANT\n- Do not include any extra explanations or formatting.\n- Do not include a title in each paragraph, only clean paragraphs ready to use\n- Output must be 4 paragraphs including the information previously requested. ",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          820,
          800
        ],
        "id": "0152e772-1afc-4da0-b96a-bc83a763e2df",
        "name": "Image Prompt Agent7"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          920,
          980
        ],
        "id": "29092867-7916-43f6-a16d-ea0195aa0909",
        "name": "Simple Memory7"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code18').item.json.prompt }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items4').item.json.row_number }}",
              "pCamAngle": "={{ $json.cameraAngle }}",
              "pAction": "={{ $json.action }}",
              "pWhoIsHere": "={{ $json.whoIsHere }}",
              "pCharDescription": "={{ $json.characterDescription }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pStyle",
                "displayName": "pStyle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pTime",
                "displayName": "pTime",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pCamAngle",
                "displayName": "pCamAngle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "pAction",
                "displayName": "pAction",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "pWhoIsHere",
                "displayName": "pWhoIsHere",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "pCharDescription",
                "displayName": "pCharDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1340,
          820
        ],
        "id": "546353f1-547f-49fa-8f7c-ad0e955a8053",
        "name": "Google Sheets8",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          1020,
          660
        ],
        "id": "9d5496ce-64bd-4132-a937-29951b620c16",
        "name": "Limit"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('Code18').item.json.prompt }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          2440,
          660
        ],
        "id": "d994a7f9-c1d5-42a8-b33f-feb3e3289d40",
        "name": "Telegram10",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/batchImages",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -140,
          1180
        ],
        "id": "cffa69c8-4ed8-4774-9641-2fc76587b4bc",
        "name": "If10"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your batch images",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          20,
          1160
        ],
        "id": "726bcd6d-c8c5-4fea-8592-a9abbc8a245d",
        "name": "Telegram19",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?batchImages\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If10').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          160,
          1160
        ],
        "id": "7c8b83fd-4efe-4a95-af3a-eb1048583366",
        "name": "Code21"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          300,
          1160
        ],
        "id": "561ecb6e-4a81-4a86-97bb-a9f59c7f504a",
        "name": "Google Sheets",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 768,\n      \"height\": 432,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          1520,
          1340
        ],
        "id": "13d06e39-5f68-41d9-b148-605688053ed7",
        "name": "ComfyUI1",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          600,
          1180
        ],
        "id": "d2bf1201-0eb1-4d75-8b5b-f1fb33acdcb6",
        "name": "Loop Over Items"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code4').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1700,
          1340
        ],
        "id": "dcdb88c4-179f-4520-bec1-2e5e6c2901fa",
        "name": "FTP1",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          940,
          1320
        ],
        "id": "f82bbb1f-dbad-40fd-b08b-e87b38b3e5a7",
        "name": "Code4"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code21').item.json.prompt }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items').item.json.row_number }}",
              "imageLink": "={{ $('Code4').item.json.publicUrl }}",
              "imageStatus": "done",
              "videoStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundFxStatus",
                "displayName": "soundFxStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoPrompt",
                "displayName": "videoPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundPrompt",
                "displayName": "soundPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundFxLink",
                "displayName": "soundFxLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1900,
          1340
        ],
        "id": "1401ec38-041d-4288-bdcc-f819099b2447",
        "name": "Google Sheets1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          1240,
          1160
        ],
        "id": "d22d6b92-07f6-4bf9-b17a-75c6e175752a",
        "name": "Limit1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/batchHtml",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -120,
          2420
        ],
        "id": "f8f34027-f0bd-47a6-92ca-f248e0d726b2",
        "name": "If11"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your batch html",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          80,
          2400
        ],
        "id": "266b8778-3132-4f0e-971b-7344111a4cd0",
        "name": "Telegram20",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\n\n// Extrae la √∫ltima palabra\nconst words = original.trim().split(/\\s+/);\nconst cleanPrompt = words.length > 0 ? words[words.length - 1] : \"\";\n\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('Telegram Trigger').item.json.message.from.id\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2860,
          2380
        ],
        "id": "b5a31d2c-91fc-4696-94cf-bc47f97188a2",
        "name": "Code22"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code22').item.json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              },
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "done"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3180,
          2380
        ],
        "id": "08d66926-6e6d-4734-a94a-4ff19b94f348",
        "name": "Google Sheets2",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const { Buffer } = global;\n\nconst rows = items.map(item => {\n  const {\n    imageLink, videoLink, narratorScript,\n    pStyle, pTime, pCamAngle, pAction, pWhoIsHere, pCharDescription\n  } = item.json;\n\n  // Media (imagen y video)\n  const media = [];\n  if (imageLink?.trim()) {\n    media.push(`<img src=\"${imageLink}\" class=\"media\">`);\n  }\n  if (videoLink?.trim()) {\n    media.push(`\n      <video controls class=\"media\">\n        <source src=\"${videoLink}\" type=\"video/mp4\">\n        Your browser does not support the video tag.\n      </video>`);\n  }\n\n  // Prompt combinado\n  const promptFields = [pStyle, pTime, pCamAngle, pAction, pWhoIsHere, pCharDescription];\n  const promptParts = promptFields\n    .map(x => (x && x.trim()) ? x.trim() : '')\n    .filter(Boolean);\n  const prompt = promptParts.length ? `<div><strong>Prompt:</strong> ${promptParts.join(', ')}</div>` : '';\n\n  // Narrador\n  const narrator = narratorScript?.trim()\n    ? `<div><strong>Narrator:</strong> ${narratorScript.trim()}</div>`\n    : '';\n\n  return `\n    <tr>\n      <td class=\"media-cell\">${media.join('<br>')}</td>\n      <td class=\"text-cell\">${prompt}${narrator}</td>\n    </tr>`;\n}).join('\\n');\n\nconst htmlContent = `\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\">\n<title>Project Media Overview</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n  }\n  table {\n    width: 100%;\n    border-collapse: collapse;\n  }\n  td {\n    border: 1px solid #ccc;\n    padding: 8px;\n    vertical-align: top;\n  }\n  .media-cell {\n    width: 220px;\n  }\n  .media {\n    max-width: 200px;\n    margin-bottom: 6px;\n    display: block;\n  }\n  .text-cell div {\n    margin-bottom: 6px;\n    line-height: 1.3;\n  }\n</style>\n</head>\n<body>\n<h1>Project Media Overview</h1>\n<table>\n<tbody>\n${rows}\n</tbody>\n</table>\n</body>\n</html>\n`;\n\nreturn [\n  {\n    binary: {\n      data: {\n        data: Buffer.from(htmlContent, 'utf-8').toString('base64'),\n        mimeType: 'text/html',\n        fileName: 'index.html',\n      }\n    }\n  }\n];\n\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3460,
          2380
        ],
        "id": "7d0f6302-1e9c-4f17-99cb-ca36a4b6f58b",
        "name": "Code5"
      },
      {
        "parameters": {
          "jsCode": "const filename = $input.first().json.prompt  + \".html\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/images/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3000,
          2380
        ],
        "id": "22723994-d526-4091-9cb0-09bad59c53f1",
        "name": "Code6"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code6').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3660,
          2380
        ],
        "id": "a3d2f04b-f51b-4a8f-a402-559e3611d362",
        "name": "FTP",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').first().json.message.chat.id }}",
          "text": "={{ $('Code6').first().json.publicUrl}}",
          "replyMarkup": "=",
          "forceReply": {},
          "replyKeyboardOptions": {},
          "replyKeyboardRemove": {},
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4100,
          2340
        ],
        "id": "601c7a50-ebd5-4c7e-85af-a55232ad3520",
        "name": "Telegram16",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/batchNarrator",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -100,
          2680
        ],
        "id": "72dc469e-86fa-4279-a743-71333bcafa4d",
        "name": "If3"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your batch audio",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          100,
          2660
        ],
        "id": "e92bb213-db9e-4c5c-a2a4-5df2f9512e92",
        "name": "Telegram7",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "8c269fad-e72b-4471-a564-6041c1d41f41",
                "name": "binary",
                "value": "={{$json[\"audioContent\"]}}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1480,
          2740
        ],
        "id": "dde5bed6-8be9-4929-949f-83b0b0e16819",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "binary",
          "options": {}
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          1620,
          2740
        ],
        "id": "229ac053-6525-4ee2-a1ab-2bb5cf890227",
        "name": "Convert to File"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://texttospeech.googleapis.com/v1/text:synthesize",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googleOAuth2Api",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"text\": \"{{ $json.cleanedText }}\"\n  },\n  \"voice\": {\n    \"languageCode\": \"en-US\",\n    \"name\": \"en-US-Chirp3-HD-Enceladus\"\n  },\n  \"audioConfig\": {\n    \"audioEncoding\": \"MP3\",\n    \"speakingRate\": 0.92,\n    \"pitch\": 0,\n    \"volumeGainDb\": 2.0\n  }\n}\n",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1300,
          2740
        ],
        "id": "64192407-f553-418e-97d9-9174a003f526",
        "name": "HTTP Request2",
        "credentials": {
          "googleOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google account"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?batchNarrator\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If11').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          260,
          2660
        ],
        "id": "9ea6f5ab-da04-4dea-9394-e4a59b361816",
        "name": "Code23"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          440,
          2660
        ],
        "id": "6bdd00a3-014e-4ce6-b10d-66d65f029665",
        "name": "Google Sheets4",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          620,
          2660
        ],
        "id": "9e48976e-6ce5-4a55-bf64-5c511ba9626d",
        "name": "Loop Over Items1"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp3\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/narrator/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/narrator/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          800,
          2740
        ],
        "id": "dfcd42f3-83f1-4680-8473-f07030274c66",
        "name": "Code9"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code9').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          2300,
          2740
        ],
        "id": "b1c966e8-69db-460c-85b2-469e3507732f",
        "name": "FTP3",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code23').item.json.prompt }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items1').item.json.row_number }}",
              "narratorLink": "={{ $('Code9').item.json.publicUrl }}",
              "narratorStatus": "done"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "soundFxStatus",
                "displayName": "soundFxStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoPrompt",
                "displayName": "videoPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundPrompt",
                "displayName": "soundPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundFxLink",
                "displayName": "soundFxLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2460,
          2740
        ],
        "id": "12d6bd26-7411-4fc3-9c88-2629a4288bd7",
        "name": "Google Sheets5",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Process Narrator finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1920,
          2540
        ],
        "id": "a82b9125-7861-48b3-bab1-a6197f6c1d8b",
        "name": "Telegram21",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          980,
          2580
        ],
        "id": "64180b53-7247-40a5-bb37-43370c4ee662",
        "name": "Limit2"
      },
      {
        "parameters": {
          "content": "## Help\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -500,
          -1360
        ],
        "id": "8170806b-e57f-4e66-9231-2bfbf64a1ade",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "## Idea\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -440,
          -460
        ],
        "id": "9f37653e-9805-4085-b565-a808721f3cee",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "content": "## Story\n\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -420,
          340
        ],
        "id": "4b6e18ca-5bb2-471a-b2c2-3efad8b4412d",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "content": "## Prompts\n\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -400,
          800
        ],
        "id": "e4e746c0-b35e-480b-80f4-cba8fc453406",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "content": "## Batch Images\n\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -460,
          1180
        ],
        "id": "951e61f4-5062-4480-81fc-82e7ed85dbde",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "content": "## Batch Html",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -440,
          2440
        ],
        "id": "35e70404-d5e0-425d-af48-a0a6919959da",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "content": "## Batch Narrator\n\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -440,
          2700
        ],
        "id": "e0f4c2a9-03d4-4f02-88df-2099ffac5ce5",
        "name": "Sticky Note6"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Code17').first().json.fullPrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1160,
          1320
        ],
        "id": "d511ad22-d4c7-493e-809e-099342f5df78",
        "name": "Code"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/batchVideos",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -120,
          2000
        ],
        "id": "ebcd3514-4704-4c9a-880e-5fd01fcdb99d",
        "name": "If"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your batch videos",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          60,
          1980
        ],
        "id": "f91978ce-d8f0-4532-9159-3c4af4ae65fd",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?batchVideos\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          240,
          1980
        ],
        "id": "cc628028-3485-4cb3-915c-58ff9d7d875d",
        "name": "Code24"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          400,
          1980
        ],
        "id": "02debe38-501b-40a2-b270-845220b693c5",
        "name": "Google Sheets9",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          600,
          2000
        ],
        "id": "500765cb-570e-4d51-8d8b-4ddf260087e6",
        "name": "Loop Over Items2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code11').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1660,
          2160
        ],
        "id": "e1946725-edd5-4e45-a448-7386a1d5d4b7",
        "name": "FTP4",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          760,
          2160
        ],
        "id": "1190fb48-588f-4baf-97db-e9ffca6e0a68",
        "name": "Code11"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code24').item.json.prompt }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items2').item.json.row_number }}",
              "videoLink": "={{ $('Code11').item.json.publicUrl }}",
              "videoStatus": "done"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundFxStatus",
                "displayName": "soundFxStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoPrompt",
                "displayName": "videoPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundPrompt",
                "displayName": "soundPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "soundFxLink",
                "displayName": "soundFxLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1880,
          2160
        ],
        "id": "8eadae2e-143d-4aba-a822-077d037663be",
        "name": "Google Sheets10",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          1020,
          1980
        ],
        "id": "8ef95846-4319-46a0-9549-a63c22c24ade",
        "name": "Limit3"
      },
      {
        "parameters": {
          "content": "## Batch Videos\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -460,
          2000
        ],
        "id": "aba22855-0357-4f77-a72e-c233ba77f756",
        "name": "Sticky Note7"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Loop Over Items2').first().json.pAction; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          920,
          2160
        ],
        "id": "c6ac036e-78b3-4046-990f-6013c1da775d",
        "name": "Code1"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Loop Over Items1').first().json.narratorScript; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1020,
          2740
        ],
        "id": "c03e1a26-dd41-402d-9187-ed7629642364",
        "name": "Code2"
      },
      {
        "parameters": {
          "workflow": "={\n  \"3\": {\n    \"inputs\": {\n      \"seed\": 1043102782273638,\n      \"steps\": 20,\n      \"cfg\": 6,\n      \"sampler_name\": \"uni_pc\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"54\",\n        0\n      ],\n      \"positive\": [\n        \"50\",\n        0\n      ],\n      \"negative\": [\n        \"50\",\n        1\n      ],\n      \"latent_image\": [\n        \"50\",\n        2\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"6\": {\n    \"inputs\": {\n      \"text\": \"{{ $('Code1').item.json.cleanedText }}\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"7\": {\n    \"inputs\": {\n      \"text\": \"Ëâ≤Ë∞ÉËâ≥‰∏ΩÔºåËøáÊõùÔºåÈùôÊÄÅÔºåÁªÜËäÇÊ®°Á≥ä‰∏çÊ∏ÖÔºåÂ≠óÂπïÔºåÈ£éÊ†ºÔºå‰ΩúÂìÅÔºåÁîª‰ΩúÔºåÁîªÈù¢ÔºåÈùôÊ≠¢ÔºåÊï¥‰ΩìÂèëÁÅ∞ÔºåÊúÄÂ∑ÆË¥®ÈáèÔºå‰ΩéË¥®ÈáèÔºåJPEGÂéãÁº©ÊÆãÁïôÔºå‰∏ëÈôãÁöÑÔºåÊÆãÁº∫ÁöÑÔºåÂ§ö‰ΩôÁöÑÊâãÊåáÔºåÁîªÂæó‰∏çÂ•ΩÁöÑÊâãÈÉ®ÔºåÁîªÂæó‰∏çÂ•ΩÁöÑËÑ∏ÈÉ®ÔºåÁï∏ÂΩ¢ÁöÑÔºåÊØÅÂÆπÁöÑÔºåÂΩ¢ÊÄÅÁï∏ÂΩ¢ÁöÑËÇ¢‰ΩìÔºåÊâãÊåáËûçÂêàÔºåÈùôÊ≠¢‰∏çÂä®ÁöÑÁîªÈù¢ÔºåÊùÇ‰π±ÁöÑËÉåÊôØÔºå‰∏âÊù°ËÖøÔºåËÉåÊôØ‰∫∫ÂæàÂ§öÔºåÂÄíÁùÄËµ∞\",\n      \"clip\": [\n        \"38\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"3\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"37\": {\n    \"inputs\": {\n      \"unet_name\": \"Wan2.1\\\\wan2.1_i2v_480p_14B_fp8_scaled.safetensors\",\n      \"weight_dtype\": \"default\"\n    },\n    \"class_type\": \"UNETLoader\",\n    \"_meta\": {\n      \"title\": \"Load Diffusion Model\"\n    }\n  },\n  \"38\": {\n    \"inputs\": {\n      \"clip_name\": \"umt5_xxl_fp8_e4m3fn_scaled.safetensors\",\n      \"type\": \"wan\",\n      \"device\": \"default\"\n    },\n    \"class_type\": \"CLIPLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP\"\n    }\n  },\n  \"39\": {\n    \"inputs\": {\n      \"vae_name\": \"wan_2.1_vae.safetensors\"\n    },\n    \"class_type\": \"VAELoader\",\n    \"_meta\": {\n      \"title\": \"Load VAE\"\n    }\n  },\n  \"49\": {\n    \"inputs\": {\n      \"clip_name\": \"clip_vision_h.safetensors\"\n    },\n    \"class_type\": \"CLIPVisionLoader\",\n    \"_meta\": {\n      \"title\": \"Load CLIP Vision\"\n    }\n  },\n  \"50\": {\n    \"inputs\": {\n      \"width\": 768,\n      \"height\": 432,\n      \"length\": 120,\n      \"batch_size\": 1,\n      \"positive\": [\n        \"6\",\n        0\n      ],\n      \"negative\": [\n        \"7\",\n        0\n      ],\n      \"vae\": [\n        \"39\",\n        0\n      ],\n      \"clip_vision_output\": [\n        \"51\",\n        0\n      ],\n      \"start_image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"WanImageToVideo\",\n    \"_meta\": {\n      \"title\": \"WanImageToVideo\"\n    }\n  },\n  \"51\": {\n    \"inputs\": {\n      \"crop\": \"none\",\n      \"clip_vision\": [\n        \"49\",\n        0\n      ],\n      \"image\": [\n        \"52\",\n        0\n      ]\n    },\n    \"class_type\": \"CLIPVisionEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Vision Encode\"\n    }\n  },\n  \"52\": {\n    \"inputs\": {\n      \"image\": \"achu (2).jpg\"\n    },\n    \"class_type\": \"LoadImage\",\n    \"_meta\": {\n      \"title\": \"Load Image\"\n    }\n  },\n  \"54\": {\n    \"inputs\": {\n      \"shift\": 8.000000000000002,\n      \"model\": [\n        \"37\",\n        0\n      ]\n    },\n    \"class_type\": \"ModelSamplingSD3\",\n    \"_meta\": {\n      \"title\": \"ModelSamplingSD3\"\n    }\n  },\n  \"55\": {\n    \"inputs\": {\n      \"frame_rate\": 12,\n      \"loop_count\": 0,\n      \"filename_prefix\": \"comfyUI\",\n      \"format\": \"video/h264-mp4\",\n      \"pix_fmt\": \"yuv420p\",\n      \"crf\": 19,\n      \"save_metadata\": true,\n      \"trim_to_audio\": false,\n      \"pingpong\": false,\n      \"save_output\": true,\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"VHS_VideoCombine\",\n    \"_meta\": {\n      \"title\": \"Video Combine üé•üÖ•üÖóüÖ¢\"\n    }\n  }\n}",
          "inputType": "binary",
          "timeout": 90
        },
        "type": "n8n-nodes-comfyui-image-to-video.comfyuiImageToVideo",
        "typeVersion": 1,
        "position": [
          1460,
          2160
        ],
        "id": "7d62c424-e13c-47ec-8333-4b4d38bb1450",
        "name": "ComfyUI Image to Video",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('Google Sheets9').item.json.imageLink }}\" -O /tmp/generated.jpg"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1080,
          2160
        ],
        "id": "e9272c06-772c-45b4-9296-45f2c48bbbd3",
        "name": "Execute Command2",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.jpg",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1260,
          2160
        ],
        "id": "767a65d6-585c-4a3c-a4c3-dc9b79699e7e",
        "name": "Read/Write Files from Disk"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1240,
          300
        ],
        "id": "b703774e-23a2-4c35-95ff-9fd7279486cf",
        "name": "DeepSeek Chat Model12",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1360,
          320
        ],
        "id": "d5df635e-6394-4098-b1f5-002e42455cdf",
        "name": "Simple Memory10"
      },
      {
        "parameters": {
          "operation": "create",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "title": "={{ $json.output }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1560,
          140
        ],
        "id": "3ce8d2dd-1f81-4ad8-9363-999d32cbc10a",
        "name": "Google Sheets13",
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "return [\n  {\n    \"imageStatus\": null,\n    \"videoStatus\": null,\n    \"narratorStatus\": null,\n    \"pStyle\": null,\n    \"pTime\": null,\n    \"pCamAngle\": null,\n    \"pLocation\": null,\n    \"pAction\": null,\n    \"pWhoIsHere\": null,\n    \"pCharDescription\": null,\n    \"narratorScript\": null,\n    \"imageLink\": null,\n    \"videoLink\": null,\n    \"narratorLink\": null,\n    \"storyIdea\": null,\n    \"allCharsDescription\": null\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1700,
          140
        ],
        "id": "7f5d1f58-90c5-474d-a4b3-d9e1fb77666d",
        "name": "Code27"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets13').item.json.sheetId }}",
            "mode": "id"
          },
          "dataMode": "autoMapInputData",
          "options": {}
        },
        "id": "e9f6fa80-f006-49d5-8557-1d6d9248d05f",
        "name": "Add header1",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 3,
        "position": [
          1840,
          140
        ],
        "executeOnce": true,
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          2020,
          300
        ],
        "id": "3b2423bd-9999-4b40-9168-9b9176e60dfa",
        "name": "DeepSeek Chat Model13",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2140,
          320
        ],
        "id": "a793ef11-e5f4-4c41-926c-c21a08cf0989",
        "name": "Simple Memory11"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, this is your highest priority \n\n# Task\nYou are a professional character designer and narrative worldbuilder. You will be given a story. For each character, generate a complete, vivid description in a **single sentence**.\n\nEach sentece must include:\n- Character's name\n- Age (if known or inferable)\n- Gender\n- Distinct facial features and physical traits (e.g., hair style, color, eye shape, skin tone, body type)\n- Clothing style, ideally connected to personality or role\n- do NOT specify visual style (like ilustration, 3d, photorealistic)\n\n#Story:{{ $('Code31').item.json.cleanedText }}\n\n\n# Output Format\nWrite each character's description as a standalone sentence, with no list formatting, bullet points or quotation marks. the paragraph should be only couple of sentences long\n\nDo **not** repeat or rephrase their name at the start of every sentence‚Äîmake the paragraph feel like a natural bio, not a template. Make the tone expressive and cinematic, suitable for animation or storytelling design.\n\nEach character sentence 30 words maximum.\n\nThe output must be one paragraph with all the sentences together\n\n# Output Example\nHaru is a 4-year-old male Shiba Inu with a polished black-and-tan coat, alert triangular ears, and intelligent dark eyes that miss nothing. Yuki is a 3-year-old female cream Shiba Inu with an expressive face and fluffy fur that flies in every direction.\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          2020,
          140
        ],
        "id": "d97861ef-a886-428d-963a-7ac5b3ae75f6",
        "name": "Character Description",
        "retryOnFail": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\nstory: \n\n{{ $json.cleanedText }}\n\nfrom the last story make:a FileName\n\nthe file name must be one sentence with no spaces that identifies the video 10 characters max\n\nyour output must be only the filename nothing else 1 word\ndo not add titles or explanations, just the text ready to use\ndo not add other string format just paragraphs\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1240,
          140
        ],
        "id": "4b954355-0c5f-4322-bd47-4f7692459dc8",
        "name": "FileName",
        "retryOnFail": true
      },
      {
        "parameters": {
          "jsCode": "const input = $input.first().json.output; // Aseg√∫rate que el nodo anterior tenga la propiedad \"text\" con todo el contenido\n\n// Dividir por l√≠neas y filtrar l√≠neas vac√≠as\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Eliminar el n√∫mero inicial de cada l√≠nea y devolver cada frase como un item separado\nreturn lines.map(line => {\n  return {\n    json: {\n      sentence: line.replace(/^\\d+\\.\\s*/, \"\").trim()\n    }\n  };\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2700,
          140
        ],
        "id": "035c7440-9fcf-4b14-88ce-af402ef39b27",
        "name": "Code16"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          2900,
          140
        ],
        "id": "e851712e-944c-448d-adbd-bacf6b8d4177",
        "name": "Loop Over Items3"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets13').item.json.sheetId }}",
            "mode": "id"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "narratorScript": "={{ $json.sentence }}",
              "storyIdea": "={{ $('Code31').item.json.cleanedText }}",
              "allCharsDescription": "={{ $('Character Description').item.json.output }}",
              "imageStatus": "ready"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pStyle",
                "displayName": "pStyle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pTime",
                "displayName": "pTime",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pCamAngle",
                "displayName": "pCamAngle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pLocation",
                "displayName": "pLocation",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pAction",
                "displayName": "pAction",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pWhoIsHere",
                "displayName": "pWhoIsHere",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pCharDescription",
                "displayName": "pCharDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3120,
          220
        ],
        "id": "fb0c7e28-9de6-4aeb-bcfb-d1be003ab859",
        "name": "Google Sheets15",
        "retryOnFail": true,
        "waitBetweenTries": 3000,
        "maxTries": 5,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Process Story finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3620,
          0
        ],
        "id": "ef157596-5c49-474b-a295-c23410ae27b9",
        "name": "Telegram26",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('FileName').item.json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3800,
          0
        ],
        "id": "d643df25-df61-466d-ae16-499b4a427075",
        "name": "Telegram27",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          3340,
          40
        ],
        "id": "c10ab37d-a5f2-44c8-9c55-fc6a223e1a49",
        "name": "Limit4"
      },
      {
        "parameters": {
          "amount": 2
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          3260,
          220
        ],
        "id": "737f0a9f-8c78-45df-bafe-ae6343593fdd",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          440,
          800
        ],
        "id": "aa38acef-1c7a-45ce-9485-5321321efb24",
        "name": "Google Sheets6",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\n\nYour target audience is 10 year olds or older do not use difficult english words.\n\nWrite a story in the format of a voiceover narration, that kicks off with a catchy, INSANE, JAW-DROPPING, THOUGHT-PROVOKING attention-grabbing line to immediately captivate the audience. The narrative should be based on the idea provided here:\n\n\n{{ $('Code31').item.json.cleanedText }}\n\nAfter the captivation line make sure to give an introduction so is easy to establish the mood.\n\nEnsure the voiceover style is vivid and cinematic, using dramatic pauses, an engaging tone, and a well-paced narrative flow. dynamic characters, unexpected twists, and an overarching theme that unifies the plot, all while maintaining clarity and a polished storytelling structure.\n\nSeparate the story in  {{ $('Wait2').item.json.sentences }} sentences, make sure each sentence could be represented in a photo or ilustration. if there is not enough information for {{ $('Wait2').item.json.sentences }} senteces make the story longer.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n- Do not add any quotes symbol / quoutes character / quotes ascii / \"\" avoid at all cost \n\n## OUTPUT\nThe output must be {{ $('Wait2').item.json.sentences }} enumarated sentences that tells a story by a narrator.\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          2400,
          140
        ],
        "id": "cb8ffe13-7077-4cbd-bc0b-1f35da386fca",
        "name": "Narrator Script",
        "retryOnFail": true
      },
      {
        "parameters": {
          "jsCode": "const input = $input.first().json.output; // Aseg√∫rate que aqu√≠ est√© todo el bloque de texto con las 4 l√≠neas\n\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Asignamos cada l√≠nea a una variable\nconst cameraAngle = lines[0] || \"\";\nconst action = lines[1] || \"\";\nconst whoIsHere = lines[2] || \"\";\nconst characterDescription = lines[3] || \"\";\n\n// Retornar como un solo item\nreturn [\n  {\n    json: {\n      cameraAngle,\n      action,\n      whoIsHere,\n      characterDescription\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1160,
          820
        ],
        "id": "0b118568-0836-4f1a-9a3a-9d602a396328",
        "name": "Code14"
      },
      {
        "parameters": {
          "jsCode": "// Obtenemos las variables directamente del item actual\nconst {\n  pStyle,\n  pTime,\n  pCamAngle,\n  pLocation,\n  pAction,\n  pWhoIsHere,\n  pCharDescription\n} = $json;\n\n// Combinamos todo en un solo string separado por comas\nconst fullPrompt = [pStyle, pTime, pCamAngle, pLocation, pAction, pWhoIsHere, pCharDescription]\n  .filter(v => v && v.trim().length > 0) // Elimina campos vac√≠os\n  .join(', ');\n\n// Devolvemos el nuevo campo\nreturn [\n  {\n    json: {\n      ...$json,\n      fullPrompt\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          760,
          1340
        ],
        "id": "fd9741db-1c64-4df1-8289-12d0e3c9dcad",
        "name": "Code17"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/render",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -80,
          2980
        ],
        "id": "503ed16b-e32b-44fa-92aa-63674f1f8e4b",
        "name": "If12"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your render",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          120,
          2960
        ],
        "id": "80e07ed2-77c3-4d22-ad3c-cf0b4ae0b69e",
        "name": "Telegram24",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?render\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If12').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          260,
          2960
        ],
        "id": "0193885a-2271-462b-bdbe-6cccc71608ef",
        "name": "Code25"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code25').item.json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "videoStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          580,
          2960
        ],
        "id": "83609a2f-d2cd-43ae-bcf5-7f54bd0d165b",
        "name": "Google Sheets7",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = $input.first().json.prompt  + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          420,
          2960
        ],
        "id": "ef022816-a93a-4824-b884-fb16f8753ab1",
        "name": "Code20"
      },
      {
        "parameters": {
          "content": "## Render Everything ",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -400,
          3000
        ],
        "id": "42ebf566-fecc-428d-9ae7-48114d909616",
        "name": "Sticky Note8"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Process Images finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1980,
          1160
        ],
        "id": "33db52cb-6100-4b33-90be-47d65f2bf415",
        "name": "Telegram14",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Process Videos finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1960,
          1980
        ],
        "id": "89b3ed5b-b446-42ba-aef6-7d2f9bfd200b",
        "name": "Telegram22",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "amount": 0.02
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          1520,
          820
        ],
        "id": "8ec4ccb7-30e2-4fd6-bb15-91cd9f9c1584",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener videoLink y narratorLink\n\n// Comando para crear carpeta temporal\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Recorre cada fila y genera los comandos\nrows.forEach((item, index) => {\n  const videoUrl = item.json.videoLink;\n  const audioUrl = item.json.narratorLink;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar archivos\n  downloadCommands += `wget -q -O \"${rawVideo}\" \"${videoUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Unir video con audio\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v copy -c:a aac -shortest \"${merged}\";\\n`;\n\n  // Agregar a la lista de concatenaci√≥n\n  fileListCommands += `echo \"file '${merged}'\" >> /tmp/render/filelist.txt\\n`;\n});\n\n// Comando para unir todos los videos\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Comando para borrar la carpeta despu√©s\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    cleanupCommand\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          740,
          2960
        ],
        "id": "462e7f16-6fd3-49b5-a0a6-3d820eb99015",
        "name": "Code7"
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          880,
          2960
        ],
        "id": "bc4d6a9d-b70e-4cd4-ab5f-ea1ff544ff48",
        "name": "Execute Command",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code7').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1020,
          2960
        ],
        "id": "2bb2ce3e-9a90-4128-821e-e60127ed5cdb",
        "name": "Execute Command1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code7').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1200,
          2960
        ],
        "id": "f75ce299-9271-46a7-a125-e6bc7170caff",
        "name": "Execute Command3",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code7').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1360,
          2960
        ],
        "id": "940ef0b4-0bc5-4f07-a51a-a2291f382b37",
        "name": "Execute Command4",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code7').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1520,
          2960
        ],
        "id": "3d862251-94ab-43cd-b969-134a2b6801c4",
        "name": "Execute Command5",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/combo.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1680,
          2960
        ],
        "id": "ae0dd9c9-5198-42b4-ab27-9b18206f7262",
        "name": "Read/Write Files from Disk1"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code20').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1840,
          2960
        ],
        "id": "17759dac-9520-4dd3-9956-94ad993f5aa7",
        "name": "FTP5",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').first().json.message.chat.id }}",
          "text": "={{ $('Code20').first().json.publicUrl}}",
          "replyMarkup": "=",
          "forceReply": {},
          "replyKeyboardOptions": {},
          "replyKeyboardRemove": {},
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          2000,
          2960
        ],
        "id": "25a9ecfa-f649-4ae4-bba7-e1d160200d11",
        "name": "Telegram18",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code7').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2160,
          2960
        ],
        "id": "93f31bdf-ba64-40e1-b7f7-9116d2660242",
        "name": "Execute Command6"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.caption }}",
                "rightValue": "/upload",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -220,
          -720
        ],
        "id": "20aa18e6-8887-4594-b224-0a927c9c6291",
        "name": "If5"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "I'm working on your upload",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          -20,
          -740
        ],
        "id": "25e9569f-a21f-4abe-a8ba-f843a673777e",
        "name": "Telegram13",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code12').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          580,
          -740
        ],
        "id": "84a50301-2b53-493e-889d-646484a95ecc",
        "name": "FTP6",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\n// Aseg√∫rate de que el binary data tambi√©n se pase correctamente\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/images/${filename}`\n    },\n    binary: items[0].binary // Esto pasa el binary data al siguiente paso\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          180,
          -740
        ],
        "id": "54a59143-8d50-4f65-98b6-1f533d317a5d",
        "name": "Code12"
      },
      {
        "parameters": {
          "resource": "file",
          "fileId": "={{ $('If5').item.json.message.document.file_id }}"
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          400,
          -740
        ],
        "id": "51c107e5-3a33-4142-b788-f2cf5e980240",
        "name": "Telegram23",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "operation": "sendPhoto",
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "binaryData": true,
          "additionalFields": {
            "caption": "={{ $('Code12').item.json.publicUrl }}"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          780,
          -740
        ],
        "id": "ee263f10-5b77-4396-911e-acfbf487d650",
        "name": "Telegram25",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "content": "## Upload\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -540,
          -700
        ],
        "id": "4af4a1d1-d499-4099-bd6f-668b039e9496",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/preview",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -120,
          3200
        ],
        "id": "cc642f86-10ef-4ca7-a8d1-3502ddbc0431",
        "name": "If13"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your preview",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          80,
          3180
        ],
        "id": "4a082d29-7a93-4de3-b9e8-5dbce7584426",
        "name": "Telegram28",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?preview\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If13').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          220,
          3180
        ],
        "id": "2878533b-369b-4697-888c-f50a2adee7c9",
        "name": "Code26"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code26').item.json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "done"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          540,
          3180
        ],
        "id": "85ac14c3-30f2-4475-b842-461eceb43a92",
        "name": "Google Sheets11",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = $input.first().json.prompt  + \"_prev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          380,
          3180
        ],
        "id": "092bfc55-d54e-402f-be5b-2d1286a91c58",
        "name": "Code28"
      },
      {
        "parameters": {
          "content": "## Preview",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -440,
          3220
        ],
        "id": "d30f3120-8725-4e74-a2af-99653150ef9d",
        "name": "Sticky Note10"
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener imageLink y narratorLink\n\n// Comando para crear carpeta temporal\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Recorre cada fila y genera los comandos\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLink;\n  const audioUrl = item.json.narratorLink;\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Crear video a partir de la imagen (10s a 30 fps, resoluci√≥n 1280x720)\n  downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t 10 -vf \"scale=1280:720,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n\n  // Unir imagen convertida en video con su audio\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v copy -c:a aac -shortest \"${merged}\";\\n`;\n\n  // Agregar a la lista de concatenaci√≥n\n  fileListCommands += `echo \"file '${merged}'\" >> /tmp/render/filelist.txt\\n`;\n});\n\n// Comando para unir todos los videos\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Comando para borrar la carpeta despu√©s\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    cleanupCommand\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          700,
          3180
        ],
        "id": "e7dfa14e-b40d-4ffd-b64b-d53dc3ccc5ea",
        "name": "Code8"
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          840,
          3180
        ],
        "id": "e36009c1-3a17-43ab-884e-fe7230e6534a",
        "name": "Execute Command7",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          980,
          3180
        ],
        "id": "c4e91aba-b86c-4f50-91c9-6c1cb20f0a13",
        "name": "Execute Command8",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1160,
          3180
        ],
        "id": "6dbe5702-366a-4247-b0e3-0abc19ef9e33",
        "name": "Execute Command9",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1320,
          3180
        ],
        "id": "92068645-8ff2-4e48-94ed-5c9ccb60a7f0",
        "name": "Execute Command10",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1480,
          3180
        ],
        "id": "693b8440-10ef-4c99-956d-2dea8b8a7fe8",
        "name": "Execute Command11",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/combo.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1640,
          3180
        ],
        "id": "49a53bd7-559f-4fdf-91cb-fa0c8eded511",
        "name": "Read/Write Files from Disk2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code28').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1800,
          3180
        ],
        "id": "b5f2278f-84ff-4feb-9ef8-81fb806a2c29",
        "name": "FTP7",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').first().json.message.chat.id }}",
          "text": "={{ $('Code28').first().json.publicUrl}}",
          "replyMarkup": "=",
          "forceReply": {},
          "replyKeyboardOptions": {},
          "replyKeyboardRemove": {},
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1960,
          3180
        ],
        "id": "1e8a12bc-aaf1-47f3-99a1-4fe3e0e947d3",
        "name": "Telegram29",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2120,
          3180
        ],
        "id": "3aad90d7-54e0-4c10-8497-ff09a2237d8f",
        "name": "Execute Command12"
      },
      {
        "parameters": {
          "content": "## I'm a note \nAegr el audio"
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          3320,
          2540
        ],
        "id": "fcf3c9b3-4c61-41b4-9a57-80ca870009c7",
        "name": "Sticky Note11"
      },
      {
        "parameters": {
          "jsCode": "const sentences = 12;  // Cambia este n√∫mero seg√∫n lo que necesites\nconst inputText = $input.first().json.message.text;\n\nreturn {\n  json: {\n    sentences,\n    inputText\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          140,
          160
        ],
        "id": "8dec778a-79d7-40c9-b31b-d054bed3c45c",
        "name": "Sentences"
      },
      {
        "parameters": {
          "amount": 0.1
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          360,
          320
        ],
        "id": "c4e44b0c-0593-4085-8fdf-015c7da16609",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/story",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -120,
          340
        ],
        "id": "219d84cd-0ce2-4350-b3fc-11de2ce15204",
        "name": "If8"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your story",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          740,
          320
        ],
        "id": "5968e988-26d4-4a3f-8814-03a2fda1af75",
        "name": "Telegram8",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $json.inputText;\n\n// Divide el texto en palabras, quita la primera, y vuelve a unir\nconst cleanPrompt = original\n  .trim()\n  .split(/\\s+/)        // divide por espacios (uno o m√°s)\n  .slice(1)            // elimina la primera palabra\n  .join(\" \");          // vuelve a unir las palabras restantes\n\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('Telegram Trigger').item.json.message.chat.id\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          580,
          320
        ],
        "id": "b13993c8-a0cc-4ff4-b995-73ba36778ceb",
        "name": "Code19"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Code19').first().json.prompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          880,
          320
        ],
        "id": "36f5585f-ea45-49bc-929a-5c746e5fd630",
        "name": "Code31"
      },
      {
        "parameters": {
          "jsCode": "const sentences = 72;  // Cambia este n√∫mero seg√∫n lo que necesites\nconst inputText = $input.first().json.message.text;\n\nreturn {\n  json: {\n    sentences,\n    inputText\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          140,
          340
        ],
        "id": "f646a04f-9bda-49d0-9d57-f2b6ae5f6a58",
        "name": "Sentences1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/234story",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -120,
          520
        ],
        "id": "e843ec5d-33a4-4f9d-9d14-eca17742f4dc",
        "name": "If9"
      },
      {
        "parameters": {
          "jsCode": "const sentences = 150;  // Cambia este n√∫mero seg√∫n lo que necesites\nconst inputText = $input.first().json.message.text;\n\nreturn {\n  json: {\n    sentences,\n    inputText\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          140,
          520
        ],
        "id": "6ac5eae4-4153-48d3-b9f2-149da460aef6",
        "name": "Sentences2"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/clean",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -200,
          -1100
        ],
        "id": "694a20f7-7be7-44b2-8137-5cb51b102f51",
        "name": "If14"
      },
      {
        "parameters": {
          "command": "#!/bin/bash\n\n# Borrar archivos en /tmp m√°s viejos de 1 d√≠a\nfind /tmp -type f -mtime +1 -exec rm -f {} \\; 2>/dev/null\nfind /tmp -type d -empty -mtime +1 -exec rmdir {} \\; 2>/dev/null\n\n# Limpiar cach√© de apt (solo si es un sistema basado en Debian/Ubuntu)\nif command -v apt-get &> /dev/null; then\n  apt-get clean\n  apt-get autoclean\nfi\n\n# Borrar archivos de log rotados (sin tocar logs actuales)\nfind /var/log -type f -name \"*.gz\" -mtime +7 -exec rm -f {} \\; 2>/dev/null\nfind /var/log -type f -name \"*.1\" -mtime +7 -exec rm -f {} \\; 2>/dev/null\n\n# Limpiar cach√© de thumbnails (si existe)\nrm -rf ~/.cache/thumbnails/* 2>/dev/null\n\n# Mostrar cu√°nto espacio libre hay despu√©s\necho \"Espacio libre en disco despu√©s de limpiar:\"\ndf -h /\n\nexit 0\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          -20,
          -1120
        ],
        "id": "2d4fffa2-8c13-4d90-99b7-94943293096a",
        "name": "Execute Command13"
      },
      {
        "parameters": {
          "content": "## Script",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -520,
          -80
        ],
        "id": "8c984baa-3d1a-4f74-bc13-70326c1e066c",
        "name": "Sticky Note12"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/script",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -160,
          -80
        ],
        "id": "78d3dac4-7c86-48cf-8be8-edf4ab71e377",
        "name": "If15"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your script",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          260,
          -100
        ],
        "id": "043d628e-52f2-48a9-9250-584ccd967c04",
        "name": "Telegram30",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $json.message.text;\n\n// Divide el texto en palabras, quita la primera, y vuelve a unir\nconst cleanPrompt = original\n  .trim()\n  .split(/\\s+/)        // divide por espacios (uno o m√°s)\n  .slice(1)            // elimina la primera palabra\n  .join(\" \");          // vuelve a unir las palabras restantes\n\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('Telegram Trigger').item.json.message.chat.id\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          60,
          -100
        ],
        "id": "a1078777-528f-456b-89a7-b660fbe0f012",
        "name": "Code29"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Code29').first().json.prompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          440,
          -100
        ],
        "id": "3f12dc85-8f83-47e6-a33f-7fb426254a84",
        "name": "Code32"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          660,
          -20
        ],
        "id": "42bfdb9b-944d-40d0-abee-855036f30633",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          780,
          0
        ],
        "id": "01ebb0e0-7ad3-48a2-9012-44fd6696c144",
        "name": "Simple Memory12"
      },
      {
        "parameters": {
          "operation": "create",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "title": "={{ $json.output }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          980,
          -180
        ],
        "id": "2e30357d-6a51-425c-b08b-e4a787ef833c",
        "name": "Google Sheets14",
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "return [\n  {\n    \"imageStatus\": null,\n    \"videoStatus\": null,\n    \"narratorStatus\": null,\n    \"pStyle\": null,\n    \"pTime\": null,\n    \"pCamAngle\": null,\n    \"pLocation\": null,\n    \"pAction\": null,\n    \"pWhoIsHere\": null,\n    \"pCharDescription\": null,\n    \"narratorScript\": null,\n    \"imageLink\": null,\n    \"videoLink\": null,\n    \"narratorLink\": null,\n    \"storyIdea\": null,\n    \"allCharsDescription\": null\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1160,
          -180
        ],
        "id": "f8ac4cf9-5d87-4b19-bf70-cb64d79442f7",
        "name": "Code30"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "dataMode": "autoMapInputData",
          "options": {}
        },
        "id": "fdd05352-4734-4588-895e-69c1afd22005",
        "name": "Add header",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 3,
        "position": [
          1300,
          -180
        ],
        "executeOnce": true,
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\nstory: \n\n{{ $json.cleanedText }}\n\nfrom the last story make:a FileName\n\nthe file name must be one sentence with no spaces that identifies the video 10 characters max\n\nyour output must be only the filename nothing else 1 word\ndo not add titles or explanations, just the text ready to use\ndo not add other string format just paragraphs\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          660,
          -180
        ],
        "id": "84bb2f4e-41b0-4e8f-9ada-703b50e7005d",
        "name": "FileName1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1520,
          -100
        ],
        "id": "5de748ae-db74-4169-80f3-314548124b97",
        "name": "DeepSeek Chat Model5",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1640,
          -80
        ],
        "id": "c71d2305-7fcf-4592-86fd-9e8d808dd1a1",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "jsCode": "const input = $input.first().json.output; // Aseg√∫rate que el nodo anterior tenga la propiedad \"text\" con todo el contenido\n\n// Dividir por l√≠neas y filtrar l√≠neas vac√≠as\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Eliminar el n√∫mero inicial de cada l√≠nea y devolver cada frase como un item separado\nreturn lines.map(line => {\n  return {\n    json: {\n      sentence: line.replace(/^\\d+\\.\\s*/, \"\").trim()\n    }\n  };\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1860,
          -240
        ],
        "id": "9fbe0f2c-c209-4c7a-b117-bf48ab9a80af",
        "name": "Code33"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          2060,
          -240
        ],
        "id": "9784dc20-48c3-4eaf-b990-4c9abfaeed8a",
        "name": "Loop Over Items5"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "narratorScript": "={{ $json.sentence }}",
              "imageStatus": "ready"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pStyle",
                "displayName": "pStyle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pTime",
                "displayName": "pTime",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pCamAngle",
                "displayName": "pCamAngle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pLocation",
                "displayName": "pLocation",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pAction",
                "displayName": "pAction",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pWhoIsHere",
                "displayName": "pWhoIsHere",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "pCharDescription",
                "displayName": "pCharDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2280,
          -160
        ],
        "id": "4c682d6c-4e07-4f34-845e-dcd167882b1a",
        "name": "Google Sheets16",
        "retryOnFail": true,
        "waitBetweenTries": 3000,
        "maxTries": 5,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Process Script finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          2780,
          -380
        ],
        "id": "ab439377-1199-4111-97bd-615e6eb12a4a",
        "name": "Telegram31",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('FileName1').item.json.output }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          2960,
          -380
        ],
        "id": "daba2aaa-0cac-480d-8d56-75b5105fa398",
        "name": "Telegram32",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          2500,
          -340
        ],
        "id": "9792cd0d-82f6-4f89-b64e-5c2f3b79ab54",
        "name": "Limit5"
      },
      {
        "parameters": {
          "amount": 2
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2420,
          -160
        ],
        "id": "1bde26c2-6d7d-486b-96c2-3668c17d3852",
        "name": "Wait3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\n\nSeparate the next text in to sentences, for a narrator script, the sentences have to be not too long not too short. \n\n\n{{ $('Code32').item.json.cleanedText }}\n\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n- Do not add any quotes symbol / quoutes character / quotes ascii / \"\" avoid at all cost \n\n## OUTPUT\nThe output must be enumarated sentences\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1520,
          -260
        ],
        "id": "09c8639f-8145-4d3c-82c5-2520f1861f81",
        "name": "Narrator Script1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "operation": "write",
          "fileName": "/tmp/audio.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          1780,
          2740
        ],
        "id": "d7222de3-d617-400d-8fd9-944235c38633",
        "name": "Read/Write Files from Disk3"
      },
      {
        "parameters": {
          "command": "ffmpeg -i /tmp/audio.mp3 -af \"apad=pad_dur=1,adelay=600|600,apad=pad_dur=1\" -y /tmp/audio_padded.mp3"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1920,
          2740
        ],
        "id": "adcdfbed-8790-49ef-9fae-e9eea592fee3",
        "name": "Execute Command14"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/audio_padded.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2100,
          2740
        ],
        "id": "382f9e8f-51a4-4ec2-b8aa-db9d5998d016",
        "name": "Read/Write Files from Disk4"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/batchPImages",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -140,
          1560
        ],
        "id": "8b51328f-b646-4795-a831-f5fcdba646a3",
        "name": "If16"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Im working on your batch images",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          60,
          1540
        ],
        "id": "66c5a85d-6923-48cb-b2ca-e257187f5ea1",
        "name": "Telegram33",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      },
      {
        "parameters": {
          "mode": "runOnceForEachItem",
          "jsCode": "const original = $('Telegram Trigger').item.json.message.text;\nconst cleanPrompt = original\n  .replace(/^\\/?batchPImages\\s*/i, \"\")  // quita `/image`, `image`, `/ image`, etc.\n  .replace(/^\\/+/, \"\")           // quita cualquier `/` al inicio si queda alguno\n  .trim();\nreturn {\n  json: {\n    prompt: cleanPrompt,\n    chat_id: $('If16').item.json.message.chat.id\n  }\n};"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          220,
          1540
        ],
        "id": "ab1da8b2-5ec0-4f03-a308-0b7dc8398993",
        "name": "Code34"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.prompt }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          380,
          1540
        ],
        "id": "0163bcee-5ab0-4d14-9d5f-938439c03a13",
        "name": "Google Sheets3",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code3').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 432,\n      \"height\": 768,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          1520,
          1720
        ],
        "id": "cdf45d53-c407-4f20-9e24-566f247444c5",
        "name": "ComfyUI",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          600,
          1560
        ],
        "id": "9175635b-d3f2-462d-a7bf-9909b5ee3eeb",
        "name": "Loop Over Items6"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code13').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1700,
          1720
        ],
        "id": "57673c47-7d3f-4849-880d-26acf2babb02",
        "name": "FTP2",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          940,
          1700
        ],
        "id": "5af85fea-a4f7-4513-aa11-b149de28c4d3",
        "name": "Code13"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU",
            "mode": "list",
            "cachedResultName": "StoryToPrompt",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntYuoz-Kbfh19M_KZrfn4qpEBRZJhZuSudWdDUT_KnU/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Code34').item.json.prompt }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items6').item.json.row_number }}",
              "imageLink": "={{ $('Code13').item.json.publicUrl }}",
              "imageStatus": "done",
              "videoStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundFxStatus",
                "displayName": "soundFxStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoPrompt",
                "displayName": "videoPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundPrompt",
                "displayName": "soundPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "soundFxLink",
                "displayName": "soundFxLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1900,
          1720
        ],
        "id": "320c1ae1-02bd-4cdf-a7ae-4cbbcc5701d5",
        "name": "Google Sheets12",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          1240,
          1540
        ],
        "id": "10103c57-0edf-4ff1-8177-b7df8c5111eb",
        "name": "Limit6"
      },
      {
        "parameters": {
          "content": "## Batch Portrait Images\n\n\n",
          "height": 80
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -460,
          1560
        ],
        "id": "71cfa115-2339-44bb-ad33-d3610dba253d",
        "name": "Sticky Note13"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Code35').first().json.fullPrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1160,
          1700
        ],
        "id": "f8c35a47-a58b-48bc-93cb-3ea93413eaef",
        "name": "Code3"
      },
      {
        "parameters": {
          "jsCode": "// Obtenemos las variables directamente del item actual\nconst {\n  pStyle,\n  pTime,\n  pCamAngle,\n  pLocation,\n  pAction,\n  pWhoIsHere,\n  pCharDescription\n} = $json;\n\n// Combinamos todo en un solo string separado por comas\nconst fullPrompt = [pStyle, pTime, pCamAngle, pLocation, pAction, pWhoIsHere, pCharDescription]\n  .filter(v => v && v.trim().length > 0) // Elimina campos vac√≠os\n  .join(', ');\n\n// Devolvemos el nuevo campo\nreturn [\n  {\n    json: {\n      ...$json,\n      fullPrompt\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          760,
          1720
        ],
        "id": "3871c76c-b071-4bb1-b112-f625c711d67d",
        "name": "Code35"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=Process Images finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          1980,
          1540
        ],
        "id": "af9f63ca-f6b5-46f7-b743-20bd596365f5",
        "name": "Telegram34",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "videoAICreator_credential"
          }
        }
      }
    ],
    "connections": {
      "If7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Sentences",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram9": {
        "main": [
          [
            {
              "node": "Telegram10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Telegram11",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram11": {
        "main": [
          [
            {
              "node": "Code10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code10": {
        "main": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent": {
        "main": [
          [
            {
              "node": "Telegram12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "Narrator Script",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Narrator Script",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Telegram17",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram17": {
        "main": [
          [
            {
              "node": "Code18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code18": {
        "main": [
          [
            {
              "node": "Google Sheets6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items4": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Image Prompt Agent7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model10": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory7": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent7": {
        "main": [
          [
            {
              "node": "Code14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets8": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit": {
        "main": [
          [
            {
              "node": "Telegram9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If10": {
        "main": [
          [
            {
              "node": "Telegram19",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram19": {
        "main": [
          [
            {
              "node": "Code21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code21": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          [
            {
              "node": "Google Sheets1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets1": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit1": {
        "main": [
          [
            {
              "node": "Telegram14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If11": {
        "main": [
          [
            {
              "node": "Telegram20",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram20": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code22": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets2": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "Google Sheets2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Telegram16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram16": {
        "main": [
          []
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Telegram7",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram7": {
        "main": [
          [
            {
              "node": "Code23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code23": {
        "main": [
          [
            {
              "node": "Google Sheets4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets4": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items1": {
        "main": [
          [
            {
              "node": "Limit2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP3": {
        "main": [
          [
            {
              "node": "Google Sheets5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets5": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit2": {
        "main": [
          [
            {
              "node": "Telegram21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "ComfyUI1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram": {
        "main": [
          [
            {
              "node": "Code24",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code24": {
        "main": [
          [
            {
              "node": "Google Sheets9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets9": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items2": {
        "main": [
          [
            {
              "node": "Limit3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP4": {
        "main": [
          [
            {
              "node": "Google Sheets10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code11": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets10": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit3": {
        "main": [
          [
            {
              "node": "Telegram22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Execute Command2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI Image to Video": {
        "main": [
          [
            {
              "node": "FTP4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command2": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk": {
        "main": [
          [
            {
              "node": "ComfyUI Image to Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model12": {
        "ai_languageModel": [
          [
            {
              "node": "FileName",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory10": {
        "ai_memory": [
          [
            {
              "node": "FileName",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets13": {
        "main": [
          [
            {
              "node": "Code27",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code27": {
        "main": [
          [
            {
              "node": "Add header1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add header1": {
        "main": [
          [
            {
              "node": "Character Description",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model13": {
        "ai_languageModel": [
          [
            {
              "node": "Character Description",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory11": {
        "ai_memory": [
          [
            {
              "node": "Character Description",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Character Description": {
        "main": [
          [
            {
              "node": "Narrator Script",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FileName": {
        "main": [
          [
            {
              "node": "Google Sheets13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code16": {
        "main": [
          [
            {
              "node": "Loop Over Items3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items3": {
        "main": [
          [
            {
              "node": "Limit4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Google Sheets15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets15": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram26": {
        "main": [
          [
            {
              "node": "Telegram27",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit4": {
        "main": [
          [
            {
              "node": "Telegram26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets6": {
        "main": [
          [
            {
              "node": "Loop Over Items4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Narrator Script": {
        "main": [
          [
            {
              "node": "Code16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code14": {
        "main": [
          [
            {
              "node": "Google Sheets8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code17": {
        "main": [
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If12": {
        "main": [
          [
            {
              "node": "Telegram24",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram24": {
        "main": [
          [
            {
              "node": "Code25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code25": {
        "main": [
          [
            {
              "node": "Code20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets7": {
        "main": [
          [
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code20": {
        "main": [
          [
            {
              "node": "Google Sheets7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram10": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram14": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram22": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram21": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "Loop Over Items4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Execute Command1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command1": {
        "main": [
          [
            {
              "node": "Execute Command3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command3": {
        "main": [
          [
            {
              "node": "Execute Command4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command4": {
        "main": [
          [
            {
              "node": "Execute Command5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command5": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk1": {
        "main": [
          [
            {
              "node": "FTP5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP5": {
        "main": [
          [
            {
              "node": "Telegram18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram18": {
        "main": [
          [
            {
              "node": "Execute Command6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If5": {
        "main": [
          [
            {
              "node": "Telegram13",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram13": {
        "main": [
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP6": {
        "main": [
          [
            {
              "node": "Telegram25",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Telegram23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram23": {
        "main": [
          [
            {
              "node": "FTP6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If13": {
        "main": [
          [
            {
              "node": "Telegram28",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram28": {
        "main": [
          [
            {
              "node": "Code26",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code26": {
        "main": [
          [
            {
              "node": "Code28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets11": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code28": {
        "main": [
          [
            {
              "node": "Google Sheets11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "Execute Command7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command7": {
        "main": [
          [
            {
              "node": "Execute Command8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command8": {
        "main": [
          [
            {
              "node": "Execute Command9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command9": {
        "main": [
          [
            {
              "node": "Execute Command10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command10": {
        "main": [
          [
            {
              "node": "Execute Command11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command11": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP7": {
        "main": [
          [
            {
              "node": "Telegram29",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram29": {
        "main": [
          [
            {
              "node": "Execute Command12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sentences": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "Code19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If8": {
        "main": [
          [
            {
              "node": "Sentences1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram8": {
        "main": [
          [
            {
              "node": "Code31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code19": {
        "main": [
          [
            {
              "node": "Telegram8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code31": {
        "main": [
          [
            {
              "node": "FileName",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If9": {
        "main": [
          [
            {
              "node": "Sentences2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sentences1": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Sentences2": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If14": {
        "main": [
          [
            {
              "node": "Execute Command13",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If15": {
        "main": [
          [
            {
              "node": "Code29",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram30": {
        "main": [
          [
            {
              "node": "Code32",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code29": {
        "main": [
          [
            {
              "node": "Telegram30",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "FileName1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory12": {
        "ai_memory": [
          [
            {
              "node": "FileName1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets14": {
        "main": [
          [
            {
              "node": "Code30",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code30": {
        "main": [
          [
            {
              "node": "Add header",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FileName1": {
        "main": [
          [
            {
              "node": "Google Sheets14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code32": {
        "main": [
          [
            {
              "node": "FileName1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code33": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items5": {
        "main": [
          [
            {
              "node": "Limit5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Google Sheets16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets16": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram31": {
        "main": [
          [
            {
              "node": "Telegram32",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit5": {
        "main": [
          [
            {
              "node": "Telegram31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait3": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Narrator Script1": {
        "main": [
          [
            {
              "node": "Code33",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add header": {
        "main": [
          [
            {
              "node": "Narrator Script1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk3": {
        "main": [
          [
            {
              "node": "Execute Command14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command14": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk4": {
        "main": [
          [
            {
              "node": "FTP3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If16": {
        "main": [
          [
            {
              "node": "Telegram33",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram33": {
        "main": [
          [
            {
              "node": "Code34",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code34": {
        "main": [
          [
            {
              "node": "Google Sheets3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets3": {
        "main": [
          [
            {
              "node": "Loop Over Items6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI": {
        "main": [
          [
            {
              "node": "FTP2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items6": {
        "main": [
          [
            {
              "node": "Limit6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code35",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP2": {
        "main": [
          [
            {
              "node": "Google Sheets12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code13": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets12": {
        "main": [
          [
            {
              "node": "Loop Over Items6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit6": {
        "main": [
          [
            {
              "node": "Telegram34",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "ComfyUI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code35": {
        "main": [
          [
            {
              "node": "Code13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram34": {
        "main": [
          [
            {
              "node": "Code22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "edcc0f6b-62e7-4d5c-9658-1eaa7d2263ab",
    "activeVersionId": null,
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-04-23T01:37:14.276Z",
        "createdAt": "2025-04-23T01:37:14.276Z",
        "role": "workflow:owner",
        "workflowId": "efj6KWKjCCcaMj3M",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-11-09T13:10:30.000Z",
    "createdAt": "2025-04-07T02:48:04.976Z",
    "id": "malWwNGbdXYLvxIm",
    "name": "My investment",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          -80,
          -20
        ],
        "id": "87d49ded-fef5-4c29-b8a1-fe84e3b8018d",
        "name": "Telegram Trigger",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram account 2"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          100,
          -20
        ],
        "id": "98fe9350-25be-46ed-8156-53f873e5d6bb",
        "name": "If1"
      },
      {
        "parameters": {
          "url": "={{ $json.url }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          500,
          -40
        ],
        "id": "ccdaec2a-dab6-4c32-a0b0-87f8a1887dc6",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "jsCode": "// Obtener los datos hist√≥ricos de Alpha Vantage (estos datos provienen del nodo HTTP Request)\nlet data = $json[\"Time Series (Daily)\"]; // Datos hist√≥ricos para el s√≠mbolo\nlet prices = [];\n\n// Extraer los precios de cierre\nfor (let date in data) {\n  prices.push(parseFloat(data[date][\"4. close\"])); // Extraer el precio de cierre\n}\n\n// Obtener el ATH (m√°ximo de los precios)\nconst ath = Math.max(...prices);\nconst currentPrice = prices[0]; // El precio m√°s reciente es el primero\n\n// Calcular la diferencia en porcentaje\nconst percentChange = ((currentPrice - ath) / ath) * 100;\n\n// Crear el mensaje de salida\nlet message = `The ${$input.first().json['Meta Data']['2. Symbol']} is `; // Usamos el s√≠mbolo din√°mico\n\nif (percentChange > 0) {\n  message += `up by ${percentChange.toFixed(2)}% from its last All-Time High.`;\n} else if (percentChange < 0) {\n  message += `down by ${Math.abs(percentChange).toFixed(2)}% from its last All-Time High.`;\n} else {\n  message += `at its last All-Time High.`;\n}\n\n// Retornar el mensaje como un objeto JSON\nreturn [{ json: { message } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          660,
          -40
        ],
        "id": "4cff6165-e88a-4614-b734-e2652c7a8915",
        "name": "Code"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $json.message }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          880,
          -20
        ],
        "id": "8c381fc8-8a98-4f3e-8d89-fd797b6240b4",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Telegram account 2"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Obtener el texto del mensaje desde la entrada\nlet command = $input.first().json.message.text;  // Accede al texto del mensaje\n\n// Eliminar el primer car√°cter \"/\" para obtener solo el s√≠mbolo y convertirlo a may√∫sculas\nlet symbol = command.slice(1).toUpperCase();  // Esto quitar√° el \"/\" y convertir√° el s√≠mbolo a may√∫sculas\n\n// Construir la URL de la API de Alpha Vantage\nlet url = `https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${symbol}&outputsize=compact&apikey=KPF97T83H6VTK4OW`;\n\n// Crear un objeto JSON con la URL y el mensaje original\nlet result = {\n  message: command,  // El mensaje original\n  symbol: symbol,    // El s√≠mbolo procesado (convertido a may√∫sculas)\n  url: url           // La URL de la API\n};\n\nreturn [{ json: result }];\n\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          300,
          -40
        ],
        "id": "6bbecaa0-c63f-4fc7-99bc-1ab83fc5e60a",
        "name": "Code1"
      }
    ],
    "connections": {
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "f8a6023e-d11c-4964-9a34-058cdf558a67",
    "activeVersionId": null,
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-04-07T02:48:04.978Z",
        "createdAt": "2025-04-07T02:48:04.978Z",
        "role": "workflow:owner",
        "workflowId": "malWwNGbdXYLvxIm",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-07-06T14:33:43.057Z",
    "createdAt": "2025-07-06T14:33:43.057Z",
    "id": "q7BGxY9d4WHyD6rc",
    "name": "borrame",
    "active": false,
    "isArchived": false,
    "nodes": [],
    "connections": {},
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": null,
    "pinData": {},
    "versionId": "e901bd16-8283-480a-9476-ffc27f1cc462",
    "activeVersionId": null,
    "triggerCount": 0,
    "shared": [
      {
        "updatedAt": "2025-07-06T14:33:43.062Z",
        "createdAt": "2025-07-06T14:33:43.062Z",
        "role": "workflow:owner",
        "workflowId": "q7BGxY9d4WHyD6rc",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-05-01T13:47:18.000Z",
    "createdAt": "2025-05-01T12:57:18.468Z",
    "id": "sVAmPt9HXett7mHX",
    "name": "audio google",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {},
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          -320,
          -20
        ],
        "id": "ebd33578-6d55-4b53-91df-c74652c082e1",
        "name": "When clicking ‚ÄòTest workflow‚Äô"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://texttospeech.googleapis.com/v1/text:synthesize",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googleOAuth2Api",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "{\n  \"input\": {\n    \"text\": \"Hola, soy Arturo y estoy usando la API de Google Cloud para convertir texto en voz\"\n  },\n  \"voice\": {\n    \"languageCode\": \"es-ES\",\n    \"name\": \"es-US-Wavenet-C\"\n  },\n  \"audioConfig\": {\n    \"audioEncoding\": \"MP3\"\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -100,
          -20
        ],
        "id": "053ccc13-6d35-4e37-94c7-a79b55ffab44",
        "name": "HTTP Request",
        "credentials": {
          "googleOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "8c269fad-e72b-4471-a564-6041c1d41f41",
                "name": "binary",
                "value": "={{$json[\"audioContent\"]}}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          120,
          -20
        ],
        "id": "a3d800ee-8787-45c0-8039-69f32b0a3e3b",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "binary",
          "options": {}
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          340,
          -20
        ],
        "id": "75ce858f-c8e6-4a5f-a46b-2d25abfef55b",
        "name": "Convert to File"
      },
      {
        "parameters": {
          "content": "https://cloud.google.com/text-to-speech/docs/list-voices-and-types#standard_voices",
          "height": 80,
          "width": 420
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -360,
          240
        ],
        "id": "da58916c-2cc1-410e-8354-d561cc01180a",
        "name": "Sticky Note"
      }
    ],
    "connections": {
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": null,
    "pinData": {},
    "versionId": "0968625c-746f-4148-9a8d-4ca2be72283d",
    "activeVersionId": null,
    "triggerCount": 0,
    "shared": [
      {
        "updatedAt": "2025-05-01T12:57:18.478Z",
        "createdAt": "2025-05-01T12:57:18.478Z",
        "role": "workflow:owner",
        "workflowId": "sVAmPt9HXett7mHX",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-04-10T00:59:58.000Z",
    "createdAt": "2025-04-08T09:00:43.140Z",
    "id": "scAzuNtH8DNQgcog",
    "name": "Japan Flashcards",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "updates": [
            "message"
          ],
          "additionalFields": {}
        },
        "type": "n8n-nodes-base.telegramTrigger",
        "typeVersion": 1.1,
        "position": [
          -540,
          -300
        ],
        "id": "93ac2b2b-be68-4490-b12d-cda10ed726b5",
        "name": "Telegram Trigger",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('Aggregate').item.json.question[$json.randomIndex]}} ",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "Show",
                      "additionalFields": {
                        "url": "=https://t.me/StudyJapaneseBot?start=show_{{ $('Aggregate').item.json.row_number[$json.randomIndex] }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          800,
          -760
        ],
        "id": "4545159e-6cf0-4061-88d4-a559b0251f40",
        "name": "Telegram2",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status"
              },
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          140,
          -760
        ],
        "id": "68de056d-90a6-473a-aef1-7f9625fc7458",
        "name": "Google Sheets",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          360,
          -760
        ],
        "id": "a4f0b301-18ac-404f-a098-0de69603c81f",
        "name": "Aggregate"
      },
      {
        "parameters": {
          "jsCode": "const randomIndex = Math.floor(Math.random() * $input.first().json.row_number.length);\nreturn [{ json: { randomIndex } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          580,
          -760
        ],
        "id": "d68c4084-cf2d-4212-b02f-0b30b9ff9301",
        "name": "Code1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/start",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -320,
          -300
        ],
        "id": "91ce420e-b770-431d-bd07-28d6aecd8b11",
        "name": "If"
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          460,
          -500
        ],
        "id": "c78a1e23-f275-446a-ad2b-a61432d03b5b",
        "name": "Aggregate1"
      },
      {
        "parameters": {
          "jsCode": "// Obt√©n el texto del mensaje\nconst messageText = $json[\"message\"][\"text\"];\n\n// Verifica si el mensaje comienza con \"/start\"\nif (messageText && messageText.startsWith(\"/start \")) {\n  // Extrae el texto despu√©s de \"/start\"\n  const extractedMessage = messageText.substring(7).trim();\n  \n  // Dividimos la cadena en dos partes usando el guion bajo como separador\n  const parts = extractedMessage.split(\"_\");  // Divide usando \"_\"\n  \n  // Aseg√∫rate de que haya exactamente dos partes: la palabra y el n√∫mero\n  if (parts.length === 2) {\n    const secondWord = parts[0];  // La palabra \"show\"\n    const thirdValue = parseInt(parts[1], 10);  // El n√∫mero 37 (entero)\n\n    // Devuelve la palabra como string y el n√∫mero como entero\n    return [\n      {\n        json: {\n          secondWord: secondWord,  // \"show\"\n          thirdValue: thirdValue   // 37 (entero)\n        }\n      }\n    ];\n  }\n}\n\n// Si el mensaje no es \"/start\" o no tiene el formato esperado\nreturn [];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -120,
          -320
        ],
        "id": "d3a862ed-39e1-42ec-9b3e-60d9d64578b0",
        "name": "Code2"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "9714a5e2-9c3e-4ca2-b52d-65d344f418b5",
                "leftValue": "={{ $json.message.text }}",
                "rightValue": "/study",
                "operator": {
                  "type": "string",
                  "operation": "startsWith"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -80,
          -740
        ],
        "id": "019374dc-1ae3-446b-8823-69618e284c4c",
        "name": "If1"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('Aggregate1').item.json.answer[ $('Code4').item.json.index]}}",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "More",
                      "additionalFields": {
                        "url": "=https://t.me/StudyJapaneseBot?start=more_{{ $('Code2').item.json.thirdValue }}"
                      }
                    },
                    {
                      "text": "Done",
                      "additionalFields": {
                        "url": "=https://t.me/StudyJapaneseBot?start=done_{{ $('Code2').item.json.thirdValue }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          780,
          -500
        ],
        "id": "bd95c392-41cb-4fa8-92e1-cb3d9712e64b",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "88fe368c-4042-4bee-8916-c1df4d26dcf5",
                "leftValue": "={{ $json.secondWord }}",
                "rightValue": "show",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          160,
          -480
        ],
        "id": "ccd220d5-ff2a-4d80-9ff5-4af3dce514ff",
        "name": "If2"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "88fe368c-4042-4bee-8916-c1df4d26dcf5",
                "leftValue": "={{ $json.secondWord }}",
                "rightValue": "more",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          100,
          -220
        ],
        "id": "2253c379-16a2-4ede-8194-fb39658f00b2",
        "name": "If3"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "more",
              "row_number": "={{ $('Code2').item.json.thirdValue }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "question",
                "displayName": "question",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "answer",
                "displayName": "answer",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          300,
          -240
        ],
        "id": "44292e8c-ef6e-4aa2-8230-49227729fc3e",
        "name": "Google Sheets2",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const randomIndex = Math.floor(Math.random() * $('Aggregate2').first().json.row_number.length);\nreturn [{ json: { randomIndex } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          760,
          -240
        ],
        "id": "3e02e399-439f-4c63-950d-4bd8dd4e7ee2",
        "name": "Code3"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('Aggregate2').item.json.question[$json.randomIndex]}} ",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "Show",
                      "additionalFields": {
                        "url": "=https://t.me/StudyJapaneseBot?start=show_{{ $('Aggregate2').item.json.row_number[$json.randomIndex] }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          900,
          -240
        ],
        "id": "a1bc84dc-44f9-40cc-a18b-aa043d142104",
        "name": "Telegram3",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              },
              {
                "lookupColumn": "status"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          320,
          -500
        ],
        "id": "1b8cf2fc-72f6-4300-82c6-a52da9c9891b",
        "name": "Google Sheets4",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              },
              {
                "lookupColumn": "status"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          480,
          -240
        ],
        "id": "3a3a18b4-60b4-42ff-9f41-6d2cf463ff94",
        "name": "Google Sheets1",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "88fe368c-4042-4bee-8916-c1df4d26dcf5",
                "leftValue": "={{ $json.secondWord }}",
                "rightValue": "done",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          120,
          40
        ],
        "id": "bb3711c0-029b-4f4e-8dbc-9b84091b73b7",
        "name": "If4"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "done",
              "row_number": "={{ $('Code2').item.json.thirdValue }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "question",
                "displayName": "question",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "answer",
                "displayName": "answer",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          320,
          20
        ],
        "id": "f4ce3cac-14ac-4654-9259-73a2b7ad3727",
        "name": "Google Sheets3",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          640,
          20
        ],
        "id": "ef62acc5-2bab-48d6-82a3-85c40450fcf2",
        "name": "Aggregate3"
      },
      {
        "parameters": {
          "jsCode": "const randomIndex = Math.floor(Math.random() * $('Aggregate3').first().json.row_number.length);\nreturn [{ json: { randomIndex } }];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          760,
          20
        ],
        "id": "b4fa8ae9-d741-4cf5-9b17-4da2b1326620",
        "name": "Code"
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "={{ $('Aggregate3').item.json.question[$json.randomIndex]}} ",
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": {
                  "buttons": [
                    {
                      "text": "Show",
                      "additionalFields": {
                        "url": "=https://t.me/StudyJapaneseBot?start=show_{{ $('Aggregate3').item.json.row_number[$json.randomIndex] }}"
                      }
                    }
                  ]
                }
              }
            ]
          },
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          900,
          20
        ],
        "id": "a8ebdd86-8a29-4b3a-9dcd-7a39a00b4c84",
        "name": "Telegram4",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "studyJapaneseTelegramBot"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4",
            "mode": "list",
            "cachedResultName": "Vocabulary",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Flashcards",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1__NlM5-eELa5eMw7qGlzpHveZizCOZA0xd6E-w59EV4/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "more"
              },
              {
                "lookupColumn": "status"
              }
            ]
          },
          "combineFilters": "OR",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          500,
          20
        ],
        "id": "edd2b8a9-0d99-4e1a-8074-ef8f8409e98e",
        "name": "Google Sheets5",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "content": "# Show first item",
          "height": 260,
          "width": 1120
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -140,
          -860
        ],
        "id": "33fa5c96-ecde-415e-ab3f-714eb40e4ece",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "## Show it!\n",
          "height": 240,
          "width": 900,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          80,
          -560
        ],
        "id": "a861abb5-42f0-42f4-92e1-88ac97aed033",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "jsCode": "// Supongamos que el array est√° en 'json.row_number'\nconst items = $input.first().json.row_number;\n\n// Par√°metro espec√≠fico que estamos buscando\nconst searchValue = $('Code2').first().json.thirdValue;  // El valor que quieres encontrar en la lista\n\n// Buscar el √≠ndice en base al par√°metro (por ejemplo, valor 20)\nconst index = items.findIndex(item => item === searchValue);\n\n// Devolver el √≠ndice encontrado\nreturn [\n  {\n    json: {\n      index: index\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          620,
          -500
        ],
        "id": "bf7b28e0-4270-420a-84c1-b798f5de511a",
        "name": "Code4"
      },
      {
        "parameters": {
          "fieldsToAggregate": {
            "fieldToAggregate": [
              {
                "fieldToAggregate": "row_number"
              },
              {
                "fieldToAggregate": "question"
              },
              {
                "fieldToAggregate": "answer"
              },
              {
                "fieldToAggregate": "status"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          620,
          -240
        ],
        "id": "b8df447c-3d77-40df-b571-30ba812889f2",
        "name": "Aggregate2"
      }
    ],
    "connections": {
      "Telegram Trigger": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "Telegram2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate1": {
        "main": [
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Google Sheets4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Google Sheets2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets2": {
        "main": [
          [
            {
              "node": "Google Sheets1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Telegram3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets4": {
        "main": [
          [
            {
              "node": "Aggregate1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets1": {
        "main": [
          [
            {
              "node": "Aggregate2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Google Sheets3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets3": {
        "main": [
          [
            {
              "node": "Google Sheets5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate3": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Telegram4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets5": {
        "main": [
          [
            {
              "node": "Aggregate3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate2": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "cf2a9860-b326-4ef8-a770-1b48446ca548",
    "activeVersionId": null,
    "triggerCount": 1,
    "shared": [
      {
        "updatedAt": "2025-04-08T09:00:43.144Z",
        "createdAt": "2025-04-08T09:00:43.144Z",
        "role": "workflow:owner",
        "workflowId": "scAzuNtH8DNQgcog",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-05-11T14:53:42.000Z",
    "createdAt": "2025-05-11T08:01:28.606Z",
    "id": "thG7BQQFHlvGtfYl",
    "name": "Youtube_Auto_Osos",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$input.first().json.output; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1100,
          -80
        ],
        "id": "66e44536-1d7d-4b55-b2bf-ddf9c08634c7",
        "name": "Code32"
      },
      {
        "parameters": {
          "operation": "create",
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "title": "={{ $json.fileName }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1860,
          -60
        ],
        "id": "7d09d44a-a190-4683-9d9f-37a5c717ff85",
        "name": "Google Sheets14",
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "return [\n  {\n    \"characterStatus\": null,\n    \"imageStatus\": null,\n    \"imageVStatus\": null,\n    \"videoStatus\": null,\n    \"videoVStatus\": null,\n    \"imagePrompt\": null,\n    \"actionScript\": null,\n    \"characterPrompt\": null,\n    \"characterLink\": null,\n    \"imageLink\": null,\n    \"imageLinkV\": null,\n    \"videoLink\": null,\n    \"videoLinkV\": null\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2040,
          -60
        ],
        "id": "03e7b6e7-7e4c-4b68-a8fd-a446ef685e55",
        "name": "Code30"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "options": {}
        },
        "id": "940e5828-42e9-45e6-9ff0-27fdcedd59e3",
        "name": "Add header",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 3,
        "position": [
          2200,
          -60
        ],
        "executeOnce": true,
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          2820,
          100
        ],
        "id": "c23463fb-dd51-4bad-80e0-a58f9590df7b",
        "name": "DeepSeek Chat Model5",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2920,
          120
        ],
        "id": "2ed3fd7c-2f48-4f86-bc45-3ed95824e7e1",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "jsCode": "const input = $input.first().json.output; // Aseg√∫rate que el nodo anterior tenga la propiedad \"text\" con todo el contenido\n\n// Dividir por l√≠neas y filtrar l√≠neas vac√≠as\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Eliminar el n√∫mero inicial de cada l√≠nea y devolver cada frase como un item separado\nreturn lines.map(line => {\n  return {\n    json: {\n      sentence: line.replace(/^\\d+\\.\\s*/, \"\").trim()\n    }\n  };\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3140,
          -80
        ],
        "id": "499db002-9dab-47bf-8bae-5dae3799d7b2",
        "name": "Code33"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3540,
          -60
        ],
        "id": "cd6c484b-79f4-41bc-8901-d82125f590ca",
        "name": "Loop Over Items5"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "imageStatus": "ready",
              "imagePrompt": "={{ $json.cleanedText }}",
              "imageVStatus": "ready",
              "characterStatus": "ready",
              "characterPrompt": "={{ $('Character Description').item.json.output }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "characterStatus",
                "displayName": "characterStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "actionScript",
                "displayName": "actionScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "characterPrompt",
                "displayName": "characterPrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "characterLink",
                "displayName": "characterLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          4200,
          -40
        ],
        "id": "9650bd7b-57ea-49a1-b316-9df1699c5938",
        "name": "Google Sheets16",
        "retryOnFail": true,
        "waitBetweenTries": 3000,
        "maxTries": 5,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Script finished  {{ $('Google Sheets14').item.json.title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5040,
          -160
        ],
        "id": "c34be8ad-3ed3-4c35-8b84-7c5bbd874ba7",
        "name": "Telegram31",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4440,
          -140
        ],
        "id": "e42bf451-d18b-4c04-8f67-2bd73e16657a",
        "name": "Limit5"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Overview  \nSeparate the next text into short, narrator-style sentences that describe an exaggerated, cinematic outdoor photo shoot of a 2-month-old Pomeranian puppy styled to look like a famous Japanese character. Each sentence must describe one moment or scene in a unique real-world location ‚Äî such as a beach at sunset, a European cobblestone street, a mountain campsite, or a vibrant city park. Mention where the scene takes place, how the puppy is posed, what expression it's making, how it moves, and how the environment complements the shot ‚Äî as if the narrator is guiding us through a professionally planned viral travel shoot for social media.\n\nMake every sentence feel bold, colorful, and scroll-stopping. Use dramatic compositions, rich environmental details, and irresistibly cute behavior from the puppy. Think of the tone as playful and cinematic ‚Äî like a behind-the-scenes voiceover for a viral dog influencer who‚Äôs touring the world with flawless lighting and perfect framing.\n\nThe final output must contain **between 4 and 5** numbered sentences that form a full sequence of the shoot. Each sentence must be vivid, visual, and exciting.\n\n{{ $('Code32').item.json.cleanedText }}  \n\n## IMPORTANT  \n- All output must be family friendly, no sensitive words should be used  \n- Do not include references to clothing or costume changes  \n- Focus only on fur-styling, expressions, camera angles, poses, and visual background  \n- No extra format nor explanations, output must be in plain ready-to-use text  \n- Do not add any quote symbols or quotation marks ‚Äî avoid \"\" at all cost  \n\n## OUTPUT  \nThe output must be enumerated sentences\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          2820,
          -80
        ],
        "id": "775de957-2b5b-450c-948b-424a448a57b9",
        "name": "Narrator Script1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1360,
          140
        ],
        "id": "b282dd9e-7844-4ac0-b92d-9cb118715a99",
        "name": "DeepSeek Chat Model8",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1460,
          140
        ],
        "id": "12ca6828-0bd4-4031-81f4-21c25234f6c4",
        "name": "Simple Memory5"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "= {{ $json.output }}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1680,
          -60
        ],
        "id": "20bd7ca5-3d74-4465-8e43-427831e6d718",
        "name": "Edit Fields5"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\ncharacter: \n\n{{ $json.cleanedText }}\n\nYou are a professional YouTube creator. Based on a short viral video idea featuring a 2-month-old Pomeranian puppy as a cosplayer characterize as cartoon characters. \n\nPomeraninan characterize as : {{ $json.cleanedText }}\n\nA YouTube Title that is fun, engaging, and clearly describes the cute and unusual activity the puppy is doing. Make it catchy and optimized for social media and YouTube searches. Feel free to use humor, emojis, or all caps if it helps make it more clickable.\n\nA YouTube Description that introduces the video as an irresistibly cute and creative moment of a Pomeranian puppy living like a little human. Make the description engaging, emotional, and packed with SEO-rich keywords, trending hashtags for pets, cuteness, dogs, and viral video content. Encourage viewers to comment, like, and share.\n\nA YouTube Thumbnail Prompt describing an eye-catching, cinematic-style image with strong color contrast and a cute composition. The thumbnail should highlight the puppy in the middle of the activity, looking expressive or funny. Include a short bold text overlay that grabs attention through curiosity, humor, or surprise.\n\nA FileName that is one single word inspired by the puppy‚Äôs activity (no spaces), max 10 characters, followed by a 3-digit random number. It must feel relevant to the story and fit in a video production workflow.\n\nA single paragraph of tags, written as a comma-separated list, using keywords that relate to cute puppies, Pomeranians, viral dog videos, pets doing human things, adorable animals, trending shorts, and YouTube for pet lovers.\n\nYour output must be exactly 5 paragraphs, one for each item above. Do not include titles, labels, numbers, or formatting. Each paragraph must be written in a way that is ready to paste directly into the YouTube upload page.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n- The output will populate a json file make sure is correctly formated\n\nFormat the output like this:\n\n{\n  \"youtubeTitle\": \"Superdog Begins this shortfilm make me cry\",\n  \"youtubeDescription\": \"Superdog Begins is a story that...\",\n  \"youtubeThumbnail\": \"Create an image of a realistic dog...\",\n  \"youtubeTags\": \"dogs, cats, pets, funny\",\n  \"fileName\": \"superDogBeg157\"\n}\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1340,
          -100
        ],
        "id": "43597439-ce4e-43ac-83f9-5ad07bdcc205",
        "name": "Titles and Description"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          3740,
          180
        ],
        "id": "cf6b78a6-2a7b-4685-ab8d-93faeb9e76f9",
        "name": "DeepSeek Chat Model10",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Overview  \nUsing the narrator-style sentence provided and the exact description of the puppy, create a single, highly detailed image prompt for a commercial-style photography scene. The prompt must combine the puppy‚Äôs character-inspired look (copied exactly as provided) with a visual description of the pose, gesture, background, and cinematic elements that match the narrator-style moment. Imagine this as a highly stylized, exaggerated studio shoot made for maximum impact on social media.\n\nThe image must feel bold, clean, and visually dynamic ‚Äî with strong lighting, appealing composition, and viral potential. You may include references to the environment (like pastel walls, spotlight effects, or themed backdrops), but do not alter the character description. Think like a creative director staging a scene for a high-end pet influencer campaign.\n\nThe final output must be **a single paragraph**, merging the sentence and the character description into one cohesive visual image. Do not add any labels, quotes, or formatting.\n\nSentence:\n{{ $('Code33').item.json.sentence }}  \n\nCharacter Description:\n{{ $('Character Description').item.json.output }}\n\n## IMPORTANT  \n- Do not change or rephrase the character description ‚Äî it must be used exactly as provided  \n- Use cinematic and photographic terms where relevant (wide shot, dramatic lighting, studio backdrop, soft shadows, etc.)  \n- Do not include any clothing or props unless part of the fur styling  \n- The prompt must describe one unified image, not two separate descriptions  \n- Output must be plain text, one paragraph, no extra formatting\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          3740,
          -40
        ],
        "id": "32e244f1-7843-4fc2-8028-28ba5a15a88d",
        "name": "Image Prompt Agent7"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          3880,
          180
        ],
        "id": "d4f2f4b1-7907-4cc3-b664-cfd874cd90f6",
        "name": "Simple Memory7"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$input.first().json.output; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4040,
          -40
        ],
        "id": "8a58d8f4-5af6-4ad4-9f6d-8600ac395afe",
        "name": "Code"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4520,
          1100
        ],
        "id": "02e8b54d-78ca-4ce7-b3db-226826deb4b0",
        "name": "Limit1"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Images finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4660,
          1100
        ],
        "id": "5be50633-8479-4cfd-bbf1-8e21afcb9ab1",
        "name": "Telegram14",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + \"_prev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3320,
          2340
        ],
        "id": "424955e8-1466-469d-b0f1-99c6ab28c21b",
        "name": "Code28",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener imageLink, narratorLink y narratorScript (1 l√≠nea)\n\nconst musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/heldByGod_Puma.wav\";\nconst fontPath = \"/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf\"; // Verifica que exista en tu VPS\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Escapa caracteres peligrosos para FFmpeg\nconst escapeText = (text) =>\n  text.replace(/:/g, '\\\\:')\n      .replace(/'/g, \"\\\\\\\\'\")\n      .replace(/\"/g, '\\\\\"')\n      .replace(/\\n/g, ' ')\n      .replace(/\\r/g, '');\n\n// Divide texto en l√≠neas cortas\nconst splitTextIntoLines = (text, maxChars = 40) => {\n  const words = text.split(' ');\n  let lines = [];\n  let currentLine = '';\n\n  for (const word of words) {\n    if ((currentLine + word).length > maxChars) {\n      lines.push(currentLine.trim());\n      currentLine = '';\n    }\n    currentLine += word + ' ';\n  }\n\n  if (currentLine.trim()) lines.push(currentLine.trim());\n  return lines;\n};\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLink;\n  const audioUrl = item.json.narratorLink;\n  const rawSubtitle = item.json.narratorScript || \"\";\n\n  const lines = splitTextIntoLines(rawSubtitle);\n  const lineHeight = 40;\n  const videoHeight = 720;\n  const safeBottom = 80; // distancia segura desde el fondo\n  const totalBlockHeight = lines.length * lineHeight;\n  const startY = videoHeight - totalBlockHeight - safeBottom;\n\n  const subtitleDraw = lines.map((line, i) => {\n    const escaped = escapeText(line);\n    const yOffset = startY + (i * lineHeight);\n    return `drawtext=fontfile='${fontPath}':text='${escaped}':x=(w-text_w)/2:y=${yOffset}:fontsize=24:fontcolor=white:borderw=2:bordercolor=black`;\n  }).join(',');\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Crear video desde imagen (10s, landscape 1280x720)\n  downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t 10 -vf \"scale=1280:720,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n\n  // Combinar imagen, audio y subt√≠tulos\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -vf \"${subtitleDraw}\" -c:v libx264 -c:a aac -shortest \"${merged}\";\\n`;\n\n  // Agregar a la lista de concatenaci√≥n\n  fileListCommands += `echo \"file '${merged}'\" >> /tmp/render/filelist.txt\\n`;\n});\n\n// Combinar todos los videos\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Descargar m√∫sica y mezclar con video final\nconst musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=1.2[a0];[1:a]volume=0.2[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n\n// Borrar archivos temporales\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    chat_id: $('Telegram Trigger').item.json.message.chat.id,\n    yt_title: $input.first().json.YoutubeTitle,\n    yt_description: $input.first().json.YoutubeDescription,\n    yt_tags: $input.first().json.YoutubeTags,\n    yt_thumbnail: $input.first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2100,
          2260
        ],
        "id": "39f793d0-a32f-4246-b0e4-14d0a4bb7871",
        "name": "Code8",
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2280,
          2360
        ],
        "id": "7e819681-9fa8-432d-84ab-63c148bb20b3",
        "name": "Execute Command7",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2420,
          2360
        ],
        "id": "be08d128-978d-4948-a1de-282bdf2806ba",
        "name": "Execute Command8",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2600,
          2360
        ],
        "id": "d3def6a7-74ea-4361-9204-4817830e4226",
        "name": "Execute Command9",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2760,
          2360
        ],
        "id": "d524100d-83a1-4104-a3d7-4997e66f0776",
        "name": "Execute Command10",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2920,
          2360
        ],
        "id": "8cc788e9-bcc2-427a-a4b7-97223633092c",
        "name": "Execute Command11",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3480,
          2340
        ],
        "id": "512deeae-a3d9-4f59-8970-b0e3e4c320a1",
        "name": "Read/Write Files from Disk2",
        "disabled": true
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code28').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3840,
          2440
        ],
        "id": "5fe6d9a7-0e8c-47c9-a24c-308e283db319",
        "name": "FTP7",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          4200,
          2440
        ],
        "id": "b647b3bf-aa17-4c24-bd91-8c5c27552bad",
        "name": "Execute Command12",
        "disabled": true
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait3').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1480,
          2360
        ],
        "id": "af983671-e773-45ed-89b5-f70d49d116ce",
        "name": "Google Sheets2",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          660,
          80
        ],
        "id": "ed0b7e53-fa61-4519-9fe7-46d9d80afc0e",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          760,
          80
        ],
        "id": "f29f488b-15e2-454d-b4b7-5ee1c70012ae",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority\n\n# Overview\nReturn the name of one single, extremely famous cartoon character that is instantly recognizable worldwide. Prioritize Japanese characters from anime, manga, or pop culture (e.g. Pikachu, Totoro, Hello Kitty), but if necessary, you may include non-Japanese characters as long as they are universally known. The selected character should be visually distinct and iconic enough to be immediately recognized in a grooming or stylized pet transformation.\n\nThe output must contain only the name of the character ‚Äî no extra text, explanation, or formatting.\n\n## IMPORTANT\n- Prioritize Japanese characters, but global icons are allowed\n- No obscure or niche characters ‚Äî must be globally recognizable\n- Output must be only the character‚Äôs name, plain text, no quotes or punctuation\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          640,
          -80
        ],
        "id": "23a4cfa5-1ce6-4864-b51c-6733cc5f37fd",
        "name": "Idea Prompt Agent1"
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3100,
          2360
        ],
        "id": "afa48763-4634-419b-98b6-23fb7841decf",
        "name": "Execute Command",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Edit Fields5').first().json.fileName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4680,
          220
        ],
        "id": "d2b4bcc6-1c0d-4cc5-a549-42904cc9e532",
        "name": "Code3"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          480,
          1120
        ],
        "id": "0be6a05b-2f37-4e09-84f5-ed3b80ed0ab9",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait2').first().json.documentName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4800,
          1360
        ],
        "id": "71f52fa3-cadf-4e6d-8b65-f5f9e456e8e0",
        "name": "Code5"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          500,
          2360
        ],
        "id": "c91f3860-579a-41f1-b5ad-630c39824400",
        "name": "Wait3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1660,
          2360
        ],
        "id": "0ceb8cd5-74ae-4d15-965f-93b66211f7e6",
        "name": "If6",
        "disabled": true
      },
      {
        "parameters": {
          "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
          "text": "=There is not images to render",
          "replyMarkup": "=",
          "forceReply": {},
          "replyKeyboardOptions": {},
          "replyKeyboardRemove": {},
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          2080,
          2460
        ],
        "id": "d803e8d3-99b0-47c6-9ba7-27ecc65398dd",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "chatId": "={{ $('Code8').item.json.chat_id }}",
          "text": "={{ $('Code28').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4020,
          2440
        ],
        "id": "3904fb8a-9e94-4aef-9cdb-ce500b4dadb9",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "chatId": "={{ $('Code8').item.json.chat_id }}",
          "text": "={{ $('Code8').item.json.yt_title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4400,
          2440
        ],
        "id": "75cdcc58-8279-41ea-9173-86434f517b29",
        "name": "Telegram16",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageVStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2920,
          1120
        ],
        "id": "ff2c90fe-0ffa-4f95-a76b-25b33bf70b50",
        "name": "Google Sheets3",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code13').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 432,\n      \"height\": 768,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          3680,
          1240
        ],
        "id": "28778311-28fc-4691-933d-391861e617c9",
        "name": "ComfyUI",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3220,
          1140
        ],
        "id": "c845f58b-190d-40fa-9226-996f0fc4c1ca",
        "name": "Loop Over Items2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code12').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3840,
          1240
        ],
        "id": "93e06a57-2b3f-48d0-a2ea-c63f28bfc142",
        "name": "FTP",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"V.jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3420,
          1240
        ],
        "id": "ebdca900-550d-43c2-98ec-eab7d5310b2d",
        "name": "Code12"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items2').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3540,
          1240
        ],
        "id": "5d9e05a3-73b5-4747-a321-de55ecd6fa1d",
        "name": "Code13"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items2').item.json.row_number }}",
              "imageLinkV": "={{ $('Code12').item.json.publicUrl }}",
              "imageVStatus": "done",
              "videoVStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          4060,
          1240
        ],
        "id": "ace0f775-ceda-4103-b233-6013c4716ebc",
        "name": "Google Sheets7",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3100,
          1000
        ],
        "id": "fc4085d1-28c6-4b8d-9f38-08fbf93ffea4",
        "name": "If7"
      },
      {
        "parameters": {
          "chatId": "={{ $('Code8').item.json.chat_id }}",
          "text": "={{ $('Code8').item.json.yt_description }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4560,
          2440
        ],
        "id": "6e780a8f-60fb-4b5c-baeb-8af4e4021a3c",
        "name": "Telegram19",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "chatId": "={{ $('Code8').item.json.chat_id }}",
          "text": "={{ $('Code8').item.json.yt_thumbnail }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4700,
          2440
        ],
        "id": "bfd7c933-663f-44ec-bb87-98cf414c27c6",
        "name": "Telegram20",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "chatId": "={{ $('Code8').item.json.chat_id }}",
          "text": "={{ $('Code8').item.json.yt_tags }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5080,
          2440
        ],
        "id": "e5de0e85-c5a2-4312-9044-ebcf2f3c6c3b",
        "name": "Telegram23",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + \"_Vprev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3300,
          2760
        ],
        "id": "c0939823-278d-4642-9320-2f81a12584c0",
        "name": "Code29",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener imageLinkV, narratorLink y narratorScript\n\nconst musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/heldByGodB.wav\";\nconst fontPath = \"/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf\";\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\n// Escapar caracteres peligrosos para drawtext\nconst escapeText = (text) =>\n  text.replace(/:/g, '\\\\:')\n      .replace(/'/g, \"\\\\\\\\'\")\n      .replace(/\"/g, '\\\\\"')\n      .replace(/\\n/g, ' ')\n      .replace(/\\r/g, '');\n\n// Dividir texto largo en m√∫ltiples l√≠neas seguras\nconst splitTextIntoLines = (text, maxChars = 40) => {\n  const words = text.split(' ');\n  let lines = [];\n  let currentLine = '';\n\n  for (const word of words) {\n    if ((currentLine + word).length > maxChars) {\n      lines.push(currentLine.trim());\n      currentLine = '';\n    }\n    currentLine += word + ' ';\n  }\n\n  if (currentLine.trim()) lines.push(currentLine.trim());\n  return lines;\n};\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLinkV;\n  const audioUrl = item.json.narratorLink;\n  const rawSubtitle = item.json.narratorScript || \"\";\n\n  // Validar que todos los elementos necesarios existen\n  if (!imageUrl || !audioUrl || !rawSubtitle) return;\n\n  const lines = splitTextIntoLines(rawSubtitle);\n  const lineHeight = 40;\n  const videoHeight = 1280;\n  const safeBottom = 200;\n  const totalBlockHeight = lines.length * lineHeight;\n  const startY = videoHeight - totalBlockHeight - safeBottom;\n\n  const subtitleDraw = lines.map((line, i) => {\n    const escaped = escapeText(line);\n    const yOffset = startY + (i * lineHeight);\n    return `drawtext=fontfile='${fontPath}':text='${escaped}':x=(w-text_w)/2:y=${yOffset}:fontsize=28:fontcolor=white:borderw=2:bordercolor=black`;\n  }).join(',');\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Crear video desde imagen (formato vertical)\n  downloadCommands += `ffmpeg -y -loop 1 -i \"${rawImage}\" -t 10 -vf \"scale=720:1280,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n\n  // Combinar imagen, audio y subt√≠tulo\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -vf \"${subtitleDraw}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n\n  // Solo agregar a filelist si el archivo realmente existe\n  fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n});\n\n// Combinar todos los clips\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Descargar m√∫sica y mezclar con el video final\nconst musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=1.8[a0];[1:a]volume=0.8[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n\n// Borrar archivos temporales\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    yt_title: $input.first().json.YoutubeTitle,\n    yt_description: $input.first().json.YoutubeDescription,\n    yt_tags: $input.first().json.YoutubeTags,\n    yt_thumbnail: $input.first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2080,
          2740
        ],
        "id": "24e3dc2b-53da-4bec-8c84-18bcc126036d",
        "name": "Code19",
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2300,
          2760
        ],
        "id": "089aebb8-d345-43c9-b67e-5d23b4f8405d",
        "name": "Execute Command13",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2460,
          2760
        ],
        "id": "e8e81e1f-a581-4e61-9f8c-12e94856e15f",
        "name": "Execute Command15",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2620,
          2760
        ],
        "id": "e5148b51-e588-4137-8122-0241db26dd13",
        "name": "Execute Command16",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2780,
          2760
        ],
        "id": "afe6c092-d839-46f4-88b1-3dc3fc0b65bc",
        "name": "Execute Command17",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2940,
          2760
        ],
        "id": "50311f22-2264-4f98-8d0c-51dd888a6923",
        "name": "Execute Command18",
        "retryOnFail": true,
        "disabled": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3560,
          2760
        ],
        "id": "4cb35efa-70af-4040-a043-dd050a36638c",
        "name": "Read/Write Files from Disk5",
        "disabled": true
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code29').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3880,
          2680
        ],
        "id": "cf21a5c4-724e-4893-ae58-ce3ed211fe31",
        "name": "FTP8",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          4640,
          2680
        ],
        "id": "cc4e5e47-bbc6-45ee-b011-cfb025c595fd",
        "name": "Execute Command19",
        "disabled": true
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait3').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageVStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1620,
          2780
        ],
        "id": "99f7871a-63bb-4a1e-8fe3-c622e535c641",
        "name": "Google Sheets11",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3120,
          2760
        ],
        "id": "a762364b-f80b-4367-b437-e561078bebfe",
        "name": "Execute Command1",
        "disabled": true
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1820,
          2800
        ],
        "id": "f011fd7c-bcb6-47dd-ba58-8472f22dd438",
        "name": "If10",
        "disabled": true
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code29').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4040,
          2680
        ],
        "id": "a9b7bcab-9cfc-4d1f-a30b-7341a6c8e13c",
        "name": "Telegram17",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "resource": "video",
          "operation": "upload",
          "title": "={{ $('Code19').item.json.yt_title }}",
          "regionCode": "JP",
          "categoryId": "27",
          "options": {
            "defaultLanguage": "en",
            "description": "={{ $('Code19').item.json.yt_description }}",
            "license": "youtube",
            "notifySubscribers": true,
            "privacyStatus": "private"
          }
        },
        "type": "n8n-nodes-base.youTube",
        "typeVersion": 1,
        "position": [
          4400,
          2680
        ],
        "id": "14105eb3-51e8-49fc-b126-58b651e432c7",
        "name": "YouTube",
        "credentials": {
          "youTubeOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "YouTube account Religion"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 8
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -520,
          -260
        ],
        "id": "ef4bdab2-1e23-4727-9f01-0e69cb4eb4c9",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 17,
                "triggerAtMinute": 5
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -500,
          20
        ],
        "id": "1c1e623e-55e0-4ae6-bbfd-453f34184166",
        "name": "Schedule Trigger1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          -580,
          820
        ],
        "id": "c6cdb4c0-aad1-4aca-bdeb-bf6f16c0e740",
        "name": "When clicking ‚ÄòTest workflow‚Äô"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "dce2d9ce-0dad-4ee3-9071-3b7e22f081a5",
                "name": "documentName",
                "value": "dorapup842",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -360,
          820
        ],
        "id": "f4409c2a-1f73-4da2-b156-8d355f34a4b7",
        "name": "Edit Fields1"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          4240,
          2680
        ],
        "id": "02cfc93f-9186-4f9d-9219-b9bb32a042f1",
        "name": "Read/Write Files from Disk6",
        "disabled": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          2460,
          80
        ],
        "id": "db02234a-ee1a-41c8-b727-24c77b6f56e4",
        "name": "DeepSeek Chat Model6",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2580,
          100
        ],
        "id": "2185558e-011a-4b8c-a571-f75e50a7bd6f",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority\n\n# Overview\nGenerate a single paragraph of no more than 80 words that begins with the exact words: **masterpiece, hyperrealistic, photorealistic. 2-month-old Pomeranian puppy that has been professionally groomed and colored to resemble: {{ $('Code32').item.json.cleanedText }}  ** Then continue with a bold and exaggerated visual description of the character The description must clearly state that the base is a Pomeranian ‚Äî the character look should be applied only through fur styling and coloring, without props or costumes.\n\nThis is for a commercial video, so the style should be vibrant, cartoonish, over-the-top, and immediately recognizable. Use strong, saturated, high-contrast colors. Avoid soft blends or subtle tones. Focus only on fur shape, fur color, and facial expression ‚Äî do not include background, props, or clothing.\n\nThe Pomeranian will be characterized as:\n{{ $('Code32').item.json.cleanedText }}\n\n## IMPORTANT\n- The paragraph must start with: masterpiece, hyperrealistic, photorealistic\n- It must clearly state that the character is applied to a groomed Pomeranian\n- No gradients, subtle details, or realism ‚Äî only bold, clear, iconic features\n- No clothing, no props, no background\n- Output must be a single plain-text paragraph, no formatting, no labels\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          2460,
          -80
        ],
        "id": "5f795208-961f-4eef-8af8-c8d455f4eae0",
        "name": "Character Description",
        "retryOnFail": true
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          480,
          1660
        ],
        "id": "1f7abc92-df66-482a-86d1-907445c384d3",
        "name": "Wait4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          2900,
          1700
        ],
        "id": "2686d5b3-03da-4f69-b539-4b24125ba24f",
        "name": "Limit3"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Images finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3040,
          1700
        ],
        "id": "547a9cae-75c3-4696-8865-708cd85ddb25",
        "name": "Telegram18",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoVStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1160,
          1740
        ],
        "id": "4d9402db-bdd6-42af-a825-fa421faeba7a",
        "name": "Google Sheets4",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1500,
          1780
        ],
        "id": "fa2b5501-ad0b-4c03-a0d9-47dfef1e0410",
        "name": "Loop Over Items3"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1380,
          1640
        ],
        "id": "cb3dd706-666f-44a0-98ac-56603105f103",
        "name": "If"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1920,
          1940
        ],
        "id": "99733669-c146-47cd-b63d-db97c09b99eb",
        "name": "HTTP Request3"
      },
      {
        "parameters": {
          "command": "=wget \"{{ $('HTTP Request3').item.json.output }}\" -O /tmp/generated.mp4"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2160,
          1940
        ],
        "id": "30d16241-074a-4ae3-9e7e-fdc0865d15fb",
        "name": "Execute Command3"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/models/kwaivgi/kling-v1.6-pro/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"prompt\": \"motion\",\n    \"duration\": 5,\n    \"cfg_scale\": 0.5,\n    \"start_image\": \"{{ $json.imageLinkV }}\",\n    \"aspect_ratio\": \"9:16\",\n    \"negative_prompt\": \"\"\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1680,
          1940
        ],
        "id": "1b1b82f5-9ed8-442f-8271-48854444e8d6",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          1800,
          1940
        ],
        "id": "51b420c1-6108-4054-b4ac-7796f850d5aa",
        "name": "Wait5",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/generated.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2300,
          1940
        ],
        "id": "6328d7ed-cd1a-4cf2-bd9d-2484b04bd686",
        "name": "Read/Write Files from Disk"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code10').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          2440,
          1940
        ],
        "id": "6b2525cd-9194-4e3a-ae61-7aeed332ab96",
        "name": "FTP2",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/videos/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/videos/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2040,
          1940
        ],
        "id": "d1a7bd40-e4ae-4b05-ab32-11c7a958008d",
        "name": "Code10"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait4').first().json.documentName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3200,
          2000
        ],
        "id": "43dccd42-9cd0-438e-bb90-262ca818bf4c",
        "name": "Code6"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait4').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items3').item.json.row_number }}",
              "videoLinkV": "={{ $('Code10').item.json.publicUrl }}",
              "videoVStatus": "done"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2620,
          1940
        ],
        "id": "9ba07da5-d5b0-433c-b92f-b0bc15eb430b",
        "name": "Google Sheets8",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3720,
          3400
        ],
        "id": "ec0691f4-4fa5-4488-9c14-6878dbff6331",
        "name": "Read/Write Files from Disk1"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code14').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3920,
          3400
        ],
        "id": "ed40576b-877b-49b8-a337-157eae49fe51",
        "name": "FTP5",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener videoLinkV\nconst musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/heldByGodB.wav\";\n\n// Crear carpeta temporal\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\nlet downloadMusicCommand = `wget -q -O /tmp/render/music.mp3 \"${musicUrl}\";\\n`;\n\n// Descargar cada video y preparar para concatenaci√≥n\nrows.forEach((item, index) => {\n  const videoUrl = item.json.videoLinkV;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n\n  // Descargar video\n  downloadCommands += `wget -q -O \"${rawVideo}\" \"${videoUrl}\";\\n`;\n\n  // Agregar a la lista de concatenaci√≥n\n  fileListCommands += `echo \"file '${rawVideo}'\" >> /tmp/render/filelist.txt\\n`;\n});\n\n// Combinar todos los videos en uno solo\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combined.mp4;\\n`;\n\n// Agregar m√∫sica de fondo al video combinado\nconst addMusicCommand = `ffmpeg -y -i /tmp/render/combined.mp4 -i /tmp/render/music.mp3 -c:v copy -c:a aac -shortest -map 0:v:0 -map 1:a:0 /tmp/render/final_with_music.mp4;\\n`;\n\n// Borrar carpeta despu√©s\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: (downloadCommands + downloadMusicCommand).trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand: combineCommand.trim(),\n    addMusicCommand: addMusicCommand.trim(),\n    cleanupCommand\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2240,
          3400
        ],
        "id": "48fc3759-78d4-4b87-a1c7-67ed8c79d797",
        "name": "Code11"
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2440,
          3400
        ],
        "id": "d5c2c48b-9706-4393-9ab7-33b56d2078ef",
        "name": "Execute Command2",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2760,
          3400
        ],
        "id": "e2a003d5-a2cc-42cd-a3f1-13c97714b624",
        "name": "Execute Command20",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2600,
          3400
        ],
        "id": "340fe66b-9fdb-4bac-91ca-c2f6b5131caa",
        "name": "Execute Command21",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2960,
          3400
        ],
        "id": "d312eb17-690c-4a60-a010-276a736d9370",
        "name": "Execute Command22",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.addMusicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          3120,
          3400
        ],
        "id": "4bd17eec-f6e1-4a2d-b42f-aa1a95db97df",
        "name": "Execute Command23",
        "retryOnFail": true
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "videoVStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1560,
          3200
        ],
        "id": "f03f49c9-a7e2-4da4-831d-0233ec53fb41",
        "name": "Google Sheets12",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1820,
          3320
        ],
        "id": "bda4fb0f-3516-41cd-b3d1-1560ee7c3a5a",
        "name": "If1"
      },
      {
        "parameters": {
          "command": "={{ $('Code11').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          4260,
          3400
        ],
        "id": "03f0f902-84ae-45d8-a5ff-98ceb298d399",
        "name": "Execute Command24"
      },
      {
        "parameters": {
          "command": "ls -lh /tmp/render"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1960,
          3900
        ],
        "id": "ba63bc0f-34a1-4d41-8a64-a815231266bb",
        "name": "Execute Command4"
      },
      {
        "parameters": {
          "command": "rm -rf /tmp/render"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2200,
          3900
        ],
        "id": "442d1d21-00e5-47c6-9c54-514cf652b8e4",
        "name": "Execute Command5"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code14').first().json.publicUrl}}",
          "replyMarkup": "=",
          "forceReply": {},
          "replyKeyboardOptions": {},
          "replyKeyboardRemove": {},
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4080,
          3400
        ],
        "id": "d1fd1ddd-5b94-4fca-b4ed-73234dcbfd1f",
        "name": "Telegram22",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + \"_Vprev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3340,
          3400
        ],
        "id": "bae5ff9a-e053-4419-81da-a6c1b5330a82",
        "name": "Code14"
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code16').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 432,\n      \"height\": 768,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          1680,
          1120
        ],
        "id": "81eb60c4-d681-464e-a499-cc550ee5a7fa",
        "name": "ComfyUI1",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code15').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          1840,
          1120
        ],
        "id": "4a81ce0c-1692-48b2-bf2d-9a1a60120270",
        "name": "FTP1",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"V.jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          680,
          1120
        ],
        "id": "02fd18c9-8061-4675-bf01-fd885980d75f",
        "name": "Code15"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$input.first().json.characterPrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1520,
          1120
        ],
        "id": "9316384f-f9b7-4cd7-aeef-6d3f2b7ac26a",
        "name": "Code16"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo",
            "mode": "list",
            "cachedResultName": "YT_auto_Osos",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1NPF_52ZViKYVljEKyGdUA6BP-iFSjlJD2Ukd1oJuKSo/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          900,
          1120
        ],
        "id": "12eff1c2-5e6c-42a1-80b4-b949ed85fdbb",
        "name": "Google Sheets",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          1100,
          1120
        ],
        "id": "79ff953d-4a8b-4b0b-9713-2576030d0bd2",
        "name": "Limit"
      }
    ],
    "connections": {
      "Code32": {
        "main": [
          [
            {
              "node": "Titles and Description",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets14": {
        "main": [
          [
            {
              "node": "Code30",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code30": {
        "main": [
          [
            {
              "node": "Add header",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add header": {
        "main": [
          [
            {
              "node": "Character Description",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code33": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items5": {
        "main": [
          [
            {
              "node": "Limit5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Image Prompt Agent7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets16": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram31": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit5": {
        "main": [
          [
            {
              "node": "Telegram31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Narrator Script1": {
        "main": [
          [
            {
              "node": "Code33",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory5": {
        "ai_memory": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Titles and Description": {
        "main": [
          [
            {
              "node": "Edit Fields5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields5": {
        "main": [
          [
            {
              "node": "Google Sheets14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model10": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory7": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent7": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Google Sheets16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit1": {
        "main": [
          [
            {
              "node": "Telegram14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram14": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code28": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "Execute Command7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command7": {
        "main": [
          [
            {
              "node": "Execute Command8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command8": {
        "main": [
          [
            {
              "node": "Execute Command9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command9": {
        "main": [
          [
            {
              "node": "Execute Command10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command10": {
        "main": [
          [
            {
              "node": "Execute Command11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command11": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets2": {
        "main": [
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Code28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Idea Prompt Agent1": {
        "main": [
          [
            {
              "node": "Code32",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "Code15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait3": {
        "main": [
          [
            {
              "node": "Google Sheets2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets11",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram15": {
        "main": [
          [
            {
              "node": "Execute Command12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command12": {
        "main": [
          [
            {
              "node": "Telegram16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets3": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items2": {
        "main": [
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Google Sheets7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Code13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code13": {
        "main": [
          [
            {
              "node": "ComfyUI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram16": {
        "main": [
          [
            {
              "node": "Telegram19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram19": {
        "main": [
          [
            {
              "node": "Telegram20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram20": {
        "main": [
          [
            {
              "node": "Telegram23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code29": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code19": {
        "main": [
          [
            {
              "node": "Execute Command13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command13": {
        "main": [
          [
            {
              "node": "Execute Command15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command15": {
        "main": [
          [
            {
              "node": "Execute Command16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command16": {
        "main": [
          [
            {
              "node": "Execute Command17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command17": {
        "main": [
          [
            {
              "node": "Execute Command18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command18": {
        "main": [
          [
            {
              "node": "Execute Command1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk5": {
        "main": [
          [
            {
              "node": "FTP8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP8": {
        "main": [
          [
            {
              "node": "Telegram17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command19": {
        "main": [
          []
        ]
      },
      "Google Sheets11": {
        "main": [
          [
            {
              "node": "If10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command1": {
        "main": [
          [
            {
              "node": "Code29",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If10": {
        "main": [
          [
            {
              "node": "Code19",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram17": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger1": {
        "main": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk6": {
        "main": [
          [
            {
              "node": "YouTube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "YouTube": {
        "main": [
          [
            {
              "node": "Execute Command19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model6": {
        "ai_languageModel": [
          [
            {
              "node": "Character Description",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "Character Description",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Character Description": {
        "main": [
          [
            {
              "node": "Narrator Script1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait4": {
        "main": [
          [
            {
              "node": "Google Sheets4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit3": {
        "main": [
          [
            {
              "node": "Telegram18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets4": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items3": {
        "main": [
          [
            {
              "node": "Limit3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Loop Over Items3",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request3": {
        "main": [
          [
            {
              "node": "Code10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command3": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Wait5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait5": {
        "main": [
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk": {
        "main": [
          [
            {
              "node": "FTP2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP2": {
        "main": [
          [
            {
              "node": "Google Sheets8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code10": {
        "main": [
          [
            {
              "node": "Execute Command3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram18": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets8": {
        "main": [
          [
            {
              "node": "Loop Over Items3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk1": {
        "main": [
          [
            {
              "node": "FTP5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP5": {
        "main": [
          [
            {
              "node": "Telegram22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code11": {
        "main": [
          [
            {
              "node": "Execute Command2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command2": {
        "main": [
          [
            {
              "node": "Execute Command21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command20": {
        "main": [
          [
            {
              "node": "Execute Command22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command21": {
        "main": [
          [
            {
              "node": "Execute Command20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command22": {
        "main": [
          [
            {
              "node": "Execute Command23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command23": {
        "main": [
          [
            {
              "node": "Code14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets12": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Code11",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram22": {
        "main": [
          [
            {
              "node": "Execute Command24",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code14": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          []
        ]
      },
      "Code15": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code16": {
        "main": [
          [
            {
              "node": "ComfyUI1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit": {
        "main": [
          [
            {
              "node": "Code16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      },
      "node:Schedule Trigger1": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "e5da3715-9790-41a5-8648-62d8d5031a20",
    "activeVersionId": null,
    "triggerCount": 2,
    "shared": [
      {
        "updatedAt": "2025-05-11T08:01:28.613Z",
        "createdAt": "2025-05-11T08:01:28.613Z",
        "role": "workflow:owner",
        "workflowId": "thG7BQQFHlvGtfYl",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-12-06T15:32:06.000Z",
    "createdAt": "2025-11-27T23:35:10.473Z",
    "id": "tvIXIoXTrKDUrqt5",
    "name": "tokoroAi",
    "active": true,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_genScript",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          48,
          -112
        ],
        "id": "d340d675-4b2b-48ea-8f75-19061939a341",
        "name": "Webhook",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=MAIN TASK:\n{{ $json.body.data.task }}\n\nNUMBER OF SHOTS:\n{{ $json.body.data.numShots }}\n\nWHAT IS THE MAIN TOPIC:\n{{ $json.body.data.topic }}\n\nGUIDELINES:\n{{ $json.body.data.example }}\n\nOUPUT STRUCTURE:\n{{ $json.body.data.output }}",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          224,
          -112
        ],
        "id": "9239d6d1-1e78-4e06-a078-1fe5c615b39c",
        "name": "AI Agent"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          304,
          64
        ],
        "id": "02db0564-63f2-4a21-ac83-5d1afded2d03",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          144,
          48
        ],
        "id": "c4977cdb-27a2-4eec-9858-6005ce9bbb7c",
        "name": "Google Gemini Chat Model",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          512,
          -112
        ],
        "id": "ca68fcdb-a34c-4ff0-9415-2c6be41ef9a6",
        "name": "Respond to Webhook"
      },
      {
        "parameters": {
          "content": "## Generate the Script",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -352,
          -112
        ],
        "id": "276ada87-c028-4305-b0ff-63658c703849",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_nano_genImage",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          2224,
          -128
        ],
        "id": "b4086c47-74c7-4c14-8df7-68ca4928de4b",
        "name": "Webhook4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          3392,
          0
        ],
        "id": "bf7fde4b-e7ee-49b8-8397-beada28794aa",
        "name": "Respond to Webhook4"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"google/nano-banana\",\n  \"input\": {\n    \"prompt\": \"{{ $json.body.data.assetDescription }}.{{ $json.body.data.artDirectionStyle }}\",\n    \"output_format\": \"jpeg\",\n    \"image_size\": \"16:9\"\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2480,
          -144
        ],
        "id": "2fbb36dd-d7dc-4677-ba88-251c579bb057",
        "name": "HTTP Request4"
      },
      {
        "parameters": {
          "amount": 10
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2688,
          -144
        ],
        "id": "93892756-2821-4626-88b3-b8c0dd64f581",
        "name": "Wait3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2864,
          -160
        ],
        "id": "1d8db83d-8a4d-44d1-894d-ae95f166e97a",
        "name": "HTTP Request5"
      },
      {
        "parameters": {
          "content": "## Nano Banana\n## Image Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1728,
          -80
        ],
        "id": "c2bafc70-ef82-453c-b82a-7f47b7196ab5",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3040,
          -192
        ],
        "id": "cf6b3584-4385-473b-8b4a-c72af956c20e",
        "name": "If2"
      },
      {
        "parameters": {
          "amount": 20
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2688,
          48
        ],
        "id": "2ac15d14-5598-4845-aa97-170ad5e41cee",
        "name": "Wait4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2848,
          48
        ],
        "id": "4b4c9f0d-f52b-4b5f-8b75-f4e317c66223",
        "name": "HTTP Request6"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3040,
          48
        ],
        "id": "6a152bbd-0fa9-4856-aaa1-0f9775039545",
        "name": "If3"
      },
      {
        "parameters": {
          "amount": 30
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2704,
          480
        ],
        "id": "945751c2-003d-474e-94af-489407becb40",
        "name": "Wait5",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3056,
          496
        ],
        "id": "9d6738c9-c9df-4595-af11-fafb37d451ef",
        "name": "HTTP Request7"
      },
      {
        "parameters": {
          "amount": 20
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2688,
          272
        ],
        "id": "209f50e7-c6c1-4d2b-8f90-61bda5e85943",
        "name": "Wait9",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2848,
          272
        ],
        "id": "a5be9895-1927-4f06-8e64-406dcfe4d3eb",
        "name": "HTTP Request12"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3040,
          272
        ],
        "id": "1dd1bca1-e0b2-43e0-8006-949944dadc86",
        "name": "If6"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_genArtDirection",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          48,
          240
        ],
        "id": "7d8de96b-51de-4541-a521-8b4af82d7b67",
        "name": "Webhook1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=SCRIPT:\n{{ $json.body.data.script }}\n\nMAIN TASK:\n{{ $json.body.data.task }}\n\nGUIDELINES:\n{{ $json.body.data.example }}\n\nOUPUT STRUCTURE:\n{{ $json.body.data.output }}",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          224,
          240
        ],
        "id": "e86578d5-e088-4cb9-9d09-d42cc176582b",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          304,
          416
        ],
        "id": "1bff00e5-c84e-48b7-9bac-175c0fea885f",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          144,
          400
        ],
        "id": "d099c195-65dc-431f-a6ad-ebbf0fa0465b",
        "name": "Google Gemini Chat Model1",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          512,
          240
        ],
        "id": "92e78a17-91a8-4b15-aaa1-ed74b25e1ded",
        "name": "Respond to Webhook1"
      },
      {
        "parameters": {
          "content": "## Generate the Art Direction",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -352,
          240
        ],
        "id": "678596e1-cc73-4121-95aa-517379f4e49c",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_genImagePrompt",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          64,
          608
        ],
        "id": "9088e21d-1557-4cd1-9a7c-b0492666a378",
        "name": "Webhook2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Task:\n{{ $('Webhook2').item.json.body.task }}\n\nSHOT:\n{{ $('Webhook2').item.json.body.script }}\n\nArt Direction:\n{{ $('Webhook2').item.json.body.artDirection }}\n\nOUPUT STRUCTURE:\n{{ $('Webhook2').item.json.body.output }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          704,
          608
        ],
        "id": "5fefddbd-5bcf-4e8d-a8e8-9c2fa3fb0e11",
        "name": "AI Agent2"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          864,
          800
        ],
        "id": "f6ecc083-3259-4d57-aeba-e866e6d94144",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          704,
          784
        ],
        "id": "a0b527a1-0a56-40c1-9a17-5bab142af13a",
        "name": "Google Gemini Chat Model2",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          1040,
          608
        ],
        "id": "363837b1-8a22-4112-92eb-e0fec3bb15f2",
        "name": "Respond to Webhook2"
      },
      {
        "parameters": {
          "content": "## Generate the Image Prompt",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -336,
          608
        ],
        "id": "94517f47-2d86-4b37-82ab-8dc4995a1c91",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "jsCode": "// Get the artDirectionImages object\nconst images = $json.body.artDirectionImages;\n\n// Prepare output\nconst results = [];\n\nfor (const key of Object.keys(images)) {\n  const url = images[key];\n  \n  // Download each image\n  const file = await this.helpers.httpRequest({\n    url,\n    method: 'GET',\n    encoding: null // <-- VERY IMPORTANT to get a Buffer\n  });\n\n  results.push({\n    json: { index: key },\n    binary: {\n      data: {\n        data: file,\n        mimeType: 'image/jpeg',\n        fileName: `image_${key}.jpg`\n      }\n    }\n  });\n}\n\nreturn results;\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          304,
          608
        ],
        "id": "766cd62d-4549-470f-b077-9dd63a69c773",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "aggregate": "aggregateAllItemData",
          "options": {}
        },
        "type": "n8n-nodes-base.aggregate",
        "typeVersion": 1,
        "position": [
          512,
          608
        ],
        "id": "444b88df-f2db-4760-872d-9e9dbf131b7e",
        "name": "Aggregate"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_nanoEdit_genImage",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          2272,
          816
        ],
        "id": "4af52815-0b63-45e9-a36e-9e0ff61a8ed4",
        "name": "Webhook5",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          3552,
          960
        ],
        "id": "74888dc5-825f-4067-ae92-b05bb7bc2cf7",
        "name": "Respond to Webhook5"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"google/nano-banana-edit\",\n  \"input\": {\n    \"prompt\": \"{{ $('Webhook5').item.json.body.prompt }}\",\n    \"image_urls\":{{ JSON.stringify($json.imageLinks) }},\n    \"output_format\": \"jpeg\",\n    \"image_size\": \"16:9\"\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2640,
          816
        ],
        "id": "bfcc2844-74e3-4b64-833a-b876a3cd8040",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "amount": 10
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2848,
          816
        ],
        "id": "929d648b-4342-47e3-ac40-60996231b26b",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3024,
          800
        ],
        "id": "8993b714-92e8-4c6e-a09c-77758b240d95",
        "name": "HTTP Request8"
      },
      {
        "parameters": {
          "content": "## Nano Banana with Images\n## Image Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1744,
          816
        ],
        "id": "3ddce695-382b-433d-bc1a-28c6dc9ed9fe",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3200,
          768
        ],
        "id": "ca76f7ae-2870-4b55-a261-adce449f83ec",
        "name": "If"
      },
      {
        "parameters": {
          "amount": 20
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2848,
          1008
        ],
        "id": "a7197d39-5b0b-4673-853d-b573b90021c2",
        "name": "Wait6",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3008,
          1008
        ],
        "id": "18394f22-7d44-4723-8c6f-f857466583d3",
        "name": "HTTP Request9"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3200,
          1008
        ],
        "id": "343e081a-84fb-4b56-a0e3-6371a80f3a01",
        "name": "If4"
      },
      {
        "parameters": {
          "amount": 30
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2864,
          1440
        ],
        "id": "2560e75e-db52-4d1b-a1b9-95410d347fa1",
        "name": "Wait7",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3216,
          1456
        ],
        "id": "11f3937f-2872-43bf-ba66-54413e8005eb",
        "name": "HTTP Request10"
      },
      {
        "parameters": {
          "amount": 20
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2848,
          1232
        ],
        "id": "1b7a9bfe-b95d-44e9-9cfc-740d46f52cfc",
        "name": "Wait10",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3008,
          1232
        ],
        "id": "60f62108-f015-406f-bae6-dc3914646329",
        "name": "HTTP Request13"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3200,
          1232
        ],
        "id": "83270a21-cb7c-4a6b-8fce-17b9381a5825",
        "name": "If7"
      },
      {
        "parameters": {
          "jsCode": "const artDirectionImages = $json.body.artDirectionImages;\n\n// 1. Usa Object.values() para obtener un array de las URLs.\nconst imageUrls = Object.values(artDirectionImages);\n\n// 2. Crea la estructura de salida requerida por n8n.\nreturn [{\n  json: {\n    imageLinks: imageUrls\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2480,
          816
        ],
        "id": "ff52e968-a330-431c-8458-6f61cb0ee17b",
        "name": "Code in JavaScript1"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_genVideoPrompt",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          64,
          992
        ],
        "id": "40dd7340-447f-4a56-a894-e81086bbc874",
        "name": "Webhook3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Task:\n{{ $('Webhook3').item.json.body.task }}\n\nSHOT:\n{{ $('Webhook3').item.json.body.script }}\n\nArt Direction:\n{{ $('Webhook3').item.json.body.artDirection }}\n\nOUPUT STRUCTURE:\n{{ $('Webhook3').item.json.body.output }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          256,
          992
        ],
        "id": "46838b75-363f-445b-90ce-8169c1e92f51",
        "name": "AI Agent3"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          416,
          1184
        ],
        "id": "3671c2c7-9fd8-4bbb-9d7b-4a61715be22c",
        "name": "Simple Memory3"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          256,
          1168
        ],
        "id": "7ca081ff-3e3f-4cc5-8ae5-ca04d67de139",
        "name": "Google Gemini Chat Model3",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          592,
          992
        ],
        "id": "4953fab4-0509-481f-a09f-2a2b12d3780b",
        "name": "Respond to Webhook3"
      },
      {
        "parameters": {
          "content": "## Generate the Video Prompt",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -336,
          992
        ],
        "id": "9f2df77e-014b-438f-9ca7-2c3bda295d43",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_genVideo",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          2208,
          1824
        ],
        "id": "b52c07f9-8de0-4adc-898f-81c31ef916f3",
        "name": "Webhook6",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          3568,
          1920
        ],
        "id": "f6a5c900-1426-40eb-ade5-f7f457afb637",
        "name": "Respond to Webhook6"
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2368,
          1824
        ],
        "id": "b1c35d7b-54c4-4ab6-b053-bd465d0297bd",
        "name": "Code1"
      },
      {
        "parameters": {
          "content": "## Video Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1808,
          1840
        ],
        "id": "8aca04c4-faf2-4bc2-8d7e-4a21c5e56135",
        "name": "Sticky Note6"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3232,
          2320
        ],
        "id": "58c3aad9-3e0f-4310-a75c-6fcdbf0f1f28",
        "name": "If5"
      },
      {
        "parameters": {
          "amount": 200
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2896,
          2512
        ],
        "id": "77b5a253-e4e7-4ac1-85d9-b86689f1e67d",
        "name": "Wait8",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3248,
          2528
        ],
        "id": "0215e854-c16f-4255-adab-3bed9c2826e1",
        "name": "HTTP Request11"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2896,
          2128
        ],
        "id": "31e2d6ed-a7ad-4b25-a55c-7e6ec82effdb",
        "name": "Wait11",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3056,
          2128
        ],
        "id": "c9c43000-e7b8-4de8-923b-caf9aa9cf85b",
        "name": "HTTP Request14"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3248,
          2128
        ],
        "id": "feea796f-15f7-4021-b6ea-2740f5e0b5a2",
        "name": "If8"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"bytedance/v1-lite-image-to-video\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_url\": \"{{ $json.body.imageUrl }}\",\n    \"resolution\": \"480p\",\n    \"duration\": \"5\",\n    \"camera_fixed\": true,\n    \"seed\": -1,\n    \"enable_safety_checker\": true\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2624,
          1792
        ],
        "id": "0e38de71-456c-4395-927f-17e390cb661f",
        "name": "HTTP Request15"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2880,
          1776
        ],
        "id": "218dcfa3-bb05-4b5a-8a7c-072fb119bc23",
        "name": "Wait12",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3056,
          1760
        ],
        "id": "fff2029f-54b7-428b-9af1-af192e4110ab",
        "name": "HTTP Request16"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3232,
          1728
        ],
        "id": "ba0883c5-34d7-4910-ac8f-2d45d16e7374",
        "name": "If9"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2880,
          2320
        ],
        "id": "ec753776-9a56-447d-bf98-6cb7642ff323",
        "name": "Wait13",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3040,
          2320
        ],
        "id": "c8637ed6-411f-42fd-8d3d-d8f68bfa7ee3",
        "name": "HTTP Request17"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2912,
          1968
        ],
        "id": "f89fc4b4-5642-4110-9e2b-49ec9d0ff45b",
        "name": "Wait14",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3072,
          1968
        ],
        "id": "75b19533-3f5c-4ff7-978d-2287a2141295",
        "name": "HTTP Request18"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3264,
          1968
        ],
        "id": "f7b0fc58-37d6-404f-be63-6caa05871852",
        "name": "If10"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_genSoundPrompt",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          96,
          1376
        ],
        "id": "4898e028-8f7e-4095-9260-6e48353005ae",
        "name": "Webhook7",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Task:\n{{ $('Webhook7').item.json.body.task }}\n\nSHOT:\n{{ $('Webhook7').item.json.body.script }}\n\nArt Direction:\n{{ $('Webhook7').item.json.body.artDirection }}\n\nOUPUT STRUCTURE:\n{{ $('Webhook7').item.json.body.output }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          288,
          1376
        ],
        "id": "07ca10cb-adda-495c-a5aa-e58e0de44c8a",
        "name": "AI Agent4"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          448,
          1568
        ],
        "id": "0762db12-54b5-416c-a292-1df12085cf83",
        "name": "Simple Memory4"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          288,
          1552
        ],
        "id": "26c4efd2-99af-4ea4-9623-0b2bcdda6b7b",
        "name": "Google Gemini Chat Model4",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          624,
          1376
        ],
        "id": "35bc6829-5789-47dc-83e2-40d518076907",
        "name": "Respond to Webhook7"
      },
      {
        "parameters": {
          "content": "## Generate the Audio Prompt",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -304,
          1376
        ],
        "id": "ecafc493-6414-4798-b6bc-d51e8d32c293",
        "name": "Sticky Note7"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "tokoroAi_genSound",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          2272,
          2864
        ],
        "id": "b216a47b-2ebb-421b-b7e5-2c4194da5986",
        "name": "Webhook9",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          3664,
          2976
        ],
        "id": "912ee054-cf0a-426d-b023-f5c4ee16caf3",
        "name": "Respond to Webhook9"
      },
      {
        "parameters": {
          "content": "## SoundFX Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1872,
          2880
        ],
        "id": "70003449-4455-43bc-9f80-c2c494dbeb0e",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "amount": 3
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2992,
          3040
        ],
        "id": "2618ff40-9497-41b3-9bd5-8bd61d0f31bc",
        "name": "Wait15",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2976,
          3232
        ],
        "id": "5c53d4d4-762f-4428-8b55-22fb5ffe3ec6",
        "name": "Wait16",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.status }}",
                "rightValue": "succeeded",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3328,
          2816
        ],
        "id": "7e7243c9-2f82-4b52-8517-985a6e824a84",
        "name": "If12"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"version\": \"zsxkib/mmaudio:TOKEN_REMOVED\",\n  \"input\": {\n    \"seed\": -1,\n    \"video\": \"{{ $json.body.videoUrl }}\",\n    \"prompt\": \"{{ $json.body.videoPrompt }}\",\n    \"duration\": 5,\n    \"num_steps\": 25,\n    \"cfg_strength\": 4.5,\n    \"negative_prompt\": \"music\"\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          2656,
          2864
        ],
        "id": "c9c83ac2-b6f3-4ff8-bcd0-0bc179a74a68",
        "name": "HTTP Request21"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.status }}",
                "rightValue": "succeeded",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3312,
          3040
        ],
        "id": "146a1097-e3ae-4d61-a751-a4f479f9d43a",
        "name": "If13"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          2880,
          2832
        ],
        "id": "c391f27f-6362-4c1d-a938-0f3bb59158d6",
        "name": "Wait17",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          3088,
          2816
        ],
        "id": "4d515fa9-5570-4029-bd63-8680b500df0f",
        "name": "HTTP Request19"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          3136,
          3040
        ],
        "id": "d6f70fc2-845a-479a-bacd-d191762407c4",
        "name": "HTTP Request20"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          3152,
          3264
        ],
        "id": "892257fa-7621-446b-886d-0b22082dfc88",
        "name": "HTTP Request22"
      }
    ],
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook4": {
        "main": [
          [
            {
              "node": "HTTP Request4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request4": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait3": {
        "main": [
          [
            {
              "node": "HTTP Request5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request5": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait4": {
        "main": [
          [
            {
              "node": "HTTP Request6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request6": {
        "main": [
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait5": {
        "main": [
          [
            {
              "node": "HTTP Request7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request7": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait9": {
        "main": [
          [
            {
              "node": "HTTP Request12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request12": {
        "main": [
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook1": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Respond to Webhook1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook2": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent2": {
        "main": [
          [
            {
              "node": "Respond to Webhook2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Aggregate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Aggregate": {
        "main": [
          [
            {
              "node": "AI Agent2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook5": {
        "main": [
          [
            {
              "node": "Code in JavaScript1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "HTTP Request8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request8": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Respond to Webhook5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait6": {
        "main": [
          [
            {
              "node": "HTTP Request9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request9": {
        "main": [
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Respond to Webhook5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait7": {
        "main": [
          [
            {
              "node": "HTTP Request10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request10": {
        "main": [
          [
            {
              "node": "Respond to Webhook5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait10": {
        "main": [
          [
            {
              "node": "HTTP Request13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request13": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Respond to Webhook5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript1": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook3": {
        "main": [
          [
            {
              "node": "AI Agent3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent3": {
        "main": [
          [
            {
              "node": "Respond to Webhook3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory3": {
        "ai_memory": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook6": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "HTTP Request15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If5": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait8": {
        "main": [
          [
            {
              "node": "HTTP Request11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request11": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait11": {
        "main": [
          [
            {
              "node": "HTTP Request14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request14": {
        "main": [
          [
            {
              "node": "If8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If8": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request15": {
        "main": [
          [
            {
              "node": "Wait12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait12": {
        "main": [
          [
            {
              "node": "HTTP Request16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request16": {
        "main": [
          [
            {
              "node": "If9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If9": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait13": {
        "main": [
          [
            {
              "node": "HTTP Request17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request17": {
        "main": [
          [
            {
              "node": "If5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait14": {
        "main": [
          [
            {
              "node": "HTTP Request18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request18": {
        "main": [
          [
            {
              "node": "If10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If10": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook7": {
        "main": [
          [
            {
              "node": "AI Agent4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent4": {
        "main": [
          [
            {
              "node": "Respond to Webhook7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory4": {
        "ai_memory": [
          [
            {
              "node": "AI Agent4",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent4",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook9": {
        "main": [
          [
            {
              "node": "HTTP Request21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait15": {
        "main": [
          [
            {
              "node": "HTTP Request20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait16": {
        "main": [
          [
            {
              "node": "HTTP Request22",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If12": {
        "main": [
          [
            {
              "node": "Respond to Webhook9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request21": {
        "main": [
          [
            {
              "node": "Wait17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If13": {
        "main": [
          [
            {
              "node": "Respond to Webhook9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait17": {
        "main": [
          [
            {
              "node": "HTTP Request19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request19": {
        "main": [
          [
            {
              "node": "If12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request20": {
        "main": [
          [
            {
              "node": "If13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request22": {
        "main": [
          [
            {
              "node": "Respond to Webhook9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": null,
    "pinData": {},
    "versionId": "4f518956-6401-4312-9757-3398f6d788d8",
    "activeVersionId": "4f518956-6401-4312-9757-3398f6d788d8",
    "triggerCount": 9,
    "shared": [
      {
        "updatedAt": "2025-11-27T23:35:10.476Z",
        "createdAt": "2025-11-27T23:35:10.476Z",
        "role": "workflow:owner",
        "workflowId": "tvIXIoXTrKDUrqt5",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": {
      "updatedAt": "2025-12-26T01:33:14.866Z",
      "createdAt": "2025-12-26T01:33:14.866Z",
      "versionId": "4f518956-6401-4312-9757-3398f6d788d8",
      "workflowId": "tvIXIoXTrKDUrqt5",
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_genScript",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            48,
            -112
          ],
          "id": "d340d675-4b2b-48ea-8f75-19061939a341",
          "name": "Webhook",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=MAIN TASK:\n{{ $json.body.data.task }}\n\nNUMBER OF SHOTS:\n{{ $json.body.data.numShots }}\n\nWHAT IS THE MAIN TOPIC:\n{{ $json.body.data.topic }}\n\nGUIDELINES:\n{{ $json.body.data.example }}\n\nOUPUT STRUCTURE:\n{{ $json.body.data.output }}",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            224,
            -112
          ],
          "id": "9239d6d1-1e78-4e06-a078-1fe5c615b39c",
          "name": "AI Agent"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            304,
            64
          ],
          "id": "02db0564-63f2-4a21-ac83-5d1afded2d03",
          "name": "Simple Memory"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            144,
            48
          ],
          "id": "c4977cdb-27a2-4eec-9858-6005ce9bbb7c",
          "name": "Google Gemini Chat Model",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            512,
            -112
          ],
          "id": "ca68fcdb-a34c-4ff0-9415-2c6be41ef9a6",
          "name": "Respond to Webhook"
        },
        {
          "parameters": {
            "content": "## Generate the Script",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -352,
            -112
          ],
          "id": "276ada87-c028-4305-b0ff-63658c703849",
          "name": "Sticky Note"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_nano_genImage",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            2224,
            -128
          ],
          "id": "b4086c47-74c7-4c14-8df7-68ca4928de4b",
          "name": "Webhook4",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            3392,
            0
          ],
          "id": "bf7fde4b-e7ee-49b8-8397-beada28794aa",
          "name": "Respond to Webhook4"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/jobs/createTask",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"google/nano-banana\",\n  \"input\": {\n    \"prompt\": \"{{ $json.body.data.assetDescription }}.{{ $json.body.data.artDirectionStyle }}\",\n    \"output_format\": \"jpeg\",\n    \"image_size\": \"16:9\"\n  }\n}",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            2480,
            -144
          ],
          "id": "2fbb36dd-d7dc-4677-ba88-251c579bb057",
          "name": "HTTP Request4"
        },
        {
          "parameters": {
            "amount": 10
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2688,
            -144
          ],
          "id": "93892756-2821-4626-88b3-b8c0dd64f581",
          "name": "Wait3",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            2864,
            -160
          ],
          "id": "1d8db83d-8a4d-44d1-894d-ae95f166e97a",
          "name": "HTTP Request5"
        },
        {
          "parameters": {
            "content": "## Nano Banana\n## Image Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            1728,
            -80
          ],
          "id": "c2bafc70-ef82-453c-b82a-7f47b7196ab5",
          "name": "Sticky Note4"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3040,
            -192
          ],
          "id": "cf6b3584-4385-473b-8b4a-c72af956c20e",
          "name": "If2"
        },
        {
          "parameters": {
            "amount": 20
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2688,
            48
          ],
          "id": "2ac15d14-5598-4845-aa97-170ad5e41cee",
          "name": "Wait4",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            2848,
            48
          ],
          "id": "4b4c9f0d-f52b-4b5f-8b75-f4e317c66223",
          "name": "HTTP Request6"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3040,
            48
          ],
          "id": "6a152bbd-0fa9-4856-aaa1-0f9775039545",
          "name": "If3"
        },
        {
          "parameters": {
            "amount": 30
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2704,
            480
          ],
          "id": "945751c2-003d-474e-94af-489407becb40",
          "name": "Wait5",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3056,
            496
          ],
          "id": "9d6738c9-c9df-4595-af11-fafb37d451ef",
          "name": "HTTP Request7"
        },
        {
          "parameters": {
            "amount": 20
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2688,
            272
          ],
          "id": "209f50e7-c6c1-4d2b-8f90-61bda5e85943",
          "name": "Wait9",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            2848,
            272
          ],
          "id": "a5be9895-1927-4f06-8e64-406dcfe4d3eb",
          "name": "HTTP Request12"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3040,
            272
          ],
          "id": "1dd1bca1-e0b2-43e0-8006-949944dadc86",
          "name": "If6"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_genArtDirection",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            48,
            240
          ],
          "id": "7d8de96b-51de-4541-a521-8b4af82d7b67",
          "name": "Webhook1",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=SCRIPT:\n{{ $json.body.data.script }}\n\nMAIN TASK:\n{{ $json.body.data.task }}\n\nGUIDELINES:\n{{ $json.body.data.example }}\n\nOUPUT STRUCTURE:\n{{ $json.body.data.output }}",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            224,
            240
          ],
          "id": "e86578d5-e088-4cb9-9d09-d42cc176582b",
          "name": "AI Agent1"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            304,
            416
          ],
          "id": "1bff00e5-c84e-48b7-9bac-175c0fea885f",
          "name": "Simple Memory1"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            144,
            400
          ],
          "id": "d099c195-65dc-431f-a6ad-ebbf0fa0465b",
          "name": "Google Gemini Chat Model1",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            512,
            240
          ],
          "id": "92e78a17-91a8-4b15-aaa1-ed74b25e1ded",
          "name": "Respond to Webhook1"
        },
        {
          "parameters": {
            "content": "## Generate the Art Direction",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -352,
            240
          ],
          "id": "678596e1-cc73-4121-95aa-517379f4e49c",
          "name": "Sticky Note1"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_genImagePrompt",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            64,
            608
          ],
          "id": "9088e21d-1557-4cd1-9a7c-b0492666a378",
          "name": "Webhook2",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=Task:\n{{ $('Webhook2').item.json.body.task }}\n\nSHOT:\n{{ $('Webhook2').item.json.body.script }}\n\nArt Direction:\n{{ $('Webhook2').item.json.body.artDirection }}\n\nOUPUT STRUCTURE:\n{{ $('Webhook2').item.json.body.output }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            704,
            608
          ],
          "id": "5fefddbd-5bcf-4e8d-a8e8-9c2fa3fb0e11",
          "name": "AI Agent2"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            864,
            800
          ],
          "id": "f6ecc083-3259-4d57-aeba-e866e6d94144",
          "name": "Simple Memory2"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            704,
            784
          ],
          "id": "a0b527a1-0a56-40c1-9a17-5bab142af13a",
          "name": "Google Gemini Chat Model2",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            1040,
            608
          ],
          "id": "363837b1-8a22-4112-92eb-e0fec3bb15f2",
          "name": "Respond to Webhook2"
        },
        {
          "parameters": {
            "content": "## Generate the Image Prompt",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -336,
            608
          ],
          "id": "94517f47-2d86-4b37-82ab-8dc4995a1c91",
          "name": "Sticky Note2"
        },
        {
          "parameters": {
            "jsCode": "// Get the artDirectionImages object\nconst images = $json.body.artDirectionImages;\n\n// Prepare output\nconst results = [];\n\nfor (const key of Object.keys(images)) {\n  const url = images[key];\n  \n  // Download each image\n  const file = await this.helpers.httpRequest({\n    url,\n    method: 'GET',\n    encoding: null // <-- VERY IMPORTANT to get a Buffer\n  });\n\n  results.push({\n    json: { index: key },\n    binary: {\n      data: {\n        data: file,\n        mimeType: 'image/jpeg',\n        fileName: `image_${key}.jpg`\n      }\n    }\n  });\n}\n\nreturn results;\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            304,
            608
          ],
          "id": "766cd62d-4549-470f-b077-9dd63a69c773",
          "name": "Code in JavaScript"
        },
        {
          "parameters": {
            "aggregate": "aggregateAllItemData",
            "options": {}
          },
          "type": "n8n-nodes-base.aggregate",
          "typeVersion": 1,
          "position": [
            512,
            608
          ],
          "id": "444b88df-f2db-4760-872d-9e9dbf131b7e",
          "name": "Aggregate"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_nanoEdit_genImage",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            2272,
            816
          ],
          "id": "4af52815-0b63-45e9-a36e-9e0ff61a8ed4",
          "name": "Webhook5",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            3552,
            960
          ],
          "id": "74888dc5-825f-4067-ae92-b05bb7bc2cf7",
          "name": "Respond to Webhook5"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/jobs/createTask",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"google/nano-banana-edit\",\n  \"input\": {\n    \"prompt\": \"{{ $('Webhook5').item.json.body.prompt }}\",\n    \"image_urls\":{{ JSON.stringify($json.imageLinks) }},\n    \"output_format\": \"jpeg\",\n    \"image_size\": \"16:9\"\n  }\n}",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            2640,
            816
          ],
          "id": "bfcc2844-74e3-4b64-833a-b876a3cd8040",
          "name": "HTTP Request"
        },
        {
          "parameters": {
            "amount": 10
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2848,
            816
          ],
          "id": "929d648b-4342-47e3-ac40-60996231b26b",
          "name": "Wait",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3024,
            800
          ],
          "id": "8993b714-92e8-4c6e-a09c-77758b240d95",
          "name": "HTTP Request8"
        },
        {
          "parameters": {
            "content": "## Nano Banana with Images\n## Image Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            1744,
            816
          ],
          "id": "3ddce695-382b-433d-bc1a-28c6dc9ed9fe",
          "name": "Sticky Note5"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3200,
            768
          ],
          "id": "ca76f7ae-2870-4b55-a261-adce449f83ec",
          "name": "If"
        },
        {
          "parameters": {
            "amount": 20
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2848,
            1008
          ],
          "id": "a7197d39-5b0b-4673-853d-b573b90021c2",
          "name": "Wait6",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3008,
            1008
          ],
          "id": "18394f22-7d44-4723-8c6f-f857466583d3",
          "name": "HTTP Request9"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3200,
            1008
          ],
          "id": "343e081a-84fb-4b56-a0e3-6371a80f3a01",
          "name": "If4"
        },
        {
          "parameters": {
            "amount": 30
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2864,
            1440
          ],
          "id": "2560e75e-db52-4d1b-a1b9-95410d347fa1",
          "name": "Wait7",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3216,
            1456
          ],
          "id": "11f3937f-2872-43bf-ba66-54413e8005eb",
          "name": "HTTP Request10"
        },
        {
          "parameters": {
            "amount": 20
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2848,
            1232
          ],
          "id": "1b7a9bfe-b95d-44e9-9cfc-740d46f52cfc",
          "name": "Wait10",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3008,
            1232
          ],
          "id": "60f62108-f015-406f-bae6-dc3914646329",
          "name": "HTTP Request13"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3200,
            1232
          ],
          "id": "83270a21-cb7c-4a6b-8fce-17b9381a5825",
          "name": "If7"
        },
        {
          "parameters": {
            "jsCode": "const artDirectionImages = $json.body.artDirectionImages;\n\n// 1. Usa Object.values() para obtener un array de las URLs.\nconst imageUrls = Object.values(artDirectionImages);\n\n// 2. Crea la estructura de salida requerida por n8n.\nreturn [{\n  json: {\n    imageLinks: imageUrls\n  }\n}];"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            2480,
            816
          ],
          "id": "ff52e968-a330-431c-8458-6f61cb0ee17b",
          "name": "Code in JavaScript1"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_genVideoPrompt",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            64,
            992
          ],
          "id": "40dd7340-447f-4a56-a894-e81086bbc874",
          "name": "Webhook3",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=Task:\n{{ $('Webhook3').item.json.body.task }}\n\nSHOT:\n{{ $('Webhook3').item.json.body.script }}\n\nArt Direction:\n{{ $('Webhook3').item.json.body.artDirection }}\n\nOUPUT STRUCTURE:\n{{ $('Webhook3').item.json.body.output }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            256,
            992
          ],
          "id": "46838b75-363f-445b-90ce-8169c1e92f51",
          "name": "AI Agent3"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            416,
            1184
          ],
          "id": "3671c2c7-9fd8-4bbb-9d7b-4a61715be22c",
          "name": "Simple Memory3"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            256,
            1168
          ],
          "id": "7ca081ff-3e3f-4cc5-8ae5-ca04d67de139",
          "name": "Google Gemini Chat Model3",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            592,
            992
          ],
          "id": "4953fab4-0509-481f-a09f-2a2b12d3780b",
          "name": "Respond to Webhook3"
        },
        {
          "parameters": {
            "content": "## Generate the Video Prompt",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -336,
            992
          ],
          "id": "9f2df77e-014b-438f-9ca7-2c3bda295d43",
          "name": "Sticky Note3"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_genVideo",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            2208,
            1824
          ],
          "id": "b52c07f9-8de0-4adc-898f-81c31ef916f3",
          "name": "Webhook6",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            3568,
            1920
          ],
          "id": "f6a5c900-1426-40eb-ade5-f7f457afb637",
          "name": "Respond to Webhook6"
        },
        {
          "parameters": {
            "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            2368,
            1824
          ],
          "id": "b1c35d7b-54c4-4ab6-b053-bd465d0297bd",
          "name": "Code1"
        },
        {
          "parameters": {
            "content": "## Video Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            1808,
            1840
          ],
          "id": "8aca04c4-faf2-4bc2-8d7e-4a21c5e56135",
          "name": "Sticky Note6"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3232,
            2320
          ],
          "id": "58c3aad9-3e0f-4310-a75c-6fcdbf0f1f28",
          "name": "If5"
        },
        {
          "parameters": {
            "amount": 200
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2896,
            2512
          ],
          "id": "77b5a253-e4e7-4ac1-85d9-b86689f1e67d",
          "name": "Wait8",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3248,
            2528
          ],
          "id": "0215e854-c16f-4255-adab-3bed9c2826e1",
          "name": "HTTP Request11"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2896,
            2128
          ],
          "id": "31e2d6ed-a7ad-4b25-a55c-7e6ec82effdb",
          "name": "Wait11",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3056,
            2128
          ],
          "id": "c9c43000-e7b8-4de8-923b-caf9aa9cf85b",
          "name": "HTTP Request14"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3248,
            2128
          ],
          "id": "feea796f-15f7-4021-b6ea-2740f5e0b5a2",
          "name": "If8"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/jobs/createTask",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"bytedance/v1-lite-image-to-video\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_url\": \"{{ $json.body.imageUrl }}\",\n    \"resolution\": \"480p\",\n    \"duration\": \"5\",\n    \"camera_fixed\": true,\n    \"seed\": -1,\n    \"enable_safety_checker\": true\n  }\n}",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            2624,
            1792
          ],
          "id": "0e38de71-456c-4395-927f-17e390cb661f",
          "name": "HTTP Request15"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2880,
            1776
          ],
          "id": "218dcfa3-bb05-4b5a-8a7c-072fb119bc23",
          "name": "Wait12",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3056,
            1760
          ],
          "id": "fff2029f-54b7-428b-9af1-af192e4110ab",
          "name": "HTTP Request16"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3232,
            1728
          ],
          "id": "ba0883c5-34d7-4910-ac8f-2d45d16e7374",
          "name": "If9"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2880,
            2320
          ],
          "id": "ec753776-9a56-447d-bf98-6cb7642ff323",
          "name": "Wait13",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3040,
            2320
          ],
          "id": "c8637ed6-411f-42fd-8d3d-d8f68bfa7ee3",
          "name": "HTTP Request17"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2912,
            1968
          ],
          "id": "f89fc4b4-5642-4110-9e2b-49ec9d0ff45b",
          "name": "Wait14",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request15').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3072,
            1968
          ],
          "id": "75b19533-3f5c-4ff7-978d-2287a2141295",
          "name": "HTTP Request18"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3264,
            1968
          ],
          "id": "f7b0fc58-37d6-404f-be63-6caa05871852",
          "name": "If10"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_genSoundPrompt",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            96,
            1376
          ],
          "id": "4898e028-8f7e-4095-9260-6e48353005ae",
          "name": "Webhook7",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=Task:\n{{ $('Webhook7').item.json.body.task }}\n\nSHOT:\n{{ $('Webhook7').item.json.body.script }}\n\nArt Direction:\n{{ $('Webhook7').item.json.body.artDirection }}\n\nOUPUT STRUCTURE:\n{{ $('Webhook7').item.json.body.output }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            288,
            1376
          ],
          "id": "07ca10cb-adda-495c-a5aa-e58e0de44c8a",
          "name": "AI Agent4"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            448,
            1568
          ],
          "id": "0762db12-54b5-416c-a292-1df12085cf83",
          "name": "Simple Memory4"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            288,
            1552
          ],
          "id": "26c4efd2-99af-4ea4-9623-0b2bcdda6b7b",
          "name": "Google Gemini Chat Model4",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            624,
            1376
          ],
          "id": "35bc6829-5789-47dc-83e2-40d518076907",
          "name": "Respond to Webhook7"
        },
        {
          "parameters": {
            "content": "## Generate the Audio Prompt",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -304,
            1376
          ],
          "id": "ecafc493-6414-4798-b6bc-d51e8d32c293",
          "name": "Sticky Note7"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "tokoroAi_genSound",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            2272,
            2864
          ],
          "id": "b216a47b-2ebb-421b-b7e5-2c4194da5986",
          "name": "Webhook9",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            3664,
            2976
          ],
          "id": "912ee054-cf0a-426d-b023-f5c4ee16caf3",
          "name": "Respond to Webhook9"
        },
        {
          "parameters": {
            "content": "## SoundFX Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            1872,
            2880
          ],
          "id": "70003449-4455-43bc-9f80-c2c494dbeb0e",
          "name": "Sticky Note9"
        },
        {
          "parameters": {
            "amount": 3
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2992,
            3040
          ],
          "id": "2618ff40-9497-41b3-9bd5-8bd61d0f31bc",
          "name": "Wait15",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {},
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2976,
            3232
          ],
          "id": "5c53d4d4-762f-4428-8b55-22fb5ffe3ec6",
          "name": "Wait16",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.status }}",
                  "rightValue": "succeeded",
                  "operator": {
                    "type": "string",
                    "operation": "equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3328,
            2816
          ],
          "id": "7e7243c9-2f82-4b52-8517-985a6e824a84",
          "name": "If12"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.replicate.com/v1/predictions",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer r8_TOKEN_REMOVED"
                },
                {
                  "name": "Prefer",
                  "value": "wait"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"version\": \"zsxkib/mmaudio:TOKEN_REMOVED\",\n  \"input\": {\n    \"seed\": -1,\n    \"video\": \"{{ $json.body.videoUrl }}\",\n    \"prompt\": \"{{ $json.body.videoPrompt }}\",\n    \"duration\": 5,\n    \"num_steps\": 25,\n    \"cfg_strength\": 4.5,\n    \"negative_prompt\": \"music\"\n  }\n} ",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            2656,
            2864
          ],
          "id": "c9c83ac2-b6f3-4ff8-bcd0-0bc179a74a68",
          "name": "HTTP Request21"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.status }}",
                  "rightValue": "succeeded",
                  "operator": {
                    "type": "string",
                    "operation": "equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3312,
            3040
          ],
          "id": "146a1097-e3ae-4d61-a751-a4f479f9d43a",
          "name": "If13"
        },
        {
          "parameters": {},
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            2880,
            2832
          ],
          "id": "c391f27f-6362-4c1d-a938-0f3bb59158d6",
          "name": "Wait17",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            3088,
            2816
          ],
          "id": "4d515fa9-5570-4029-bd63-8680b500df0f",
          "name": "HTTP Request19"
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            3136,
            3040
          ],
          "id": "d6f70fc2-845a-479a-bacd-d191762407c4",
          "name": "HTTP Request20"
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            3152,
            3264
          ],
          "id": "892257fa-7621-446b-886d-0b22082dfc88",
          "name": "HTTP Request22"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "AI Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory": {
          "ai_memory": [
            [
              {
                "node": "AI Agent",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook4": {
          "main": [
            [
              {
                "node": "HTTP Request4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request4": {
          "main": [
            [
              {
                "node": "Wait3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait3": {
          "main": [
            [
              {
                "node": "HTTP Request5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request5": {
          "main": [
            [
              {
                "node": "If2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If2": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait4": {
          "main": [
            [
              {
                "node": "HTTP Request6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request6": {
          "main": [
            [
              {
                "node": "If3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If3": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait5": {
          "main": [
            [
              {
                "node": "HTTP Request7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request7": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait9": {
          "main": [
            [
              {
                "node": "HTTP Request12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request12": {
          "main": [
            [
              {
                "node": "If6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If6": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook1": {
          "main": [
            [
              {
                "node": "AI Agent1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent1": {
          "main": [
            [
              {
                "node": "Respond to Webhook1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory1": {
          "ai_memory": [
            [
              {
                "node": "AI Agent1",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model1": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent1",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook2": {
          "main": [
            [
              {
                "node": "Code in JavaScript",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent2": {
          "main": [
            [
              {
                "node": "Respond to Webhook2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory2": {
          "ai_memory": [
            [
              {
                "node": "AI Agent2",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model2": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent2",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Code in JavaScript": {
          "main": [
            [
              {
                "node": "Aggregate",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Aggregate": {
          "main": [
            [
              {
                "node": "AI Agent2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook5": {
          "main": [
            [
              {
                "node": "Code in JavaScript1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request": {
          "main": [
            [
              {
                "node": "Wait",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait": {
          "main": [
            [
              {
                "node": "HTTP Request8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request8": {
          "main": [
            [
              {
                "node": "If",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If": {
          "main": [
            [
              {
                "node": "Respond to Webhook5",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait6": {
          "main": [
            [
              {
                "node": "HTTP Request9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request9": {
          "main": [
            [
              {
                "node": "If4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If4": {
          "main": [
            [
              {
                "node": "Respond to Webhook5",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait7": {
          "main": [
            [
              {
                "node": "HTTP Request10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request10": {
          "main": [
            [
              {
                "node": "Respond to Webhook5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait10": {
          "main": [
            [
              {
                "node": "HTTP Request13",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request13": {
          "main": [
            [
              {
                "node": "If7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If7": {
          "main": [
            [
              {
                "node": "Respond to Webhook5",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code in JavaScript1": {
          "main": [
            [
              {
                "node": "HTTP Request",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook3": {
          "main": [
            [
              {
                "node": "AI Agent3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent3": {
          "main": [
            [
              {
                "node": "Respond to Webhook3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory3": {
          "ai_memory": [
            [
              {
                "node": "AI Agent3",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model3": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent3",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook6": {
          "main": [
            [
              {
                "node": "Code1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code1": {
          "main": [
            [
              {
                "node": "HTTP Request15",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If5": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait8": {
          "main": [
            [
              {
                "node": "HTTP Request11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request11": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait11": {
          "main": [
            [
              {
                "node": "HTTP Request14",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request14": {
          "main": [
            [
              {
                "node": "If8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If8": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait13",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request15": {
          "main": [
            [
              {
                "node": "Wait12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait12": {
          "main": [
            [
              {
                "node": "HTTP Request16",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request16": {
          "main": [
            [
              {
                "node": "If9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If9": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait14",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait13": {
          "main": [
            [
              {
                "node": "HTTP Request17",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request17": {
          "main": [
            [
              {
                "node": "If5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait14": {
          "main": [
            [
              {
                "node": "HTTP Request18",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request18": {
          "main": [
            [
              {
                "node": "If10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If10": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook7": {
          "main": [
            [
              {
                "node": "AI Agent4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent4": {
          "main": [
            [
              {
                "node": "Respond to Webhook7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory4": {
          "ai_memory": [
            [
              {
                "node": "AI Agent4",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model4": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent4",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook9": {
          "main": [
            [
              {
                "node": "HTTP Request21",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait15": {
          "main": [
            [
              {
                "node": "HTTP Request20",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait16": {
          "main": [
            [
              {
                "node": "HTTP Request22",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If12": {
          "main": [
            [
              {
                "node": "Respond to Webhook9",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait15",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request21": {
          "main": [
            [
              {
                "node": "Wait17",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If13": {
          "main": [
            [
              {
                "node": "Respond to Webhook9",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait16",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait17": {
          "main": [
            [
              {
                "node": "HTTP Request19",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request19": {
          "main": [
            [
              {
                "node": "If12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request20": {
          "main": [
            [
              {
                "node": "If13",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request22": {
          "main": [
            [
              {
                "node": "Respond to Webhook9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "authors": "system migration",
      "name": null,
      "description": null,
      "autosaved": false
    },
    "tags": []
  },
  {
    "updatedAt": "2025-05-21T22:39:31.000Z",
    "createdAt": "2025-05-09T03:50:47.186Z",
    "id": "u59hbXnwKwf9TYsZ",
    "name": "Youtube_Auto_Religion",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$input.first().json.output; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1320,
          -80
        ],
        "id": "695ecbd6-fadd-4d56-ba12-1aeb8fca1461",
        "name": "Code32"
      },
      {
        "parameters": {
          "operation": "create",
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "title": "={{ $json.fileName }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2080,
          -60
        ],
        "id": "78c2274a-4dab-4ac7-a311-beee76265d94",
        "name": "Google Sheets14",
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "return [\n  {\n    \"imageStatus\": null,\n    \"imageVStatus\": null,\n    \"videoStatus\": null,\n    \"videoVStatus\": null,\n    \"narratorStatus\": null,\n    \"imagePrompt\": null,\n    \"narratorScript\": null,\n    \"imageLink\": null,\n    \"imageLinkV\": null,\n    \"videoLink\": null,\n    \"videoLinkV\": null,\n    \"narratorLink\": null,\n    \"storyIdea\": null,\n    \"allCharsDescription\": null,\n    \"YoutubeTitle\": null,\n    \"YoutubeDescription\": null,\n    \"YoutubeTags\": null,\n    \"YoutubeThumbnail\": null\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2260,
          -60
        ],
        "id": "6e2dfcee-98d7-47c0-ab07-86f9bbc8f6dc",
        "name": "Code30"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "options": {}
        },
        "id": "91da2eab-0997-4c25-a913-c394bc26d3cd",
        "name": "Add header",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 3,
        "position": [
          2420,
          -60
        ],
        "executeOnce": true,
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          2620,
          100
        ],
        "id": "e21985d3-27b7-4f1f-b600-4f5f1e1a2c1f",
        "name": "DeepSeek Chat Model5",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2740,
          120
        ],
        "id": "ef8702df-9766-42e4-ae9f-e4f85ec55e80",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "jsCode": "const input = $input.first().json.output; // Aseg√∫rate que el nodo anterior tenga la propiedad \"text\" con todo el contenido\n\n// Dividir por l√≠neas y filtrar l√≠neas vac√≠as\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Eliminar el n√∫mero inicial de cada l√≠nea y devolver cada frase como un item separado\nreturn lines.map(line => {\n  return {\n    json: {\n      sentence: line.replace(/^\\d+\\.\\s*/, \"\").trim()\n    }\n  };\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2960,
          -60
        ],
        "id": "e5c6f143-a409-4923-8504-b1b5ab48ca0d",
        "name": "Code33"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3200,
          -60
        ],
        "id": "7084d61d-cc40-4a16-b60a-6ceb71c70af9",
        "name": "Loop Over Items5"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "narratorScript": "={{ $('Code33').item.json.sentence }}",
              "imageStatus": "ready",
              "narratorStatus": "ready",
              "imagePrompt": "={{ $json.cleanedText }}",
              "YoutubeTitle": "={{ $('Edit Fields5').item.json.youtubeTitle }}",
              "YoutubeDescription": "={{ $('Edit Fields5').item.json.youtubeDescription }}",
              "YoutubeThumbnail": "={{ $('Edit Fields5').item.json.youtubeThumbnail }}",
              "YoutubeTags": "={{ $('Edit Fields5').item.json.youtubeTags }}",
              "imageVStatus": "ready"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3860,
          -40
        ],
        "id": "07cccdc1-0134-4bd2-8ce1-6082fdf0c52c",
        "name": "Google Sheets16",
        "retryOnFail": true,
        "waitBetweenTries": 3000,
        "maxTries": 5,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Script finished  {{ $('Google Sheets14').item.json.title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4700,
          -160
        ],
        "id": "a52c2b7b-9122-40f7-b3c3-d97f7baca3cb",
        "name": "Telegram31",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4100,
          -140
        ],
        "id": "7a57b6c1-2bae-46d7-b1a6-c5fe19ace69b",
        "name": "Limit5"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Overview  \nSeparate the next text into narrator-style sentences that sound like a dramatic, slightly ironic storytelling voiceover for a video titled ‚ÄúWhy it sucked to be [Biblical Character]‚Äù. Each sentence must describe a moment or scene that shows how difficult or frustrating their life was. The tone should be emotional, grounded, and filled with human tension ‚Äî but with modern, relatable humor and a clear sense that this is a parody.\n\nit should feel like the narrator is walking the viewer through the miserable highlights of this person‚Äôs life ‚Äî one painful moment at a time. Use dramatic pauses, ironic contrasts, and subtle jokes to create empathy while also entertaining.\n\nThe final output must contain **between 10 and 16** numbered sentences that feel like a progressive story being told ‚Äî scene by scene ‚Äî focused on why it truly sucked to be this character.\n\nMake sure to use a couple of sentences for an introduction of the video.\n\n{{ $('Code32').item.json.cleanedText }}  \n\n## IMPORTANT  \n- All output must be family friendly, no sensitive words should be used.  \n- No references to weapons (even toy guns).  \n- No reference of ‚Äúshowdowns‚Äù or violent events.  \n- Add originality and modern-day fun, but do not mock faith or scripture.  \n- No extra format nor explanations, output must be in plain ready-to-use text.  \n- Do not add any quote symbols or quotation marks ‚Äî avoid \"\" at all cost \n- Do not add any * symbols or any special format  ‚Äî avoid ** at all cost \n\n## OUTPUT  \nThe output must be enumerated sentences\n\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          2620,
          -60
        ],
        "id": "fc68cd46-cf6f-4a9d-8ee8-981372d7a9e7",
        "name": "Narrator Script1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1580,
          140
        ],
        "id": "9e3fa5c3-17ec-46d1-9a06-812c9a070e85",
        "name": "DeepSeek Chat Model8",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1680,
          140
        ],
        "id": "37f218b1-abd9-49a0-8f67-7058131f45c0",
        "name": "Simple Memory5"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "= {{ $json.output }}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1900,
          -60
        ],
        "id": "284864c1-faf4-47a0-8439-24a79f1b9486",
        "name": "Edit Fields5"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\nstory: \n\n{{ $json.cleanedText }}\n\nYou are a professional YouTube creator. Based on a Bible story retold in a humorous and dramatic way under the theme ‚ÄúWhy it sucked to be [Biblical Character]‚Äù, generate:\n\nA YouTube Title that is funny, catchy, and clearly part of the ‚ÄúWhy it sucked to be‚Äù series. It should spark curiosity and hint at the struggles of the biblical character, while being respectful and suitable for a wide audience.\n\nA YouTube Description that presents the video as a humorous but emotional reflection on the hardships faced by the biblical character. It should use storytelling language, include SEO-rich keywords, and connect with both faith-based viewers and audiences who enjoy ironic or educational content. Include relevant hashtags to boost visibility.\n\nA YouTube Thumbnail Prompt that describes a striking image in the style of a dramatic documentary or biopic thumbnail. Use intense expressions, symbolic elements, dramatic lighting, and bold, ironic text that emphasizes the character's suffering or bad luck in a visual way.\n\nA FileName that is one single word inspired by the story (no spaces), max 10 characters, followed by a 3-digit random number. It must feel relevant to the tone of the video and work well in a video production pipeline.\n\nA single paragraph of tags, written as a comma-separated list, using keywords related to Bible stories, Christian faith, character struggles, emotional storytelling, dark humor, YouTube series, and biblical lessons.\n\nYour output must be exactly 5 paragraphs, one for each item above. Do not include titles, labels, numbers, or formatting. Each paragraph must be written in a way that is ready to paste directly into the YouTube upload page.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n\nFormat the output like this:\n\n{\n  \"youtubeTitle\": \"Superdog Begins this shortfilm make me cry\",\n  \"youtubeDescription\": \"Superdog Begins is a story that...\",\n  \"youtubeThumbnail\": \"Create an image of a realistic dog...\",\n  \"youtubeTags\": \"dogs, cats, pets, funny\",\n  \"fileName\": \"superDogBeg157\"\n}\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1560,
          -100
        ],
        "id": "8f68dff5-4a30-45fd-bbca-142f8105a498",
        "name": "Titles and Description"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          3380,
          120
        ],
        "id": "3343c328-e825-41aa-99e7-3c79375f383b",
        "name": "DeepSeek Chat Model10",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Task  \nYou are a professional text-to-image prompt engineer working for a Christian YouTube channel. You will receive:  \n1 narrator sentence.  \n\nYour job is to convert that sentence into a single image prompt that looks like a moment from a handcrafted claymation-style documentary series called ‚ÄúWhy it sucked to be {{ $('Google Sheets4').item.json.idea }}‚Äù.  \n\nEach image must reflect emotional storytelling, symbolic irony, and expressive character design ‚Äî all rendered in a **handmade claymation style**. The figures and environments should clearly look like they are sculpted with modeling clay, showing fingerprints, rough edges, and soft imperfections that highlight the crafted feel.\n\n\nUse this structure for each prompt:  \nhandcrafted claymation style, \"[CharacterName] is a [age]-year-old [gender] made of colorful clay, with [facial features] (e.g., [hair color/style, eye shape, exaggerated or simple features]), wearing [clothing style] that reflects their [personality traits]. Their [physical mannerisms] (such as [posture or gesture]) express their emotional state. In this scene, they are [action/position] in a [environment] made of clay, with visible modeling textures, enhanced by [lighting, mood, colors].\"\n\nIf the sentence does not involve a character, describe the **scene or symbolic element** as a claymation diorama, focusing on sculpted textures, handcrafted elements, lighting, and story-driven emotion.\n\n#Narrator Sentence  \n{{ $json.sentence }}\n\n# Rules  \n- All characters and elements must look like they are sculpted with modeling clay  \n- No cinematic or photorealistic movie style ‚Äî use handcrafted claymation aesthetic only  \n- Do not number the prompts or use labels like Scene1 or VersionB  \n- Do not include any extra explanations or formatting  \n- Do not generate intimate imagery (e.g. kissing, suggestive poses)  \n- Output must be exactly 1 standalone prompt in paragraph form  \n\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          3380,
          -40
        ],
        "id": "7ccb4a65-204e-4b25-845d-388ee35b10a2",
        "name": "Image Prompt Agent7"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          3500,
          120
        ],
        "id": "5138f26b-3833-4d7f-913b-8d7f6809743b",
        "name": "Simple Memory7"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$input.first().json.output; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3700,
          -40
        ],
        "id": "d7e471fd-879f-45f8-bffc-7007761edced",
        "name": "Code"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          980,
          640
        ],
        "id": "7f295ed3-6a33-47b8-94cb-215b85b151c9",
        "name": "Google Sheets",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "8c269fad-e72b-4471-a564-6041c1d41f41",
                "name": "binary",
                "value": "={{$json[\"audioContent\"]}}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2360,
          660
        ],
        "id": "c747f166-2042-4414-a87c-4103dc8c1207",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "binary",
          "options": {}
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          2500,
          660
        ],
        "id": "822f6f40-8f2b-47d5-8460-3e0deaa28433",
        "name": "Convert to File"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://texttospeech.googleapis.com/v1/text:synthesize",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googleOAuth2Api",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"text\": \"{{ $json.cleanedText }}\"\n  },\n  \"voice\": {\n    \"languageCode\": \"en-US\",\n    \"name\": \"en-US-Chirp3-HD-Enceladus\"\n  },\n  \"audioConfig\": {\n    \"audioEncoding\": \"MP3\",\n    \"speakingRate\": 0.92,\n    \"pitch\": 0,\n    \"volumeGainDb\": 2.0\n  }\n}\n",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          2180,
          660
        ],
        "id": "b9d9649a-2911-41e3-81a3-63cd1e0ce833",
        "name": "HTTP Request2",
        "credentials": {
          "googleOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1500,
          580
        ],
        "id": "56e4461c-32bf-43bd-afa5-2f493254d419",
        "name": "Loop Over Items1"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp3\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/god/audios/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/god/audios/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1680,
          660
        ],
        "id": "718ddbda-f514-4473-9f38-1e91e4753547",
        "name": "Code9"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code9').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3180,
          660
        ],
        "id": "23a93c41-2975-42f2-bb1f-101fc1b842bd",
        "name": "FTP3",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait1').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items1').item.json.row_number }}",
              "narratorLink": "={{ $('Code9').item.json.publicUrl }}",
              "narratorStatus": "done"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3360,
          640
        ],
        "id": "5ba5f71f-dfa4-4013-afc5-d60dc020b5a7",
        "name": "Google Sheets5",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Narrator finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5000,
          620
        ],
        "id": "14b03a59-3f3a-4225-bec1-63185572e09d",
        "name": "Telegram21",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          3860,
          540
        ],
        "id": "67589408-3465-4709-bffd-e55429f9b5af",
        "name": "Limit2"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Loop Over Items1').first().json.narratorScript; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1900,
          660
        ],
        "id": "9680a9f3-d6e8-41a9-96b4-044b9addfbd4",
        "name": "Code2"
      },
      {
        "parameters": {
          "operation": "write",
          "fileName": "/tmp/audio.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2660,
          660
        ],
        "id": "e30f9c6d-ceb9-4d94-b55a-9a04f967e74e",
        "name": "Read/Write Files from Disk3"
      },
      {
        "parameters": {
          "command": "ffmpeg -i /tmp/audio.mp3 -af \"apad=pad_dur=1,adelay=200|200,apad=pad_dur=1\" -y /tmp/audio_padded.mp3"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2800,
          660
        ],
        "id": "dfa72d37-78e6-4e04-b481-c6c875d26eef",
        "name": "Execute Command14"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/audio_padded.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2980,
          660
        ],
        "id": "94521280-787f-4065-972a-2f3cc7118f63",
        "name": "Read/Write Files from Disk4"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1060,
          1100
        ],
        "id": "c66c791c-e813-442d-94a9-9c5c2cf0282b",
        "name": "Google Sheets1",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code1').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 768,\n      \"height\": 432,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          2140,
          1240
        ],
        "id": "c31b5204-5e7b-40e8-95a8-ca761e367036",
        "name": "ComfyUI1",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1500,
          1100
        ],
        "id": "42961b89-3846-4e48-b1b1-543f41b2f02f",
        "name": "Loop Over Items"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code4').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          2280,
          1240
        ],
        "id": "f5716ecd-20d3-4963-8439-effc24fa84c8",
        "name": "FTP1",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/god/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/god/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1880,
          1240
        ],
        "id": "de304506-2763-4d61-b9fa-20ea53255869",
        "name": "Code4"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4380,
          1080
        ],
        "id": "85866d3c-b40e-420b-8cc7-b24e4e179b76",
        "name": "Limit1"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Images finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5180,
          1140
        ],
        "id": "b24b92b7-b5b0-4d57-b99c-4b4bad79f663",
        "name": "Telegram14",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2020,
          1240
        ],
        "id": "fa3494d3-a710-4030-a8e8-7e5ba0a08148",
        "name": "Code1"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items').item.json.row_number }}",
              "imageStatus": "done",
              "imageLink": "={{ $('Code4').item.json.publicUrl }}",
              "videoStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2440,
          1240
        ],
        "id": "3bf1ca0f-b651-4098-baaa-69d631db36b6",
        "name": "Google Sheets6",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + \"_prev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3100,
          1780
        ],
        "id": "b216c031-4128-4a85-adb6-eb6306221806",
        "name": "Code28"
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener imageLink y narratorLink\n\nconst musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLink;\n  const audioUrl = item.json.narratorLink;\n\n  if (!imageUrl || !audioUrl) return;\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Obtener duraci√≥n del audio y generar video de fondo\n  downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); ` +\n                      `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=1280:720,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n\n  // Combinar imagen + audio (sin texto)\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n\n  // Agregar a la lista para concatenar\n  fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n});\n\n// Combinar todos los clips\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Descargar m√∫sica y mezclar con el video final\nconst musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n\n// Limpiar\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    yt_title: $input.first().json.YoutubeTitle,\n    yt_description: $input.first().json.YoutubeDescription,\n    yt_tags: $input.first().json.YoutubeTags,\n    yt_thumbnail: $input.first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1880,
          1700
        ],
        "id": "7329d651-785a-4481-a605-77f54ad131ff",
        "name": "Code8"
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2060,
          1800
        ],
        "id": "f928b72c-d736-46c0-8583-e9b04ecd5666",
        "name": "Execute Command7",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2200,
          1800
        ],
        "id": "db7ac52d-5746-4d24-8b7b-7e399a30bd12",
        "name": "Execute Command8",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2380,
          1800
        ],
        "id": "690cacd4-80c1-4fe8-aff4-24a5456dd8e4",
        "name": "Execute Command9",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2540,
          1800
        ],
        "id": "5aebe000-dc2b-40a0-a011-ada7a66cb140",
        "name": "Execute Command10",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2700,
          1800
        ],
        "id": "058d7758-afc1-42eb-8cbf-e67119f1880d",
        "name": "Execute Command11",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3360,
          1780
        ],
        "id": "f93f6a79-36ad-4e61-b695-b6c0a2507653",
        "name": "Read/Write Files from Disk2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code28').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3600,
          1800
        ],
        "id": "fda12671-a8f9-4ac6-b709-87a25403d568",
        "name": "FTP7",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          4640,
          1880
        ],
        "id": "bf00d007-ae5f-49bf-a03a-4f84b8541fa4",
        "name": "Execute Command12"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait3').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1260,
          1800
        ],
        "id": "6426cd42-9ea8-4088-ab03-4553778552eb",
        "name": "Google Sheets2",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          920,
          120
        ],
        "id": "4cd64de8-9549-4be9-82b2-bbd3bf3d46ff",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1060,
          100
        ],
        "id": "5cc00ddd-4cca-480e-bd03-704469165013",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nCreate a concept for a video titled ‚ÄúWhy it sucked to be {{ $('Google Sheets4').item.json.idea }}‚Äù. The tone should balance emotional storytelling with a touch of dark humor and irony, while still being respectful and family-friendly. Write a single engaging paragraph that feels like the dramatic intro of a documentary or character study, highlighting why this person‚Äôs life was difficult despite their importance in the Bible. Focus on the emotional struggles, personal sacrifices, divine tests, misunderstandings, or betrayals they endured. Include the title of the story, a catchy tagline, and describe the main conflict, the character‚Äôs emotional arc, and the moments that made their journey especially hard. Use vivid language that evokes visuals and emotion, but avoid anything that feels overly epic or cinematic. Keep it grounded, human, and compelling. Do not break it into bullet points ‚Äî return only one cinematic paragraph.\n\n## IMPORTANT\n- Do not provide a title only the general idea of the script \n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- the ouput must be in 1 paragraph\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          920,
          -80
        ],
        "id": "79cd653f-f6c9-4461-ad13-0e65eaea3160",
        "name": "Idea Prompt Agent1"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          3640,
          640
        ],
        "id": "eb7ec9a5-8576-43f1-9624-9d205ac5dc9a",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2880,
          1800
        ],
        "id": "0f51018a-abcf-461e-af90-68745c7d3e07",
        "name": "Execute Command"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Edit Fields5').first().json.fileName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4340,
          220
        ],
        "id": "548c4788-4c85-462f-ba60-961d580f1089",
        "name": "Code3"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          680,
          640
        ],
        "id": "c3ec7542-4925-41e4-8d58-0a8292c83eb0",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait1').first().json.documentName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4180,
          800
        ],
        "id": "e2001cfd-2ae6-40ee-b964-0feadddbb940",
        "name": "Code7"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          700,
          1120
        ],
        "id": "61e50359-36ef-472c-b28e-31c5eca6af17",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait2').first().json.documentName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4580,
          1360
        ],
        "id": "2917332a-b6d7-4cc2-8210-9e434c8b8ff7",
        "name": "Code5"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1220,
          460
        ],
        "id": "2b3a29a3-b478-4587-aebc-37d440891642",
        "name": "If3"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1240,
          1080
        ],
        "id": "bb4684fc-ebdd-4329-820f-66f1aa36254c",
        "name": "If4"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          720,
          1800
        ],
        "id": "81b5cf92-50c9-4f73-89eb-489f43ed8c94",
        "name": "Wait3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1440,
          1800
        ],
        "id": "743f46d1-2ffa-4b01-9f48-94426aace387",
        "name": "If6"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code28').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3780,
          1780
        ],
        "id": "8319ef3d-12f6-46c6-87a6-896530251641",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4840,
          1880
        ],
        "id": "82827450-692d-43f2-b148-a5a70bc83cf1",
        "name": "Telegram16",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageVStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2700,
          1120
        ],
        "id": "79a40879-e683-4df0-bbee-26d2749e9eae",
        "name": "Google Sheets3",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code13').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 432,\n      \"height\": 768,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          3460,
          1240
        ],
        "id": "af8c8cba-cb2d-43d5-b4e5-fd389173f8c4",
        "name": "ComfyUI",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3000,
          1140
        ],
        "id": "c7083aeb-19a5-4d03-aa9c-ee567093dd1d",
        "name": "Loop Over Items2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code12').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3620,
          1240
        ],
        "id": "07eb9fca-eefa-4716-90dd-6d6857575375",
        "name": "FTP",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"V.jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/god/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/god/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3200,
          1240
        ],
        "id": "64edc180-f547-49c1-aecd-715d50be440f",
        "name": "Code12"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items2').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3320,
          1240
        ],
        "id": "bf7e11e8-fd14-4e70-bd48-531b08b7bc6b",
        "name": "Code13"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items2').item.json.row_number }}",
              "imageVStatus": "done",
              "imageLinkV": "={{ $('Code12').item.json.publicUrl }}",
              "videoVStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3840,
          1240
        ],
        "id": "b719d195-d727-4299-9c11-2688cf710bc5",
        "name": "Google Sheets7",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          2880,
          1000
        ],
        "id": "9afa7973-f52e-4e4f-82a2-011fd28a664c",
        "name": "If7"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          2440,
          1080
        ],
        "id": "a89a55c1-a960-4542-adf1-5fbcea14b766",
        "name": "Limit"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_description }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5000,
          1880
        ],
        "id": "a357fae9-ab91-4d4d-aa00-27cbeadb0162",
        "name": "Telegram19",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_thumbnail }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5140,
          1880
        ],
        "id": "c9efe9b9-ef67-4d32-8236-9865c44a4290",
        "name": "Telegram20",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_tags }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5300,
          1880
        ],
        "id": "9725b8aa-fb93-4df0-acd2-142c146f83d6",
        "name": "Telegram23",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + \"_Vprev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3080,
          2200
        ],
        "id": "4db5f9d8-8b41-40aa-bb52-3d6716c33daa",
        "name": "Code29"
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener imageLinkV y narratorLink\n\nconst musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLinkV;\n  const audioUrl = item.json.narratorLink;\n\n  // Validar que los elementos necesarios existen\n  if (!imageUrl || !audioUrl) return;\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Crear video con duraci√≥n del audio\n  downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); ` +\n                      `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=720:1280,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n\n  // Combinar imagen + audio (sin texto)\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n\n  // Agregar a lista de archivos para concatenar\n  fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n});\n\n// Combinar todos los clips\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Descargar m√∫sica y mezclar con el video final\nconst musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n\n// Borrar archivos temporales\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    yt_title: $input.first().json.YoutubeTitle,\n    yt_description: $input.first().json.YoutubeDescription,\n    yt_tags: $input.first().json.YoutubeTags,\n    yt_thumbnail: $input.first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1860,
          2240
        ],
        "id": "584fbf1c-535d-491a-925f-a254962ea806",
        "name": "Code19"
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2080,
          2200
        ],
        "id": "9c522b52-10d2-4a61-8ea8-38e6ddef3c66",
        "name": "Execute Command13",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2240,
          2200
        ],
        "id": "d80afde8-b44b-4e3d-aa02-2cb714767a22",
        "name": "Execute Command15",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2400,
          2200
        ],
        "id": "e8639648-f129-4916-b969-238137f71172",
        "name": "Execute Command16",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2560,
          2200
        ],
        "id": "81615077-53ef-484f-8384-95e47d37ccab",
        "name": "Execute Command17",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2720,
          2200
        ],
        "id": "c466ef4f-f4c0-4349-b752-6b3074c5af0a",
        "name": "Execute Command18",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3340,
          2200
        ],
        "id": "218038a0-e193-4a24-b25f-dacba608c4d3",
        "name": "Read/Write Files from Disk5"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code29').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3620,
          2200
        ],
        "id": "abb44ac4-0c43-455c-867f-a20f9dbba584",
        "name": "FTP8",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          4380,
          2200
        ],
        "id": "ccaa9700-9c22-4daa-b4f8-33ccbecbdd0d",
        "name": "Execute Command19"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait3').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageVStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1240,
          2220
        ],
        "id": "65267cc4-9a7c-47fc-8da8-8c6d51b914b6",
        "name": "Google Sheets11",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2900,
          2200
        ],
        "id": "2fb260a7-dd60-442c-9b10-49a43a31b7ba",
        "name": "Execute Command1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1540,
          2340
        ],
        "id": "d193ea93-4df9-4e26-b85f-b125537eeabe",
        "name": "If10"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code29').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3780,
          2200
        ],
        "id": "bc874d37-b70f-4657-a160-4155bd1beb23",
        "name": "Telegram17",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "resource": "video",
          "operation": "upload",
          "title": "={{ $('Code19').item.json.yt_title }}",
          "regionCode": "JP",
          "categoryId": "27",
          "options": {
            "defaultLanguage": "en",
            "description": "={{ $('Code19').item.json.yt_description }}",
            "license": "youtube",
            "notifySubscribers": true,
            "privacyStatus": "private"
          }
        },
        "type": "n8n-nodes-base.youTube",
        "typeVersion": 1,
        "position": [
          4180,
          2200
        ],
        "id": "2c4adb35-6712-42bd-bcca-a1f4310d088e",
        "name": "YouTube",
        "credentials": {
          "youTubeOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "YouTube account Religion"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 4
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -240,
          -200
        ],
        "id": "f76c9476-5a28-4dc2-9c3f-7e864fe9edf8",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 12
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -240,
          -20
        ],
        "id": "1ac841c9-2fc5-4a72-8762-7d844a296262",
        "name": "Schedule Trigger1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          -140,
          1060
        ],
        "id": "87b19b07-7ce3-4c9a-9843-fe71e5c10801",
        "name": "When clicking ‚ÄòTest workflow‚Äô"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "dce2d9ce-0dad-4ee3-9071-3b7e22f081a5",
                "name": "documentName",
                "value": "davidcry327",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          80,
          1060
        ],
        "id": "9fbe22f1-fb50-43d4-b1f9-97ee26ca05f5",
        "name": "Edit Fields1"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3980,
          2200
        ],
        "id": "13019ccd-ee35-4785-b41b-6a51d3a1ef84",
        "name": "Read/Write Files from Disk6"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          180,
          -200
        ],
        "id": "45340fde-bcac-4c08-aba3-e56c4d17fdd1",
        "name": "Google Sheets4",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          0,
          -200
        ],
        "id": "2dc5da6c-18dc-41c3-a613-f15994553d7e",
        "name": "Wait4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          360,
          -200
        ],
        "id": "01eedc0e-ec96-40b0-b3ce-cc44cd8ec948",
        "name": "Limit3"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk",
            "mode": "list",
            "cachedResultName": "YT_auto_Religion",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1jJPxTyLEcJGGGm5xtr6CQQ_Fe6h9s0ljCsF3xsfLjZk/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Google Sheets4').item.json.row_number }}",
              "status": "done"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "idea",
                "displayName": "idea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          580,
          -200
        ],
        "id": "3fd4bb85-af16-4ebd-8b35-b669e3bd8df0",
        "name": "Google Sheets8",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      }
    ],
    "connections": {
      "Code32": {
        "main": [
          [
            {
              "node": "Titles and Description",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets14": {
        "main": [
          [
            {
              "node": "Code30",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code30": {
        "main": [
          [
            {
              "node": "Add header",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add header": {
        "main": [
          [
            {
              "node": "Narrator Script1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code33": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items5": {
        "main": [
          [
            {
              "node": "Limit5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Image Prompt Agent7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets16": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram31": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit5": {
        "main": [
          [
            {
              "node": "Telegram31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Narrator Script1": {
        "main": [
          [
            {
              "node": "Code33",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory5": {
        "ai_memory": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Titles and Description": {
        "main": [
          [
            {
              "node": "Edit Fields5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields5": {
        "main": [
          [
            {
              "node": "Google Sheets14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model10": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory7": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent7": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Google Sheets16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items1": {
        "main": [
          [
            {
              "node": "Limit2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP3": {
        "main": [
          [
            {
              "node": "Google Sheets5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets5": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit2": {
        "main": [
          [
            {
              "node": "Telegram21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk3": {
        "main": [
          [
            {
              "node": "Execute Command14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command14": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk4": {
        "main": [
          [
            {
              "node": "FTP3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          [
            {
              "node": "Google Sheets6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit1": {
        "main": [
          [
            {
              "node": "Telegram14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets1": {
        "main": [
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "ComfyUI1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets6": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram21": {
        "main": [
          [
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram14": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code28": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "Execute Command7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command7": {
        "main": [
          [
            {
              "node": "Execute Command8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command8": {
        "main": [
          [
            {
              "node": "Execute Command9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command9": {
        "main": [
          [
            {
              "node": "Execute Command10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command10": {
        "main": [
          [
            {
              "node": "Execute Command11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command11": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets2": {
        "main": [
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Code28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Idea Prompt Agent1": {
        "main": [
          [
            {
              "node": "Code32",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "Google Sheets1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait3": {
        "main": [
          [
            {
              "node": "Google Sheets11",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram15": {
        "main": [
          [
            {
              "node": "Execute Command12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command12": {
        "main": [
          [
            {
              "node": "Telegram16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets3": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items2": {
        "main": [
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Google Sheets7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Code13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code13": {
        "main": [
          [
            {
              "node": "ComfyUI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit": {
        "main": [
          [
            {
              "node": "Google Sheets3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram16": {
        "main": [
          [
            {
              "node": "Telegram19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram19": {
        "main": [
          [
            {
              "node": "Telegram20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram20": {
        "main": [
          [
            {
              "node": "Telegram23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code29": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code19": {
        "main": [
          [
            {
              "node": "Execute Command13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command13": {
        "main": [
          [
            {
              "node": "Execute Command15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command15": {
        "main": [
          [
            {
              "node": "Execute Command16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command16": {
        "main": [
          [
            {
              "node": "Execute Command17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command17": {
        "main": [
          [
            {
              "node": "Execute Command18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command18": {
        "main": [
          [
            {
              "node": "Execute Command1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk5": {
        "main": [
          [
            {
              "node": "FTP8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP8": {
        "main": [
          [
            {
              "node": "Telegram17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command19": {
        "main": [
          []
        ]
      },
      "Google Sheets11": {
        "main": [
          [
            {
              "node": "If10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command1": {
        "main": [
          [
            {
              "node": "Code29",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If10": {
        "main": [
          [
            {
              "node": "Code19",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram17": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger1": {
        "main": [
          []
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk6": {
        "main": [
          [
            {
              "node": "YouTube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "YouTube": {
        "main": [
          [
            {
              "node": "Execute Command19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait4": {
        "main": [
          [
            {
              "node": "Google Sheets4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets4": {
        "main": [
          [
            {
              "node": "Limit3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit3": {
        "main": [
          [
            {
              "node": "Google Sheets8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets8": {
        "main": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram23": {
        "main": [
          []
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      },
      "node:Schedule Trigger1": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "cf6c9e94-35f8-4d60-baea-4e27554ecd0e",
    "activeVersionId": null,
    "triggerCount": 2,
    "shared": [
      {
        "updatedAt": "2025-05-09T03:50:47.189Z",
        "createdAt": "2025-05-09T03:50:47.189Z",
        "role": "workflow:owner",
        "workflowId": "u59hbXnwKwf9TYsZ",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-04-03T02:12:24.000Z",
    "createdAt": "2025-04-03T01:54:44.432Z",
    "id": "uDo1wljAZMSLP9rg",
    "name": "FacelessShortsSystem",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {},
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          100,
          380
        ],
        "id": "1cecd205-abad-4e7e-aec8-dd5c4f6f6948",
        "name": "When clicking ‚ÄòTest workflow‚Äô"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "sheetName": {
            "__rl": true,
            "value": "",
            "mode": "list",
            "cachedResultName": "",
            "cachedResultUrl": ""
          }
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          320,
          300
        ],
        "id": "29cda7d3-bfe2-4950-9a65-64c0cb915d3a",
        "name": "Grab Idea"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "aefd1ab6-29fc-46a8-b817-cf86d62d5e4d",
                "name": "animals",
                "value": "=[\"{{ $json['animal 1'] }}\",\"{{ $json['animal 2'] }}\",\"{{ $json['animal 3'] }}\",\"{{ $json['animal 4'] }}\"]",
                "type": "array"
              },
              {
                "id": "16c0db54-c132-4719-87e6-9253a3fc6a54",
                "name": "style",
                "value": "={{ $json.style }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          540,
          300
        ],
        "id": "93e89044-e69d-468d-8198-2eec74d77a16",
        "name": "Set Animals"
      },
      {
        "parameters": {
          "fieldToSplitOut": "animals",
          "options": {}
        },
        "type": "n8n-nodes-base.splitOut",
        "typeVersion": 1,
        "position": [
          760,
          300
        ],
        "id": "988bbede-a399-4cfe-a9e7-1f73d4181cfb",
        "name": "Split Out"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4o",
            "mode": "list",
            "cachedResultName": "gpt-4o"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          880,
          460
        ],
        "id": "98bfe6fa-86df-442d-98cf-f1e9528e4c8d",
        "name": "GPT 4o"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Animal: {{ $json.animals }}\nStyle: {{ $('Set Animals').item.json.style }}",
          "options": {
            "systemMessage": "=# Overview\nYou are a master image prompt generator specialized in crafting detailed, high-quality prompts for advanced image models like Flux. Your task is to generate vivid, well-structured prompts that accurately depict an animal dressed in a specified style, with a matching background that complements the theme.\n\n## Instructions:\n- Clearly describe the animal's appearance, including fur, feathers, or scales.\n- Specify the outfit and accessories that reflect the given style, ensuring they fit naturally.\n- Include details about the background that reinforce the style, creating a cohesive scene.\n- Use rich, descriptive language to enhance visual fidelity.\n- Avoid generic terms‚Äîopt for precise, imaginative descriptions that maximize prompt effectiveness.\n- Never output quotation marks (\"\") or newlines (\\n)\n\n## Example \n- Input:\nAnimal: Fox\nStyle: Cyberpunk\n\n- Output:\nA sleek red fox with vibrant fur and piercing blue cybernetic eyes, wearing a futuristic black leather jacket with neon blue accents and glowing circuitry patterns. A high-tech visor covers one eye, displaying holographic data. The fox stands confidently on a rain-slicked city street illuminated by neon signs in Japanese and English. Hovering drones and bustling pedestrians in cybernetic attire add depth to the scene, while distant flying cars streak through the dark, misty skyline.\n\n\n## IMPORTANT\n- All prompts must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          980,
          300
        ],
        "id": "96eefd56-143d-433b-ae0a-0fc0982d8882",
        "name": "Image Prompt Agent"
      },
      {
        "parameters": {
          "jsCode": "// N8N Code Node to remove all newline characters from previous node outputs\n\n// Process all items in the array\n// This will work regardless of whether we're running once for all items or once per item\nfor (let i = 0; i < items.length; i++) {\n  const currentItem = items[i];\n  \n  // Check if the item has an output property\n  if (currentItem.json && currentItem.json.output !== undefined) {\n    // Replace all newline characters with empty string\n    // Using a global regex to catch ALL instances of \\n\n    currentItem.json.output = currentItem.json.output.replace(/\\\\n/g, '');\n    \n    // Also replace actual newline characters if they exist\n    currentItem.json.output = currentItem.json.output.replace(/\\n/g, '');\n  }\n}\n\n// Return the processed items array\nreturn items;"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1340,
          300
        ],
        "id": "bb81d4b2-4251-42c0-8640-4dcad245e023",
        "name": "Remove \\n"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "3f7846c8-2c7f-440f-8245-71bf158ea311",
                "name": "prompts",
                "value": "={{ $json.output }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1540,
          300
        ],
        "id": "674bcfed-0103-49d0-afe8-5fee551bc3e4",
        "name": "Set Prompts"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.piapi.ai/api/v1/task",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n    \"model\": \"Qubico/flux1-dev\",\n    \"task_type\": \"txt2img\",\n    \"input\": {\n        \"prompt\": \"{{ $json.prompts }}\",\n        \"width\": 540, \n        \"height\": 960\n    } \n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          80,
          720
        ],
        "id": "a904033d-2d0d-4349-8d6d-4578a901ad78",
        "name": "Generate Image"
      },
      {
        "parameters": {
          "amount": 90
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          260,
          720
        ],
        "id": "8af864d0-45d6-4836-9c39-c229ed77c9d2",
        "name": "90 seconds",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "=https://api.piapi.ai/api/v1/task/{{ $json.data.task_id }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          440,
          720
        ],
        "id": "05450f86-431f-4c55-a16c-84b8086f9953",
        "name": "Get Images"
      },
      {
        "parameters": {
          "amount": 8,
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          240,
          1500
        ],
        "id": "494ec83f-849b-4306-9637-4166fd2c6364",
        "name": "8 Minutes",
        "webhookId": "WEBHOOKID_REMOVED",
        "disabled": true
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          40,
          1020
        ],
        "id": "867d5ddc-46e7-44d3-8b7d-eeb9bda98891",
        "name": "Limit"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1K-Btbc1KvhIK-ShsRhFpcPpxR604vHwNACz0Ohwf7Gk/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Grab Idea').item.json.row_number }}",
              "videoStatus": "Created"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "title",
                "displayName": "title",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 1",
                "displayName": "animal 1",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 2",
                "displayName": "animal 2",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 3",
                "displayName": "animal 3",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 4",
                "displayName": "animal 4",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "style",
                "displayName": "style",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "caption",
                "displayName": "caption",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "publishStatus",
                "displayName": "publishStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          180,
          1020
        ],
        "id": "f120149b-2db3-4703-8f20-09b6dcf5266f",
        "name": "Video Status"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          320,
          1220
        ],
        "id": "186aeeb0-9276-46f0-9082-307e8c3f3b1e",
        "name": "Flash 2.0"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Style: {{ $('Grab Idea').item.json.style }}",
          "options": {
            "systemMessage": "=# Overview\nYou are a master sound prompt generator. Given a style, generate a vivid one-to-two sentence prompt that describes the ambiance, tone, and key sound elements to create an immersive audio scene. Use evocative language to capture the essence of the style.\n\n## Example\n- Style: Haunted Ghost Hunters\n- Output: Eerie whispers echo through a decaying mansion as floorboards creak under cautious footsteps. A distant, distorted radio crackles with ghostly voices, while a cold wind howls through shattered windows."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          340,
          1020
        ],
        "id": "e128c634-5a97-4700-8d4d-3d364cd3764d",
        "name": "Sound Agent"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "5bf4beb2-3a46-4825-9292-13de8ed56400",
                "name": "audio",
                "value": "={{ $json.output.trimEnd() }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          660,
          1020
        ],
        "id": "e616b463-ff30-4264-a0d9-3af7517b0075",
        "name": "Set Audio"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.elevenlabs.io/v1/sound-generation",
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "text",
                "value": "={{ $json.audio }}"
              },
              {
                "name": "duration_seconds",
                "value": "20"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          800,
          1020
        ],
        "id": "a653f6c7-72d1-4a78-97f5-bc8cb208dafa",
        "name": "Generate Audio"
      },
      {
        "parameters": {
          "name": "={{ $('Grab Idea').item.json.style }}.mp3",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "mode": "list",
            "value": "root",
            "cachedResultName": "/ (Root folder)"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          940,
          1020
        ],
        "id": "89642d1f-e028-4c88-9517-76e664269b74",
        "name": "Upload to Drive"
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineAll",
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3,
        "position": [
          1360,
          760
        ],
        "id": "cfc56890-f7a9-4777-9f70-dbe62278c649",
        "name": "Merge"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.creatomate.com/v1/renders",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer API KEY HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"template_id\": \"d02f8e71-6e1b-4ab9-9c5e-629c35a845b7\",\n  \"modifications\": {\n    \"Video-1.source\": \"{{ $json.urls[0].url }}\",\n    \"Video-2.source\": \"{{ $json.urls[1].url }}\",\n    \"Video-3.source\": \"{{ $json.urls[2].url }}\",\n    \"Video-4.source\": \"{{ $json.urls[3].url }}\",\n    \"Audio-Track.source\": \"{{ $('Upload to Drive').first().json.webContentLink }}\",\n    \"Text-1.text\": \"{{ $('Grab Idea').first().json['animal 1'] }}\",\n    \"Text-2.text\": \"{{ $('Grab Idea').first().json['animal 2'] }}\",\n    \"Text-3.text\": \"{{ $('Grab Idea').first().json['animal 3'] }}\",\n    \"Text-4.text\": \"{{ $('Grab Idea').first().json['animal 4'] }}\"\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1760,
          760
        ],
        "id": "e3385195-1c66-4e44-b68b-41d9b6d8e66d",
        "name": "Render Video"
      },
      {
        "parameters": {
          "amount": 25
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          1960,
          760
        ],
        "id": "3700c84a-aa2d-4329-bd87-239dac264d1f",
        "name": "25 Seconds",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "={{ $json.url }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1360,
          980
        ],
        "id": "6c87bc67-4d4e-4258-8491-778882a59a26",
        "name": "Download Video"
      },
      {
        "parameters": {
          "resource": "video",
          "operation": "upload",
          "title": "={{ $('Grab Idea').first().json.title }}",
          "regionCode": "US",
          "categoryId": "1",
          "options": {
            "description": "={{ $('Grab Idea').first().json.caption }}",
            "privacyStatus": "unlisted"
          }
        },
        "type": "n8n-nodes-base.youTube",
        "typeVersion": 1,
        "position": [
          1560,
          980
        ],
        "id": "d9b358bf-6fa4-4a6c-8cb6-af162f1d443e",
        "name": "Upload Video"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1K-Btbc1KvhIK-ShsRhFpcPpxR604vHwNACz0Ohwf7Gk/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Grab Idea').first().json.row_number }}",
              "publishStatus": "Processed",
              "videoLink": "={{ $('Download Video').item.json.url }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "title",
                "displayName": "title",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 1",
                "displayName": "animal 1",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 2",
                "displayName": "animal 2",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 3",
                "displayName": "animal 3",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "animal 4",
                "displayName": "animal 4",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "style",
                "displayName": "style",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "caption",
                "displayName": "caption",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "publishStatus",
                "displayName": "publishStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1760,
          980
        ],
        "id": "f887a223-02f0-463a-b649-547e55a9e392",
        "name": "Update Sheet"
      },
      {
        "parameters": {
          "subject": "=New Short Processed: {{ $('Grab Idea').first().json.title }}",
          "emailType": "text",
          "message": "=[Name],\n\nA new short has been created and is awaiting your approval.\n\nIt is called \"{{ $('Grab Idea').first().json.title }}\".\n\nYou can view it here: \n\nCheers!",
          "options": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          1960,
          980
        ],
        "id": "bd16af26-3c54-4a19-8a61-40d3a8062874",
        "name": "Notification",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          100,
          220
        ],
        "id": "cb579935-1a44-47ef-8852-bddbdbb3d53b",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {
          "content": "# Generate Image Prompts",
          "height": 460,
          "width": 1840,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          120
        ],
        "typeVersion": 1,
        "id": "67164de8-ab66-483c-9d09-c7d7fb355a8c",
        "name": "Sticky Note3",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# Generate Images\n",
          "height": 260,
          "width": 600,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          620
        ],
        "typeVersion": 1,
        "id": "295a9a31-3b5b-4585-b425-6555d636ec7e",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "content": "# Generate Videos (Kling)\n",
          "height": 260,
          "width": 820,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          1400
        ],
        "typeVersion": 1,
        "id": "6363e4c3-de9f-4cd8-880b-5b88aaef70d7",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "content": "# Generate Audio\n\n",
          "height": 280,
          "width": 1240,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          920
        ],
        "typeVersion": 1,
        "id": "fdcbdba8-df9e-4777-b63b-b9e933a186fa",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "# Render & Upload\n",
          "height": 580,
          "width": 880
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          1280,
          620
        ],
        "typeVersion": 1,
        "id": "d22e3553-6c44-4cfe-98a9-8df47a17fd31",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "url": "=https://api.piapi.ai/api/v1/task/{{ $json.data.task_id }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          420,
          1500
        ],
        "id": "ec0c2094-5677-44c2-93e7-4bdd24f50b13",
        "name": "Get Videos (Kling)",
        "disabled": true
      },
      {
        "parameters": {
          "url": "=https://api.dev.runwayml.com/v1/tasks/{{ $json.id }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-Runway-Version",
                "value": "2024-11-06"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1020,
          720
        ],
        "id": "f95acaaf-d3f4-4c11-8b5a-d8000a56440b",
        "name": "Get Videos"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.piapi.ai/api/v1/task",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n    \"model\": \"kling\",\n    \"mode\": \"std\",\n    \"task_type\": \"video_generation\",\n    \"input\": {\n        \"prompt\": \"{{ $json.data.input.prompt }}\",\n        \"negative_prompt\": \"bad quality\",\n        \"cfg_scale\": 0.5,\n        \"duration\": 5,\n        \"image_url\": \"{{ $json.data.output.image_url }}\",\n        \"aspect_ratio\": \"9:16\",\n        \"camera_control\": {\n            \"type\": \"simple\",\n            \"config\": {\n                \"horizontal\": 0,\n                \"vertical\": 0,\n                \"pan\": 0,\n                \"tilt\": 0,\n                \"roll\": 0,\n                \"zoom\": 0\n            }\n        },\n        \"mode\": \"std\"\n    },\n    \"config\": {}\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          60,
          1500
        ],
        "id": "ed5452bf-9e75-4b3e-a79a-c1149541de9f",
        "name": "Generate Videos (Kling)",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.dev.runwayml.com/v1/image_to_video",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "X-Runway-Version",
                "value": "2024-11-06"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "promptImage",
                "value": "={{ $json.data.output.image_url }}"
              },
              {
                "name": "model",
                "value": "gen3a_turbo"
              },
              {
                "name": "ratio",
                "value": "768:1280"
              },
              {
                "name": "duration",
                "value": "5"
              },
              {
                "name": "promptText",
                "value": "={{ $json.data.input.prompt }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          680,
          720
        ],
        "id": "4306532c-89d5-49d9-8430-bc5b55e2a7e5",
        "name": "Generate Videos"
      },
      {
        "parameters": {
          "amount": 2,
          "unit": "minutes"
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          860,
          720
        ],
        "id": "dca490f2-8e92-4020-bed8-db90df64422d",
        "name": "2 minutes",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "content": "# Generate Videos\n",
          "height": 260,
          "width": 600,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          640,
          620
        ],
        "typeVersion": 1,
        "id": "022950f2-c4b1-4e44-9d2f-db02e2118dff",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "jsCode": "// Code to extract video URLs from JSON data in n8n\n// This handles various possible input structures\n\n// Function to extract video info if the object has the expected structure\nfunction extractVideoInfo(obj, index) {\n  if (obj && obj.code === 200 && \n      obj.data && obj.data.output && obj.data.output.video_url) {\n    return {\n      index: index,\n      taskId: obj.data.task_id,\n      videoUrl: obj.data.output.video_url,\n      prompt: obj.data.input.prompt\n    };\n  }\n  return null;\n}\n\n// Initialize results array\nconst videoUrls = [];\nlet currentIndex = 1;\n\n// n8n specific: loop through all items\nfor (const item of items) {\n  // Case 1: item.json is our array\n  if (Array.isArray(item.json)) {\n    item.json.forEach(entry => {\n      const videoInfo = extractVideoInfo(entry, currentIndex);\n      if (videoInfo) {\n        videoUrls.push(videoInfo);\n        currentIndex++;\n      }\n    });\n  } \n  // Case 2: item.json is a single object with our data\n  else if (typeof item.json === 'object') {\n    const videoInfo = extractVideoInfo(item.json, currentIndex);\n    if (videoInfo) {\n      videoUrls.push(videoInfo);\n      currentIndex++;\n    }\n    \n    // Case 3: item.json has a data property that is our array\n    if (Array.isArray(item.json.data)) {\n      item.json.data.forEach(entry => {\n        const videoInfo = extractVideoInfo(entry, currentIndex);\n        if (videoInfo) {\n          videoUrls.push(videoInfo);\n          currentIndex++;\n        }\n      });\n    }\n  }\n  \n  // Log what we're working with to help with debugging\n  console.log('Processing item:', JSON.stringify(item.json).substring(0, 200) + '...');\n}\n\n// Return the extracted URLs as the output\nreturn [{\n  json: {\n    totalVideos: videoUrls.length,\n    videos: videoUrls\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          640,
          1500
        ],
        "id": "05a8bca8-6fb2-4700-b993-95c54826a5c3",
        "name": "Split Out Parts (Kling)",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// N8n Code Node to extract URLs from output arrays and combine them into a single array\n\n// This code assumes your input JSON is in items[0].json or is multiple items\n// Determine data source format\nlet inputArray;\n\nif (items.length === 1 && Array.isArray(items[0].json)) {\n  // If we have a single item containing our array\n  inputArray = items[0].json;\n} else if (items.length > 1) {\n  // If we already have multiple items, each containing part of our data\n  inputArray = items.map(item => item.json || item);\n} else {\n  throw new Error('Input structure not recognized. Please check your data format.');\n}\n\n// Create a single array to hold all URLs\nconst urlArray = [];\n\n// Process each item in the input array\nfor (const item of inputArray) {\n  // Get the data object\n  const data = item;\n  \n  // Check if the item has an output array\n  if (data.output && Array.isArray(data.output)) {\n    // For each URL in the output array, add to our URL array\n    for (const url of data.output) {\n      // You can choose to add just the URL or include metadata\n      urlArray.push({\n        url: url,\n        sourceId: data.id,\n        createdAt: data.createdAt\n      });\n    }\n  }\n}\n\n// Return a single item containing the array of all URLs\nreturn [{\n  json: {\n    urls: urlArray\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1560,
          760
        ],
        "id": "e177b24f-8834-4b1a-81e8-0744f86bc668",
        "name": "Split Out Parts"
      },
      {
        "parameters": {
          "operation": "share",
          "fileId": {
            "__rl": true,
            "value": "={{ $json.id }}",
            "mode": "id"
          },
          "permissionsUi": {
            "permissionsValues": {
              "role": "reader",
              "type": "anyone",
              "allowFileDiscovery": true
            }
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          1080,
          1020
        ],
        "id": "337c6a4b-d701-4497-8bdd-0f6c2d3d7548",
        "name": "Share File"
      },
      {
        "parameters": {
          "content": "# Nate Herk | AI Automation",
          "height": 80,
          "width": 500,
          "color": 6
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          0,
          0
        ],
        "typeVersion": 1,
        "id": "3bb81c4b-c314-409d-ae79-3a141a3a7ea1",
        "name": "Sticky Note6"
      }
    ],
    "connections": {
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Grab Idea",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Grab Idea": {
        "main": [
          [
            {
              "node": "Set Animals",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Animals": {
        "main": [
          [
            {
              "node": "Split Out",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out": {
        "main": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GPT 4o": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent": {
        "main": [
          [
            {
              "node": "Remove \\n",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Remove \\n": {
        "main": [
          [
            {
              "node": "Set Prompts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Prompts": {
        "main": [
          [
            {
              "node": "Generate Image",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Image": {
        "main": [
          [
            {
              "node": "90 seconds",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "90 seconds": {
        "main": [
          [
            {
              "node": "Get Images",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Images": {
        "main": [
          [
            {
              "node": "Generate Videos",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "8 Minutes": {
        "main": [
          [
            {
              "node": "Get Videos (Kling)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit": {
        "main": [
          [
            {
              "node": "Video Status",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Video Status": {
        "main": [
          [
            {
              "node": "Sound Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Flash 2.0": {
        "ai_languageModel": [
          [
            {
              "node": "Sound Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Sound Agent": {
        "main": [
          [
            {
              "node": "Set Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set Audio": {
        "main": [
          [
            {
              "node": "Generate Audio",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Audio": {
        "main": [
          [
            {
              "node": "Upload to Drive",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload to Drive": {
        "main": [
          [
            {
              "node": "Share File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Split Out Parts",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Render Video": {
        "main": [
          [
            {
              "node": "25 Seconds",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "25 Seconds": {
        "main": [
          [
            {
              "node": "Download Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Download Video": {
        "main": [
          [
            {
              "node": "Upload Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video": {
        "main": [
          [
            {
              "node": "Update Sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update Sheet": {
        "main": [
          [
            {
              "node": "Notification",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Grab Idea",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Videos (Kling)": {
        "main": [
          [
            {
              "node": "8 Minutes",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Videos": {
        "main": [
          [
            {
              "node": "2 minutes",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "2 minutes": {
        "main": [
          [
            {
              "node": "Get Videos",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Videos": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            },
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Split Out Parts": {
        "main": [
          [
            {
              "node": "Render Video",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Share File": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": null,
    "pinData": {},
    "versionId": "e1b4e520-21a9-49da-a48e-15b8c446b734",
    "activeVersionId": null,
    "triggerCount": 0,
    "shared": [
      {
        "updatedAt": "2025-04-03T01:54:44.434Z",
        "createdAt": "2025-04-03T01:54:44.434Z",
        "role": "workflow:owner",
        "workflowId": "uDo1wljAZMSLP9rg",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-05-21T11:03:58.000Z",
    "createdAt": "2025-05-20T13:32:05.760Z",
    "id": "ulwDUlIGVeRUmReM",
    "name": "Youtube_Auto_WhyItSucks",
    "active": false,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$input.first().json.output; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1320,
          -80
        ],
        "id": "b5e1835d-3478-482a-b3e1-e5e0978e2797",
        "name": "Code32"
      },
      {
        "parameters": {
          "operation": "create",
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "title": "={{ $json.fileName }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2080,
          -60
        ],
        "id": "a287aad3-957f-4d5b-a187-3c0f864bade0",
        "name": "Google Sheets14",
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "return [\n  {\n    \"imageStatus\": null,\n    \"imageVStatus\": null,\n    \"videoStatus\": null,\n    \"videoVStatus\": null,\n    \"narratorStatus\": null,\n    \"imagePrompt\": null,\n    \"narratorScript\": null,\n    \"imageLink\": null,\n    \"imageLinkV\": null,\n    \"videoLink\": null,\n    \"videoLinkV\": null,\n    \"narratorLink\": null,\n    \"storyIdea\": null,\n    \"allCharsDescription\": null,\n    \"YoutubeTitle\": null,\n    \"YoutubeDescription\": null,\n    \"YoutubeTags\": null,\n    \"YoutubeThumbnail\": null\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2260,
          -60
        ],
        "id": "cde93dba-d0fd-4c9c-8330-f41f66145710",
        "name": "Code30"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "dataMode": "autoMapInputData",
          "options": {}
        },
        "id": "fd7f4e4b-a3af-4e45-bec3-5d1bad6e1233",
        "name": "Add header",
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 3,
        "position": [
          2420,
          -60
        ],
        "executeOnce": true,
        "retryOnFail": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          2620,
          100
        ],
        "id": "6a7f8e2a-ef37-4c9b-bbb5-5680d30d65fd",
        "name": "DeepSeek Chat Model5",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2740,
          120
        ],
        "id": "2e3f4ec4-805c-4e11-abf4-83a94ca15b1c",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "jsCode": "const input = $input.first().json.output; // Aseg√∫rate que el nodo anterior tenga la propiedad \"text\" con todo el contenido\n\n// Dividir por l√≠neas y filtrar l√≠neas vac√≠as\nconst lines = input.split('\\n').filter(line => line.trim().length > 0);\n\n// Eliminar el n√∫mero inicial de cada l√≠nea y devolver cada frase como un item separado\nreturn lines.map(line => {\n  return {\n    json: {\n      sentence: line.replace(/^\\d+\\.\\s*/, \"\").trim()\n    }\n  };\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2960,
          -60
        ],
        "id": "9c2e118d-56b6-42b9-9013-878292905cbc",
        "name": "Code33"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3200,
          -60
        ],
        "id": "c78bf86a-340a-407a-a452-3fd9a67c1be0",
        "name": "Loop Over Items5"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Google Sheets14').item.json.sheetId }}",
            "mode": "id"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "narratorScript": "={{ $('Code33').item.json.sentence }}",
              "imageStatus": "ready",
              "narratorStatus": "ready",
              "imagePrompt": "={{ $json.cleanedText }}",
              "YoutubeTitle": "={{ $('Edit Fields5').item.json.youtubeTitle }}",
              "YoutubeDescription": "={{ $('Edit Fields5').item.json.youtubeDescription }}",
              "YoutubeThumbnail": "={{ $('Edit Fields5').item.json.youtubeThumbnail }}",
              "YoutubeTags": "={{ $('Edit Fields5').item.json.youtubeTags }}",
              "imageVStatus": "ready"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3860,
          -40
        ],
        "id": "3fa98a70-3f6f-4493-aaff-c5b0e7da017d",
        "name": "Google Sheets16",
        "retryOnFail": true,
        "waitBetweenTries": 3000,
        "maxTries": 5,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Script finished  {{ $('Google Sheets14').item.json.title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4700,
          -160
        ],
        "id": "01b4af61-5227-4a4b-88b4-1148083a90a4",
        "name": "Telegram31",
        "webhookId": "WEBHOOKID_REMOVED",
        "retryOnFail": true,
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4100,
          -140
        ],
        "id": "c8699d5e-7be5-46bc-bd52-db57402aa680",
        "name": "Limit5"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Overview  \nSeparate the next text into narrator-style sentences that sound like a dramatic, slightly ironic storytelling voiceover for a video titled ‚ÄúWhy it sucked to be {{ $('Limit3').item.json.idea }}‚Äù. Each sentence must describe a moment or scene that shows how difficult, frustrating, or unexpectedly ironic their life was. The tone should be emotional, grounded, and filled with human tension ‚Äî but with modern, relatable humor and a clear sense that this is a parody. If the character is fictional or from pop culture, describe their challenges in a generalized and transformative way that avoids direct or copyrighted references, while still making their identity recognizable.\n\nIt should feel like the narrator is walking the viewer through the miserable highlights of this character‚Äôs life ‚Äî one painful or awkward moment at a time. Use dramatic pauses, ironic contrasts, and subtle jokes to create empathy while also entertaining. Focus on internal struggles, contradictions, misunderstandings, or unexpected downsides of their supposed greatness or fame.\n\nThe final output must contain **between 10 and 16** numbered sentences that feel like a progressive story being told ‚Äî scene by scene ‚Äî focused on why it truly sucked to be this character.\n\nThe first sentence must be:\n1. {{ $('Edit Fields5').item.json.youtubeTitle }}\n\nstory:\n{{ $('Code32').item.json.cleanedText }}  \n\n## IMPORTANT  \n- All output must be family friendly, no sensitive words should be used.  \n- No references to weapons (even toy guns).  \n- No reference of ‚Äúshowdowns‚Äù or violent events.  \n- Add originality and modern-day fun, but do not mock faith, real-life trauma, or copyrighted plots.  \n- Do not copy direct lines or events from source material.  \n- No extra format nor explanations, output must be in plain ready-to-use text.  \n- Do not add any quote symbols or quotation marks  \n- avoid \"\" at all cost  \n- Do not add any * symbols or any special format  \n- avoid * at all cost  \n\n## OUTPUT  \nThe output must be enumerated sentences\n\n\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          2620,
          -60
        ],
        "id": "9ee90698-71f0-480b-8060-ec22ff037b90",
        "name": "Narrator Script1",
        "retryOnFail": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          1580,
          140
        ],
        "id": "708f79b2-f65f-46c9-9b8f-07d4d2bee84d",
        "name": "DeepSeek Chat Model8",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1680,
          140
        ],
        "id": "fca2036e-0346-44ca-a4eb-f84be2989a90",
        "name": "Simple Memory5"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "= {{ $json.output }}",
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1900,
          -60
        ],
        "id": "5f25b098-68ad-4810-8778-9250a34a2611",
        "name": "Edit Fields5"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\nstory: \n{{ $json.cleanedText }}\n\nYou are a professional YouTube creator. Based on a story retold in a humorous and dramatic way under the theme ‚ÄúWhy it sucked to be [Character]‚Äù, generate:\n\nA YouTube Title that is funny, catchy, and clearly part of the ‚ÄúWhy it sucked to be‚Äù series. It should spark curiosity and hint at the struggles of the character, while being respectful and suitable for a wide audience, the title must start with Why it sucked to be {{ $('Google Sheets4').item.json.idea }}\n\nA YouTube Description that presents the video as a humorous but emotional reflection on the hardships faced by the character. It should use storytelling language, include SEO-rich keywords, and connect with both faith-based viewers and audiences who enjoy ironic or educational content. Include relevant hashtags to boost visibility.\n\nA YouTube Thumbnail must be this:  \"A claymation-style image with a clean white background. At the center is a handcrafted clay figure of {{ $('Google Sheets4').item.json.idea }}, sculpted with expressive facial features and exaggerated emotional details, as if made from real plasticine. Above the character, the title ‚ÄúWHY IT SUCKED TO BE {{ $('Google Sheets4').item.json.idea }}‚Äù is written in extra large, colorful clay letters‚Äîeach word in a different vibrant color (red, yellow, blue, green, orange, purple). The letters should be bold, oversized, and clearly legible even at small thumbnail size, taking up a significant portion of the top half of the image. The font is playful and eye-catching, with a handcrafted texture. The overall image should look like a still frame from a high-end stop-motion clay documentary, with dramatic composition and soft shadows for realism, but always keeping a handcrafted plasticine aesthetic.\"\n\nA FileName that is one single word inspired by the story (no spaces), max 10 characters, followed by a 3-digit random number. It must feel relevant to the tone of the video and work well in a video production pipeline.\n\nA single paragraph of tags, written as a comma-separated list, using keywords related to the character series, character struggles, emotional storytelling, dark humor, YouTube series, and any other that could help.\n\nYour output must be exactly 5 paragraphs, one for each item above. Do not include titles, labels, numbers, or formatting. Each paragraph must be written in a way that is ready to paste directly into the YouTube upload page.\n\n## IMPORTANT\n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format nor explanations output in a ready to use text\n- Do not add any extra information other than the story\n\nFormat the output like this:\n\n{\n  \"youtubeTitle\": \"Superdog Begins this shortfilm make me cry\",\n  \"youtubeDescription\": \"Superdog Begins is a story that...\",\n  \"youtubeThumbnail\": \"Create an image of a realistic dog...\",\n  \"youtubeTags\": \"dogs, cats, pets, funny\",\n  \"fileName\": \"superDogBeg157\"\n}\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          1560,
          -100
        ],
        "id": "7ebde7c7-a8fb-42a8-bbb8-36fd8d8c1b07",
        "name": "Titles and Description"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          3380,
          120
        ],
        "id": "c84b99fc-f594-43e2-8b2b-231d24bd52d2",
        "name": "DeepSeek Chat Model10",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING  \nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority  \n\n# Task  \nYou are a professional text-to-image prompt engineer working for a YouTube channel. You will receive:  \n1 narrator sentence.  \n\nYour job is to convert that sentence into a single image prompt that looks like a moment from a handcrafted claymation-style documentary series called ‚ÄúWhy it sucked to be {{ $('Google Sheets4').item.json.idea }}‚Äù.  \n\nEach image must reflect emotional storytelling, symbolic irony, and expressive character design ‚Äî all rendered in a claymation. The figures and environments should clearly look like they are sculpted with modeling clay, showing fingerprints, rough edges, and soft imperfections that highlight the crafted feel.\n\n\nUse this structure for each prompt:  \nhandcrafted claymation style, \"[CharacterName] is a [age]-year-old [gender] made of colorful clay, with [facial features] (e.g., [hair color/style, eye shape, exaggerated or simple features]), wearing [clothing style] that reflects their [personality traits]. Their [physical mannerisms] (such as [posture or gesture]) express their emotional state. In this scene, they are [action/position] in a [environment] made of clay, with visible modeling textures, enhanced by [lighting, mood, colors].\"\n\nIf the sentence does not involve a character, describe the scene or symbolic element as a claymation diorama, focusing on sculpted textures, handcrafted elements, lighting, and story-driven emotion.\n\n#Narrator Sentence  \n{{ $json.sentence }}\n\n# Rules  \n- All characters and elements must look like they are sculpted with modeling clay  \n- No cinematic or photorealistic movie style ‚Äî use handcrafted claymation aesthetic only  \n- Do not number the prompts or use labels like Scene1 or VersionB  \n- Do not include any extra explanations or formatting  \n- Do not generate intimate imagery (e.g. kissing, suggestive poses)  \n- Output must be exactly 1 standalone prompt in paragraph form  \n\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          3380,
          -40
        ],
        "id": "80bf1efb-0955-4129-92cc-7181da39bef3",
        "name": "Image Prompt Agent7"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          3500,
          120
        ],
        "id": "c6a5d02d-a567-44d8-a101-d8947a4a4b30",
        "name": "Simple Memory7"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$input.first().json.output; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3700,
          -40
        ],
        "id": "db63f2b7-7c81-49f2-950e-f8c8735fd19c",
        "name": "Code"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          980,
          640
        ],
        "id": "f6720a83-0b90-4a21-ac2d-d878aaf48b45",
        "name": "Google Sheets",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "8c269fad-e72b-4471-a564-6041c1d41f41",
                "name": "binary",
                "value": "={{$json[\"audioContent\"]}}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2360,
          660
        ],
        "id": "f0851313-6457-46cf-9b91-f04065bfc9a7",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "operation": "toBinary",
          "sourceProperty": "binary",
          "options": {}
        },
        "type": "n8n-nodes-base.convertToFile",
        "typeVersion": 1.1,
        "position": [
          2500,
          660
        ],
        "id": "f10852e8-ff14-486d-894e-d5fa33f9f03a",
        "name": "Convert to File"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://texttospeech.googleapis.com/v1/text:synthesize",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googleOAuth2Api",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"input\": {\n    \"text\": \"{{ $json.cleanedText }}\"\n  },\n  \"voice\": {\n    \"languageCode\": \"en-US\",\n    \"name\": \"en-US-Chirp3-HD-Enceladus\"\n  },\n  \"audioConfig\": {\n    \"audioEncoding\": \"MP3\",\n    \"speakingRate\": 0.92,\n    \"pitch\": 0,\n    \"volumeGainDb\": 2.0\n  }\n}\n",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          2180,
          660
        ],
        "id": "666b594c-8f7e-4538-af02-d0f8b62d761c",
        "name": "HTTP Request2",
        "credentials": {
          "googleOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1500,
          580
        ],
        "id": "4ceef9ff-4c7f-4bf7-a606-2351985cfc5b",
        "name": "Loop Over Items1"
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".mp3\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/god/audios/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/god/audios/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1680,
          660
        ],
        "id": "f8bfd53e-ffab-4aec-9a41-518142ff1506",
        "name": "Code9"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code9').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3180,
          660
        ],
        "id": "5e7aef65-fed6-4ea7-b0f2-c81376369741",
        "name": "FTP3",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait1').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items1').item.json.row_number }}",
              "narratorLink": "={{ $('Code9').item.json.publicUrl }}",
              "narratorStatus": "done"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3360,
          640
        ],
        "id": "3472dfe6-e781-4d95-8780-e5df8a18db6e",
        "name": "Google Sheets5",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Narrator finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5000,
          620
        ],
        "id": "d832f188-384b-42a0-8c5b-de5c12a7d52d",
        "name": "Telegram21",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          3860,
          540
        ],
        "id": "46335b59-f7f7-458c-8311-08d1990dadd8",
        "name": "Limit2"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text = $('Loop Over Items1').first().json.narratorScript; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1900,
          660
        ],
        "id": "fdd47cb0-8159-4501-bfc6-599292e113fa",
        "name": "Code2"
      },
      {
        "parameters": {
          "operation": "write",
          "fileName": "/tmp/audio.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2660,
          660
        ],
        "id": "db080c10-7dba-4c9a-8a94-867ec1086564",
        "name": "Read/Write Files from Disk3"
      },
      {
        "parameters": {
          "command": "ffmpeg -i /tmp/audio.mp3 -af \"apad=pad_dur=1,adelay=200|200,apad=pad_dur=1\" -y /tmp/audio_padded.mp3"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2800,
          660
        ],
        "id": "180ddfcf-0d79-4649-aa96-44c283ae98aa",
        "name": "Execute Command14"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/audio_padded.mp3",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          2980,
          660
        ],
        "id": "39fa9e6b-d70c-4886-851a-3835c080a994",
        "name": "Read/Write Files from Disk4"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1020,
          1060
        ],
        "id": "6be116a7-9519-4618-9583-6a176d855f27",
        "name": "Google Sheets1",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code1').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 768,\n      \"height\": 432,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          2140,
          1240
        ],
        "id": "026aec67-cc09-4e03-b635-37cf94c97fa2",
        "name": "ComfyUI1",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          1500,
          1100
        ],
        "id": "36ec1648-a656-4c6b-9da9-f3788da49ebc",
        "name": "Loop Over Items"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code4').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          2280,
          1240
        ],
        "id": "cc60099b-bdeb-4dc8-8ac1-6954cb7aeb0e",
        "name": "FTP1",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/god/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/god/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1880,
          1240
        ],
        "id": "fc949bed-ca18-4952-84fb-d8d703e85612",
        "name": "Code4"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          4380,
          1080
        ],
        "id": "e502f358-d4d7-4d3a-a3c5-090feb4c3c86",
        "name": "Limit1"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "=Process Images finished ",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5180,
          1140
        ],
        "id": "b4177ac7-24e8-4553-98c3-a9371a0ed33c",
        "name": "Telegram14",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2020,
          1240
        ],
        "id": "9a0f929c-18f6-4893-b510-8014c0f9d88d",
        "name": "Code1"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items').item.json.row_number }}",
              "imageStatus": "done",
              "imageLink": "={{ $('Code4').item.json.publicUrl }}",
              "videoStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2440,
          1240
        ],
        "id": "b76e8934-6775-4fa6-82f2-855b3bac88f7",
        "name": "Google Sheets6",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + \"_prev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3100,
          1780
        ],
        "id": "7e7fd17a-ccc7-4c15-ba5b-74c341f461cf",
        "name": "Code28"
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener imageLink y narratorLink\n\nconst musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLink;\n  const audioUrl = item.json.narratorLink;\n\n  if (!imageUrl || !audioUrl) return;\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Obtener duraci√≥n del audio y generar video de fondo\n  downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); ` +\n                      `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=1280:720,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n\n  // Combinar imagen + audio (sin texto)\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n\n  // Agregar a la lista para concatenar\n  fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n});\n\n// Combinar todos los clips\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Descargar m√∫sica y mezclar con el video final\nconst musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n\n// Limpiar\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    yt_title: $input.first().json.YoutubeTitle,\n    yt_description: $input.first().json.YoutubeDescription,\n    yt_tags: $input.first().json.YoutubeTags,\n    yt_thumbnail: $input.first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1880,
          1700
        ],
        "id": "30da2af8-85a4-4ece-835b-0126da54989b",
        "name": "Code8"
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2060,
          1800
        ],
        "id": "5baa7e5a-635d-46c2-8c2e-9c86240dd40e",
        "name": "Execute Command7",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2200,
          1800
        ],
        "id": "f36a21fd-14c2-4dba-ad3b-2c4ef79f39ab",
        "name": "Execute Command8",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2380,
          1800
        ],
        "id": "9d2a3a60-6862-4b9a-8ef6-695eeb3e7a09",
        "name": "Execute Command9",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2540,
          1800
        ],
        "id": "70aa471d-5ac6-46b8-8b1e-7f2ae883b49b",
        "name": "Execute Command10",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2700,
          1800
        ],
        "id": "5eb0046d-1318-43b9-8ecb-b197db14830d",
        "name": "Execute Command11",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3360,
          1780
        ],
        "id": "fe2b51cf-d377-41f0-8cfe-416aa0f00364",
        "name": "Read/Write Files from Disk2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code28').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3600,
          1800
        ],
        "id": "71a010e6-80d8-4401-8467-24a9fcc26bc1",
        "name": "FTP7",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          4640,
          1880
        ],
        "id": "3736fcbc-4525-4b2c-9bf0-198b61070abc",
        "name": "Execute Command12"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait3').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1260,
          1800
        ],
        "id": "6d01940a-17d4-4e4e-bb26-fdda52825186",
        "name": "Google Sheets2",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
        "typeVersion": 1,
        "position": [
          900,
          -20
        ],
        "id": "f112be1f-72cb-479a-889f-9c3b498b9122",
        "name": "DeepSeek Chat Model",
        "credentials": {
          "deepSeekApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "DeepSeek account"
          }
        }
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED"
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          1060,
          20
        ],
        "id": "7fe63f2a-0c7e-4e52-9723-753ca64eb529",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=## WARNING\nThis is part of a n8n build so the most important is to follow the output format, that is your highest priority \n\n# Overview\nCreate a concept for a video titled ‚ÄúWhy it sucked to be {{ $('Google Sheets4').item.json.idea }}‚Äù. The tone should balance emotional storytelling with a touch of dark humor and irony, while remaining respectful, family-friendly, and legally safe when referencing fictional characters. Write a single engaging paragraph that feels like the dramatic intro of a documentary or character study, highlighting why this character‚Äôs life was unexpectedly difficult or unfair despite their fame, powers, or heroic status. Focus on emotional burdens, social pressure, identity struggles, misunderstood intentions, or ironic outcomes. Use vivid, imaginative language to evoke visuals and feelings without sounding too cinematic. Keep the story grounded, relatable, and with a hint of satire or social commentary. Avoid quoting or copying exact phrases or events from copyrighted material ‚Äî use generalized references instead. Do not break into bullet points ‚Äî return only one compelling paragraph.\n\n## IMPORTANT\n- The first sentence of the paragraph must be ‚ÄúWhy it sucked to be {{ $('Google Sheets4').item.json.idea }}‚Äù.\n- Do not provide a title only the general idea of the script \n- All output must be family friendly, no sensitive words should be used.\n- No references to weapons (even toy guns).\n- No reference of ‚Äúshowdowns\" or violent events.\n- No extra format on top or bottom nor explanations output in a ready to use text\n- the ouput must be in 1 paragraph\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 1.7,
        "position": [
          900,
          -180
        ],
        "id": "f29039b7-4a07-47f9-9267-c8856b395a57",
        "name": "Idea Prompt Agent1"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          3640,
          640
        ],
        "id": "3cf457d8-d453-4e9f-87c0-21c27d97097b",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "command": "={{ $('Code8').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2880,
          1800
        ],
        "id": "3e7e55d3-70d9-4245-9912-7d81c6624542",
        "name": "Execute Command"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Edit Fields5').first().json.fileName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4340,
          220
        ],
        "id": "76b67aea-2fda-4dfc-871e-12bcb599344f",
        "name": "Code3"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          680,
          640
        ],
        "id": "92a53687-c22e-4a92-8e95-1f48491289b7",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait1').first().json.documentName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4180,
          800
        ],
        "id": "e556bc4b-2f19-4f2e-bba9-6a23987ccb89",
        "name": "Code7"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          700,
          1120
        ],
        "id": "0f1eccb5-2a1c-4f80-906c-257dd4892f1d",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "const documentName = $('Wait2').first().json.documentName; \n\nreturn [\n  {\n    documentName \n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          4580,
          1360
        ],
        "id": "9de29916-2a18-4343-9778-bd124e58d4ca",
        "name": "Code5"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1220,
          460
        ],
        "id": "345b8692-33c5-4d41-8883-1162f17d1bbf",
        "name": "If3"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1240,
          1080
        ],
        "id": "3ddc7242-e7f9-46c7-80ff-cbfb741be613",
        "name": "If4"
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          720,
          1800
        ],
        "id": "096a5c9a-529b-4030-a1ce-b528ba42fd62",
        "name": "Wait3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1440,
          1800
        ],
        "id": "7a53290a-803d-4677-adf3-cea27ea0a9ef",
        "name": "If6"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code28').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3780,
          1780
        ],
        "id": "0545c0eb-aef8-472c-ac71-4f64252dfc68",
        "name": "Telegram15",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_title }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          4840,
          1880
        ],
        "id": "e8bc5620-21b2-4e83-80bb-3a3636416f92",
        "name": "Telegram16",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageVStatus",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          2700,
          1120
        ],
        "id": "38126ef2-cb6e-4439-9216-dcb2dd1a8985",
        "name": "Google Sheets3",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code13').item.json.cleanedText }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 432,\n      \"height\": 768,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          3460,
          1240
        ],
        "id": "7cbffa5a-36b3-4045-8d69-839f675ec635",
        "name": "ComfyUI",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3000,
          1140
        ],
        "id": "783ff62b-8149-47c2-9141-f80947b52114",
        "name": "Loop Over Items2"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code12').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3620,
          1240
        ],
        "id": "54255146-8316-4894-bd1d-3bad9a4fa4e0",
        "name": "FTP",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"V.jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/god/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/god/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3200,
          1240
        ],
        "id": "81c6ffd3-4c89-4eff-b711-f9d58bdf0703",
        "name": "Code12"
      },
      {
        "parameters": {
          "jsCode": "// Get the text input from the previous node\nconst text =$('Loop Over Items2').first().json.imagePrompt; // Assuming the text is passed as a variable named \"text\"\n\n// Regular expression to remove quotes and asterisks\nconst cleanedText = text.replace(/[\"'*]/g, ''); // The 'g' flag means global, it replaces all occurrences\n\n// Return the cleaned text\nreturn [{\n  json: {\n    originalText: text,\n    cleanedText: cleanedText,\n  },\n}];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3320,
          1240
        ],
        "id": "985f3e02-7d12-44eb-91e5-c46b4317d8c2",
        "name": "Code13"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait2').item.json.documentName }}",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $('Loop Over Items2').item.json.row_number }}",
              "imageVStatus": "done",
              "imageLinkV": "={{ $('Code12').item.json.publicUrl }}",
              "videoVStatus": "ready"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "imageStatus",
                "displayName": "imageStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageVStatus",
                "displayName": "imageVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoStatus",
                "displayName": "videoStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoVStatus",
                "displayName": "videoVStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "narratorStatus",
                "displayName": "narratorStatus",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imagePrompt",
                "displayName": "imagePrompt",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorScript",
                "displayName": "narratorScript",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLink",
                "displayName": "imageLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "imageLinkV",
                "displayName": "imageLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "videoLink",
                "displayName": "videoLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "videoLinkV",
                "displayName": "videoLinkV",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "narratorLink",
                "displayName": "narratorLink",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "storyIdea",
                "displayName": "storyIdea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "allCharsDescription",
                "displayName": "allCharsDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTitle",
                "displayName": "YoutubeTitle",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeDescription",
                "displayName": "YoutubeDescription",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeTags",
                "displayName": "YoutubeTags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "YoutubeThumbnail",
                "displayName": "YoutubeThumbnail",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          3840,
          1240
        ],
        "id": "ccb2e2c3-b44b-4e88-94a0-5627da9a8f7c",
        "name": "Google Sheets7",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          2880,
          1000
        ],
        "id": "6ba975bc-1b0b-4122-a7be-b661476bab72",
        "name": "If7"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          2440,
          1080
        ],
        "id": "d3ea6b49-8e98-43db-9f21-91a8a7f2325e",
        "name": "Limit"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_description }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5000,
          1880
        ],
        "id": "3247f937-c53e-4e08-81ac-c37fa46aed2f",
        "name": "Telegram19",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_thumbnail }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5140,
          1880
        ],
        "id": "cb4ae4cd-2f3c-407f-a2b8-a04084e1a6f9",
        "name": "Telegram20",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code8').item.json.yt_tags }}",
          "additionalFields": {
            "appendAttribution": false
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          5300,
          1880
        ],
        "id": "41bd6208-3f4a-42f1-8af6-66acafd24503",
        "name": "Telegram23",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename =  $('Wait3').first().json.documentName + \"_Vprev.mp4\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/videoCreator/render/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/videoCreator/render/${filename}`\n    }\n  }\n];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3080,
          2200
        ],
        "id": "b05b2c00-af95-4e93-811f-6ea8af91f561",
        "name": "Code29"
      },
      {
        "parameters": {
          "jsCode": "const rows = items; // Cada item debe tener imageLinkV y narratorLink\n\nconst musicUrl = \"https://lemonsushi.com/uploads/aatoMusic/music/movie.wav\";\n\nconst mkdirCommand = `mkdir -p /tmp/render;\\n`;\n\nlet downloadCommands = '';\nlet mergeCommands = '';\nlet fileListCommands = 'echo \"\" > /tmp/render/filelist.txt\\n';\n\nrows.forEach((item, index) => {\n  const imageUrl = item.json.imageLinkV;\n  const audioUrl = item.json.narratorLink;\n\n  // Validar que los elementos necesarios existen\n  if (!imageUrl || !audioUrl) return;\n\n  const rawImage = `/tmp/render/image${index}.jpg`;\n  const rawAudio = `/tmp/render/audio${index}.mp3`;\n  const rawVideo = `/tmp/render/video${index}.mp4`;\n  const merged = `/tmp/render/merged${index}.mp4`;\n\n  // Descargar imagen y audio\n  downloadCommands += `wget -q -O \"${rawImage}\" \"${imageUrl}\"; wget -q -O \"${rawAudio}\" \"${audioUrl}\";\\n`;\n\n  // Crear video con duraci√≥n del audio\n  downloadCommands += `duration=$(ffprobe -i \"${rawAudio}\" -show_entries format=duration -v quiet -of csv=\"p=0\"); ` +\n                      `ffmpeg -y -loop 1 -i \"${rawImage}\" -t $duration -vf \"scale=720:1280,fps=30\" -pix_fmt yuv420p \"${rawVideo}\";\\n`;\n\n  // Combinar imagen + audio (sin texto)\n  mergeCommands += `ffmpeg -y -i \"${rawVideo}\" -i \"${rawAudio}\" -c:v libx264 -c:a aac -shortest \"${merged}\" 2>&1;\\n`;\n\n  // Agregar a lista de archivos para concatenar\n  fileListCommands += `if [ -f \"${merged}\" ]; then echo \"file '${merged}'\" >> /tmp/render/filelist.txt; fi\\n`;\n});\n\n// Combinar todos los clips\nconst combineCommand = `ffmpeg -y -f concat -safe 0 -i /tmp/render/filelist.txt -c:v libx264 -c:a aac -b:a 192k /tmp/render/combo.mp4`;\n\n// Descargar m√∫sica y mezclar con el video final\nconst musicCommand = `wget -q -O /tmp/render/music.wav \"${musicUrl}\"; ffmpeg -y -i /tmp/render/combo.mp4 -i /tmp/render/music.wav -filter_complex \"[0:a]volume=3.8[a0];[1:a]volume=0.5[a1];[a0][a1]amix=inputs=2:duration=shortest[aout]\" -map 0:v -map \"[aout]\" -c:v copy -c:a aac -shortest /tmp/render/final_with_music.mp4`;\n\n// Borrar archivos temporales\nconst cleanupCommand = `rm -rf /tmp/render`;\n\nreturn {\n  json: {\n    mkdirCommand,\n    downloadCommands: downloadCommands.trim(),\n    mergeCommands: mergeCommands.trim(),\n    fileListCommands: fileListCommands.trim(),\n    combineCommand,\n    musicCommand: musicCommand.trim(),\n    cleanupCommand,\n    yt_title: $input.first().json.YoutubeTitle,\n    yt_description: $input.first().json.YoutubeDescription,\n    yt_tags: $input.first().json.YoutubeTags,\n    yt_thumbnail: $input.first().json.YoutubeThumbnail\n  }\n};\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1860,
          2240
        ],
        "id": "a68598e7-0599-482c-a838-441aff3ea7f6",
        "name": "Code19"
      },
      {
        "parameters": {
          "command": "={{ $json.mkdirCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2080,
          2200
        ],
        "id": "3e02f55b-b27d-4748-9bf6-e663348a1bdd",
        "name": "Execute Command13",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.downloadCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2240,
          2200
        ],
        "id": "4c1d250a-465b-494d-8354-460d8a944192",
        "name": "Execute Command15",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.mergeCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2400,
          2200
        ],
        "id": "d396a493-12af-4945-a2fe-ef45f4a2229a",
        "name": "Execute Command16",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.fileListCommands }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2560,
          2200
        ],
        "id": "ee566aa0-2c6b-4608-9ab7-2c12d7c3d2ed",
        "name": "Execute Command17",
        "retryOnFail": true
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.combineCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2720,
          2200
        ],
        "id": "90bdfb50-3c7d-4f3c-ab32-1f0e6e23121b",
        "name": "Execute Command18",
        "retryOnFail": true
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3340,
          2200
        ],
        "id": "a162eaf3-f943-4765-89e1-987b2aaa281e",
        "name": "Read/Write Files from Disk5"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code29').first().json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          3620,
          2200
        ],
        "id": "a8081d7f-07b7-4491-985b-7a8b8585b4ba",
        "name": "FTP8",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.cleanupCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          4380,
          2200
        ],
        "id": "eb528044-0918-4994-9711-084438bf7daa",
        "name": "Execute Command19"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "={{ $('Wait3').item.json.documentName }}",
            "mode": "name"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "imageVStatus",
                "lookupValue": "done"
              },
              {
                "lookupColumn": "narratorStatus",
                "lookupValue": "done"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          1240,
          2220
        ],
        "id": "cbe961e0-a00f-469d-b81b-687111bcd46b",
        "name": "Google Sheets11",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "command": "={{ $('Code19').item.json.musicCommand }}"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          2900,
          2200
        ],
        "id": "3b596017-6c7e-40b0-891a-d4e6a5b5e96f",
        "name": "Execute Command1"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d392eeb6-5079-43f3-9f69-8e72b13f8f90",
                "leftValue": "={{ $json.row_number }}",
                "rightValue": "",
                "operator": {
                  "type": "number",
                  "operation": "exists",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1540,
          2340
        ],
        "id": "b406b35f-3480-4095-bd7c-712508d231ef",
        "name": "If10"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code29').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          3780,
          2200
        ],
        "id": "7df5f5c2-21af-4d15-bf58-a1aa7333f8e2",
        "name": "Telegram17",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "resource": "video",
          "operation": "upload",
          "title": "={{ $('Code19').item.json.yt_title }}",
          "regionCode": "JP",
          "categoryId": "27",
          "options": {
            "defaultLanguage": "en",
            "description": "={{ $('Code19').item.json.yt_description }}",
            "license": "youtube",
            "notifySubscribers": true,
            "privacyStatus": "private"
          }
        },
        "type": "n8n-nodes-base.youTube",
        "typeVersion": 1,
        "position": [
          4180,
          2200
        ],
        "id": "da88cd27-76ea-4ec9-8bde-10ac6799a221",
        "name": "YouTube",
        "disabled": true
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 4
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -240,
          -200
        ],
        "id": "baa61eb1-a37a-4425-9fc4-40508753c5e5",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {
                "triggerAtHour": 12
              }
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.2,
        "position": [
          -240,
          -20
        ],
        "id": "96ee0008-8a57-4794-b557-2b2ebdaffdf2",
        "name": "Schedule Trigger1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          -300,
          1620
        ],
        "id": "136e5dd9-0199-4ba9-be10-8d85a1f2b81b",
        "name": "When clicking ‚ÄòTest workflow‚Äô"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "dce2d9ce-0dad-4ee3-9071-3b7e22f081a5",
                "name": "documentName",
                "value": "potterblu427",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -40,
          1620
        ],
        "id": "873ca27e-54a0-46a3-ba65-b88d9db547ce",
        "name": "Edit Fields1"
      },
      {
        "parameters": {
          "fileSelector": "/tmp/render/final_with_music.mp4",
          "options": {}
        },
        "type": "n8n-nodes-base.readWriteFile",
        "typeVersion": 1,
        "position": [
          3980,
          2200
        ],
        "id": "7fc22323-9e95-44e1-995b-b3804bfc458c",
        "name": "Read/Write Files from Disk6"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "status",
                "lookupValue": "ready"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          180,
          -200
        ],
        "id": "5736a847-aa8d-46d6-ac0c-1cac82ca47f5",
        "name": "Google Sheets4",
        "alwaysOutputData": true,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "amount": 0.01
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          0,
          -200
        ],
        "id": "50b72367-0f6c-416e-a92b-a6627673b364",
        "name": "Wait4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.limit",
        "typeVersion": 1,
        "position": [
          360,
          -200
        ],
        "id": "eacdcdf0-4106-44b4-9a25-650944126b46",
        "name": "Limit3"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk",
            "mode": "list",
            "cachedResultName": "YT_auto_Why",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1_7p5V0YM7pGGXBj3N-PXdHLrHS8s4PX_H152WcYyJRk/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "status": "done",
              "row_number": "={{ $('Google Sheets4').item.json.row_number }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "idea",
                "displayName": "idea",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "status",
                "displayName": "status",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.5,
        "position": [
          580,
          -200
        ],
        "id": "e5429622-9cb9-4438-b451-afb8a13725f6",
        "name": "Google Sheets8",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "workflow": "={\n  \"6\": {\n    \"inputs\": {\n      \"text\":\"{{ $('Code8').item.json.yt_thumbnail }}\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Positive Prompt)\"\n    }\n  },\n  \"8\": {\n    \"inputs\": {\n      \"samples\": [\n        \"31\",\n        0\n      ],\n      \"vae\": [\n        \"30\",\n        2\n      ]\n    },\n    \"class_type\": \"VAEDecode\",\n    \"_meta\": {\n      \"title\": \"VAE Decode\"\n    }\n  },\n  \"9\": {\n    \"inputs\": {\n      \"filename_prefix\": \"ComfyUI\",\n      \"images\": [\n        \"8\",\n        0\n      ]\n    },\n    \"class_type\": \"SaveImage\",\n    \"_meta\": {\n      \"title\": \"Save Image\"\n    }\n  },\n  \"27\": {\n    \"inputs\": {\n      \"width\": 768,\n      \"height\": 432,\n      \"batch_size\": 1\n    },\n    \"class_type\": \"EmptySD3LatentImage\",\n    \"_meta\": {\n      \"title\": \"EmptySD3LatentImage\"\n    }\n  },\n  \"30\": {\n    \"inputs\": {\n      \"ckpt_name\": \"FLUX1\\\\flux1-dev-fp8.safetensors\"\n    },\n    \"class_type\": \"CheckpointLoaderSimple\",\n    \"_meta\": {\n      \"title\": \"Load Checkpoint\"\n    }\n  },\n  \"31\": {\n    \"inputs\": {\n      \"seed\": 972054013131368,\n      \"steps\": 20,\n      \"cfg\": 1,\n      \"sampler_name\": \"euler\",\n      \"scheduler\": \"simple\",\n      \"denoise\": 1,\n      \"model\": [\n        \"30\",\n        0\n      ],\n      \"positive\": [\n        \"35\",\n        0\n      ],\n      \"negative\": [\n        \"33\",\n        0\n      ],\n      \"latent_image\": [\n        \"27\",\n        0\n      ]\n    },\n    \"class_type\": \"KSampler\",\n    \"_meta\": {\n      \"title\": \"KSampler\"\n    }\n  },\n  \"33\": {\n    \"inputs\": {\n      \"text\": \"\",\n      \"clip\": [\n        \"30\",\n        1\n      ]\n    },\n    \"class_type\": \"CLIPTextEncode\",\n    \"_meta\": {\n      \"title\": \"CLIP Text Encode (Negative Prompt)\"\n    }\n  },\n  \"35\": {\n    \"inputs\": {\n      \"guidance\": 3.5,\n      \"conditioning\": [\n        \"6\",\n        0\n      ]\n    },\n    \"class_type\": \"FluxGuidance\",\n    \"_meta\": {\n      \"title\": \"FluxGuidance\"\n    }\n  }\n}",
          "jpegQuality": 100
        },
        "type": "n8n-nodes-comfyui.comfyui",
        "typeVersion": 1,
        "position": [
          5660,
          1860
        ],
        "id": "902cfc5f-dcff-4a26-9601-e61d4044fa39",
        "name": "ComfyUI2",
        "credentials": {
          "comfyUIApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "ComfyUI account"
          }
        }
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code6').item.json.filepath }}"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          5840,
          1860
        ],
        "id": "f9b6ef21-14d4-4bd0-a4aa-1adfe7e0f78d",
        "name": "FTP2",
        "retryOnFail": true,
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \"ThumbNail.jpg\";\n\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/god/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/god/images/${filename}`\n    }\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          5500,
          1860
        ],
        "id": "0ac7bed0-2643-4ada-a370-f1051c67dab0",
        "name": "Code6"
      },
      {
        "parameters": {
          "chatId": "=6407630145",
          "text": "={{ $('Code6').item.json.publicUrl }}",
          "additionalFields": {
            "appendAttribution": false,
            "parse_mode": "HTML"
          }
        },
        "type": "n8n-nodes-base.telegram",
        "typeVersion": 1.2,
        "position": [
          6040,
          1860
        ],
        "id": "8c602289-3f51-490a-98e3-ffb9103eaf9b",
        "name": "Telegram",
        "webhookId": "WEBHOOKID_REMOVED",
        "credentials": {
          "telegramApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Full Auto Puma"
          }
        }
      },
      {
        "parameters": {
          "command": "#!/bin/bash\n\n# Borrar archivos en /tmp m√°s viejos de 1 d√≠a\nfind /tmp -type f -mtime +1 -exec rm -f {} \\; 2>/dev/null\nfind /tmp -type d -empty -mtime +1 -exec rmdir {} \\; 2>/dev/null\n\n# Limpiar cach√© de apt (solo si es un sistema basado en Debian/Ubuntu)\nif command -v apt-get &> /dev/null; then\n  apt-get clean\n  apt-get autoclean\nfi\n\n# Borrar archivos de log rotados (sin tocar logs actuales)\nfind /var/log -type f -name \"*.gz\" -mtime +7 -exec rm -f {} \\; 2>/dev/null\nfind /var/log -type f -name \"*.1\" -mtime +7 -exec rm -f {} \\; 2>/dev/null\n\n# Limpiar cach√© de thumbnails (si existe)\nrm -rf ~/.cache/thumbnails/* 2>/dev/null\n\n# Mostrar cu√°nto espacio libre hay despu√©s\necho \"Espacio libre en disco despu√©s de limpiar:\"\ndf -h /\n\nexit 0\n"
        },
        "type": "n8n-nodes-base.executeCommand",
        "typeVersion": 1,
        "position": [
          1280,
          3060
        ],
        "id": "74c58cbe-6376-4873-9a79-2d259ad1780b",
        "name": "Execute Command20"
      },
      {
        "parameters": {
          "content": "## Cleanup",
          "height": 260,
          "width": 360
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          1160,
          2980
        ],
        "id": "18d569f6-d765-4e88-a1b4-09fd18495c66",
        "name": "Sticky Note"
      }
    ],
    "connections": {
      "Code32": {
        "main": [
          [
            {
              "node": "Titles and Description",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets14": {
        "main": [
          [
            {
              "node": "Code30",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code30": {
        "main": [
          [
            {
              "node": "Add header",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Add header": {
        "main": [
          [
            {
              "node": "Narrator Script1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "Narrator Script1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Code33": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items5": {
        "main": [
          [
            {
              "node": "Limit5",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Image Prompt Agent7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets16": {
        "main": [
          [
            {
              "node": "Loop Over Items5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram31": {
        "main": [
          [
            {
              "node": "Code3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit5": {
        "main": [
          [
            {
              "node": "Telegram31",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Narrator Script1": {
        "main": [
          [
            {
              "node": "Code33",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model8": {
        "ai_languageModel": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory5": {
        "ai_memory": [
          [
            {
              "node": "Titles and Description",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Titles and Description": {
        "main": [
          [
            {
              "node": "Edit Fields5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields5": {
        "main": [
          [
            {
              "node": "Google Sheets14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model10": {
        "ai_languageModel": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory7": {
        "ai_memory": [
          [
            {
              "node": "Image Prompt Agent7",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Image Prompt Agent7": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Google Sheets16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Convert to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert to File": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items1": {
        "main": [
          [
            {
              "node": "Limit2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP3": {
        "main": [
          [
            {
              "node": "Google Sheets5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets5": {
        "main": [
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit2": {
        "main": [
          [
            {
              "node": "Telegram21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk3": {
        "main": [
          [
            {
              "node": "Execute Command14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command14": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk4": {
        "main": [
          [
            {
              "node": "FTP3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets": {
        "main": [
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI1": {
        "main": [
          [
            {
              "node": "FTP1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items": {
        "main": [
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP1": {
        "main": [
          [
            {
              "node": "Google Sheets6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code4": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit1": {
        "main": [
          [
            {
              "node": "Telegram14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets1": {
        "main": [
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "ComfyUI1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets6": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram21": {
        "main": [
          [
            {
              "node": "Code7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram14": {
        "main": [
          [
            {
              "node": "Code5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code28": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code8": {
        "main": [
          [
            {
              "node": "Execute Command7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command7": {
        "main": [
          [
            {
              "node": "Execute Command8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command8": {
        "main": [
          [
            {
              "node": "Execute Command9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command9": {
        "main": [
          [
            {
              "node": "Execute Command10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command10": {
        "main": [
          [
            {
              "node": "Execute Command11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command11": {
        "main": [
          [
            {
              "node": "Execute Command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk2": {
        "main": [
          [
            {
              "node": "FTP7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP7": {
        "main": [
          [
            {
              "node": "Telegram15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets2": {
        "main": [
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "DeepSeek Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command": {
        "main": [
          [
            {
              "node": "Code28",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Idea Prompt Agent1": {
        "main": [
          [
            {
              "node": "Code32",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code3": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code7": {
        "main": [
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "Google Sheets1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code5": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Loop Over Items1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Loop Over Items",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait3": {
        "main": [
          [
            {
              "node": "Google Sheets2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Code8",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram15": {
        "main": [
          [
            {
              "node": "Execute Command12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command12": {
        "main": [
          [
            {
              "node": "Telegram16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets3": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI": {
        "main": [
          [
            {
              "node": "FTP",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over Items2": {
        "main": [
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Code12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP": {
        "main": [
          [
            {
              "node": "Google Sheets7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code12": {
        "main": [
          [
            {
              "node": "Code13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code13": {
        "main": [
          [
            {
              "node": "ComfyUI",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Loop Over Items2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Limit1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit": {
        "main": [
          [
            {
              "node": "Google Sheets3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram16": {
        "main": [
          [
            {
              "node": "Telegram19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram19": {
        "main": [
          [
            {
              "node": "Telegram20",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram20": {
        "main": [
          [
            {
              "node": "Telegram23",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code29": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code19": {
        "main": [
          [
            {
              "node": "Execute Command13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command13": {
        "main": [
          [
            {
              "node": "Execute Command15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command15": {
        "main": [
          [
            {
              "node": "Execute Command16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command16": {
        "main": [
          [
            {
              "node": "Execute Command17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command17": {
        "main": [
          [
            {
              "node": "Execute Command18",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command18": {
        "main": [
          [
            {
              "node": "Execute Command1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk5": {
        "main": [
          [
            {
              "node": "FTP8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP8": {
        "main": [
          [
            {
              "node": "Telegram17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command19": {
        "main": [
          []
        ]
      },
      "Google Sheets11": {
        "main": [
          [
            {
              "node": "If10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Execute Command1": {
        "main": [
          [
            {
              "node": "Code29",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If10": {
        "main": [
          [
            {
              "node": "Code19",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "Telegram17": {
        "main": [
          [
            {
              "node": "Read/Write Files from Disk6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger1": {
        "main": [
          []
        ]
      },
      "When clicking ‚ÄòTest workflow‚Äô": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Read/Write Files from Disk6": {
        "main": [
          [
            {
              "node": "YouTube",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "YouTube": {
        "main": [
          [
            {
              "node": "Execute Command19",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait4": {
        "main": [
          [
            {
              "node": "Google Sheets4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets4": {
        "main": [
          [
            {
              "node": "Limit3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Limit3": {
        "main": [
          [
            {
              "node": "Google Sheets8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets8": {
        "main": [
          [
            {
              "node": "Idea Prompt Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ComfyUI2": {
        "main": [
          [
            {
              "node": "FTP2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code6": {
        "main": [
          [
            {
              "node": "ComfyUI2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Telegram23": {
        "main": [
          [
            {
              "node": "Code6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP2": {
        "main": [
          [
            {
              "node": "Telegram",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": {
      "node:Schedule Trigger": {
        "recurrenceRules": []
      },
      "node:Schedule Trigger1": {
        "recurrenceRules": []
      }
    },
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "78d25d25-c5f3-4e21-b421-d5d735302f33",
    "activeVersionId": null,
    "triggerCount": 2,
    "shared": [
      {
        "updatedAt": "2025-05-20T13:32:05.775Z",
        "createdAt": "2025-05-20T13:32:05.775Z",
        "role": "workflow:owner",
        "workflowId": "ulwDUlIGVeRUmReM",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": null,
    "tags": []
  },
  {
    "updatedAt": "2025-11-19T13:18:33.000Z",
    "createdAt": "2025-11-07T02:08:56.220Z",
    "id": "vqNteL2eYv09zj95",
    "name": "aiVidWebhook",
    "active": true,
    "isArchived": false,
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "scriptIdea",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          0,
          0
        ],
        "id": "68e3ab01-7084-443f-8f78-f1a49c9657fc",
        "name": "Webhook",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=\n\nYour task is to generate the story for a video with the central theme:\n{{ $json.body.videoIdea }}\n\n{{ $json.body.promptTemplate }}",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          288,
          0
        ],
        "id": "5b1c9ee1-0e45-4aef-b569-7daca05ec34f",
        "name": "AI Agent"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          352,
          160
        ],
        "id": "acf73bfa-e7ff-4990-bd89-e4629843af40",
        "name": "Simple Memory"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          64,
          208
        ],
        "id": "d7567545-0c9a-43dd-bc83-c02dc8faad55",
        "name": "Google Gemini Chat Model",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          896,
          32
        ],
        "id": "4e9fd6e6-a9aa-4930-9c3e-4ec4ffcbde93",
        "name": "Respond to Webhook"
      },
      {
        "parameters": {
          "jsCode": "// Obtiene la salida del nodo Gemini (la cadena de texto con el JSON)\nconst jsonString = $input.first().json.output; \n\n// 1. Limpia los marcadores de bloque de c√≥digo (si los hay)\nconst cleanedString = jsonString\n    .replace('```json\\n', '')\n    .replace('\\n```', '')\n    .trim();\n\n// 2. Parsea la cadena limpia en un objeto JSON real\nconst jsonObject = JSON.parse(cleanedString);\n\n// 3. Devuelve el objeto JSON para que el workflow lo use\nreturn [{ json: jsonObject }];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          656,
          16
        ],
        "id": "bb1ed4c7-42ad-408e-9990-6e581a1e9660",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "artdirection",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -16,
          416
        ],
        "id": "baaa5f2d-2ad9-4712-ba9a-9d9734901611",
        "name": "Webhook1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "={{ $json.body.artDirectionPromptTemplate }}\n{{ $json.body.script }}\nextra information:\n{{ $json.body.artDirectionIdea }}\nimage reference:\n{{ $json.body.image }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          240,
          416
        ],
        "id": "42fd472e-b74e-4dc1-986c-8d40e5135f1f",
        "name": "AI Agent1"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          336,
          576
        ],
        "id": "43f6ff89-7c4c-4719-a821-75f4ca691b4e",
        "name": "Simple Memory1"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          0,
          608
        ],
        "id": "1ae9dad9-8639-4936-8fdc-707c8d17af80",
        "name": "Google Gemini Chat Model1",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          576,
          416
        ],
        "id": "b8c70dcb-6fe4-4d6a-b18a-e05b5b6c802c",
        "name": "Respond to Webhook1"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "imageGen",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          2560,
          896
        ],
        "id": "4fb23850-3f2b-4653-b9ce-66c0af44a424",
        "name": "Webhook2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=You are an expert prompt engineer for cinematic AI image generation. Your task is to combine provided information into a single, highly detailed, and cinematic image prompt.\n\nI will provide you with:\n1.  **ACTION SHOT:** A single sentence describing a specific action and its location (Home, Commute, or Maid Cafe).\n2.  **CHARACTER DESCRIPTION:** A detailed, hyperrealistic description of the main anthropomorphic pomeranian character.\n3.  **HOME LOCATION DESCRIPTION:** A detailed description of the pomeranian's modern, urban home.\n4.  **OUTFIT DESCRIPTION:** A detailed description of the full Maid Cafe server uniform.\n5.  **ADVENTURE LOCATION DESCRIPTION:** A detailed description of the Maid Cafe setting.\n6.  **PAJAMA/CASUAL DESCRIPTION (NEW):** A detailed description of the pomeranian's casual wear or pajamas (e.g., comfortable cotton pajamas, simple hoodie and jeans).\n\nYour output must be ONLY the final, single-line, highly detailed and cinematic image prompt. Do not include any additional text, titles, or numbering.\n\n**LOGIC RULE:**\n* If the **ACTION SHOT** takes place in the **HOME** (Bedroom, Bathroom, Kitchen, Living Room) AND is **NOT** the shot where the outfit is being put on (Shot 7), you MUST use the **PAJAMA/CASUAL DESCRIPTION**.\n* If the **ACTION SHOT** takes place on the **COMMUTE** or in the **MAID CAFE**, or IF the shot is **Shot 7 (putting on uniform)**, you MUST use the **OUTFIT DESCRIPTION**.\n* Only use the relevant LOCATION (HOME or ADVENTURE) in the final prompt.\n\nFocus on:\n-   Integrating all relevant details from the provided descriptions.\n-   Adding cinematic elements (soft volumetric lighting, low angle, anamorphic lens, film grain).\n-   Specifying high quality (e.g., \"ultra-realistic,\" \"photorealistic,\" \"Candid photo\").\n-   Ensuring the pomeranian is the clear focal point of the action.\n\nExample Structure:\n[ACTION_SHOT_DETAIL], [CHARACTER_DESCRIPTION_INTEGRATED_INTO_ACTION], [OUTFIT/PAJAMA_DETAIL_APPLIED], [RELEVANT_LOCATION_DETAIL_INTEGRATED_INTO_SCENE], cinematic composition, shallow depth of field, [CINEMATIC_ELEMENTS: lighting, camera angle, mood], ultra-realistic, photorealistic, high detail, masterpiece.\n\n**ACTION SHOT** MOST IMPORTANT\n{{ $json.body.script }}\n\n**Extra details**\n{{ $json.body.artDirection }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          2784,
          896
        ],
        "id": "70db3feb-ac5e-4b31-8c0b-acc7e4696d6b",
        "name": "AI Agent2"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          2896,
          1072
        ],
        "id": "09cf79c2-cbc8-4030-9872-97058102aa55",
        "name": "Simple Memory2"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-lite",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          2784,
          1056
        ],
        "id": "ed49985c-fe21-4e0c-b77e-1bba6e9b074b",
        "name": "Google Gemini Chat Model2",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          4416,
          896
        ],
        "id": "6b37fcf6-4ce4-4121-8145-da083d9f9d1d",
        "name": "Respond to Webhook2"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"google/nano-banana-edit\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_urls\": [\n      \"{{ $('Webhook2').item.json.body.image }}\"\n    ],\n    \"output_format\": \"png\",\n    \"image_size\": \"16:9\"\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3280,
          896
        ],
        "id": "4b9eb38e-57e6-4354-9909-c337b20c119a",
        "name": "HTTP Request2"
      },
      {
        "parameters": {
          "amount": 10
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          3472,
          848
        ],
        "id": "37b4941c-bd14-44d0-a5d1-31a2e540262c",
        "name": "Wait1",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3648,
          832
        ],
        "id": "6bf3dd63-ec10-445f-9931-35551dabfea6",
        "name": "HTTP Request3"
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // 1. Verificar y remover las comillas dobles iniciales y finales\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  // 2. Remover todos los saltos de l√≠nea (\\n) y retornos de carro (\\r)\n  // Utilizamos una expresi√≥n regular global (/g) para asegurarnos de que se eliminen todos.\n  if (typeof outputText === \"string\") {\n    outputText = outputText.replace(/[\\n\\r]/g, \"\"); \n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          3120,
          896
        ],
        "id": "5b2d09da-f7ac-4366-90dc-3770633c75b6",
        "name": "Code9"
      },
      {
        "parameters": {
          "content": "## Generate the Script",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -448,
          16
        ],
        "id": "5eaecbf3-1c14-4c2a-8a83-45b123fb8bb1",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "content": "## Generate the Art Direction",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -432,
          432
        ],
        "id": "44daf38a-44f0-4b8e-ad14-ada59f7bcb7b",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "content": "## Image Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          2160,
          912
        ],
        "id": "196c6b0b-53d3-4d46-b038-8ef0a90b1531",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3824,
          800
        ],
        "id": "edc67a35-c304-40d8-a58e-eff3023650a1",
        "name": "If"
      },
      {
        "parameters": {
          "amount": 20
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          3472,
          1040
        ],
        "id": "d397a895-4ecb-438e-82bd-94ff2b54d842",
        "name": "Wait",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request2').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3632,
          1040
        ],
        "id": "59289d8d-ced2-4ef6-93ce-8cf5a7119ca0",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          3824,
          1040
        ],
        "id": "3b038b19-b992-43cc-bb51-7f75ee4de2b2",
        "name": "If1"
      },
      {
        "parameters": {
          "amount": 30
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          3488,
          1232
        ],
        "id": "e997a359-4c3d-4fd4-8c31-e479dc99c67d",
        "name": "Wait2",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request2').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          3840,
          1248
        ],
        "id": "ceee9331-47d6-4aef-947f-25b0cba2a715",
        "name": "HTTP Request1"
      },
      {
        "parameters": {
          "content": "## Prompt Image Generation\n",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -384,
          800
        ],
        "id": "10e1f8c3-c72b-43e8-b0e0-ea74f11027c0",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "promptImageGen",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          32,
          768
        ],
        "id": "f42bba1f-5e10-4599-b925-8f6259907d28",
        "name": "Webhook3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=[Instructions]\n{{ $json.body.promptTemplate }}\n\n[Shot information][THIS IS THE MOST IMPORTANT]\n{{ $json.body.script }}\n\n[Art Direction]\n{{ $json.body.artDirection }}\n\n[Image Reference]\n{{ $json.body.image }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          288,
          768
        ],
        "id": "062550ac-b983-46e2-89c2-e2cea31da4ca",
        "name": "AI Agent3"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          384,
          928
        ],
        "id": "3bc75d56-ecf7-4694-b5a5-abb484e1ab31",
        "name": "Simple Memory3"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          96,
          992
        ],
        "id": "68a940f1-9ec2-47ce-9dce-ce9ef1273e2e",
        "name": "Google Gemini Chat Model3",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          624,
          768
        ],
        "id": "e9a76bf6-dafb-40aa-8d34-06d191a86498",
        "name": "Respond to Webhook3"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "ImageGenFromPrompt",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -128,
          1184
        ],
        "id": "4b048932-8db1-4b2b-aa25-69a33b61321a",
        "name": "Webhook4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          1440,
          1136
        ],
        "id": "3e268b46-fe5b-4364-a59a-a2ec7655cc9b",
        "name": "Respond to Webhook4"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"google/nano-banana-edit\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_urls\": [\n      \"{{ $('Webhook4').item.json.body.image }}\"\n    ],\n    \"output_format\": \"png\",\n    \"image_size\": \"16:9\"\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          272,
          1168
        ],
        "id": "58c1c407-3dc7-452e-a201-85913a03ba67",
        "name": "HTTP Request4"
      },
      {
        "parameters": {
          "amount": 10
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          752,
          992
        ],
        "id": "949fc6ee-69ec-4ac7-8736-8ee80858b590",
        "name": "Wait3",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          928,
          976
        ],
        "id": "3aaf0ab4-aeeb-44df-8d63-c15f85063ba2",
        "name": "HTTP Request5"
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          32,
          1184
        ],
        "id": "3a4f4fe7-f010-43ca-a106-1db5718d3dd4",
        "name": "Code"
      },
      {
        "parameters": {
          "content": "## Image Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -528,
          1200
        ],
        "id": "ec91b90f-c68f-4cfb-851e-d125f9d29833",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1104,
          944
        ],
        "id": "fcab4f57-8c31-4dd0-9aea-8d2c2785c19c",
        "name": "If2"
      },
      {
        "parameters": {
          "amount": 20
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          752,
          1184
        ],
        "id": "62f281d7-dd2e-4378-ac1f-f8162c3dbee1",
        "name": "Wait4",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          912,
          1184
        ],
        "id": "d882254c-fa31-4707-98ab-b48f31ce487d",
        "name": "HTTP Request6"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1104,
          1184
        ],
        "id": "c1d5bbac-7d74-4ab6-9495-a11247d46ce1",
        "name": "If3"
      },
      {
        "parameters": {
          "amount": 30
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          768,
          1616
        ],
        "id": "814f1af5-c499-475a-ae9b-b2a3b617ff1f",
        "name": "Wait5",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          1120,
          1632
        ],
        "id": "5abec5ea-aaa8-4d8a-afd3-6de975a94055",
        "name": "HTTP Request7"
      },
      {
        "parameters": {
          "content": "## Prompt Video Generation\n",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -288,
          1840
        ],
        "id": "f3185982-a487-44da-95a9-f85d1ded1918",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "prompVideoGen",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          128,
          1808
        ],
        "id": "c568139d-eab0-404e-9432-eb588cceba1c",
        "name": "Webhook5",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=[Instructions]\n{{ $json.body.promptTemplate }}\n\n[Shot information][THIS IS THE MOST IMPORTANT]\n{{ $json.body.shotDescription }}\n\n[Image Reference]\n{{ $json.body.thumbnail }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          384,
          1808
        ],
        "id": "ce6301fa-360f-482f-bcbc-da791757bf25",
        "name": "AI Agent4"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          480,
          1968
        ],
        "id": "85959950-9040-4bc1-9a2b-4e23c3ae2c4d",
        "name": "Simple Memory4"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          240,
          2032
        ],
        "id": "b043fce2-743f-47c0-be21-b0a35d4aa396",
        "name": "Google Gemini Chat Model4",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          720,
          1808
        ],
        "id": "b287c10e-c3f5-42a5-a90e-2360aebab370",
        "name": "Respond to Webhook5"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "VideoGenFromPrompt",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -32,
          2288
        ],
        "id": "dbfc1d3a-85d4-4bc4-823d-3c274768195a",
        "name": "Webhook6",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          1328,
          2384
        ],
        "id": "41d4bf85-3316-4975-8f32-23094828d24d",
        "name": "Respond to Webhook6"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.kie.ai/api/v1/jobs/createTask",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"bytedance/v1-lite-image-to-video\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_url\": \"{{ $json.body.thumbnail }}\",\n    \"resolution\": \"480p\",\n    \"duration\": \"5\",\n    \"camera_fixed\": true,\n    \"seed\": -1,\n    \"enable_safety_checker\": true\n  }\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          384,
          2256
        ],
        "id": "efc73cb4-1986-4aeb-982e-d81dfa9b7dfc",
        "name": "HTTP Request8"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          640,
          2240
        ],
        "id": "c2b5c71c-e2c9-4c2f-a687-ec6367344721",
        "name": "Wait6",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          816,
          2224
        ],
        "id": "82147c68-4f6c-4835-a28c-c941219adf01",
        "name": "HTTP Request9"
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          128,
          2288
        ],
        "id": "6b1a4e5c-c8d3-49c2-8d13-e2c068ebeb33",
        "name": "Code1"
      },
      {
        "parameters": {
          "content": "## Video Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -432,
          2304
        ],
        "id": "8ee0380e-5f11-4a73-81ee-5df833d7425e",
        "name": "Sticky Note6"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          992,
          2192
        ],
        "id": "f50601de-a659-4b68-9b26-28a8696152ea",
        "name": "If4"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          640,
          2784
        ],
        "id": "1984b6b7-6319-4aa4-8a45-4588a948e3f3",
        "name": "Wait7",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          800,
          2784
        ],
        "id": "0d21571e-965e-41cc-b225-c7195f7d549f",
        "name": "HTTP Request10"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          992,
          2784
        ],
        "id": "6986f519-4f40-4147-b4f2-48fda41c3bab",
        "name": "If5"
      },
      {
        "parameters": {
          "amount": 200
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          656,
          2976
        ],
        "id": "c3e8cf4d-d432-4ecf-80b3-9683d6373a8f",
        "name": "Wait8",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          1008,
          2992
        ],
        "id": "b2461e4c-83ce-445e-8e26-fe391c51573d",
        "name": "HTTP Request11"
      },
      {
        "parameters": {
          "amount": 20
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          752,
          1408
        ],
        "id": "e3641672-d7df-45ab-acf2-fe109a5bee83",
        "name": "Wait9",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          912,
          1408
        ],
        "id": "c3cf6cb2-db90-414a-a378-55c8a0f0c611",
        "name": "HTTP Request12"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1104,
          1408
        ],
        "id": "ffd8312a-23dd-4345-a0ff-278195d9635c",
        "name": "If6"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          672,
          2432
        ],
        "id": "d29a75a4-dfa2-4836-a80f-eea9253bcc0c",
        "name": "Wait10",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          832,
          2432
        ],
        "id": "b0e39519-630f-4ca4-bca9-aec5ef6bf9d3",
        "name": "HTTP Request13"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1024,
          2432
        ],
        "id": "67ecc1e8-c02c-4cbf-b109-23ace3700e88",
        "name": "If7"
      },
      {
        "parameters": {
          "amount": 50
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          656,
          2592
        ],
        "id": "67271c1b-67e1-4d00-9389-5a3090498ac7",
        "name": "Wait11",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "taskId",
                "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
              }
            ]
          },
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          816,
          2592
        ],
        "id": "d06e1fb0-c47a-49f8-93da-f8c39f47644e",
        "name": "HTTP Request14"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.data.state }}",
                "rightValue": "success",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1008,
          2592
        ],
        "id": "569020f0-5d34-4617-ba43-2e6266b84b14",
        "name": "If8"
      },
      {
        "parameters": {
          "content": "## Upload image\n",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -32,
          3296
        ],
        "id": "fce76f81-62cb-497a-8b8e-c81de4f720c9",
        "name": "Sticky Note7"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "uploadReferenceImage",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          384,
          3264
        ],
        "id": "30e42562-aeae-4ebf-8deb-967e1532c7a8",
        "name": "Webhook7",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"url\": \"{{ $json.publicUrl }}\"\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          896,
          3264
        ],
        "id": "30eebf13-a29f-4d9f-97f0-08566d32617a",
        "name": "Respond to Webhook7"
      },
      {
        "parameters": {
          "operation": "upload",
          "path": "={{ $('Code10').item.json.filepath }}",
          "binaryPropertyName": "file"
        },
        "type": "n8n-nodes-base.ftp",
        "typeVersion": 1,
        "position": [
          736,
          3264
        ],
        "id": "ad3b9b14-55c0-4219-a7ab-f15a0f103b95",
        "name": "FTP3",
        "credentials": {
          "ftp": {
            "id": "CREDENTIAL_REMOVED",
            "name": "FTP account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpeg\";\n\n// Aseg√∫rate de que el binary data tambi√©n se pase correctamente\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    },\n    binary: items[0].binary // Esto pasa el binary data al siguiente paso\n  }\n];\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          576,
          3264
        ],
        "id": "3bdfb1da-45e7-4428-a6a3-a8f4ed03e96d",
        "name": "Code10"
      },
      {
        "parameters": {
          "content": "## Prompt SoundFX Generation\n",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -96,
          3584
        ],
        "id": "f47b83e0-cd42-4a8b-904e-3e8bd9ffd049",
        "name": "Sticky Note8"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "prompSoundFXGen",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          336,
          3568
        ],
        "id": "53a00f43-7573-499f-b9ed-eba13a6fc946",
        "name": "Webhook8",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=[Instructions]\n{{ $json.body.promptTemplate }}\n\n[Shot information][THIS IS THE MOST IMPORTANT]\n{{ $json.body.shotDescription }}\n\n[Image Reference]\n{{ $json.body.thumbnail }}",
          "options": {
            "passthroughBinaryImages": true
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          592,
          3568
        ],
        "id": "edc03d89-c977-42dc-bec1-5c1cff681c74",
        "name": "AI Agent5"
      },
      {
        "parameters": {
          "sessionIdType": "customKey",
          "sessionKey": "SENSITIVE_DATA_REMOVED",
          "contextWindowLength": 9
        },
        "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
        "typeVersion": 1.3,
        "position": [
          688,
          3728
        ],
        "id": "1ac0891c-41d5-4c55-8713-bd4db3224238",
        "name": "Simple Memory5"
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          448,
          3792
        ],
        "id": "2ecf4fea-9fe6-4c6c-a588-257638db61cc",
        "name": "Google Gemini Chat Model5",
        "credentials": {
          "googlePalmApi": {
            "id": "CREDENTIAL_REMOVED",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          928,
          3568
        ],
        "id": "6c853c16-1bab-4e4c-8237-5298dbad95ea",
        "name": "Respond to Webhook8"
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "SoundFXGenFromPrompt",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          336,
          4016
        ],
        "id": "08b6525f-3092-4e5d-861a-476a8bf2202b",
        "name": "Webhook9",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "respondWith": "allIncomingItems",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          1712,
          4112
        ],
        "id": "1cf541c7-4983-4a74-9688-38a4a9411564",
        "name": "Respond to Webhook9"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          944,
          3984
        ],
        "id": "4e388d1c-36d4-4056-8449-adb2f46e4bb9",
        "name": "Wait12",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          528,
          4016
        ],
        "id": "30441f84-88b7-4001-a4ae-f548686e00c6",
        "name": "Code2"
      },
      {
        "parameters": {
          "content": "## SoundFX Generation",
          "height": 80,
          "width": 336
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -64,
          4032
        ],
        "id": "f49a4485-e995-4213-ae66-5756f5956389",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "amount": 3
        },
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          1056,
          4192
        ],
        "id": "690e5d53-009e-4b10-9bd0-f4c4d45a1b7e",
        "name": "Wait15",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          1040,
          4384
        ],
        "id": "77be7077-eed1-44f2-971b-1a73932dc3ea",
        "name": "Wait16",
        "webhookId": "WEBHOOKID_REMOVED"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.status }}",
                "rightValue": "succeeded",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1392,
          3968
        ],
        "id": "fbfc1854-d196-4c2e-8ce8-83b9b03a1570",
        "name": "If12"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.replicate.com/v1/predictions",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Bearer r8_TOKEN_REMOVED"
              },
              {
                "name": "Prefer",
                "value": "wait"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"version\": \"zsxkib/mmaudio:TOKEN_REMOVED\",\n  \"input\": {\n    \"seed\": -1,\n    \"video\": \"{{ $json.body.video }}\",\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"duration\": 5,\n    \"num_steps\": 25,\n    \"cfg_strength\": 4.5,\n    \"negative_prompt\": \"music\"\n  }\n} ",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          720,
          4016
        ],
        "id": "7961a560-348f-4d66-ac41-a02972efa0dc",
        "name": "HTTP Request21"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1152,
          3968
        ],
        "id": "3aaee13f-fe29-492c-804e-a83bd5f12320",
        "name": "HTTP Request15"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1200,
          4192
        ],
        "id": "4fdbb780-c2fc-4090-984c-abee203e57d0",
        "name": "HTTP Request16"
      },
      {
        "parameters": {
          "url": "={{ $json.urls.get }}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Authorization",
                "value": "Token r8_TOKEN_REMOVED"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1216,
          4416
        ],
        "id": "69d5bfc2-ebe0-4adb-8028-6b4268618fc0",
        "name": "HTTP Request17"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                "leftValue": "={{ $json.status }}",
                "rightValue": "succeeded",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          1376,
          4192
        ],
        "id": "b913a502-d275-411b-83ee-6032b308bdce",
        "name": "If13"
      }
    ],
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "AI Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory": {
        "ai_memory": [
          [
            {
              "node": "AI Agent",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent": {
        "main": [
          [
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook1": {
        "main": [
          [
            {
              "node": "AI Agent1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent1": {
        "main": [
          [
            {
              "node": "Respond to Webhook1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory1": {
        "ai_memory": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook2": {
        "main": [
          [
            {
              "node": "AI Agent2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent2": {
        "main": [
          [
            {
              "node": "Code9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory2": {
        "ai_memory": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent2",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Wait1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait1": {
        "main": [
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code9": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request3": {
        "main": [
          [
            {
              "node": "If",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If": {
        "main": [
          [
            {
              "node": "Respond to Webhook2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait": {
        "main": [
          [
            {
              "node": "HTTP Request",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request": {
        "main": [
          [
            {
              "node": "If1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If1": {
        "main": [
          [
            {
              "node": "Respond to Webhook2",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait2": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request1": {
        "main": [
          [
            {
              "node": "Respond to Webhook2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook3": {
        "main": [
          [
            {
              "node": "AI Agent3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent3": {
        "main": [
          [
            {
              "node": "Respond to Webhook3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory3": {
        "ai_memory": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent3",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook4": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request4": {
        "main": [
          [
            {
              "node": "Wait3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait3": {
        "main": [
          [
            {
              "node": "HTTP Request5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request5": {
        "main": [
          [
            {
              "node": "If2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "HTTP Request4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If2": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait4": {
        "main": [
          [
            {
              "node": "HTTP Request6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request6": {
        "main": [
          [
            {
              "node": "If3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If3": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait5": {
        "main": [
          [
            {
              "node": "HTTP Request7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request7": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook5": {
        "main": [
          [
            {
              "node": "AI Agent4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent4": {
        "main": [
          [
            {
              "node": "Respond to Webhook5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory4": {
        "ai_memory": [
          [
            {
              "node": "AI Agent4",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model4": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent4",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook6": {
        "main": [
          [
            {
              "node": "Code1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request8": {
        "main": [
          [
            {
              "node": "Wait6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait6": {
        "main": [
          [
            {
              "node": "HTTP Request9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request9": {
        "main": [
          [
            {
              "node": "If4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code1": {
        "main": [
          [
            {
              "node": "HTTP Request8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If4": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait7": {
        "main": [
          [
            {
              "node": "HTTP Request10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request10": {
        "main": [
          [
            {
              "node": "If5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If5": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait8": {
        "main": [
          [
            {
              "node": "HTTP Request11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request11": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait9": {
        "main": [
          [
            {
              "node": "HTTP Request12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request12": {
        "main": [
          [
            {
              "node": "If6",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If6": {
        "main": [
          [
            {
              "node": "Respond to Webhook4",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait10": {
        "main": [
          [
            {
              "node": "HTTP Request13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request13": {
        "main": [
          [
            {
              "node": "If7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If7": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait11",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait11": {
        "main": [
          [
            {
              "node": "HTTP Request14",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request14": {
        "main": [
          [
            {
              "node": "If8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If8": {
        "main": [
          [
            {
              "node": "Respond to Webhook6",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook7": {
        "main": [
          [
            {
              "node": "Code10",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code10": {
        "main": [
          [
            {
              "node": "FTP3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "FTP3": {
        "main": [
          [
            {
              "node": "Respond to Webhook7",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook8": {
        "main": [
          [
            {
              "node": "AI Agent5",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent5": {
        "main": [
          [
            {
              "node": "Respond to Webhook8",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Simple Memory5": {
        "ai_memory": [
          [
            {
              "node": "AI Agent5",
              "type": "ai_memory",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model5": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent5",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Webhook9": {
        "main": [
          [
            {
              "node": "Code2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait12": {
        "main": [
          [
            {
              "node": "HTTP Request15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code2": {
        "main": [
          [
            {
              "node": "HTTP Request21",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait15": {
        "main": [
          [
            {
              "node": "HTTP Request16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait16": {
        "main": [
          [
            {
              "node": "HTTP Request17",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If12": {
        "main": [
          [
            {
              "node": "Respond to Webhook9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait15",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request21": {
        "main": [
          [
            {
              "node": "Wait12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request15": {
        "main": [
          [
            {
              "node": "If12",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request16": {
        "main": [
          [
            {
              "node": "If13",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request17": {
        "main": [
          [
            {
              "node": "Respond to Webhook9",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "If13": {
        "main": [
          [
            {
              "node": "Respond to Webhook9",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Wait16",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "settings": {
      "executionOrder": "v1"
    },
    "staticData": null,
    "meta": {
      "templateCredsSetupCompleted": true
    },
    "pinData": {},
    "versionId": "af155485-16e5-4d24-8019-b6a8a6da14e2",
    "activeVersionId": "af155485-16e5-4d24-8019-b6a8a6da14e2",
    "triggerCount": 10,
    "shared": [
      {
        "updatedAt": "2025-11-07T02:08:56.224Z",
        "createdAt": "2025-11-07T02:08:56.224Z",
        "role": "workflow:owner",
        "workflowId": "vqNteL2eYv09zj95",
        "projectId": "l0nkiXsgbXEDzHYa"
      }
    ],
    "activeVersion": {
      "updatedAt": "2025-12-26T01:33:14.866Z",
      "createdAt": "2025-12-26T01:33:14.866Z",
      "versionId": "af155485-16e5-4d24-8019-b6a8a6da14e2",
      "workflowId": "vqNteL2eYv09zj95",
      "nodes": [
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "scriptIdea",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            0,
            0
          ],
          "id": "68e3ab01-7084-443f-8f78-f1a49c9657fc",
          "name": "Webhook",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=\n\nYour task is to generate the story for a video with the central theme:\n{{ $json.body.videoIdea }}\n\n{{ $json.body.promptTemplate }}",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            288,
            0
          ],
          "id": "5b1c9ee1-0e45-4aef-b569-7daca05ec34f",
          "name": "AI Agent"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            352,
            160
          ],
          "id": "acf73bfa-e7ff-4990-bd89-e4629843af40",
          "name": "Simple Memory"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            64,
            208
          ],
          "id": "d7567545-0c9a-43dd-bc83-c02dc8faad55",
          "name": "Google Gemini Chat Model",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            896,
            32
          ],
          "id": "4e9fd6e6-a9aa-4930-9c3e-4ec4ffcbde93",
          "name": "Respond to Webhook"
        },
        {
          "parameters": {
            "jsCode": "// Obtiene la salida del nodo Gemini (la cadena de texto con el JSON)\nconst jsonString = $input.first().json.output; \n\n// 1. Limpia los marcadores de bloque de c√≥digo (si los hay)\nconst cleanedString = jsonString\n    .replace('```json\\n', '')\n    .replace('\\n```', '')\n    .trim();\n\n// 2. Parsea la cadena limpia en un objeto JSON real\nconst jsonObject = JSON.parse(cleanedString);\n\n// 3. Devuelve el objeto JSON para que el workflow lo use\nreturn [{ json: jsonObject }];"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            656,
            16
          ],
          "id": "bb1ed4c7-42ad-408e-9990-6e581a1e9660",
          "name": "Code in JavaScript"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "artdirection",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            -16,
            416
          ],
          "id": "baaa5f2d-2ad9-4712-ba9a-9d9734901611",
          "name": "Webhook1",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "={{ $json.body.artDirectionPromptTemplate }}\n{{ $json.body.script }}\nextra information:\n{{ $json.body.artDirectionIdea }}\nimage reference:\n{{ $json.body.image }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            240,
            416
          ],
          "id": "42fd472e-b74e-4dc1-986c-8d40e5135f1f",
          "name": "AI Agent1"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            336,
            576
          ],
          "id": "43f6ff89-7c4c-4719-a821-75f4ca691b4e",
          "name": "Simple Memory1"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            0,
            608
          ],
          "id": "1ae9dad9-8639-4936-8fdc-707c8d17af80",
          "name": "Google Gemini Chat Model1",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            576,
            416
          ],
          "id": "b8c70dcb-6fe4-4d6a-b18a-e05b5b6c802c",
          "name": "Respond to Webhook1"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "imageGen",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            2560,
            896
          ],
          "id": "4fb23850-3f2b-4653-b9ce-66c0af44a424",
          "name": "Webhook2",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=You are an expert prompt engineer for cinematic AI image generation. Your task is to combine provided information into a single, highly detailed, and cinematic image prompt.\n\nI will provide you with:\n1.  **ACTION SHOT:** A single sentence describing a specific action and its location (Home, Commute, or Maid Cafe).\n2.  **CHARACTER DESCRIPTION:** A detailed, hyperrealistic description of the main anthropomorphic pomeranian character.\n3.  **HOME LOCATION DESCRIPTION:** A detailed description of the pomeranian's modern, urban home.\n4.  **OUTFIT DESCRIPTION:** A detailed description of the full Maid Cafe server uniform.\n5.  **ADVENTURE LOCATION DESCRIPTION:** A detailed description of the Maid Cafe setting.\n6.  **PAJAMA/CASUAL DESCRIPTION (NEW):** A detailed description of the pomeranian's casual wear or pajamas (e.g., comfortable cotton pajamas, simple hoodie and jeans).\n\nYour output must be ONLY the final, single-line, highly detailed and cinematic image prompt. Do not include any additional text, titles, or numbering.\n\n**LOGIC RULE:**\n* If the **ACTION SHOT** takes place in the **HOME** (Bedroom, Bathroom, Kitchen, Living Room) AND is **NOT** the shot where the outfit is being put on (Shot 7), you MUST use the **PAJAMA/CASUAL DESCRIPTION**.\n* If the **ACTION SHOT** takes place on the **COMMUTE** or in the **MAID CAFE**, or IF the shot is **Shot 7 (putting on uniform)**, you MUST use the **OUTFIT DESCRIPTION**.\n* Only use the relevant LOCATION (HOME or ADVENTURE) in the final prompt.\n\nFocus on:\n-   Integrating all relevant details from the provided descriptions.\n-   Adding cinematic elements (soft volumetric lighting, low angle, anamorphic lens, film grain).\n-   Specifying high quality (e.g., \"ultra-realistic,\" \"photorealistic,\" \"Candid photo\").\n-   Ensuring the pomeranian is the clear focal point of the action.\n\nExample Structure:\n[ACTION_SHOT_DETAIL], [CHARACTER_DESCRIPTION_INTEGRATED_INTO_ACTION], [OUTFIT/PAJAMA_DETAIL_APPLIED], [RELEVANT_LOCATION_DETAIL_INTEGRATED_INTO_SCENE], cinematic composition, shallow depth of field, [CINEMATIC_ELEMENTS: lighting, camera angle, mood], ultra-realistic, photorealistic, high detail, masterpiece.\n\n**ACTION SHOT** MOST IMPORTANT\n{{ $json.body.script }}\n\n**Extra details**\n{{ $json.body.artDirection }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            2784,
            896
          ],
          "id": "70db3feb-ac5e-4b31-8c0b-acc7e4696d6b",
          "name": "AI Agent2"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            2896,
            1072
          ],
          "id": "09cf79c2-cbc8-4030-9872-97058102aa55",
          "name": "Simple Memory2"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash-lite",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            2784,
            1056
          ],
          "id": "ed49985c-fe21-4e0c-b77e-1bba6e9b074b",
          "name": "Google Gemini Chat Model2",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            4416,
            896
          ],
          "id": "6b37fcf6-4ce4-4121-8145-da083d9f9d1d",
          "name": "Respond to Webhook2"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/jobs/createTask",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"google/nano-banana-edit\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_urls\": [\n      \"{{ $('Webhook2').item.json.body.image }}\"\n    ],\n    \"output_format\": \"png\",\n    \"image_size\": \"16:9\"\n  }\n}",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3280,
            896
          ],
          "id": "4b9eb38e-57e6-4354-9909-c337b20c119a",
          "name": "HTTP Request2"
        },
        {
          "parameters": {
            "amount": 10
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            3472,
            848
          ],
          "id": "37b4941c-bd14-44d0-a5d1-31a2e540262c",
          "name": "Wait1",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3648,
            832
          ],
          "id": "6bf3dd63-ec10-445f-9931-35551dabfea6",
          "name": "HTTP Request3"
        },
        {
          "parameters": {
            "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.output;\n\n  // 1. Verificar y remover las comillas dobles iniciales y finales\n  if (typeof outputText === \"string\" && outputText.startsWith('\"') && outputText.endsWith('\"')) {\n    outputText = outputText.slice(1, -1); // Remueve la primera y √∫ltima comilla\n  }\n\n  // 2. Remover todos los saltos de l√≠nea (\\n) y retornos de carro (\\r)\n  // Utilizamos una expresi√≥n regular global (/g) para asegurarnos de que se eliminen todos.\n  if (typeof outputText === \"string\") {\n    outputText = outputText.replace(/[\\n\\r]/g, \"\"); \n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            3120,
            896
          ],
          "id": "5b2d09da-f7ac-4366-90dc-3770633c75b6",
          "name": "Code9"
        },
        {
          "parameters": {
            "content": "## Generate the Script",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -448,
            16
          ],
          "id": "5eaecbf3-1c14-4c2a-8a83-45b123fb8bb1",
          "name": "Sticky Note"
        },
        {
          "parameters": {
            "content": "## Generate the Art Direction",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -432,
            432
          ],
          "id": "44daf38a-44f0-4b8e-ad14-ada59f7bcb7b",
          "name": "Sticky Note1"
        },
        {
          "parameters": {
            "content": "## Image Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            2160,
            912
          ],
          "id": "196c6b0b-53d3-4d46-b038-8ef0a90b1531",
          "name": "Sticky Note2"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3824,
            800
          ],
          "id": "edc67a35-c304-40d8-a58e-eff3023650a1",
          "name": "If"
        },
        {
          "parameters": {
            "amount": 20
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            3472,
            1040
          ],
          "id": "d397a895-4ecb-438e-82bd-94ff2b54d842",
          "name": "Wait",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request2').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3632,
            1040
          ],
          "id": "59289d8d-ced2-4ef6-93ce-8cf5a7119ca0",
          "name": "HTTP Request"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            3824,
            1040
          ],
          "id": "3b038b19-b992-43cc-bb51-7f75ee4de2b2",
          "name": "If1"
        },
        {
          "parameters": {
            "amount": 30
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            3488,
            1232
          ],
          "id": "e997a359-4c3d-4fd4-8c31-e479dc99c67d",
          "name": "Wait2",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request2').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            3840,
            1248
          ],
          "id": "ceee9331-47d6-4aef-947f-25b0cba2a715",
          "name": "HTTP Request1"
        },
        {
          "parameters": {
            "content": "## Prompt Image Generation\n",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -384,
            800
          ],
          "id": "10e1f8c3-c72b-43e8-b0e0-ea74f11027c0",
          "name": "Sticky Note3"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "promptImageGen",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            32,
            768
          ],
          "id": "f42bba1f-5e10-4599-b925-8f6259907d28",
          "name": "Webhook3",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=[Instructions]\n{{ $json.body.promptTemplate }}\n\n[Shot information][THIS IS THE MOST IMPORTANT]\n{{ $json.body.script }}\n\n[Art Direction]\n{{ $json.body.artDirection }}\n\n[Image Reference]\n{{ $json.body.image }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            288,
            768
          ],
          "id": "062550ac-b983-46e2-89c2-e2cea31da4ca",
          "name": "AI Agent3"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            384,
            928
          ],
          "id": "3bc75d56-ecf7-4694-b5a5-abb484e1ab31",
          "name": "Simple Memory3"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            96,
            992
          ],
          "id": "68a940f1-9ec2-47ce-9dce-ce9ef1273e2e",
          "name": "Google Gemini Chat Model3",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            624,
            768
          ],
          "id": "e9a76bf6-dafb-40aa-8d34-06d191a86498",
          "name": "Respond to Webhook3"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "ImageGenFromPrompt",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            -128,
            1184
          ],
          "id": "4b048932-8db1-4b2b-aa25-69a33b61321a",
          "name": "Webhook4",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            1440,
            1136
          ],
          "id": "3e268b46-fe5b-4364-a59a-a2ec7655cc9b",
          "name": "Respond to Webhook4"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/jobs/createTask",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"google/nano-banana-edit\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_urls\": [\n      \"{{ $('Webhook4').item.json.body.image }}\"\n    ],\n    \"output_format\": \"png\",\n    \"image_size\": \"16:9\"\n  }\n}",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            272,
            1168
          ],
          "id": "58c1c407-3dc7-452e-a201-85913a03ba67",
          "name": "HTTP Request4"
        },
        {
          "parameters": {
            "amount": 10
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            752,
            992
          ],
          "id": "949fc6ee-69ec-4ac7-8736-8ee80858b590",
          "name": "Wait3",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            928,
            976
          ],
          "id": "3aaf0ab4-aeeb-44df-8d63-c15f85063ba2",
          "name": "HTTP Request5"
        },
        {
          "parameters": {
            "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            32,
            1184
          ],
          "id": "3a4f4fe7-f010-43ca-a106-1db5718d3dd4",
          "name": "Code"
        },
        {
          "parameters": {
            "content": "## Image Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -528,
            1200
          ],
          "id": "ec91b90f-c68f-4cfb-851e-d125f9d29833",
          "name": "Sticky Note4"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            1104,
            944
          ],
          "id": "fcab4f57-8c31-4dd0-9aea-8d2c2785c19c",
          "name": "If2"
        },
        {
          "parameters": {
            "amount": 20
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            752,
            1184
          ],
          "id": "62f281d7-dd2e-4378-ac1f-f8162c3dbee1",
          "name": "Wait4",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            912,
            1184
          ],
          "id": "d882254c-fa31-4707-98ab-b48f31ce487d",
          "name": "HTTP Request6"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            1104,
            1184
          ],
          "id": "c1d5bbac-7d74-4ab6-9495-a11247d46ce1",
          "name": "If3"
        },
        {
          "parameters": {
            "amount": 30
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            768,
            1616
          ],
          "id": "814f1af5-c499-475a-ae9b-b2a3b617ff1f",
          "name": "Wait5",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            1120,
            1632
          ],
          "id": "5abec5ea-aaa8-4d8a-afd3-6de975a94055",
          "name": "HTTP Request7"
        },
        {
          "parameters": {
            "content": "## Prompt Video Generation\n",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -288,
            1840
          ],
          "id": "f3185982-a487-44da-95a9-f85d1ded1918",
          "name": "Sticky Note5"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "prompVideoGen",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            128,
            1808
          ],
          "id": "c568139d-eab0-404e-9432-eb588cceba1c",
          "name": "Webhook5",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=[Instructions]\n{{ $json.body.promptTemplate }}\n\n[Shot information][THIS IS THE MOST IMPORTANT]\n{{ $json.body.shotDescription }}\n\n[Image Reference]\n{{ $json.body.thumbnail }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            384,
            1808
          ],
          "id": "ce6301fa-360f-482f-bcbc-da791757bf25",
          "name": "AI Agent4"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            480,
            1968
          ],
          "id": "85959950-9040-4bc1-9a2b-4e23c3ae2c4d",
          "name": "Simple Memory4"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            240,
            2032
          ],
          "id": "b043fce2-743f-47c0-be21-b0a35d4aa396",
          "name": "Google Gemini Chat Model4",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            720,
            1808
          ],
          "id": "b287c10e-c3f5-42a5-a90e-2360aebab370",
          "name": "Respond to Webhook5"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "VideoGenFromPrompt",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            -32,
            2288
          ],
          "id": "dbfc1d3a-85d4-4bc4-823d-3c274768195a",
          "name": "Webhook6",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            1328,
            2384
          ],
          "id": "41d4bf85-3316-4975-8f32-23094828d24d",
          "name": "Respond to Webhook6"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.kie.ai/api/v1/jobs/createTask",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"model\": \"bytedance/v1-lite-image-to-video\",\n  \"input\": {\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"image_url\": \"{{ $json.body.thumbnail }}\",\n    \"resolution\": \"480p\",\n    \"duration\": \"5\",\n    \"camera_fixed\": true,\n    \"seed\": -1,\n    \"enable_safety_checker\": true\n  }\n}",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            384,
            2256
          ],
          "id": "efc73cb4-1986-4aeb-982e-d81dfa9b7dfc",
          "name": "HTTP Request8"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            640,
            2240
          ],
          "id": "c2b5c71c-e2c9-4c2f-a687-ec6367344721",
          "name": "Wait6",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            816,
            2224
          ],
          "id": "82147c68-4f6c-4835-a28c-c941219adf01",
          "name": "HTTP Request9"
        },
        {
          "parameters": {
            "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            128,
            2288
          ],
          "id": "6b1a4e5c-c8d3-49c2-8d13-e2c068ebeb33",
          "name": "Code1"
        },
        {
          "parameters": {
            "content": "## Video Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -432,
            2304
          ],
          "id": "8ee0380e-5f11-4a73-81ee-5df833d7425e",
          "name": "Sticky Note6"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            992,
            2192
          ],
          "id": "f50601de-a659-4b68-9b26-28a8696152ea",
          "name": "If4"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            640,
            2784
          ],
          "id": "1984b6b7-6319-4aa4-8a45-4588a948e3f3",
          "name": "Wait7",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            800,
            2784
          ],
          "id": "0d21571e-965e-41cc-b225-c7195f7d549f",
          "name": "HTTP Request10"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            992,
            2784
          ],
          "id": "6986f519-4f40-4147-b4f2-48fda41c3bab",
          "name": "If5"
        },
        {
          "parameters": {
            "amount": 200
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            656,
            2976
          ],
          "id": "c3e8cf4d-d432-4ecf-80b3-9683d6373a8f",
          "name": "Wait8",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            1008,
            2992
          ],
          "id": "b2461e4c-83ce-445e-8e26-fe391c51573d",
          "name": "HTTP Request11"
        },
        {
          "parameters": {
            "amount": 20
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            752,
            1408
          ],
          "id": "e3641672-d7df-45ab-acf2-fe109a5bee83",
          "name": "Wait9",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request4').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            912,
            1408
          ],
          "id": "c3cf6cb2-db90-414a-a378-55c8a0f0c611",
          "name": "HTTP Request12"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            1104,
            1408
          ],
          "id": "ffd8312a-23dd-4345-a0ff-278195d9635c",
          "name": "If6"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            672,
            2432
          ],
          "id": "d29a75a4-dfa2-4836-a80f-eea9253bcc0c",
          "name": "Wait10",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            832,
            2432
          ],
          "id": "b0e39519-630f-4ca4-bca9-aec5ef6bf9d3",
          "name": "HTTP Request13"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            1024,
            2432
          ],
          "id": "67ecc1e8-c02c-4cbf-b109-23ace3700e88",
          "name": "If7"
        },
        {
          "parameters": {
            "amount": 50
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            656,
            2592
          ],
          "id": "67271c1b-67e1-4d00-9389-5a3090498ac7",
          "name": "Wait11",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
            "sendQuery": true,
            "queryParameters": {
              "parameters": [
                {
                  "name": "taskId",
                  "value": "={{ $('HTTP Request8').item.json.data.taskId }}"
                }
              ]
            },
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            816,
            2592
          ],
          "id": "d06e1fb0-c47a-49f8-93da-f8c39f47644e",
          "name": "HTTP Request14"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.data.state }}",
                  "rightValue": "success",
                  "operator": {
                    "type": "string",
                    "operation": "equals",
                    "name": "filter.operator.equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            1008,
            2592
          ],
          "id": "569020f0-5d34-4617-ba43-2e6266b84b14",
          "name": "If8"
        },
        {
          "parameters": {
            "content": "## Upload image\n",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -32,
            3296
          ],
          "id": "fce76f81-62cb-497a-8b8e-c81de4f720c9",
          "name": "Sticky Note7"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "uploadReferenceImage",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            384,
            3264
          ],
          "id": "30e42562-aeae-4ebf-8deb-967e1532c7a8",
          "name": "Webhook7",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "json",
            "responseBody": "={\n  \"url\": \"{{ $json.publicUrl }}\"\n}",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            896,
            3264
          ],
          "id": "30eebf13-a29f-4d9f-97f0-08566d32617a",
          "name": "Respond to Webhook7"
        },
        {
          "parameters": {
            "operation": "upload",
            "path": "={{ $('Code10').item.json.filepath }}",
            "binaryPropertyName": "file"
          },
          "type": "n8n-nodes-base.ftp",
          "typeVersion": 1,
          "position": [
            736,
            3264
          ],
          "id": "ad3b9b14-55c0-4219-a7ab-f15a0f103b95",
          "name": "FTP3",
          "credentials": {
            "ftp": {
              "id": "CREDENTIAL_REMOVED",
              "name": "FTP account"
            }
          }
        },
        {
          "parameters": {
            "jsCode": "const filename = new Date().toISOString()\n  .replace(/:/g, \"-\")\n  .replace(/\\..+/, \"\")\n  .replace(\"T\", \"_\") + \".jpeg\";\n\n// Aseg√∫rate de que el binary data tambi√©n se pase correctamente\nreturn [\n  {\n    json: {\n      filename,\n      filepath: `/public_html/uploads/pets/images/${filename}`,\n      publicUrl: `https://lemonsushi.com/uploads/pets/images/${filename}`\n    },\n    binary: items[0].binary // Esto pasa el binary data al siguiente paso\n  }\n];\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            576,
            3264
          ],
          "id": "3bdfb1da-45e7-4428-a6a3-a8f4ed03e96d",
          "name": "Code10"
        },
        {
          "parameters": {
            "content": "## Prompt SoundFX Generation\n",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -96,
            3584
          ],
          "id": "f47b83e0-cd42-4a8b-904e-3e8bd9ffd049",
          "name": "Sticky Note8"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "prompSoundFXGen",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            336,
            3568
          ],
          "id": "53a00f43-7573-499f-b9ed-eba13a6fc946",
          "name": "Webhook8",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "promptType": "define",
            "text": "=[Instructions]\n{{ $json.body.promptTemplate }}\n\n[Shot information][THIS IS THE MOST IMPORTANT]\n{{ $json.body.shotDescription }}\n\n[Image Reference]\n{{ $json.body.thumbnail }}",
            "options": {
              "passthroughBinaryImages": true
            }
          },
          "type": "@n8n/n8n-nodes-langchain.agent",
          "typeVersion": 3,
          "position": [
            592,
            3568
          ],
          "id": "edc03d89-c977-42dc-bec1-5c1cff681c74",
          "name": "AI Agent5"
        },
        {
          "parameters": {
            "sessionIdType": "customKey",
            "sessionKey": "SENSITIVE_DATA_REMOVED",
            "contextWindowLength": 9
          },
          "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
          "typeVersion": 1.3,
          "position": [
            688,
            3728
          ],
          "id": "1ac0891c-41d5-4c55-8713-bd4db3224238",
          "name": "Simple Memory5"
        },
        {
          "parameters": {
            "modelName": "models/gemini-2.0-flash",
            "options": {}
          },
          "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
          "typeVersion": 1,
          "position": [
            448,
            3792
          ],
          "id": "2ecf4fea-9fe6-4c6c-a588-257638db61cc",
          "name": "Google Gemini Chat Model5",
          "credentials": {
            "googlePalmApi": {
              "id": "CREDENTIAL_REMOVED",
              "name": "Google Gemini(PaLM) Api account"
            }
          }
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            928,
            3568
          ],
          "id": "6c853c16-1bab-4e4c-8237-5298dbad95ea",
          "name": "Respond to Webhook8"
        },
        {
          "parameters": {
            "httpMethod": "POST",
            "path": "SoundFXGenFromPrompt",
            "responseMode": "responseNode",
            "options": {}
          },
          "type": "n8n-nodes-base.webhook",
          "typeVersion": 2.1,
          "position": [
            336,
            4016
          ],
          "id": "08b6525f-3092-4e5d-861a-476a8bf2202b",
          "name": "Webhook9",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "respondWith": "allIncomingItems",
            "options": {}
          },
          "type": "n8n-nodes-base.respondToWebhook",
          "typeVersion": 1.4,
          "position": [
            1712,
            4112
          ],
          "id": "1cf541c7-4983-4a74-9688-38a4a9411564",
          "name": "Respond to Webhook9"
        },
        {
          "parameters": {},
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            944,
            3984
          ],
          "id": "4e388d1c-36d4-4056-8449-adb2f46e4bb9",
          "name": "Wait12",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "jsCode": "for (const item of $input.all()) {\n  let outputText = item.json.body.prompt;\n\n  if (typeof outputText === \"string\") {\n\n    // 1. Quitar comillas iniciales y finales\n    outputText = outputText.replace(/^[\"']|[\"']$/g, \"\");\n\n    // 2. Quitar TODAS las comillas dobles, simples y escapadas\n    outputText = outputText.replace(/[\"'\\\\]/g, \"\");\n\n    // 3. Eliminar saltos de l√≠nea y tabs\n    outputText = outputText.replace(/[\\n\\r\\t]/g, \" \");\n\n    // 4. Quitar cualquier bracket o s√≠mbolo que pueda romper prompts\n    outputText = outputText.replace(/[{}\\[\\]<>\\(\\)]/g, \"\");\n\n    // 5. Quitar espacios m√∫ltiples\n    outputText = outputText.replace(/\\s+/g, \" \");\n\n    // 6. Trim final\n    outputText = outputText.trim();\n  }\n\n  item.json.cleanedOutput = outputText;\n}\n\nreturn $input.all();\n"
          },
          "type": "n8n-nodes-base.code",
          "typeVersion": 2,
          "position": [
            528,
            4016
          ],
          "id": "30441f84-88b7-4001-a4ae-f548686e00c6",
          "name": "Code2"
        },
        {
          "parameters": {
            "content": "## SoundFX Generation",
            "height": 80,
            "width": 336
          },
          "type": "n8n-nodes-base.stickyNote",
          "typeVersion": 1,
          "position": [
            -64,
            4032
          ],
          "id": "f49a4485-e995-4213-ae66-5756f5956389",
          "name": "Sticky Note9"
        },
        {
          "parameters": {
            "amount": 3
          },
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            1056,
            4192
          ],
          "id": "690e5d53-009e-4b10-9bd0-f4c4d45a1b7e",
          "name": "Wait15",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {},
          "type": "n8n-nodes-base.wait",
          "typeVersion": 1.1,
          "position": [
            1040,
            4384
          ],
          "id": "77be7077-eed1-44f2-971b-1a73932dc3ea",
          "name": "Wait16",
          "webhookId": "WEBHOOKID_REMOVED"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.status }}",
                  "rightValue": "succeeded",
                  "operator": {
                    "type": "string",
                    "operation": "equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            1392,
            3968
          ],
          "id": "fbfc1854-d196-4c2e-8ce8-83b9b03a1570",
          "name": "If12"
        },
        {
          "parameters": {
            "method": "POST",
            "url": "https://api.replicate.com/v1/predictions",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Bearer r8_TOKEN_REMOVED"
                },
                {
                  "name": "Prefer",
                  "value": "wait"
                }
              ]
            },
            "sendBody": true,
            "specifyBody": "json",
            "jsonBody": "={\n  \"version\": \"zsxkib/mmaudio:TOKEN_REMOVED\",\n  \"input\": {\n    \"seed\": -1,\n    \"video\": \"{{ $json.body.video }}\",\n    \"prompt\": \"{{ $json.cleanedOutput }}\",\n    \"duration\": 5,\n    \"num_steps\": 25,\n    \"cfg_strength\": 4.5,\n    \"negative_prompt\": \"music\"\n  }\n} ",
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.3,
          "position": [
            720,
            4016
          ],
          "id": "7961a560-348f-4d66-ac41-a02972efa0dc",
          "name": "HTTP Request21"
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            1152,
            3968
          ],
          "id": "3aaee13f-fe29-492c-804e-a83bd5f12320",
          "name": "HTTP Request15"
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            1200,
            4192
          ],
          "id": "4fdbb780-c2fc-4090-984c-abee203e57d0",
          "name": "HTTP Request16"
        },
        {
          "parameters": {
            "url": "={{ $json.urls.get }}",
            "sendHeaders": true,
            "headerParameters": {
              "parameters": [
                {
                  "name": "Authorization",
                  "value": "Token r8_TOKEN_REMOVED"
                }
              ]
            },
            "options": {}
          },
          "type": "n8n-nodes-base.httpRequest",
          "typeVersion": 4.2,
          "position": [
            1216,
            4416
          ],
          "id": "69d5bfc2-ebe0-4adb-8028-6b4268618fc0",
          "name": "HTTP Request17"
        },
        {
          "parameters": {
            "conditions": {
              "options": {
                "caseSensitive": true,
                "leftValue": "",
                "typeValidation": "strict",
                "version": 2
              },
              "conditions": [
                {
                  "id": "d99fae8a-b95c-438a-b3d9-744d407cf03c",
                  "leftValue": "={{ $json.status }}",
                  "rightValue": "succeeded",
                  "operator": {
                    "type": "string",
                    "operation": "equals"
                  }
                }
              ],
              "combinator": "and"
            },
            "options": {}
          },
          "type": "n8n-nodes-base.if",
          "typeVersion": 2.2,
          "position": [
            1376,
            4192
          ],
          "id": "b913a502-d275-411b-83ee-6032b308bdce",
          "name": "If13"
        }
      ],
      "connections": {
        "Webhook": {
          "main": [
            [
              {
                "node": "AI Agent",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory": {
          "ai_memory": [
            [
              {
                "node": "AI Agent",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent": {
          "main": [
            [
              {
                "node": "Code in JavaScript",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code in JavaScript": {
          "main": [
            [
              {
                "node": "Respond to Webhook",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook1": {
          "main": [
            [
              {
                "node": "AI Agent1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent1": {
          "main": [
            [
              {
                "node": "Respond to Webhook1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory1": {
          "ai_memory": [
            [
              {
                "node": "AI Agent1",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model1": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent1",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook2": {
          "main": [
            [
              {
                "node": "AI Agent2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent2": {
          "main": [
            [
              {
                "node": "Code9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory2": {
          "ai_memory": [
            [
              {
                "node": "AI Agent2",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model2": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent2",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request2": {
          "main": [
            [
              {
                "node": "Wait1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait1": {
          "main": [
            [
              {
                "node": "HTTP Request3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code9": {
          "main": [
            [
              {
                "node": "HTTP Request2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request3": {
          "main": [
            [
              {
                "node": "If",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If": {
          "main": [
            [
              {
                "node": "Respond to Webhook2",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait": {
          "main": [
            [
              {
                "node": "HTTP Request",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request": {
          "main": [
            [
              {
                "node": "If1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If1": {
          "main": [
            [
              {
                "node": "Respond to Webhook2",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait2": {
          "main": [
            [
              {
                "node": "HTTP Request1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request1": {
          "main": [
            [
              {
                "node": "Respond to Webhook2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook3": {
          "main": [
            [
              {
                "node": "AI Agent3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent3": {
          "main": [
            [
              {
                "node": "Respond to Webhook3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory3": {
          "ai_memory": [
            [
              {
                "node": "AI Agent3",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model3": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent3",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook4": {
          "main": [
            [
              {
                "node": "Code",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request4": {
          "main": [
            [
              {
                "node": "Wait3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait3": {
          "main": [
            [
              {
                "node": "HTTP Request5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request5": {
          "main": [
            [
              {
                "node": "If2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code": {
          "main": [
            [
              {
                "node": "HTTP Request4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If2": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait4": {
          "main": [
            [
              {
                "node": "HTTP Request6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request6": {
          "main": [
            [
              {
                "node": "If3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If3": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait5": {
          "main": [
            [
              {
                "node": "HTTP Request7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request7": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook5": {
          "main": [
            [
              {
                "node": "AI Agent4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent4": {
          "main": [
            [
              {
                "node": "Respond to Webhook5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory4": {
          "ai_memory": [
            [
              {
                "node": "AI Agent4",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model4": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent4",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook6": {
          "main": [
            [
              {
                "node": "Code1",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request8": {
          "main": [
            [
              {
                "node": "Wait6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait6": {
          "main": [
            [
              {
                "node": "HTTP Request9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request9": {
          "main": [
            [
              {
                "node": "If4",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code1": {
          "main": [
            [
              {
                "node": "HTTP Request8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If4": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait7": {
          "main": [
            [
              {
                "node": "HTTP Request10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request10": {
          "main": [
            [
              {
                "node": "If5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If5": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait8": {
          "main": [
            [
              {
                "node": "HTTP Request11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request11": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait9": {
          "main": [
            [
              {
                "node": "HTTP Request12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request12": {
          "main": [
            [
              {
                "node": "If6",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If6": {
          "main": [
            [
              {
                "node": "Respond to Webhook4",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait10": {
          "main": [
            [
              {
                "node": "HTTP Request13",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request13": {
          "main": [
            [
              {
                "node": "If7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If7": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait11",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait11": {
          "main": [
            [
              {
                "node": "HTTP Request14",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request14": {
          "main": [
            [
              {
                "node": "If8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If8": {
          "main": [
            [
              {
                "node": "Respond to Webhook6",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook7": {
          "main": [
            [
              {
                "node": "Code10",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code10": {
          "main": [
            [
              {
                "node": "FTP3",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "FTP3": {
          "main": [
            [
              {
                "node": "Respond to Webhook7",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Webhook8": {
          "main": [
            [
              {
                "node": "AI Agent5",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "AI Agent5": {
          "main": [
            [
              {
                "node": "Respond to Webhook8",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Simple Memory5": {
          "ai_memory": [
            [
              {
                "node": "AI Agent5",
                "type": "ai_memory",
                "index": 0
              }
            ]
          ]
        },
        "Google Gemini Chat Model5": {
          "ai_languageModel": [
            [
              {
                "node": "AI Agent5",
                "type": "ai_languageModel",
                "index": 0
              }
            ]
          ]
        },
        "Webhook9": {
          "main": [
            [
              {
                "node": "Code2",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait12": {
          "main": [
            [
              {
                "node": "HTTP Request15",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Code2": {
          "main": [
            [
              {
                "node": "HTTP Request21",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait15": {
          "main": [
            [
              {
                "node": "HTTP Request16",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "Wait16": {
          "main": [
            [
              {
                "node": "HTTP Request17",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If12": {
          "main": [
            [
              {
                "node": "Respond to Webhook9",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait15",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request21": {
          "main": [
            [
              {
                "node": "Wait12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request15": {
          "main": [
            [
              {
                "node": "If12",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request16": {
          "main": [
            [
              {
                "node": "If13",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "HTTP Request17": {
          "main": [
            [
              {
                "node": "Respond to Webhook9",
                "type": "main",
                "index": 0
              }
            ]
          ]
        },
        "If13": {
          "main": [
            [
              {
                "node": "Respond to Webhook9",
                "type": "main",
                "index": 0
              }
            ],
            [
              {
                "node": "Wait16",
                "type": "main",
                "index": 0
              }
            ]
          ]
        }
      },
      "authors": "system migration",
      "name": null,
      "description": null,
      "autosaved": false
    },
    "tags": []
  }
]